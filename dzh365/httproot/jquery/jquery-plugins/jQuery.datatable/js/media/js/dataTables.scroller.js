(function(d,c,a){var b=function(f,e){if(!this instanceof b){alert("Scroller warning: Scroller must be initialised with the 'new' keyword.");return}if(typeof e=="undefined"){e={}}this.s={dt:f,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,rowHeight:null,autoHeight:true,viewportHeight:0,viewportRows:0,stateTO:null,drawTO:null};this.s=d.extend(this.s,b.oDefaults,e);this.dom={force:a.createElement("div"),scroller:null,table:null};this.s.dt.oScroller=this;this._fnConstruct()};b.prototype={fnRowToPixels:function(e){return e*this.s.rowHeight},fnPixelsToRow:function(e){return parseInt(e/this.s.rowHeight,10)},fnScrollToRow:function(g,f){var e=this.fnRowToPixels(g);if(typeof f=="undefined"||f){d(this.dom.scroller).animate({scrollTop:e})}else{d(this.dom.scroller).scrollTop(e)}},fnMeasure:function(e){if(this.s.autoHeight){this._fnCalcRowHeight()}this.s.viewportHeight=d(this.dom.scroller).height();this.s.viewportRows=parseInt(this.s.viewportHeight/this.s.rowHeight,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer;if(this.s.trace){console.log("Row height: "+this.s.rowHeight+" Viewport height: "+this.s.viewportHeight+" Viewport rows: "+this.s.viewportRows+" Display rows: "+this.s.dt._iDisplayLength)}if(typeof e=="undefined"||e){this.s.dt.oInstance.fnDraw()}},_fnConstruct:function(){var e=this;this.dom.force.style.position="absolute";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=d("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=d(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";d(this.s.dt.nTableWrapper).addClass("DTS");if(this.s.loadingIndicator){d(this.dom.scroller.parentNode).css("position","relative").append('<div class="DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>")}if(this.s.rowHeight&&this.s.rowHeight!="auto"){this.s.autoHeight=false}this.fnMeasure(false);d(this.dom.scroller).scroll(function(){e._fnScroll.call(e)});d(this.dom.scroller).bind("touchstart",function(){e._fnScroll.call(e)});this.s.dt.aoDrawCallback.push({fn:function(){if(e.s.dt.bInitialised){e._fnDrawCallback.call(e)}},sName:"Scroller"});this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(f,g){g.iScroller=e.dom.scroller.scrollTop},"Scroller_State")},_fnScroll:function(){var g=this,f=this.dom.scroller.scrollTop,h;if(this.s.dt.bFiltered||this.s.dt.bSorted){return}if(this.s.trace){console.log("Scroll: "+f+"px - boundaries: "+this.s.redrawTop+" / "+this.s.redrawBottom+".  Showing rows "+this.fnPixelsToRow(f)+" to "+this.fnPixelsToRow(f+d(this.dom.scroller).height())+" in the viewport, with rows "+this.s.dt._iDisplayStart+" to "+(this.s.dt._iDisplayEnd)+" rendered by the DataTable")}this._fnInfo();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){g.s.dt.oApi._fnSaveState(g.s.dt)},250);if(f<this.s.redrawTop||f>this.s.redrawBottom){var e=((this.s.displayBuffer-1)/2)*this.s.viewportRows;h=parseInt(f/this.s.rowHeight,10)-e;if(h<0){h=0}else{if(h+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()){h=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength;if(h<0){h=0}}else{if(h%2!==0){h++}}}if(h!=this.s.dt._iDisplayStart){this.s.tableTop=d(this.s.dt.nTable).offset().top;this.s.tableBottom=d(this.s.dt.nTable).height()+this.s.tableTop;if(this.s.dt.oFeatures.bServerSide){clearTimeout(this.s.drawTO);this.s.drawTO=setTimeout(function(){g.s.dt._iDisplayStart=h;g.s.dt.oApi._fnCalculateEnd(g.s.dt);g.s.dt.oApi._fnDraw(g.s.dt)},this.s.serverWait)}else{this.s.dt._iDisplayStart=h;this.s.dt.oApi._fnCalculateEnd(this.s.dt);this.s.dt.oApi._fnDraw(this.s.dt)}if(this.s.trace){console.log("Scroll forcing redraw - top DT render row: "+h)}}}},_fnDrawCallback:function(){var g=this,e=this.dom.scroller.scrollTop,h=e+this.s.viewportHeight;this.dom.force.style.height=(this.s.rowHeight*this.s.dt.fnRecordsDisplay())+"px";var f=(this.s.rowHeight*this.s.dt._iDisplayStart);if(this.s.dt._iDisplayStart===0){f=0}else{if(this.s.dt._iDisplayStart===this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength){f=this.s.rowHeight*this.s.dt._iDisplayStart}}this.dom.table.style.top=f+"px";this.s.tableTop=f;this.s.tableBottom=d(this.s.dt.nTable).height()+this.s.tableTop;this.s.redrawTop=e-((e-this.s.tableTop)*this.s.boundaryScale);this.s.redrawBottom=e+((this.s.tableBottom-h)*this.s.boundaryScale);if(this.s.trace){console.log("Table redraw. Table top: "+f+"px Table bottom: "+this.s.tableBottom+" Scroll boundary top: "+this.s.redrawTop+" Scroll boundary bottom: "+this.s.redrawBottom+" Rows drawn: "+this.s.dt._iDisplayLength)}setTimeout(function(){g._fnInfo.call(g)},0);if(this.s.dt.oFeatures.bStateSave&&this.s.dt.oLoadedState!==null&&typeof this.s.dt.oLoadedState.iScroller!="undefined"){if((this.s.dt.sAjaxSource!==null&&this.s.dt.iDraw==2)||(this.s.dt.sAjaxSource===null&&this.s.dt.iDraw==1)){setTimeout(function(){d(g.dom.scroller).scrollTop(g.s.dt.oLoadedState.iScroller);g.s.redrawTop=g.s.dt.oLoadedState.iScroller-(g.s.viewportHeight/2)},0)}}},_fnCalcRowHeight:function(){var f=this.s.dt.nTable.cloneNode(false);var e=d('<div class="'+this.s.dt.oClasses.sWrapper+' DTS"><div class="'+this.s.dt.oClasses.sScrollWrapper+'"><div class="'+this.s.dt.oClasses.sScrollBody+'"></div></div></div>')[0];d(f).append("<tbody><tr><td>&nbsp;</td></tr></tbody>");d("div."+this.s.dt.oClasses.sScrollBody,e).append(f);a.body.appendChild(e);this.s.rowHeight=d("tbody tr",f).outerHeight();a.body.removeChild(e)},_fnInfo:function(){if(!this.s.dt.oFeatures.bInfo){return}var f=this.s.dt,l=this.dom.scroller.scrollTop,e=this.fnPixelsToRow(l)+1,m=f.fnRecordsTotal(),r=f.fnRecordsDisplay(),o=this.fnPixelsToRow(l+d(this.dom.scroller).height()),u=r<o?r:o,g=f.fnFormatNumber(e),k=f.fnFormatNumber(u),t=f.fnFormatNumber(m),s=f.fnFormatNumber(r),q;if(f.fnRecordsDisplay()===0&&f.fnRecordsDisplay()==f.fnRecordsTotal()){q=f.oLanguage.sInfoEmpty+f.oLanguage.sInfoPostFix}else{if(f.fnRecordsDisplay()===0){q=f.oLanguage.sInfoEmpty+" "+f.oLanguage.sInfoFiltered.replace("_MAX_",t)+f.oLanguage.sInfoPostFix}else{if(f.fnRecordsDisplay()==f.fnRecordsTotal()){q=f.oLanguage.sInfo.replace("_START_",g).replace("_END_",k).replace("_TOTAL_",s)+f.oLanguage.sInfoPostFix}else{q=f.oLanguage.sInfo.replace("_START_",g).replace("_END_",k).replace("_TOTAL_",s)+" "+f.oLanguage.sInfoFiltered.replace("_MAX_",f.fnFormatNumber(f.fnRecordsTotal()))+f.oLanguage.sInfoPostFix}}}var j=f.aanFeatures.i;if(typeof j!="undefined"){for(var p=0,h=j.length;p<h;p++){d(j[p]).html(q)}}}};b.oDefaults={trace:false,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:0.5,loadingIndicator:false};b.prototype.CLASS="Scroller";b.VERSION="1.1.0";b.prototype.VERSION=b.VERSION;if(typeof d.fn.dataTable=="function"&&typeof d.fn.dataTableExt.fnVersionCheck=="function"&&d.fn.dataTableExt.fnVersionCheck("1.9.0")){d.fn.dataTableExt.aoFeatures.push({fnInit:function(g){var f=(typeof g.oInit.oScroller=="undefined")?{}:g.oInit.oScroller;var e=new b(g,f);return e.dom.wrapper},cFeature:"S",sFeature:"Scroller"})}else{alert("Warning: Scroller requires DataTables 1.9.0 or greater - www.datatables.net/download")}d.fn.dataTable.Scroller=b})(jQuery,window,document);