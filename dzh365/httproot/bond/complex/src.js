define("models/security",["observable","formatter"],function(e,t){return e.extend(function(e){$.extend(this,e),this.symbol=t.fixSymbol(this.obj)},{obj:"",name:"--",update:function(e){for(var t in e)("new"!==t||0!=e[t])&&(this[t]=isNaN(Number(e[t]))?e[t]:Number(e[t]));this.calculate(),this.emit("updated")},calculate:function(){this.lastTrade=t.fixLastTrade(this),this.change=t.fixChange(this),this.chg=t.fixChg(this)}})}),define("repositories/security",["repository_base","../models/security"],function(e,t){return e.extend({getInfo:function(e,t){return 1===arguments.length&&(t=e,e="new,lastclose"),$.send("/objinfo/getinfo",{field:e,where:"obj="+t})},getQuotes:function(e,t,n){switch(arguments.length){case 1:n=e,t="new,lastclose",e=void 0;break;case 2:n=t,t=e,e=void 0}return $.send(e?"/did?did="+e:"/quote/dyna",{field:t,where:"obj="+n,response_mode:0,response_times:-1})},getBlockInfo:function(e){return $.send({service:"blockinfo",type:e?"leaf":"sub",source:"local",block:e||"自选股",depth:1},{after:function(e){return e.map(function(e){return new t({obj:e.stockid,name:e.stockname})})}})}})}),define("models/deliverable",["./security"],function(e){return e.extend({bond:new e,rate:new e,regDate:new RegExp("(\\d\\d)(\\d\\d)$"),getIRR:function(e){var t=Number(this[e])+Number(this.tradeDateAccruedInterest),n=this.bond.lastTrade*Number(this.conversionFactor)+Number(this.deliveryDateAccruedInterest),i=new Date(this.valueDate.replace(this.regDate,"-$1-$2")),r=new Date(this.tradeDate.replace(this.regDate,"-$1-$2")),s=new Date(this.deliveryDate.replace(this.regDate,"-$1-$2")),o=0,a=0,d=Number(this.couponRate),u=Number(this.paymentFrequency),c=(s-r)/864e5;for(r.getFullYear()-i.getFullYear()&&i.setFullYear(r.getFullYear()-1);s>i;)i.setMonth(i.getMonth()+12/u),i>r&&s>i&&(o+=d/u,a+=o*((s-i)/864e5)/c);return(n-t+o)*(365/c)/(t-a)*100},getBSS:function(e){return Number(this[e])-Number(this.bond.lastTrade)*Number(this.conversionFactor)},getBNOC:function(e){var t=Number(this[e])+Number(this.tradeDateAccruedInterest),n=this.bond.lastTrade*Number(this.conversionFactor)+Number(this.deliveryDateAccruedInterest),i=new Date(this.tradeDate.replace(this.regDate,"-$1-$2")),r=new Date(this.deliveryDate.replace(this.regDate,"-$1-$2")),s=(r-i)/864e5;return t*(1+Number(this.rate.lastTrade/100)*s/365)-n}})}),define("repositories/bond",["./security","../models/security","../models/deliverable"],function(e,t,n){return new(e.extend({getBondIndices:function(e){switch(e){case 0:return $.send("/bond/treasuryBondScreen/getZzBondIndex.dzh");case 1:return $.send("/bond/treasuryBondScreen/getCsiBondIndex.dzh");default:return $.Deferred()}},getYieldCurves:function(e){return $.send("/bond/treasuryBondScreen/getYieldCurveList.dzh",{bondType:++e})},getInterBankBonds:function(e){var t=$.Deferred();return $.send("/did",{did:100007,fullmarket:1,where:"obj=IB&field=obj"}).then(function(t){$.send("/bond/treasuryBondScreen/getInterbankQuotationList.dzh",{bondType:++e,bondCode:t.map(function(e){return e.obj}).toString()},{before:function(e){return e.head.forEach(function(e,t){switch(e){case"A28":this[t]="obj"}},e.head),e}}).then(this.resolve.bind(this))}.bind(t)),t},getBestPriceBonds:function(e){var t=$.Deferred();return $.send("/did",{did:100011,fullmarket:1,where:"obj=IB&field=obj"}).then(function(t){$.send("/bond/treasuryBondScreen/getInterbankQuotationList.dzh",{bondType:++e,bondCode:t.map(function(e){return e.obj}).toString()},{before:function(e){return e.head.forEach(function(e,t){switch(e){case"A28":this[t]="obj"}},e.head),e}}).then(this.resolve.bind(this))}.bind(t)),t},getBonds:function(e){return this.getBlockInfo(["上证债券","上证小公募","上证转债","深证债券","深证转债"][e])},getTreasuryFutures:function(){var e=$.Deferred();return this.getBlockInfo("国债期货").then(function(e){this.resolve(e.filter(function(e){return-1===e.obj.indexOf("0000.")}))}.bind(e),function(){this.reject.apply(this,arguments)}.bind(e)),e},getInterestRateList:function(){var e=$.Deferred();return this.getBlockInfo("上证回购,深证回购").then(function(e){this.resolve([new t({obj:"IBR001.rpo"}),new t({obj:"IBR007.rpo"}),new t({obj:"IBR014.rpo"}),new t({obj:"IBR021.rpo"}),new t({obj:"IBR1M.rpo"}),new t({obj:"IBR2M.rpo"}),new t({obj:"IBR3M.rpo"}),new t({obj:"IBR6M.rpo"}),new t({obj:"IBR9M.rpo"}),new t({obj:"IBR1Y.rpo"})].concat(e.filter(function(e){return!/^SH20[1-3]/.test(e.obj)})))}.bind(e),function(){this.reject.apply(this,arguments)}.bind(e)),e},getBondYields:function(){return $.send("/bond/bondWeixin/getBondsYieldCurve.dzh",{curve:"treBondCurve"})},getDeliverableBonds:function(e){return $.send("/bond/treasuryfutureScreen/getDeliverableBondsResult.dzh",{contractCode:e},{before:function(e){return e.datas.forEach(function(e){e[0].head.forEach(function(e,t){switch(e){case"bondCode":this[t]="obj";break;case"bondName":this[t]="name";break;case"bondCodeShort":this[t]="symbol"}},e[0].head)}),e},after:function(e){return e.map(function(e){return e.map(function(e){return new n(e)})})}})}}))}),define("repositories/news",["repository_base"],function(e){return new(e.extend({getNewsByMenuId:function(e){return $.send("/rpc",{so:"jso-ui-zhpnews.jar","function":"gw.sh.func.SearchNewsFromSolrRequest",paraencode:"base64",parameter:btoa(JSON.stringify({fids:"C1,C3,C6,C8",menuid:e,dcategory:"1",bdate:"",edate:"",sort:"C6:-1",skip:"0",amount:"50"}))})},getReportByTreeId:function(e){return $.send("/stock/html5_orr2/solr_report/getReportDataForTree112.mod",{treeId:e,__encoding:"gbk",page:1,jg:"",userName:external.getDZHProperty?external.getDZHProperty("userid"):""})},getNoticeByTypeId:function(e){return $.send("/rpc",{so:"jso-ui-notice_new.jar","function":"gw.sh.func.NoticeSearchRequest",paraencode:"base64",parameter:btoa(JSON.stringify({type:e,pageNum:1,pageSize:50,bdate:"",edate:""}))},{before:function(e){return e&&(e.datas[0][1].head=["TYPE","CV","C1","C6","C3","C4","C5","C8","C7"]),e}})}}))}),define("presenters/index",["presenter_base","../repositories/bond","../repositories/news"],function(e,t,n){return e.extend(function(){this.view.on("tabActive",this.onTabActive.bind(this))},{onInit:function(){$.when(this.cacheBondIndices0=t.getBondIndices(0),this.cacheYieldCurves0=t.getYieldCurves(0),this.cacheInterBankBonds0=t.getInterBankBonds(0),this.cacheBestPriceBonds0=t.getBestPriceBonds(0),this.cacheBonds0=t.getBonds(0),n.getNewsByMenuId("000001000")).then(function(){this.view.renderBondIndicesGrid(arguments[0]),this.view.renderYieldCurvesGrid(arguments[1]),this.view.renderInterBankBondsGrid(arguments[2]),this.view.renderBestPriceBondsGrid(arguments[3]),this.view.renderBondsGrid(arguments[4]),this.view.renderNewsGrid(5,arguments[5]),n.getNewsByMenuId("000001007").then(this.view.renderNewsGrid.bind(this.view,6)),n.getNoticeByTypeId(10).then(this.view.renderNewsGrid.bind(this.view,7))}.bind(this),function(){location.reload()}.bind(this))},onTabActive:function(e,n){var i="cache"+n+e;i in this||(this.view["render"+n+"Grid"]([]),this[i]=t["get"+n](e)),this[this.active]&&"resolved"!==this[this.active].state()&&(this[this.active].reject("cancel"),delete this[this.active]),this[i].then(this.view["render"+n+"Grid"].bind(this.view)),this.active=i}})}),define("views/index",["view_base","../presenters/index","fast_grid","active_grid","quotes_grid","tabs","dialog"],function(e,t,n,i,r){var s=e.extend(function(){this.tabs.on("active",this.onTabActive.bind(this))},{onTabActive:function(e,t){var i=e.currentTarget.widget.panes.eq(t).widget();i instanceof n?i.refresh():this.emit("tabActive",t,["BondIndices","YieldCurves","InterBankBonds","BestPriceBonds","Bonds"][this.tabs.index(e.currentTarget)])},onGridSelectItem:function(e){this.fastGrids.forEach(function(e){e!==this&&(e.selectedItem=void 0,e.target.find("tr.active").removeClass("active"))},e)},renderBondIndicesGrid:function(e){var t=0,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new i(this.grids[t],{columns:[{width:"220",name:"债券指数",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.co+'">'+e.c1+"</a>"}},{width:"75",name:"最新",color:function(e){return this.fixColor(e.c4,4)},sort:!0,value:function(e){return e.c2}},{width:"75",name:"涨跌",color:function(e){return this.fixColor(e.c3,4)},sort:!0,value:function(e){return this.fixFloat(e.c3)}},{width:"85",name:"涨跌幅",color:function(e){return this.fixColor(e.c3,4)},sort:!0,value:function(e){return this.fixPercent(e.c4)}},{width:"85",name:"日期",sort:!0,value:function(e){return this.fixTime(e.c5,"Y-M-d")}}],items:e,onSelectItem:this.onGridSelectItem.bind(this)}))},renderYieldCurvesGrid:function(e){var t=1,i=this.grids[t].widget;i?(i.selectedItem=void 0,i.setItems(e),i.head.find("th:first-child").html("期限"+(this.tabs.eq(1).widget().selectedIndex>2?"(AAA)":""))):this.fastGrids.push(new n(this.grids[t],{columns:[{width:"75",name:"期限",css:"l",sort:!0,value:function(e){return e.A16}},{width:"85",name:"收益率(%)",css:"yellow",sort:!0,value:function(e){return e.A17}},{width:"75",name:"近一日(bp)",sort:!0,value:function(e){return e.A18}},{width:"75",name:"近一月(bp)",sort:!0,value:function(e){return e.A19}},{width:"75",name:"近一年(bp)",sort:!0,value:function(e){return e.A20}},{width:"60",name:"中位数",sort:!0,value:function(e){return e.A21}},{width:"50",name:"分位",sort:!0,value:function(e){return this.fixPercent(100*e.A22)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this)}))},renderInterBankBondsGrid:function(e){var t=2,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["100007:newclean,newyield,changeclean"],columns:[{width:"85",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+this.fixSymbol(e.obj)+"</a>"}},{width:"170",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.A24+"</a>"}},{width:"85",name:"最新价",color:function(e){return this.fixColor(e.changeclean)},sort:!0,value:function(e){return this.fixFloat(e.newclean,4)}},{width:"85",name:"收益率",sort:!0,value:function(e){return this.fixPercent(e.newyield,4)}},{width:"85",name:"涨跌幅",color:function(e){return this.fixColor(e.changeclean)},sort:!0,order:"desc",value:function(e){return this.fixPercent(e.changeclean)}},{width:"100",name:"最新估值",sort:!0,value:function(e){return this.fixFloat(e.A25,4)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderBestPriceBondsGrid:function(e){var t=3,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["100011:buyclean,buyyield,sellclean,sellyield,buyinitiator,sellinitiator,buytime"],columns:[{width:"85",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+this.fixSymbol(e.obj)+"</a>"}},{width:"170",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.A24+"</a>"}},{width:"130",name:"最优买",sort:function(e){return this.fixFloat(e.buyyield)},value:function(e){return this.fixFloat(e.buyclean,4)+"/"+this.fixPercent(e.buyyield,4)}},{width:"130",name:"最优卖",sort:function(e){return this.fixFloat(e.sellyield)},value:function(e){return this.fixFloat(e.sellclean,4)+"/"+this.fixPercent(e.sellyield,4)}},{width:"110",name:"买方",css:"l",sort:!0,value:function(e){return e.buyinitiator||"－"}},{width:"110",name:"卖方",css:"l",sort:!0,value:function(e){return e.sellinitiator||"－"}},{width:"0",name:"",sort:function(e){return e.buytime||""},order:"desc",value:function(){return""}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderBondsGrid:function(e){var t=4,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["new,lastclose,amount,volume"],columns:[{width:"70",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.symbol+"</a>"}},{width:"75",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}},{width:"75",name:"最新价",color:!0,sort:!0,value:function(e){return this.fixFloat(e.lastTrade)}},{width:"75",name:"涨跌幅",color:!0,sort:!0,order:"desc",value:function(e){return this.fixPercent(e.chg)}},{width:"95",name:"成交额(元)",sort:!0,value:function(e){return this.fixInt(e.amount)}},{width:"95",name:"成交量(手)",sort:!0,value:function(e){return this.fixInt(e.volume)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderNewsGrid:function(e,t){var i=this.grids[e].widget;i?(i.selectedItem=void 0,i.setItems(t)):this.fastGrids.push(new n(this.grids[e],{columns:[{width:"auto",name:"标题",css:"l",sort:!0,title:!0,value:function(e){return"<a href=\"dzh://navigate?'root://news/details/index.html#"+e.C1+"#DZHPOPUP(854,504)#'\">"+e.C3+"</a>"}},{width:"85",name:"时间",sort:!0,value:function(e){return this.fixTime(e.C6,"Y-M-d")}}],items:t,onSelectItem:this.onGridSelectItem.bind(this)}))}});return s.init=function(){new t(new this({root:$(document),grids:$(".grid"),chart:$("iframe.flex-auto"),tabs:$(".nav-tabs"),fastGrids:[]}))},s}),define("presenters/futures",["presenter_base","../repositories/bond","../repositories/news"],function(e,t,n){return e.extend(function(){this.view.on("gridSelectItem",this.onGridSelectItem.bind(this)),this.onSelectItemUpdated=this.view.renderDeliverableBonds.bind(this.view)},{onInit:function(){$.when(t.getTreasuryFutures(),t.getInterestRateList(),n.getNewsByMenuId("000001006")).then(function(){this.rate=arguments[1].filter(function(e){return"IBR007.rpo"===e.obj})[0].on("updated",this.onSelectItemUpdated),this.view.renderTreasuryFuturesGrid(arguments[0]),this.view.renderSpreadMatrixGrid(arguments[0]),this.view.renderInterestRateGrid(arguments[1]),this.view.renderDefaultFutures(),t.getBondYields().then(this.view.renderBondYieldsGrid.bind(this.view)),this.view.renderNewsGrid(8,arguments[2]),n.getNewsByMenuId("000001007").then(this.view.renderNewsGrid.bind(this.view,9)),n.getReportByTreeId("B13005").then(this.view.renderReportGrid.bind(this.view))}.bind(this),function(){location.reload()}.bind(this))},onGridSelectItem:function(e){e!==this.active&&(this.active&&this.active.off("updated",this.onSelectItemUpdated),this.promise&&this.promise.cancel(),this.active=e,this.promise=t.getDeliverableBonds(e.obj).then(function(e){e.forEach(function(e){e.forEach(function(e){e.bond=this.active,e.rate=this.rate},this)},this),this.view.renderOfferGrid(e[0]),this.view.renderTradedGrid(e[1]),this.view.renderValuationGrids([e[2],e[3]]),this.active.on("updated",this.onSelectItemUpdated)}.bind(this)))}})}),define("views/futures",["view_base","../presenters/futures","fast_grid","active_grid","quotes_grid","tabs","dialog"],function(e,t,n,i,r){var s=e.extend(function(){this.tabs.on("active",this.onTabActive.bind(this))},{onTabActive:function(e,t){var i=e.currentTarget.widget.panes.eq(t).widget();i instanceof n&&i.refresh()},onGridSelectItem:function(e,t){this.fastGrids.forEach(function(e){e!==this&&(e.selectedItem=void 0,e.target.find("tr.active").removeClass("active"))},e),/cmdty$/.test(t.obj)&&this.renderChart(t.obj)},renderTreasuryFuturesGrid:function(e){var t=0,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{decimals:3,fields:"new,lastclose,buyprice,sellprice,openinterest,volume,presettle",columns:[{width:"85",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}},{width:"60",name:"最新",color:!0,sort:!0,value:function(e){return this.fixFloat(this.fixLastTrade(e),this.decimals)}},{width:"60",name:"涨幅",color:!0,sort:!0,value:function(e){return this.fixPercent(this.fixChg(e))}},{width:"60",name:"买一",color:!0,sort:!0,value:function(e){return this.fixFloat(e.buyprice instanceof Array?e.buyprice[0]:e.buyprice,this.decimals)}},{width:"60",name:"卖一",color:!0,sort:!0,value:function(e){return this.fixFloat(e.sellprice instanceof Array?e.sellprice[0]:e.sellprice,this.decimals)}},{width:"75",name:"持仓量",sort:!0,value:function(e){return this.fixInt(e.openinterest)}},{width:"75",name:"成交量",sort:!0,value:function(e){return this.fixInt(e.volume)}},{width:"60",name:"昨收",sort:!0,value:function(e){return this.fixFloat(e.lastclose,this.decimals)}},{width:"75",name:"昨结算",sort:!0,value:function(e){return this.fixFloat(e.presettle,this.decimals)}}],items:e,onSelectItem:function(e,t){this.emit("gridSelectItem",t),this.onGridSelectItem(e,t)}.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderSpreadMatrixGrid:function(e){var t=1,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):(this.fastGrids.push(new i(this.grids[t],{columns:[{width:"85",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}}].concat(e.map(function(e){return{width:15*e.name.replace(/\d{4}/g,"***").length+10,name:e.name,color:function(e,t,n){return this.fixColor(this.fixLastTrade(e)-this.fixLastTrade(this.columns[n].item),3)},value:function(e,t,n){return this.fixFloat(this.fixLastTrade(e)-this.fixLastTrade(this.columns[n].item),3)},item:e}})),items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}})),this.grids.eq(0).widget().on("changed",function(){this.refresh(!0)}.bind(this.grids.eq(1).widget())))},renderChart:function(e){this.chart.attr("src","/platform/charts/index.html#"+e)},renderDefaultChart:function(){for(var e=0,t=this.fastGrids.length;t>e;e++){var n=this.fastGrids[e];if(n.getItems().length){n.one("sorted",function(e){this.onQuotesGridSelectItem(e.getItem(0).obj)}.bind(this));break}}},renderOfferGrid:function(e){var t=2,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["100007:newclean,newyield"],columns:[{width:"65",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.symbol+"</a>"}},{width:"110",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}},{width:"85",name:"最新",sort:!0,value:function(e){return this.fixFloat(e.newclean,4)}},{width:"85",name:"转换因子",sort:!0,value:function(e){return e.conversionFactor}},{width:"100",name:"收益率",sort:!0,value:function(e){return this.fixPercent(e.newyield,4)}},{width:"115",name:"隐含回购利率",css:"yellow",sort:!0,order:"desc",value:function(e){return this.fixPercent(e.getIRR("newclean"),4)}},{width:"85",name:"基差",sort:!0,value:function(e){return this.fixFloat(e.getBSS("newclean"),4)}},{width:"85",name:"净基差",sort:!0,value:function(e){return this.fixFloat(e.getBNOC("newclean"),4)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderTradedGrid:function(e){var t=3,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["new,lastclose","100012:ytm"],columns:[{width:"65",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.symbol+"</a>"}},{width:"110",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}},{width:"85",name:"最新",color:!0,sort:!0,value:function(e){return this.fixFloat(this.fixLastTrade(e),4)}},{width:"85",name:"转换因子",sort:!0,value:function(e){return e.conversionFactor}},{width:"100",name:"收益率",sort:!0,value:function(e){return this.fixPercent(100*e.ytm,4)}},{width:"115",name:"隐含回购利率",css:"yellow",sort:!0,order:"desc",value:function(e){return this.fixPercent(e.getIRR("lastTrade"),4)}},{width:"85",name:"基差",sort:!0,value:function(e){return this.fixFloat(e.getBSS("lastTrade"),4)}},{width:"85",name:"净基差",sort:!0,value:function(e){return this.fixFloat(e.getBNOC("lastTrade"),4)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderValuationGrids:function(e){e.forEach(function(e,t){t=[6,7][t];var n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new i(this.grids[t],{columns:[{width:"65",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.symbol+"</a>"}},{width:"110",name:"简称",css:"yellow l",sort:!0,title:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.name+"</a>"}},{width:"85",name:"最新估值",sort:!0,value:function(e){return e.newValuation}},{width:"85",name:"转换因子",sort:!0,value:function(e){return this.fixFloat(e.conversionFactor,4)}},{width:"100",name:"收益率",sort:!0,value:function(e){return this.fixPercent(e.valuationOfRate,4)}},{width:"115",name:"隐含回购利率",css:"yellow",sort:!0,order:"desc",value:function(e){return this.fixPercent(e.getIRR("newValuation"),4)}},{width:"85",name:"基差",sort:!0,value:function(e){return this.fixFloat(e.getBSS("newValuation"),4)}},{width:"85",name:"净基差",sort:!0,value:function(e){return this.fixFloat(e.getBNOC("newValuation"),4)}},{width:"100",name:"日期",sort:!0,value:function(e){return this.fixTime(e.valDate,"Y-M-d")}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},this)},renderInterestRateGrid:function(e){var t=4,n=this.grids[t].widget;n?(n.selectedItem=void 0,n.setItems(e)):this.fastGrids.push(new r(this.grids[t],{fields:["new,lastclose,avg,open,high,low,lastavg","100005:new,lastclose,avg,open,high,low,lastavg"],columns:[{width:"65",name:"代码",css:"blue l",sort:!0,value:function(e){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+e.obj+'">'+e.symbol+"</a>"}},{width:"70",name:"最新",color:!0,sort:!0,value:function(e){return this.fixFloat(this.fixLastTrade(e),4)}},{width:"70",name:"涨幅",color:!0,sort:!0,value:function(e){return this.fixPercent(this.fixChg(e))}},{width:"70",name:"均价",sort:!0,value:function(e){return this.fixFloat(e.avg||0/0,4)}},{width:"70",name:"开盘",sort:!0,value:function(e){return this.fixFloat(e.open||0/0,4)}},{width:"70",name:"最高",sort:!0,value:function(e){return this.fixFloat(e.high||0/0,4)}},{width:"70",name:"最低",sort:!0,value:function(e){return this.fixFloat(e.low||0/0,4)}},{width:"70",name:"前均价",sort:!0,value:function(e){return this.fixFloat(e.lastavg||0/0,4)}}],items:e,onSelectItem:this.onGridSelectItem.bind(this),onDblClick:function(e){location.assign($(e.currentTarget).find("a").attr("href"))}}))},renderBondYieldsGrid:function(e){var t=5,i=this.grids[t].widget;i?(i.selectedItem=void 0,i.setItems(e)):this.fastGrids.push(new n(this.grids[t],{columns:[{width:"100",name:"期限",css:"l",sort:!0,value:function(e){return"国债收益率:"+e.deadline}},{width:"90",name:"收益率(%)",css:"yellow",sort:!0,value:function(e){return e.yieldRate}},{width:"90",name:"近一日(bp)",sort:!0,value:function(e){return e.beforeDayYieldRateBp}},{width:"90",name:"近一月(bp)",sort:!0,value:function(e){return e.beforeMonthYieldRateBp}},{width:"90",name:"近一年(bp)",sort:!0,value:function(e){return e.beforeYearYieldRateBp}}],items:e,onSelectItem:this.onGridSelectItem.bind(this)}))},renderNewsGrid:function(e,t){var i=this.grids[e].widget;i?(i.selectedItem=void 0,i.setItems(t)):this.fastGrids.push(new n(this.grids[e],{columns:[{width:"auto",name:"标题",css:"l",sort:!0,title:!0,value:function(e){return"<a href=\"dzh://navigate?'root://news/details/index.html#"+e.C1+"#DZHPOPUP(854,504)#'\">"+e.C3+"</a>"}},{width:"100",name:"来源",css:"l",sort:!0,value:function(e){return e.C8}},{width:"85",name:"时间",sort:!0,value:function(e){return this.fixTime(e.C6,"Y-M-d")}}],items:t,onSelectItem:this.onGridSelectItem.bind(this)}))},renderReportGrid:function(e){var t=10,i=this.grids[t].widget;i?(i.selectedItem=void 0,i.setItems(e)):this.fastGrids.push(new n(this.grids[t],{columns:[{width:"auto",name:"标题",css:"l",sort:!0,title:!0,value:function(e){return"<a href=\"dzh://navigate?'root://news/details/report.html#"+e.bgnm+"#DZHPOPUP(854,504)#'\">"+e.bt+"</a>"}},{width:"100",name:"机构",css:"l",sort:!0,value:function(e){return e.yjjg.split("_")[0]}},{width:"85",name:"时间",sort:!0,value:function(e){return e.rq}}],items:e,onSelectItem:this.onGridSelectItem.bind(this)}))},renderDeliverableBonds:function(){this.grids.each(function(e){switch(e){case 2:case 3:case 6:case 7:this.widget&&this.widget.refresh(!0)}})},renderDefaultFutures:function(){this.grids.eq(0).widget().body.find("tr:first-child").click()}});return s.init=function(){new t(new this({root:$(document),grids:$(".grid"),chart:$("iframe.flex-auto"),tabs:$(".nav-tabs"),fastGrids:[]}))},s}),require(["views/index","views/futures"],function(){require(["views/"+(location.pathname.match(/([^\/]+)\.html/)||[,"index"])[1]],function(){arguments[0]&&arguments[0].init&&arguments[0].init()})}),define("src",function(){});