define("js/plan",["jquery","socket"],function(e){userPreferEntryUrl="/stock/sys/sys_user/preferdata/userPreferEntry.mod";var t,n,a,i=window.external.getDZHProperty?window.external.getDZHProperty("userid"):"dzh112_094",l=[{id:"default1",defaultPlan:!0,rank:0,title:"铁道债",data:{tj:{publisherName:"中国铁路总公司",survivalStatus:"1",pageNum:1},sm:"中国铁路总公司发行的债券。	"}},{id:"default2",defaultPlan:!0,rank:0,survivalStatus:"1",title:"交易所高收益债",data:{tj:{listMarket:"CNSESH,CNSESZ",survivalStatus:"1",valuationRate:"5",pageNum:1},sm:" 沪深交易所上市的债券，最新估值收益率高于9%。"}}],s=function(e){for(var t={id:"",rank:"",title:"",data:{tj:{survivalStatus:"1"},sm:""}},a=0,i=n.length;i>a;a++)if(n[a]&&n[a].id==e)for(var l in n[a])if("data"==l){t.data={},t.data.sm=n[a].data.sm,t.data.tj={};for(var s in n[a].data.tj)t.data.tj[s]=n[a].data.tj[s]}else t[l]=n[a][l];return t},o=function(){var t={action:"select",type:"appdic",name:"bondFind"};e.send(userPreferEntryUrl,t).then(function(e){console.log("---------------appicData--------------"),a=e[0].id,r(e[0].id)},function(){console.log("---------------appdicData--------出错了----------"),console.dir(arguments)})},d=function(){for(var n="",a=0,i=t.length;i>a;a++)n+='<li data-planid="'+t[a].id+'" data-formserver="true">'+t[a].title+"</li>";e("#myPlanUl li[data-formserver = true]").remove(),e("#manageUl li[data-formserver = true]").remove(),e("#myPlanUl").append(n),e("#manageUl").append(n)},r=function(a){var s={action:"query",type:"userdata",user:i,appid:a,categoryid:0};e.send(userPreferEntryUrl,s).then(function(e){if(console.log("---------------queryData--------------"),e[0].id){for(var a=0,i=e.length;i>a;a++)e[a].data=JSON.parse(e[a].data);t=e,n=l.concat(e),d()}else n=l.concat([])},function(){console.log("-----------请求用户方案出错了----------------"),console.dir(arguments),n=l.concat([])})},c=function(e,t,a){for(var i=0,l=n.length;l>i;i++)n[i]&&n[i].id==e&&(n[i].title=t,n[i].data=a)},u=function(e,t,a){var i={};i.id=e,i.title=t,i.data=a,n.push(i)},f=function(t,n,a){e("#myPlanUl li").each(function(e,a){a.dataset.planid==t&&(a.innerHTML=n)}),e("#manageUl li").each(function(e,a){a.dataset.planid==t&&(a.innerHTML=n)});var i=e("#showPlanName");i.attr("data-planid")==t&&(i.html(n),e("#projectName").val(n),e("#projectDetail").val(a.sm))},h=function(t,n){var a='<li data-planid="'+t+'" data-formserver="true">';a+=n+"</li>",e("#myPlanUl").append(a),e("#manageUl").append(a)},p=function(t){var n=s(t);e("#projectName").val(n.title),e("#projectDetail").val(n.data.sm)},m=function(t){var n=s(t),a=e("#manageProjectName"),i=e("#manageProjectDetail");a.val(n.title),i.val(n.data.sm),e("#manageUl li.selected").attr("data-formserver")?(a.prop({disabled:!1}),i.prop({disabled:!1})):(a.prop({disabled:!0}),i.prop({disabled:!0}))};e("#myPlanUl li").live("click",function(t){var n=e(t.target),a=n.attr("data-planid"),i=n.text(),l=e("#showPlanName");l.attr({"data-planid":a}),l.text(i),p(a)}),e("#manageUl li").live("click",function(t){e("#manageUl li").removeClass("selected"),e(t.target).prop("class","selected");var n=e(t.target).attr("data-planid");m(n)});var v=function(t){for(var a=!1,i=(e("#showPlanName").attr("data-planid"),0),l=n.length;l>i;i++)n[i]&&n[i].title==t&&(a=!0);return a},g=function(e,t){for(var a=!1,i=t,l=0,s=n.length;s>l;l++)if(n[l]&&n[l].title==e&&n[l].id!=i){a=!0;break}return a},b=function(){var t=e("#projectName").val(),l=e("#projectDetail").val();if(""==t||null==t)e("#poinMainContent").html("方案名称不能为空"),e(".point-dialog").widget("dialog").show();else if(v(t))e("#poinMainContent").html("此方案名称已存在，请修改方案名称"),e(".point-dialog").widget("dialog").show();else{for(var s=1,o=0,d=n.length;d>o;o++)n[o]&&s++;if(203>s){var r={};for(var c in selectedConditions)""!=selectedConditions[c]&&"all"!=selectedConditions[c]&&(r[c]=selectedConditions[c]);var f={tj:r,sm:l},p={action:"insert",type:"userdata",user:i,categoryid:0,appid:a,title:t,data:JSON.stringify(f)};e.send(userPreferEntryUrl,p).then(function(t){if(t[0].resultcode)e("#poinMainContent").html("方案保存失败！"),e(".point-dialog").widget("dialog").show();else if(t[0].id){e(".save-dialog").widget("dialog").hide(),e("#poinMainContent").html("方案保存成功。"),e(".point-dialog").widget("dialog").show();var n=t[0].id,a=t[0].title,i=JSON.parse(t[0].data);u(n,a,i),h(n,a,i)}},function(){console.log("--------出错了--------------"),console.log(arguments),e("#poinMainContent").html("方案保存失败！"),e(".point-dialog").widget("dialog").show()})}else e("#poinMainContent").html("您的方案已经有200个了不能再保存！"),e(".point-dialog").widget("dialog").show()}};_updataServerPlan=function(t,n,a){var i=n;if(""==i||null==i)e("#poinMainContent").html("方案名称不能为空"),e(".point-dialog").widget("dialog").show();else if(g(i,t))e("#poinMainContent").html("此方案名称已存在，请修改方案名称"),e(".point-dialog").widget("dialog").show();else{var l={action:"update",type:"userdata",udid:t,title:i,data:JSON.stringify(a)};console.log("-----------方案更新请求开始-----------------"),console.log((new Date).toISOString()),e.send(userPreferEntryUrl,l).then(function(i){console.log((new Date).toISOString()),console.log("---------得到更新完成------------end----------"),i.length<1||i[0].resultcode?(e("#poinMainContent").html("方案更新失败！"),e(".point-dialog").widget("dialog").show(),console.log("-----------失败结果--------------"),console.dir(i)):i[0].id&&(c(t,n,a),f(t,n,a),e(".save-dialog").widget("dialog").hide(),e(".manage-dialog").widget("dialog").hide(),e("#poinMainContent").html("方案更新成功。"),e(".point-dialog").widget("dialog").show())},function(){console.log("--------出错了--------------"),console.log(arguments),e("#poinMainContent").html("方案更新失败！"),e(".point-dialog").widget("dialog").show()})}};var C=function(){var t,a=e("#manageUl li.selected");if(a){t=a.attr("data-planid");var i={action:"delete",type:"userdata",udid:t};e.send(userPreferEntryUrl,i).then(function(a){if("1"==a[0].resultcode){for(var i=0,l=n.length;l>i;i++)n[i]&&n[i].id==t&&delete n[i];e("#poinMainContent").html("方案删除成功！"),e(".point-dialog").widget("dialog").show(),e("#manageUl li").remove("li.selected"),e("#myPlanUl li").remove("li[data-planid = "+t+"]"),e("#manageProjectName").val(""),e("#manageProjectDetail").val("");var s=e("#showPlanName").attr("data-planid");s==t&&(e("#projectName").val(""),e("#projectDetail").val(""))}else e("#poinMainContent").html("方案删除失败！"),e(".point-dialog").widget("dialog").show()},function(){console.log("--------删除出错了--------------"),console.log(arguments),e("#poinMainContent").html("方案删除失败！"),e(".point-dialog").widget("dialog").show()})}else e("#poinMainContent").html("请选择要删除的方案。"),e(".point-dialog").widget("dialog").show()},y=function(){var t=e("#showPlanName").attr("data-planid");if("djfa"==t||null==t||"default1"==t||"default2"==t||"default3"==t)b();else{var n=e("#projectName").val(),a=e("#projectDetail").val(),i={};for(var l in selectedConditions)""!=selectedConditions[l]&&"all"!=selectedConditions[l]&&(i[l]=selectedConditions[l]);var s={tj:i,sm:a};_updataServerPlan(t,n,s)}};e("#deletePlan").click(function(){C()}),e("#managesure").click(function(){var t,a=e("#manageUl li.selected"),i=a.attr("data-planid"),l=e("#manageProjectName").val(),s=e("#manageProjectDetail").val();if(i){for(var o=0,d=n.length;d>o;o++)n[o]&&i==n[o].id&&(t=n[o].data);t.sm=s,_updataServerPlan(i,l,t)}else e("#poinMainContent").html("请选择方案！"),e(".point-dialog").widget("dialog").show()}),e("#poinContentSure").click(function(){e(".point-dialog").widget("dialog").hide()});var x={init:function(){o(),console.log("planModle.init();"),e("#myManage").click(function(){e("#myPlan").css({display:"inline-block"})}),e("#savePlan").click(function(){e(".save-dialog").widget("dialog").show()}),e("#cancelPlan").click(function(){e(".save-dialog").widget("dialog").hide()}),e("#managePlan").click(function(){e(".manage-dialog").widget("dialog").show()}),e("#cancelUpdataPlan").click(function(){e(".manage-dialog").widget("dialog").hide()}),e("body").click(function(t){var n=e(t.target);"myPlan"!=n.attr("id")&&"myManage"!=n.attr("id")&&e("#myPlan").css({display:"none"})}),e("#confirmPlan").click(y)},findThePlan:s};return x}),define("js/jquery.cxselect",["jquery"],function(e){var t=function(e){e.fn.cxSelect=function(t){var n={settings:e.extend({},e.cxSelect.defaults,t),dom:{box:this}};n.init=function(){var t=this;if(t.dom.box.length&&t.settings.selects.length){t.selectArray=[],t.selectSum=t.settings.selects.length;for(var n=0;n<t.selectSum&&t.dom.box.find("select."+t.settings.selects[n]);n++)t.selectArray.push(t.dom.box.find("select."+t.settings.selects[n]));t.selectSum=t.selectArray.length,t.selectSum&&("string"==typeof t.settings.url?e.getJSON(t.settings.url,function(e){t.dataJson=e,t.buildContent()}):"object"==typeof t.settings.url&&(t.dataJson=t.settings.url,t.buildContent()))}},n.isArray=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},n.getIndex=function(e){return this.settings.required?e:e-1},n.getNewOptions=function(t,n){if(t){var a=this.settings.firstTitle,i=this.settings.firstValue,l=t.data("firstTitle"),s=t.data("firstValue"),o="";return("string"==typeof l||"number"==typeof l||"boolean"==typeof l)&&(a=l.toString()),("string"==typeof s||"number"==typeof s||"boolean"==typeof s)&&(i=s.toString()),this.settings.required||(o='<option value="'+i+'">'+a+"</option>"),e.each(n,function(e,t){o+="string"==typeof t.v||"number"==typeof t.v||"boolean"==typeof t.v?'<option value="'+t.v+'">'+t.n+"</option>":'<option value="'+t.n+'">'+t.n+"</option>"}),o}},n.buildContent=function(){var e=this;e.dom.box.on("change","select",function(){e.selectChange(this.className)});var t=e.getNewOptions(e.selectArray[0],e.dataJson);e.selectArray[0].html(t).prop("disabled",!1).trigger("change"),e.setDefaultValue()},n.setDefaultValue=function(e){e=e||0;var t,n=this;e>=n.selectSum||!n.selectArray[e]||(t=n.selectArray[e].data("value"),("string"==typeof t||"number"==typeof t||"boolean"==typeof t)&&(t=t.toString(),setTimeout(function(){n.selectArray[e].val(t).trigger("change"),e++,n.setDefaultValue(e)},1)))},n.selectChange=function(e){e=e.replace(/ /g,","),e=","+e+",";for(var t,n,a,i,l=[],s=0;s<this.selectSum;s++)l.push(this.getIndex(this.selectArray[s].get(0).selectedIndex)),"number"==typeof t&&s>t&&(this.selectArray[s].empty().prop("disabled",!0),"none"===this.settings.nodata?this.selectArray[s].css("display","none"):"hidden"===this.settings.nodata&&this.selectArray[s].css("visibility","hidden")),e.indexOf(","+this.settings.selects[s]+",")>-1&&(t=s);n=t+1,a=this.dataJson;for(var s=0;n>s;s++){if("undefined"==typeof a[l[s]]||this.isArray(a[l[s]].s)===!1||!a[l[s]].s.length)return;a=a[l[s]].s}this.selectArray[n]&&(i=this.getNewOptions(this.selectArray[n],a),this.selectArray[n].html(i).prop("disabled",!1).css({display:"",visibility:""}).trigger("change"))},n.init()},e.cxSelect={defaults:{selects:[],url:null,nodata:null,required:!1,firstTitle:"请选择",firstValue:"0"}}};e(function(){t(e)})}),define("js/jquery.autocomplete",["jquery"],function(e){var t=function(e){e.fn.extend({autocomplete:function(t,n){var a="string"==typeof t;return n=e.extend({},e.Autocompleter.defaults,{url:a?t:null,data:a?null:t,delay:a?e.Autocompleter.defaults.delay:10,max:n&&!n.scroll?10:150},n),n.highlight=n.highlight||function(e){return e},n.formatMatch=n.formatMatch||n.formatItem,this.each(function(){new e.Autocompleter(this,n)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,n){function a(){var a=w.selected();if(!a)return!1;var i=a.result;if(C=i,n.multiple){var s=l(b.val());if(s.length>1){var o,d=n.multipleSeparator.length,c=e(t).selection().start,u=0;e.each(s,function(e,t){return u+=t.length,u>=c?(o=e,!1):void(u+=d)}),s[o]=i,i=s.join(n.multipleSeparator)}i+=n.multipleSeparator}return b.val(i),r(),b.trigger("result",[a.data,a.value]),!0}function i(e,t){if(m==g.DEL)return void w.hide();var a=b.val();(t||a!=C)&&(C=a,a=s(a),a.length>=n.minChars?(b.addClass(n.loadingClass),n.matchCase||(a=a.toLowerCase()),u(a,c,r)):(h(),w.hide()))}function l(t){return t?n.multiple?e.map(t.split(n.multipleSeparator),function(n){return e.trim(t).length?e.trim(n):null}):[e.trim(t)]:[""]}function s(a){if(!n.multiple)return a;var i=l(a);if(1==i.length)return i[0];var s=e(t).selection().start;return i=l(s==a.length?a:a.replace(a.substring(s),"")),i[i.length-1]}function o(a,i){n.autoFill&&s(b.val()).toLowerCase()==a.toLowerCase()&&m!=g.BACKSPACE&&(b.val(b.val()+i.substring(s(C).length)),e(t).selection(C.length,C.length+i.length))}function d(){clearTimeout(p),p=setTimeout(r,200)}function r(){w.visible();w.hide(),clearTimeout(p),h(),n.mustMatch&&b.search(function(e){if(!e)if(n.multiple){var t=l(b.val()).slice(0,-1);b.val(t.join(n.multipleSeparator)+(t.length?n.multipleSeparator:""))}else b.val(""),b.trigger("result",null)})}function c(e,t){t&&t.length&&x?(h(),w.display(t,e),o(e,t[0].value),w.show()):r()}function u(a,i,l){n.matchCase||(a=a.toLowerCase());var o=y.load(a);if(o&&o.length)i(a,o);else if("string"==typeof n.url&&n.url.length>0){var d={timestamp:+new Date};e.each(n.extraParams,function(e,t){d[e]="function"==typeof t?t():t});var r=s(a);if(n.websocket){e("#histroy").remove();var c="";c=""==n.websocketOption?n.url+r.toUpperCase():n.createUrlFun(r),e.send(c).then(function(t){if(o=t,null==o)return e(".ac_results ul").empty(),!1;if(0!=o.length){var s=o,d=[];if(""==n.websocketOption)for(var r in s)d.push({data:s[r][1],value:s[r][0]});else for(var r in s)d.push({data:s[r]});y.add(a,d),i(a,d)}else w.emptyList(),l(a)},function(){console.log("--------------发行人名称请求错误----------------"),console.dir(arguments)})}else if("function"==typeof n.formatRequesturl&&(r=n.formatRequesturl(r)),"getjsonstock"==n.ajaxfun)e.getJSON(n.url+"?q="+r,d,function(t){if(0==t.responseHeader.status){var n=t.response.docs,s=n.length,o=[];s>0?(e.each(n,function(e,t){var n=-1;-1!=(n=t.id.indexOf("."))&&(t.id=t.id.substring(0,n)),o.push({data:t,value:t.id})}),y.add(a,o),i(a,o)):(w.emptyList(),l(a))}});else{var u={jsonp:e.ajaxSetup().jsonp};e.ajaxSetup({jsonp:"json.wrf"}),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:n.dataType,url:n.url+"?q="+r,data:e.extend({limit:n.max},d),success:function(t){if("string"!=typeof t)if("jsonp"==n.dataType){var s=t.response.docs,o=s.length,d=[];o>0?(e.each(s,function(e,t){t.id&&(t.id=t.id,d.push({data:t,value:t.id}))}),y.add(a,d),i(a,d)):(w.emptyList(),l(a))}else y.add(a,t),i(a,t);else{var r=n.parse&&n.parse(dataHandle)||f(dataHandle);y.add(a,r),i(a,r)}}}),e.ajaxSetup(u)}}else w.emptyList(),l(a)}function f(t){for(var a=[],i=t.split("\n"),l=0;l<i.length;l++){var s=e.trim(i[l]);s&&(s=s.split("|"),a[a.length]={data:s,value:s[0],result:n.formatResult&&n.formatResult(s,s[0])||s[0]})}return a}function h(){b.removeClass(n.loadingClass)}var p,m,v,g={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},b=e(t).attr("autocomplete","off").addClass(n.inputClass),C="",y=e.Autocompleter.Cache(n),x=0,N={mouseDownOnSelect:!1},w=e.Autocompleter.Select(n,t,a,N);b.bind("keydown.autocomplete",function(t){switch(x=1,m=t.keyCode,t.keyCode){case g.UP:t.preventDefault(),w.visible()?w.prev():i(0,!0);break;case g.DOWN:t.preventDefault(),w.visible()?w.next():i(0,!0);break;case g.PAGEUP:t.preventDefault(),w.visible()?w.pageUp():i(0,!0);break;case g.PAGEDOWN:t.preventDefault(),w.visible()?w.pageDown():i(0,!0);break;case n.multiple&&","==e.trim(n.multipleSeparator)&&g.COMMA:case g.TAB:case g.RETURN:if(a())return t.preventDefault(),v=!0,n.selecttrigger?w.getselectedli().find("div.ac_div").trigger("click"):null,!1;break;case g.ESC:w.hide();break;default:clearTimeout(p),p=setTimeout(i,n.delay)}}).focus(function(){x++}).blur(function(){x=0,N.mouseDownOnSelect||d()}).click(function(){x++>=1&&!w.visible()&&i(0,!0)}).bind("search",function(){function t(e,t){var a;if(t&&t.length)for(var i=0;i<t.length;i++)if(t[i].result.toLowerCase()==e.toLowerCase()){a=t[i];break}"function"==typeof n?n(a):b.trigger("result",a&&[a.data,a.value])}var n=arguments.length>1?arguments[1]:null;e.each(l(b.val()),function(e,n){u(n,t,t)})}).bind("flushCache",function(){y.flush()}).bind("setOptions",function(){e.extend(n,arguments[1]),"data"in arguments[1]&&y.populate()}).bind("unautocomplete",function(){w.unbind(),b.unbind(),e(t.form).unbind(".autocomplete")}).bind("input",function(){i(0,!0)})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,callformatdelay:null,formatRequesturl:null,formatRequestype:null,formatRequestCode:null,ajaxfun:"ajax",matchCase:!1,matchSubset:!1,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,selecttrigger:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,txtValAuto:!1,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180,websocket:!0,websocketOption:"",websocketType:"jg",createUrlFun:function(){}},e.Autocompleter.Cache=function(t){function n(e,n){t.matchCase||(e=e.toLowerCase());var a=e.indexOf(n);return"word"==t.matchContains&&(a=e.toLowerCase().search(n.toLowerCase())),-1==a?!1:0==a||t.matchContains}function a(e,n){o>t.cacheLength&&l(),s[e]||o++,s[e]=n}function i(){if(!t.data)return!1;var n={},i=0;t.url||(t.cacheLength=1),n[""]=[];for(var l=0,s=t.data.length;s>l;l++){var o=t.data[l];o="string"==typeof o?[o]:o;var d=t.formatMatch(o,l+1,t.data.length);if(d!==!1){var r=d.charAt(0).toLowerCase();n[r]||(n[r]=[]);var c={value:d,data:o,result:t.formatResult&&t.formatResult(o)||d};n[r].push(c),i++<t.max&&n[""].push(c)}}e.each(n,function(e,n){t.cacheLength++,a(e,n)})}function l(){s={},o=0}var s={},o=0;return setTimeout(i,25),{flush:l,add:a,populate:i,load:function(a){if(!t.cacheLength||!o)return null;if(!t.url&&t.matchContains){var i=[];for(var l in s)if(l.length>0){var d=s[l];e.each(d,function(e,t){n(t.value,a)&&i.push(t)})}return i}if(s[a])return s[a];if(t.matchSubset)for(var r=a.length-1;r>=t.minChars;r--){var d=s[a.substr(0,r)];if(d){var i=[];return e.each(d,function(e,t){n(t.value,a)&&(i[i.length]=t)}),i}}return null}}},e.Autocompleter.Select=function(t,n,a,i){function l(){y&&(p=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),m=e("<ul/>").appendTo(p).mouseover(function(t){s(t).nodeName&&"LI"==s(t).nodeName.toUpperCase()&&(b=e("li",m).removeClass(g.ACTIVE).index(s(t)),e(s(t)).addClass(g.ACTIVE))}).click(function(t){return e(s(t)).addClass(g.ACTIVE),a(),n.focus(),!1}).mousedown(function(){i.mouseDownOnSelect=!0}).mouseup(function(){i.mouseDownOnSelect=!1}),t.width>0&&p.css("width",t.width),y=!1)}function s(e){for(var t=e.target;t&&"LI"!=t.tagName;)t=t.parentNode;return t?t:[]}function o(){}function d(e){f.slice(b,b+1).removeClass(g.ACTIVE),r(e);var n=f.slice(b,b+1).addClass(g.ACTIVE);if(t.scroll){var a=0;f.slice(0,b).each(function(){a+=this.offsetHeight}),a+n[0].offsetHeight-m.scrollTop()>m[0].clientHeight?m.scrollTop(a+n[0].offsetHeight-m.innerHeight()):a<m.scrollTop()&&m.scrollTop(a)}}function r(e){b+=e,0>b?b=f.size()-1:b>=f.size()&&(b=0)}function c(e){return t.max&&t.max<e?t.max:e}function u(){m.empty();for(var n=c(h.length),a=0;n>a;a++)if(h[a]){var i=t.formatItem(h[a].data,a+1,n,h[a].value,C);if(i!==!1){var l=e("<li/>").html(t.highlight(i,C)).addClass(a%2==0?"ac_even":"ac_odd").appendTo(m)[0];e.data(l,"ac_data",h[a])}}f=m.find("li"),t.selectFirst&&(f.slice(0,1).addClass(g.ACTIVE),b=0),e.fn.bgiframe&&m.bgiframe()}var f,h,p,m,v,g={ACTIVE:"ac_over"},b=-1,C="",y=!0,x=e(n).attr("autocomplete","off").addClass(t.inputClass);return{display:function(e,n){l(),h=e,C=n,t.callformatdelay===!0?o():u()},next:function(){this.getSelectName(),d(1)},prev:function(){this.getSelectName(),d(-1)},pageUp:function(){d(0!=b&&0>b-8?-b:-8)},pageDown:function(){d(b!=f.size()-1&&b+8>f.size()?f.size()-1-b:8)},hide:function(){p&&p.hide(),f&&f.removeClass(g.ACTIVE),b=-1},visible:function(){return p&&p.is(":visible")},current:function(){return this.visible()&&(f.filter("."+g.ACTIVE)[0]||t.selectFirst&&f[0])},show:function(){var a=e(n).offset();if(p.css({width:"string"==typeof t.width||t.width>0?t.width:e(n).width()+75,top:a.top+n.offsetHeight,left:a.left-24}).show(),t.scroll&&(m.scrollTop(0),m.css({maxHeight:t.scrollHeight,overflow:"auto"}),"undefined"==typeof document.body.style.maxHeight)){var i=0;f.each(function(){i+=this.offsetHeight});var l=i>t.scrollHeight;m.css("height",l?t.scrollHeight:i),l||f.width(m.width()-parseInt(f.css("padding-left"))-parseInt(f.css("padding-right")))}},selected:function(){v=f.filter("."+g.ACTIVE);var n=f&&v.removeClass(g.ACTIVE);if(t.txtValAuto){if(40==window.event.keyCode){if("undefined"==typeof n.next()[0])return e.data(f[0],"ac_data");n=n.next()}else if(38==window.event.keyCode){if("undefined"==typeof n.prev()[0])return e.data(f[f.length-1],"ac_data");n=n.prev()}}else n=n;return n&&n.length&&e.data(n[0],"ac_data")},emptyList:function(){m&&m.empty()},unbind:function(){p&&p.remove()},getselectedli:function(){return v},getSelectName:function(){if(t.txtValAuto){var e=this.selected().data.name;e="*"==e.substring(0,1)?e.substring(1,e.length):"*."==e.substring(0,2)?e.substring(2,e.length):e,x.val(e)}}}},e.fn.selection=function(e,t){if(void 0!==e)return this.each(function(){if(this.createTextRange){var n=this.createTextRange();void 0===t||e==t?(n.move("character",e),n.select()):(n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",t),n.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)});var n=this[0];if(n.createTextRange){var a=document.selection.createRange(),i=n.value,l="<->",s=a.text.length;a.text=l;var o=n.value.indexOf(l);return n.value=i,this.selection(o,o+s),{start:o,end:o+s}}return void 0!==n.selectionStart?{start:n.selectionStart,end:n.selectionEnd}:void 0}};e(function(){t(e)})}),define("js/index.js",["jquery","select","./plan","grid","filter","splitter","datetime","dialog","./jquery.cxselect","socket","ztree","./jquery.autocomplete"],function(e,t,n){function a(t){var n=buildGrid(e("#mainGrid"),t,kt,{frozenColumn:2,resize:1},new Slick.Data.DataView);n.onDblClick.subscribe(function(e,t){if(1==t.cell){var n=this.getDataItem(t.row).co;location=-1!=n.indexOf("N")?"../../platform/f9/redirect.html?obj="+n:"DZH://VIEWSTOCK?LABEL="+n+"&DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势"}})}function i(e){return e+1+100*(selectedConditions.pageNum-1)}function l(e,t,n){return'<span class="link">'+n+"</span>"}function s(){var t={};for(var n in selectedConditions)""!=selectedConditions[n]&&"all"!=selectedConditions[n]&&(t[n]=selectedConditions[n]);var i="/bond/bondFind/findBondResultList.dzh";oldSelectedConditions=t,e.send(i,t).then(function(t){var n=0,i=0;if(t.length>0)for(var n=parseInt(t[0].totalCount),i=parseInt(Math.ceil(n/100)),l=0;l<t.length;l++)t[l].id=l.toString();e("#pageSumNum").html(i),e("#bondSumNum").text(n),xt=t,a(t)},function(){console.log("--------出错了--------------"),console.log(arguments)})}function o(){var t=e("#nowPage");t.val(1),selectedConditions.pageNum=1;var n={};for(var a in selectedConditions)""!=selectedConditions[a]&&"all"!=selectedConditions[a]&&(n[a]=selectedConditions[a]);n!=oldSelectedConditions&&s()}function d(e){var t;if(bt)for(e in bt)t=bt.planName;t||(t={survivalStatus:"1",publisherName:"",bondType:"all",bondRating:"all",mainBodyRating:"all",guaranteeWay:"all",leftTerm:"all",interestAccrualWay:"all",listMarket:"all",interestAccrualWay:"all",bondRight:"all",pageNum:1}),selectedConditions=t}function r(){selectedConditions={survivalStatus:"1",publisherName:"",bondType:"all",bondRating:"all",mainBodyRating:"all",guaranteeWay:"all",leftTerm:"all",interestAccrualWay:"all",listMarket:"all",interestAccrualWay:"all",bondRight:"all",valuationRate:"all",pageNum:1}}function c(e){var t=!0;for(var n in selectedConditions){for(var a=0;a<e.length;a++)if(e[a].dataset.value==n){t=!1;break}t&&delete selectedConditions[n]}}function u(e){for(var t=["publishBeginDate","publishEndDate","interestBeginDate","interestEndDate","tenderDate","listingDate","issueRate","valuationRate"],n={},a=0;a<e.length;a++){var i=!1;for(var l in selectedConditions)e[a].dataset.value==l&&(i=!0);if(i){var s=e[a].dataset.value;if("proId"==s)n.proId=selectedConditions.proId,selectedConditions.cityId&&(n.cityId=selectedConditions.cityId),selectedConditions.countyId&&(n.countyId=selectedConditions.countyId);else if("industry"==s)n.industry=selectedConditions.industry,selectedConditions.firstInd&&(n.firstInd=selectedConditions.firstInd),selectedConditions.secondInd&&(n.secondInd=selectedConditions.secondInd);else if(-1!=t.indexOf(s)){n[s]=selectedConditions[s];var o=s+"Begin",d=s+"End";selectedConditions[o]&&(n[o]=selectedConditions[o]),selectedConditions[d]&&(n[d]=selectedConditions[d])}else n[s]=selectedConditions[s]}else n[e[a].dataset.value]="all"}selectedConditions=n,selectedConditions.pageNum=1}function f(e){for(var t=e.parentNode.children,n=e.dataset.name,a="",i=0;i<t.length;i++)-1!=t[i].className.indexOf("btn-selected")&&(a+=0==a.length?t[i].dataset.value:","+t[i].dataset.value);selectedConditions[n]=a,"0"==Nt&&o()}function h(t){var n=(e(t).multiselect("getChecked"),e(t).val()),a=e(t)[0].id;null==n||-1!=n.indexOf("all")?(selectedConditions[a]="all",setTimeout(function(){e(t+" + button").children()[1].innerHTML="全部"},20),"0"==Nt&&o()):-1!=n.indexOf("custom")?selectedConditions[a]="custom":(selectedConditions[a]=n.join(),"0"==Nt&&o())}function p(t){var n=e(t),a=n.attr("id"),i=n.val();selectedConditions[a]=i,"7"!=i&&"0"==Nt&&o()}function m(){var t=e("#search_publisherName"),n=t.val();""==n?(selectedConditions.publisherName="all",t.val("请输入发行人名称或首字母..."),t.css({color:"#A9A9A9"})):(selectedConditions.publisherName=n,t.css({color:"#000"}))}function v(e){delete selectedConditions.firstInd,delete selectedConditions.secondInd,selectedConditions.industry=e,"0"==Nt&&o()}function g(e,t){selectedConditions.industry=e,selectedConditions.firstInd=t,delete selectedConditions.secondInd,"0"==Nt&&o()}function b(e){var t=e.value;selectedConditions.secondInd=t,"0"==Nt&&o()}function C(){var t=e("#province"),n=t.val();"0"==n&&(selectedConditions.proId="all",delete selectedConditions.cityId,delete selectedConditions.area,"0"==Nt&&o())}function y(){var t=e("#province"),n=t.val(),a=e("#city"),i=a.val(),l=e("#area").val();"0"==i?(selectedConditions.proId=n,delete selectedConditions.cityId,delete selectedConditions.countyId,"0"==Nt&&o()):null!=l&&l||(selectedConditions.proId=n,selectedConditions.cityId=i,delete selectedConditions.countyId,"0"==Nt&&o())}function x(){var t=e("#province"),n=t.val(),a=e("#city"),i=a.val(),l=e("#area"),s=l.val();"0"==s&&(s="all"),selectedConditions.proId=n,selectedConditions.cityId=i,selectedConditions.countyId=s,"0"==Nt&&o()}function N(e){var t;return t=""==e||null==e?["0"]:e.split(",")}function w(e,t){var n="";return"button"==e.type?n=Tt.createButton(e,t):"radioButton"==e.type?n=Tt.createButton(e,t,!0):"select"==e.type?n=Tt.createSelect(e,t):"citySelect"==e.type?n=Tt.createCitySelect(e,t):"input"==e.type?n=Tt.createInput(e,t):"industrySelect"==e.type?n=Tt.createIndustrySelect(e,t):"oneSelectCustom"==e.type?n=Tt.createOneSelectCustom(e,t):"selectCheckbox"==e.type&&(n=Tt.createSelectCheckbox(e,t)),n}function S(e){for(var t,n=0;n<Ct.length;n++)if(Ct[n].name==e){t=Ct[n];break}return t}function I(){e.cxSelect.defaults.url="./resources/json/cityData.json",e("#city-b").cxSelect({selects:["province","city","area"],nodata:"none"})}function k(){var t=e.fn.zTree.getZTreeObj("bondTypeTree"),n=t.getCheckedNodes(!0),a=t.getCheckedNodes(!1),i=(t.getNodes()[0].getCheckStatus(),""),l="";if(0==a.length)i="全部",l="all";else{for(var s=0,d=n.length;d>s;s++)0==n[s].getCheckStatus().half&&(i+=n[s].cname+",",l+=n[s].cid+",");i.length>0&&(i=i.substring(0,i.length-1)),l.length>0&&(l=l.substring(0,l.length-1))}var r=e("#bondTypeSel");r.attr("value",i),selectedConditions.bondType=l,"0"==Nt&&o()}function T(){var t="/bond/bondFind/getBondTypeTree.dzh";e.send(t).then(function(t){var n={treeId:"bondTypezTree",treeObj:null,check:{chkboxType:{Y:"ps",N:"ps"},chkStyle:"checkbox",enable:!0},data:{key:{name:"cname"},simpleData:{enable:!0,idKey:"cid",pIdKey:"pid",rootPId:"c0"}},callback:{onCheck:k}};if(t.push({cid:"0",cname:"全部",checked:!0}),selectedConditions.bondType&&"all"!=selectedConditions.bondType)for(var a=selectedConditions.bondType.split(","),i=0,l=t.length;l>i;i++)-1!=a.indexOf(t[i].cid)&&(t[i].checked=!0),("0"==t[i].pid||"0"==t[i].cid)&&(t[i].open=!0);else for(var i=0;i<t.length;i++)t[i].checked=!0,("0"==t[i].pid||"0"==t[i].cid)&&(t[i].open=!0);e.fn.zTree.init(e("#bondTypeTree"),n,t),k()})}function A(){var e="";for(var t in selectedConditions){var n=S(t);if(n){var a=w(n,selectedConditions[t]);e+=a}}return e}function O(){e("select.SelectCheckbox").each(function(t,n){-1!=e(n).val().indexOf("all")&&(e("#"+n.id+" + button").children()[1].innerHTML="全部")})}function P(e){var t=e.slice(0,4)+"-"+e.slice(4,6)+"-"+e.slice(6,8);return t}function D(){var t=["publishBeginDate","publishEndDate","interestBeginDate","interestEndDate","tenderDate","listingDate"];for(var n in selectedConditions){if(-1!=t.indexOf(n)&&"7"==selectedConditions[n]){var a='div[data-value="'+n+'"] .dateCustom';e(a).css("display","inline-block");var i=n+"Begin",l=n+"End";e("#"+i).val(selectedConditions[i]?P(selectedConditions[i]):""),e("#"+l).val(selectedConditions[l]?P(selectedConditions[l]):"")}if("issueRate"==n&&"custom"==selectedConditions[n]){var a="#"+n+"CustomParent";e(a).css("display","inline-block");var i=n+"Begin",l=n+"End";e("#"+i).val(selectedConditions[i]?selectedConditions[i]:""),e("#"+l).val(selectedConditions[l]?selectedConditions[l]:"")}}}function L(){for(var t=["survivalStatus","bondRating","mainBodyRating","guaranteeWay","leftTerm","interestAccrualWay","listMarket","bondRight"],n=0,a=t.length;a>n;n++){var i=t[n],l="button[data-name="+i+"].btn-selected";if(selectedConditions[i]&&"all"!=selectedConditions[i]){var s="button[data-name="+i+"]";e(l).removeClass("btn-selected"),e(s).each(function(t,n){-1!=selectedConditions[i].indexOf(n.dataset.value)&&e(this).addClass("btn-selected")})}else{e(l).removeClass("btn-selected");var o="button[data-name="+i+"][data-value=all]";e(o).addClass("btn-selected")}}}function j(){var t=e("#search_publisherName");selectedConditions.publisherName&&"all"!=selectedConditions.publisherName&&""!=selectedConditions.publisherName?(t.val(selectedConditions.publisherName),t.css("color","#000")):(t.val("请输入发行人名称或首字母..."),t.css({color:"#A9A9A9"}))}function U(){var t=e("#valuationRate option"),n="#valuationRateCustomParent";if(e("#valuationRate").val(""),selectedConditions.valuationRate&&"all"!=selectedConditions.valuationRate){{var a=selectedConditions.valuationRate;N(selectedConditions.valuationRate)}t.each(function(e,t){-1!=a.indexOf(t.value)&&(t.selected="selected")}),"custom"==selectedConditions.valuationRate?e(n).css("display","inline-block"):e(n).css("display","none");var i="valuationRateBegin",l="valuationRateEnd";e("#valuationRateBegin").val(selectedConditions[i]?selectedConditions[i]:""),e("#valuationRateEnd").val(selectedConditions[l]?selectedConditions[l]:"")}else{e(n).css("display","none");for(var s=0,o=t.length-1;o>s;s++)t[s].selected="selected";e("#valuationRateBegin").val(""),e("#valuationRateEnd").val("")}}function W(){L(),j(),U()}function R(){if(selectedConditions.industry&&(e("#industry option").each(function(e,t){t.value==selectedConditions.industry&&(t.selected="selected")}),selectedConditions.industry||"all"!=selectedConditions.industry)){var t=e("#firstInd"),n=e("#secondInd"),a=selectedConditions.firstInd,i=selectedConditions.industry;if("all"!=i&&(console.log("******************--------send--------******************"),e.send("/bond/bondFind/getIndustryFirstLevelByType.dzh",{type:i}).then(function(e){var n='<option value="all">全部</option>',i=Tt.createSelectOption(e,a);
n+=i,t[0].innerHTML=n,t.css("display","inline-block"),t.removeAttr("disabled")}),a&&"all"!=a)){var l=selectedConditions.secondInd;e.send(St,{type:i,node:a}).then(function(e){var t='<option value="all">全部</option>',a=Tt.createSelectOption(e,l);t+=a,n[0].innerHTML=t,n.css("display","inline-block"),n.removeAttr("disabled")})}}}function E(){var t=e("#panel-connection")[0];"bottom"==wt?t.scrollTop=t.scrollHeight-t.clientHeight:"top"==wt&&(t.scrollTop=0)}function _(){var n=A(),a=e("#conditionParentDiv");a.html(n),E(),I(),T(),R(),W(),t.init(),e("#valuationRate").widget().refresh(),O(),D()}function M(e){var t=e.parentNode.dataset.value,n=!1;"all"!=selectedConditions[t]&&(n=!0),"area"==t?(delete selectedConditions.proId,delete selectedConditions.cityId,delete selectedConditions.countyId):delete selectedConditions[t],e.parentNode.parentNode.removeChild(e.parentNode),n&&o()}function B(e){for(var t,n=!0,a=0;a<e.length;a++)if("BUTTON"==e[a].nodeName&&"all"==e[a].dataset.value&&(t=e[a]),"BUTTON"==e[a].nodeName&&-1!=e[a].className.indexOf("btn-selected")){n=!1;break}n&&(t.className=-1!=t.className.indexOf("radio")?"btn-flat radio btn-selected":"btn-flat btn-selected")}function V(e){var t=e.parentNode.children;if("all"==e.dataset.value){for(var n=0;n<t.length;n++)"BUTTON"==t[n].nodeName&&(t[n].className=-1!=e.className.indexOf("radio")?"btn-flat radio":"btn-flat");e.className=-1!=e.className.indexOf("radio")?"btn-flat radio btn-selected":"btn-flat btn-selected"}else if(-1==e.className.indexOf("btn-selected")){for(var n=0;n<t.length;n++)"BUTTON"==t[n].nodeName&&"all"==t[n].dataset.value&&(t[n].className=-1!=e.className.indexOf("radio")?"btn-flat radio":"btn-flat");if(-1!=e.className.indexOf("radio")){for(var n=0;n<t.length;n++)"BUTTON"==t[n].nodeName&&(t[n].className="btn-flat radio");e.className="btn-flat radio btn-selected"}else e.className="btn-flat btn-selected"}else-1!=e.className.indexOf("btn-selected")&&(e.className=-1!=e.className.indexOf("radio")?"btn-flat radio":"btn-flat",B(t))}function H(e){V(e),f(e)}function q(t){var n=e("#firstInd"),a=e("#secondInd"),i=t.value;"all"!=t.value?(console.log("******************--------send--------******************"),e.send("/bond/bondFind/getIndustryFirstLevelByType.dzh",{type:i}).then(function(e){var t='<option value="all">全部</option>',a=Tt.createSelectOption(e);t+=a,n[0].innerHTML=t,n.css("display","inline-block"),n.removeAttr("disabled"),console.dir(e)})):(n.css("display","none"),n.attr("disabled","disabled")),a.css("display","none"),a.attr("disabled","disabled"),v(i)}function F(t){var n=e("#secondInd"),a=t.value,i=e("#industry")[0].value;"all"!=a?e.send(St,{type:i,node:a}).then(function(e){var t='<option value="all">全部</option>',a=Tt.createSelectOption(e);t+=a,n[0].innerHTML=t,n.css("display","inline-block"),n.removeAttr("disabled")}):(n.css("display","none"),n.attr("disabled","disabled")),g(i,a)}function z(){function t(){var t=e("#bondTypeSel"),n=t.offset();e("#bondTypeMenuContent").css({left:n.left+"px",top:n.top+t.outerHeight()+"px"}).slideDown("fast"),e("body").bind("mousedown",a)}function n(){e("#bondTypeMenuContent").fadeOut("fast"),e("body").unbind("mousedown",a)}function a(t){"bondTypeSel"==t.target.id||"bondTypeBtn"==t.target.id||"bondTypeMenuContent"==t.target.id||e(t.target).parents("#bondTypeMenuContent").length>0||n()}e("#allconditionParentDiv").click(function(e){"I"==e.target.nodeName&&-1!=e.target.className.indexOf("icon-x")?M(e.target):"BUTTON"==e.target.nodeName&&H(e.target)}),e("#bondTypeLi").click(function(){t()})}function K(e){d(e),_()}function J(){for(var t="",n=yt.concat(Ct),a=0;a<n.length;a++)t+='<li class="indexLi" data-value="'+n[a].name+'">'+n[a].title_name+"</li>";var i=e("#allIndexUl")[0];i.innerHTML=t}function G(){var t="";for(var n in selectedConditions){var a=S(n);a&&(t+='<li class="indexLi" data-value="'+a.name+'">'+a.title_name+"</li>")}e("#selectedIndexUl li.indexLi").remove(),e("#selectedIndexUl").append(t)}function Z(){e("#add-index").live("click",function(){e(".add-dialog").widget("dialog").show(),G()})}function Y(){for(var t=e("#allIndexUl li.selected"),n=e("#selectedIndexUl li"),a=[],i=0;i<t.length;i++){t[i].className="indexLi";for(var l=!0,s=0;s<n.length;s++)t[i].innerHTML==n[s].innerHTML&&(l=!1);l&&a.push(t[i])}return a}function $(){e("#leftIn").click(function(){var t=Y(),n=e("#selectedIndexUl");t.forEach(function(e){n.append(e.outerHTML)})})}function Q(){e("#allIndexUl li").dblclick(function(t){e("#allIndexUl li.lastSelected").each(function(e,t){t.className="indexLi selected"}),t.target.className="indexLi selected lastSelected";var n=Y(),a=e("#selectedIndexUl");n.forEach(function(e){a.append(e.outerHTML)})})}function X(){e("#rightOut").click(function(){e("#selectedIndexUl li").remove(".selected")})}function et(){e("#selectedIndexUl li.indexLi").live("dblclick",function(){e(this).attr("class","indexLi selected"),e("#selectedIndexUl li").remove(".selected")})}function tt(e,t){for(var n,a=0;a<e.length;a++)if(e[a].className==t){n=a;break}return n}function nt(e,t){for(var n,a=0;a<e.length;a++)e[a]==t&&(n=a);return n}function at(t,n){var a=e(t),i=tt(a,"indexLi selected lastSelected"),l=nt(a,n);a.each(function(e,t){(e>i&&l>e||e>l&&i>e)&&(t.className="indexLi selected")});var s=t+".lastSelected";e(s).each(function(e,t){t.className="indexLi selected"}),n.className="indexLi selected lastSelected"}function it(){e("#allIndexUl").click(function(t){t.shiftKey||t.ctrlKey?(t.ctrlKey&&(-1==t.target.className.indexOf("selected")?(e("#allIndexUl li.lastSelected").each(function(e,t){t.className="indexLi selected"}),t.target.className="indexLi selected lastSelected"):t.target.className="indexLi"),t.shiftKey&&at("#allIndexUl li",t.target)):(e("#allIndexUl li.selected").each(function(e,t){t.className="indexLi"}),t.target.className="indexLi selected lastSelected")})}function lt(){e("#selectedIndexUl").click(function(t){t.shiftKey||t.ctrlKey?(t.ctrlKey&&-1==t.target.className.indexOf("disable")&&(-1==t.target.className.indexOf("selected")?(e("#selectedIndexUl li.lastSelected").each(function(e,t){t.className="indexLi selected"}),t.target.className="indexLi selected lastSelected"):t.target.className="indexLi"),t.shiftKey&&-1==t.target.className.indexOf("disable")&&at("#selectedIndexUl li",t.target)):-1==t.target.className.indexOf("disable")&&(e("#selectedIndexUl li.selected").each(function(e,t){t.className="indexLi"}),t.target.className="indexLi selected lastSelected")})}function st(e){for(var t,n=0;n<e.length;n++)if("indexLi selected"==e[n].className||"indexLi selected lastSelected"==e[n].className){t=n;break}return t}function ot(e,t){var n=[];11>t&&(t=11);for(var a=0;t>a;a++)e[a]&&-1==e[a].className.indexOf("selected")&&n.push(e[a]);return n}function dt(e){for(var t=[],n=0;n<e.length;n++)-1!=e[n].className.indexOf("selected")&&t.push(e[n]);return t}function rt(e,t){var n=[];11>t&&(t=11);for(var a=t;a<e.length;a++)e[a]&&-1==e[a].className.indexOf("selected")&&n.push(e[a]);return n}function ct(){var t=e("#selectedIndexUl li"),n=st(t),a=[],i=ot(t,n-1),l=dt(t),s=rt(t,n-1);return a=i.concat(l,s)}function ut(){e("#moveup").click(function(){var t=e("#selectedIndexUl"),n=ct();if(n.length>0){t.empty();for(var a=0;a<n.length;a++)t.append(n[a])}})}function ft(e){for(var t,n=e.length-1;n>-1;n--)if("indexLi selected"==e[n].className||"indexLi selected lastSelected"==e[n].className){t=n;break}return t}function ht(){var t=e("#selectedIndexUl li"),n=ft(t),a=[],i=ot(t,n+2),l=dt(t),s=rt(t,n+2);return a=i.concat(l,s)}function pt(){e("#movedown").click(function(){var t=e("#selectedIndexUl"),n=ht();if(n.length>0){t.empty();for(var a=0;a<n.length;a++)t.append(n[a])}})}function mt(){var t=e("#nowPage");e("#fristPage").click(function(){selectedConditions.pageNum=1,t.val(1),s()}),e("#upPage").click(function(){selectedConditions.pageNum>1&&(selectedConditions.pageNum--,t.val(selectedConditions.pageNum),s())}),e("#nextPage").click(function(){var n=parseInt(e("#pageSumNum").text());selectedConditions.pageNum<n&&(selectedConditions.pageNum++,t.val(selectedConditions.pageNum),s())}),e("#finalPage").click(function(){var n=parseInt(e("#pageSumNum").text());selectedConditions.pageNum!=n&&(selectedConditions.pageNum=n,t.val(selectedConditions.pageNum),s())}),t.keyup(function(n){var a=parseInt(t.val());isNaN(a)&&(a=1);var i=parseInt(e("#pageSumNum").text());13==n.keyCode&&selectedConditions.pageNum!=a&&(selectedConditions.pageNum=1>a?1:a>i?i:a,s()),13==n.keyCode&&t.val(selectedConditions.pageNum)}),t.blur(function(){var n=parseInt(t.val());isNaN(n)&&(n=1);var a=parseInt(e("#pageSumNum").text());selectedConditions.pageNum!=n&&(selectedConditions.pageNum=1>n?1:n>a?a:n,t.val(selectedConditions.pageNum),s())})}function vt(){e("#sure-dialog").click(function(){wt="bottom";var t=e("#selectedIndexUl li");c(t),u(t),_(),e(".add-dialog").widget("dialog").hide(),o()})}function gt(){e("#close-dialog").click(function(){e(".add-dialog").widget("dialog").hide()})}selectedConditions={},oldSelectedConditions={};var bt,Ct,yt,xt,Nt="0",wt="top",St="/bond/bondFind/getIndustrySecondLevelByType.dzh",It="/bond/bondFind/getBondPublishNameBySolr.dzh?param=",kt=[{id:"title",name:"序号",field:"xh",formatter:i,minWidth:50,cssClass:"center",width:50},{id:"bondCode",name:"债券代码",field:"bondCode",formatter:l,minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"bondName",name:"债券简称",field:"bondName",minWidth:50,width:155,cssClass:"font_left",sortable:!0},{id:"bondType",name:"债券类型",field:"bondType",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"listMarket",name:"上市市场",field:"listMarket",minWidth:50,width:130,cssClass:"font_left",sortable:!0},{id:"publishBeginDate",name:"发行起始日",field:"publishBeginDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"latestInterestRate",name:"最新票面利率(%)",field:"latestInterestRate",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"bondTerm",name:"债券期限(年)",field:"bondTerm",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"bondRate",name:"债项评级",field:"bondRate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"mainBodyRating",name:"主体评级",field:"mainBodyRating",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"guaranteeWay",name:"担保方式",field:"guaranteeWay",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"planIssuanceScale",name:"计划发行规模(亿元)",field:"planIssuanceScale",minWidth:50,width:145,cssClass:"font_right",sortable:!0},{id:"actualIssuanceScale",name:"实际发行规模(亿元)",field:"actualIssuanceScale",minWidth:50,width:145,cssClass:"font_right",sortable:!0},{id:"publishEndDate",name:"发行截止日",field:"publishEndDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"tenderDate",name:"招标日期",field:"tenderDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"tenderWay",name:"招标方式",field:"tenderWay",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"bidding",name:"招标标的",field:"bidding",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"interestAccrualWay",name:"计息方式",field:"interestAccrualWay",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"payInterestWay",name:"付息方式",field:"payInterestWay",minWidth:80,width:140,cssClass:"font_left",sortable:!0},{id:"interestAccrualNum",name:"年付息次数(次)",field:"interestAccrualNum",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"interestBeginDate",name:"起息日",field:"interestBeginDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"payInterestDate",name:"付息日",field:"payInterestDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"interestEndDate",name:"到期日",field:"interestEndDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"bondRight",name:"回售赎回权",field:"bondRight",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"listingDate",name:"上市日期",field:"listingDate",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"isAdditional",name:"是否增发",field:"isAdditional",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"isCityBond",name:"是否城投债",field:"isCityBond",minWidth:50,width:120,cssClass:"center",sortable:!0},{id:"issuePrice",name:"发行价格",field:"issuePrice",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"faceValue",name:"面值",field:"faceValue",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"floatingRate",name:"浮息基准利率(%)",field:"floatingRate",minWidth:50,width:120,cssClass:"font_right",sortable:!0},{id:"bondRateOrgan",name:"债项评级机构",field:"bondRateOrgan",minWidth:50,width:235,cssClass:"font_left",sortable:!0},{id:"publisherName",name:"发行人名称",field:"publisherName",minWidth:50,width:220,cssClass:"font_left",sortable:!0},{id:"issuerEconmicPro",name:"发行人经济性质",field:"issuerEconmicPro",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"mainBodyRatingOrgan",name:"主体评级机构",field:"mainBodyRatingOrgan",minWidth:50,width:235,cssClass:"font_left",sortable:!0},{id:"guarantorName",name:"担保人名称",field:"guarantorName",minWidth:50,width:220,cssClass:"font_left",sortable:!0},{id:"masterUnderwriter",name:"主承销商",field:"masterUnderwriter",minWidth:50,width:235,cssClass:"font_left",sortable:!0},{id:"csrcIndustry",name:"证监会行业",field:"csrcIndustry",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"cicsIndustry",name:"CICS行业",field:"cicsIndustry",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"swIndustry",name:"申万行业",field:"swIndustry",minWidth:50,width:120,cssClass:"font_left",sortable:!0},{id:"valuationRate",name:"估值收益率(%)",field:"valuationRate",minWidth:50,width:110,cssClass:"font_left",sortable:!0}],Tt={innerHTMLbegin:function(e){var t='<div class="mg-l fl" data-value="'+e.name+'"><i class="icon-x gray"></i><span class="title_name">';return t+=e.title_name+"： ",t+="</span>"},isAddSelect:function(e,t){for(var n=!1,a=0;a<t.length;a++)e.value==t[a]&&(n=!0);return n},createButton:function(e,t,n){for(var a=N(t),i=this.innerHTMLbegin(e),l=0;l<e.allValue.length;l++)i+='<button type="button"',i+=' data-value="'+e.allValue[l].value,i+='" data-name="'+e.name+'" class="btn-flat',n&&(i+=" radio"),this.isAddSelect(e.allValue[l],a)&&(i+=" btn-selected"),i+='">',i+=e.allValue[l].title,i+="</button>";return i+="</div>"},createSelect:function(e,t){var n=this.innerHTMLbegin(e);n+='<select data-option="" name="select-val" data-value="'+t+'">';for(var a=0;a<e.allValue.length;a++)n+='<option value="'+e.allValue[a].value+'">'+e.allValue[a].title+"</option>";return n+="</select></div>"},createCitySelect:function(){var e="all",t="all",n="all";selectedConditions.proId&&(e=selectedConditions.proId),selectedConditions.cityId&&(t=selectedConditions.cityId),selectedConditions.countyId&&(n=selectedConditions.countyId);var a='<div class="mg-l fl" id="city-b" data-value="area"><i class="icon-x gray"></i><span class="title_name">所属地区：</span><select id="province" data-name="province" class="province diqu" data-value="'+e+'" data-first-title="选择省或直辖市" ></select><select id="city"  data-name="city" class="city diqu" data-value="'+t+'" data-first-title="选择市" ></select><select id="area" data-name="area" class="area diqu" data-value="'+n+'" data-first-title="选择地区" ></select></div>';return a},createIndustrySelect:function(){var e='<div class="mg-l fl" id="industry-b" data-value="industry"><i class="icon-x gray"></i><span class="title_name">行业：</span><select id="industry" data-name="industry" class="industrySelect" data-value="all" data-first-title="全部"><option value="all">全部</option><option value="csrc">证监会行业</option><option value="sw">申万行业</option><option value="gics">GICS行业</option></select><select id="firstInd" data-name="firstInd" class="industrySelect" data-value="all" data-first-title="全部" disabled="disabled"><option value="all">全部</option><option value="csrc">证监会行业</option><option value="sw">申万行业</option><option value="gics">GICS行业</option></select><select id="secondInd" data-name="secondInd" class="industrySelect" data-value="all" data-first-title="全部" disabled="disabled"></select></div>';return e},createOneSelectCustom:function(e,t){var n="all",a="全部";t&&(n=t);var i=this.innerHTMLbegin(e);i+='<select id="'+e.name+'" data-name="'+e.name,i+='" data-value="'+n,i+='" data-first-title="'+a,i+='" class="oneSelectCustom">';for(var l=0;l<e.allValue.length;l++)i+='<option value="'+e.allValue[l].value+'"',n==e.allValue[l].value&&(i+=' selected="selected"'),i+=">",i+=e.allValue[l].title,i+="</option>";return i+="</select>",i+='<div class="dateCustom">',i+='<input type="datetime" data-date-format="yyyy-mm-dd" id="'+e.name+'Begin" value=""><i class="fa fa-calendar"></i> &nbsp;&nbsp;&nbsp;至&nbsp;&nbsp;&nbsp;',i+='<input type="datetime" data-date-format="yyyy-mm-dd" id="'+e.name+'End" value=""><i class="fa fa-calendar"></i>',i+="</div></div>"},createInput:function(e,t){var n=this.innerHTMLbegin(e);return n+='<input type="search" id="issuer-name" value="'+t+'"></div>'},createSelectOption:function(e,t){for(var n="",a=0;a<e.length;a++){isSelected=e[a].col1==t?'selected="selected"':"";var i='<option value="'+e[a].col1+'" '+isSelected+">"+e[a].col2+"</option>";n+=i}return n},createSelectCheckbox:function(e,t){var n=this.innerHTMLbegin(e);n+='<select id="'+e.name+'" class="SelectCheckbox" data-option="checkbox"  multiple="multiple"><optgroup label="">';var a=N(t),i="",l=!1;isDefaultAllSelected="";for(var s=0,o=e.allValue.length;o>s;s++)i=(-1!=a.indexOf("0")||-1!=a.indexOf("all"))&&"custom"!=e.allValue[s].value||-1!=a.indexOf(e.allValue[s].value)?' selected="selected"':"",s==o-1&&"custom"==e.allValue[s].value?(l=!0,n+='</optgroup><optgroup label="-"><option id="'+e.name+e.allValue[s].value+'"  value="',n+=e.allValue[s].value,n+='"'+i+">"+e.allValue[s].title,n+="</option></optgroup>"):(n+='<option id="'+e.name+e.allValue[s].value+'" value="'+e.allValue[s].value+'"'+i+">",n+=e.allValue[s].title,n+="</option>");return l?(n+="</select>",n+='<div class="selectCheckBoxcustomParent" id="'+e.name+'CustomParent">',n+='<input type="text" class="customNum" id="'+e.name+'Begin">% 至 ',n+='<input type="text" class="customNum" id="'+e.name+'End">%</div>'):n+="</optgroup></select>",n+="</div>"}};e("#search_publisherName").focus(function(){"请输入发行人名称或首字母..."==e(this).prop("value")&&(e(this).css("color","#000"),e(this).prop("value",""))}),e("#search_select").click(function(){var t=e("#search_publisherName");t.focus(),t.trigger("keydown"),t.css("color","#000"),t.val(""),t.trigger("click")}),_afterAutocomplete=function(){e("#search_publisherName").autocomplete("searchKeyWordsUrl",{minChars:0,delay:300,cacheLength:500,max:20,minWidth:281,scrollHeight:300,websocket:!0,matchCase:!0,matchContains:!1,websocketType:"jg",extraParams:{v:function(){return e("#search_publisherName").val()}},matchContains:!1,websocketOption:"opt",formatItem:function(e){return'<span datavalue="'+e.publishName+'" >'+e.publishName+"</span>"},createUrlFun:function(t){return t=t.toUpperCase(),t=e.trim(t),encodeURI(It+t)}}).result(function(t,n){e("#search_publisherName").val(n.publishName),m(),o()})},e("#allconditionParentDiv select.industrySelect").live("change",function(){if("industry"==this.id){var e=this;q(e)}else if("firstInd"==this.id){var t=this;F(t)}else if("secondInd"==this.id){var n=this;b(n)}}),e("#allconditionParentDiv select.diqu").live("change",function(){var e=this.id;"province"==e?C():"city"==e?y():"area"==e&&x()}),e("#allconditionParentDiv select.oneSelectCustom").live("change",function(){var t='div[data-value="'+this.dataset.name+'"] .dateCustom';if("7"==this.value)console.log("*********************88default******************"),e(t).css("display","inline-block");else{e(t).css("display","none");var n=this.id+"Begin",a=this.id+"End";delete selectedConditions[n],delete selectedConditions[a]}var i=this;p(i)}),e("#allconditionParentDiv input[type='datetime']").live("change input",function(){var t=e(this),n=t.val().split("-"),a=t.attr("id");if(3==n.length&&4==n[0].length&&""!=n[1]&&""!=n[2]&&n[1].length<3&&n[2].length<3){var i=n[0],l=n[1],s=n[2];1==n[1].length&&(l="0"+l),1==n[2].length&&(s="0"+s);var d=i+l+s+"000000";selectedConditions[a]=d,"0"==Nt&&o()}}),e("input.customNum").live("keyup",function(t){var n=e(t.target),a=n.attr("id"),i=n.val();isNaN(i)?(e("#poinMainContent").html("提示：请输入数字"),e(".point-dialog").widget("dialog").show()):(selectedConditions[a]=i,o())});var At=function(t,n){console.log("---------select.SelectCheckbox------");var a,i,l=e(event.target),s=(e(n),n.children[0].children),o=l.attr("aria-selected"),d="#"+n.id,r=d+"CustomParent",c=e(r);n.children[1]&&(a=n.children[1].children,i=!0);var u;if(u="true"==o?!0:!1,"all"==l.attr("value")){for(var f=1,h=s.length;h>f;f++)s[f].selected=u;i&&(a[0].selected=!1),c.css("display","none")}else if("custom"!=l.attr("value"))"false"==o?s[0].selected=!1:i&&(a[0].selected=!1),c.css("display","none");else if("custom"==l.attr("value")){if("true"==o)for(var f=0,h=s.length;h>f;f++)s[f].selected=!1;c.css("display","inline-block")}e(d).multiselect("refresh")};e("#allconditionParentDiv select.SelectCheckbox").live("change",function(e){var t=this,n="#"+t.id;At(e,t),h(n)}),e("#clean-index").click(function(){e("#conditionParentDiv").empty(),r(),W(),T(),e("#valuationRate").widget().target.multiselect("refresh"),O(),o()}),e("#restore").click(function(){e("#selectedIndexUl li").remove(".indexLi")}),e("body").click(function(t){var n=e("#search_publisherName");"search_publisherName"!=t.target.id&&""==n.val()&&(n.val("请输入发行人名称或首字母..."),n.css({color:"#A9A9A9"}),"all"!=selectedConditions.publisherName&&(selectedConditions.publisherName="all","0"==Nt&&o()))}),e("#myPlanUl").click(function(e){function t(){Nt="0"}wt="top";var a=e.target;if("LI"==a.nodeName){Nt="1",setTimeout(t,1e3);var i=a.dataset.planid,l=n.findThePlan(i);selectedConditions=l.data.tj,_(),o()}});var Ot=function(e,t,n,a,i){e=e||"大智慧数据导出",t=t||"",n=n||e,i=i;var l,s=[],o=a,d=o.length,r=["<html xmlns:x='urn:schemas-microsoft-com:office:excel'><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>"];r.push(n),r.push("</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv='content-type' content='text/html; charset=gbk'><style>.text { font-family:Arial;font-size:10pt;mso-number-format:'@';}</style></head>"),r.push("<body>"),r.push("<table style='border-bottom: 0px;'  width='100%' border='1' cellpadding='0' bordercolorlight='#999999' bordercolordark='#FFFFFF' cellspacing='0' align='center'>"),r.push("<tr>");for(var c=0,u=i.length;u>c;c++)"xh"!=i[c].field&&(s.push(i[c].field),r.push("<th><div>"),r.push(i[c].name),i[c].group&&r.push("("+i[c].group+")"),r.push("</div></th>"));r.push("</tr>"),l=s.length;for(var c=0;d>c;c++){r.push("<tr>");for(var f=0;l>f;f++){if(r.push("<td>"),"xh"==s[f])h=c+1;else var h=o[c][s[f]];r.push(h),r.push("</td>")}r.push("</tr>")}r.push(t),r.push("</table>"),r.push("</body>"),window.external.saveas?window.external.saveas(r.join(""),e,"xls"):alert("请在大智慧客户端使用")};e("#xeceldaochu").click(function(){var e="<tr></tr><tr></tr><tr><td colspan='3' style='border: 0px;text-align:left;'>数据来源:大智慧</td></tr>";Ot("债券查找",e,"大智慧债券查找",xt,kt)}),e(function(){e.getJSON("./resources/json/condition.json").then(function(t){Ct=t,K(),e.getJSON("./resources/json/unchangeCondition.json").then(function(e){yt=e,J(),Q()}),it(),$(),Z(),lt(),X(),et(),ut(),pt(),vt(),gt(),z(),mt(),e("#search_publisherName").css("color","#A9A9A9"),n.init(),_afterAutocomplete()})})}),require(["js/index.js"],function(){require(["js/"+(location.pathname.match(/([^\/]+)\.html/)||[,"index"])[1]+".js"],function(){arguments[0]&&arguments[0].init&&arguments[0].init()})}),define("src",function(){});