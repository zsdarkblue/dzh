/*
	Copyright (c) 2012-2013,   To get sources and documentation, please visit:

		http://dms.gw.com.cn
*/

//>>built
require({cache:{"bond/bondPortfolio/view/_helper/CustomKeyboardSpirit":function(){define("dojo/_base/lang,dojo/_base/declare,dojo/_base/array,dojo/on,dojo/_base/window,dojo/aspect,dijit/form/ComboBox,dojox/store/GridWSStore,dojo/json".split(","),function(h,e,j,o,w,u,E,y){return e("bond.bondPortfolio.view._helper.CustomKeyboardSpirit",[E],{hasDownArrow:!1,autoComplete:!1,labelType:"html",labelAttr:"name",searchAttr:"code",selectOnClick:!0,labelFunc:function(e){return e[this.labelAttr]+" "+e[this.searchAttr].slice(0,
e[this.searchAttr].length-5)},onSearch:function(e,o,j){j.direction=!0;this.dropDown.clearResultList()},postMixInProperties:function(){this.store=new y;u.before(this.store,"query",h.hitch(this,this.beforeQuery));u.after(this.store,"convert",h.hitch(this,this.afterQuery));this.inherited(arguments)},afterQuery:function(){for(var e=this.get("value"),o=bondCustomKeyboardSpirit.keyboardValue,j=[],u=0,w=bondList,h=0;h<w.length;h++){if(w[h].edate>o&&(-1!=w[h].code.indexOf(e)||-1!=w[h].shortKey.indexOf(e)))j[u]=
w[h],u++;if(10==u)break}return j},beforeQuery:function(e){e.service="kbspirit";e.key=this.get("value").toUpperCase();e.response_times=1;e.response_mode=0},startup:function(){this._setHasDownArrowAttr(this.hasDownArrow);this.inherited(arguments)}})})},"bond/bondPortfolio/view/_helper/MCheckedMultiSelect":function(){define("dojo/on,dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/_base/event,dojo/dom-geometry,dojo/dom-class,dojo/dom-construct,dojo/i18n,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/registry,dijit/Menu,dijit/MenuItem,dijit/Tooltip,dijit/form/_FormSelectWidget,dijit/form/ComboButton,dojo/text!dojox/form/resources/_CheckedMultiSelectMenuItem.html,dojo/text!dojox/form/resources/_CheckedMultiSelectItem.html,dojo/text!dojox/form/resources/CheckedMultiSelect.html,dojo/i18n!dojox/form/nls/CheckedMultiSelect,dijit/form/CheckBox,dojo/css!dijit/themes/claro/CheckedMultiSelect.css".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M){var C=e("dojox.form._CheckedMultiSelectItem",[K,F,da],{templateString:P,baseClass:"dojoxMultiSelectItem",option:null,parent:null,disabled:!1,readOnly:!1,postMixInProperties:function(){this._type=this.parent.multiple?{type:"checkbox",baseClass:"dijitCheckBox"}:{type:"radio",baseClass:"dijitRadio"};this.disabled=this.option.disabled=this.option.disabled||!1;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=
this.option.label},_changeBox:function(){if(!this.get("disabled")&&!this.get("readOnly"))this.parent.multiple?this.option.selected=this.checkBox.get("value")&&!0:this.parent.set("value",this.option.value),this.parent._updateSelection(),this.parent.focus()},_onClick:function(d){this.get("disabled")||this.get("readOnly")?w.stop(d):this.checkBox._onClick(d)},_updateBox:function(){this.checkBox.set("value",this.option.selected)},_setDisabledAttr:function(d){this.disabled=d||this.option.disabled;this.checkBox.set("disabled",
this.disabled);E.toggle(this.domNode,"dojoxMultiSelectDisabled",this.disabled)},_setReadOnlyAttr:function(d){this.checkBox.set("readOnly",d);this.readOnly=d}}),G=e("dojox.form._CheckedMultiSelectMenu",S,{multiple:!1,buildRendering:function(){this.inherited(arguments);var d=this.menuTableNode=this.domNode,c=this.domNode=y.create("div",{style:{overflowX:"hidden",overflowY:"scroll"}});d.parentNode&&d.parentNode.replaceChild(c,d);E.remove(d,"dijitMenuTable");c.className=d.className+" dojoxCheckedMultiSelectMenu";
d.className="dijitReset dijitMenuTable";d.setAttribute("role","listbox");c.setAttribute("role","presentation");c.appendChild(d)},resize:function(d){if(d&&(u.setMarginBox(this.domNode,d),"w"in d))this.menuTableNode.style.width="100%"},onClose:function(){this.inherited(arguments);if(this.menuTableNode)this.menuTableNode.style.width=""},onItemClick:function(d){function c(b){o.forEach(m.getChildren(),function(m){m.option.selected=b})}function r(){var b=m.getChildren().slice(1),d=m.getChildren()[0];o.every(b,
function(b){return b.option.selected})?c(!0):d.option.selected=!1}"undefined"==typeof this.isShowingNow&&this._markActive();var e=d.option,j=e.selected,m=this;/all|\u5168\u90e8/gi.test(e.value)?j?c(!0):c(!1):r();this.focusChild(d);if(d.disabled||d.readOnly)return!1;if(!this.multiple)this.onExecute()}}),A=e("dojox.form._CheckedMultiSelectMenuItem",U,{templateString:O,option:null,parent:null,_iconClass:"",postMixInProperties:function(){this.parent.multiple?(this._iconClass="dojoxCheckedMultiSelectMenuCheckBoxItemIcon",
this._type={type:"checkbox"}):(this._iconClass="",this._type={type:"hidden"});this.disabled=this.option.disabled;this.checked=this.option.selected;this.label=this.option.label;this.readOnly=this.option.readOnly;this.inherited(arguments)},onChange:function(){},_updateBox:function(){E.toggle(this.domNode,"dojoxCheckedMultiSelectMenuItemChecked",!!this.option.selected);this.domNode.setAttribute("aria-checked",this.option.selected);this.inputNode.checked=this.option.selected;this.parent.multiple||E.toggle(this.domNode,
"dijitSelectSelectedOption",!!this.option.selected)},_onClick:function(d){if(!this.disabled&&!this.readOnly)if(this.parent.multiple)this.option.selected=!this.option.selected,this.parent.onChange(),this.onChange(this.option.selected);else if(!this.option.selected)o.forEach(this.parent.getChildren(),function(c){c.option.selected=!1}),this.option.selected=!0,this.parent.onChange(),this.onChange(this.option.selected);this.inherited(arguments)}});return e("bond.bondQuotation.view._helper.MCheckedMultiSelect",
V,{templateString:M,baseClass:"dojoxCheckedMultiSelect",required:!1,invalidMessage:"$_unset_$",_message:"",multiple:!0,dropDown:!0,labelText:"",tooltipPosition:[],setStore:function(d,c,e){this.inherited(arguments);var s=function(m){var b=[];o.forEach(m,function(m){m.selected&&b.push(m.value)});b.length&&this.set("value",b);this._updateSelection()},w=this.store.query(this.query,this.queryOptions);j.isArray(w)?s.call(this,w):w.then(j.hicth(this,s))},postMixInProperties:function(){this.inherited(arguments);
this._nlsResources=v.getLocalization("dojox.form","CheckedMultiSelect",this.lang);if("$_unset_$"==this.invalidMessage)this.invalidMessage=this._nlsResources.invalidMessage},_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var d=this.srcNodeRef.selectedIndex||0;this.value=this.options[0<=d?d:0].value}if(this.dropDown)E.toggle(this.selectNode,"dojoxCheckedMultiSelectHidden"),this.dropDownMenu=new G({id:this.id+"_menu",style:"display: none;",multiple:this.multiple,
onChange:j.hitch(this,"_updateSelection")})},postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.inherited(arguments);if(this.dropDown){this.dropDownButton=new W({label:this.labelText,dropDown:this.dropDownMenu,baseClass:"dojoxCheckedMultiSelectButton",maxHeight:this.maxHeight},this.comboButtonNode);var d=this.dropDownButton.titleNode,c=y.create("input",{"class":"dijitReset dijitInline dijitButtonText dojoxCheckedMultiSelectButton",readOnly:!0}),e=function(c){c.stopPropagation()};
this.own(h(c,"keypress",e),h(c,"keydown",e),h(c,"keyup",e),h(c,"mousedown",e),h(c,"mouseup",e),h(c,"click",e));d.lastChild.style.display="none";d.appendChild(c);d.lastChild.style.width=this.width-25+"px";this._updateSelection()}},_onMouseDown:function(d){w.stop(d)},validator:function(){return!this.required?!0:o.some(this.getOptions(),function(d){return d.selected&&null!=d.value&&0!=d.value.toString().length})},validate:function(d){Q.hide(this.domNode);(d=this.isValid(d))||this.displayMessage(this.invalidMessage);
return d},isValid:function(){return this.validator()},getErrorMessage:function(){return this.invalidMessage},displayMessage:function(d){Q.hide(this.domNode);d&&Q.show(d,this.domNode,this.tooltipPosition)},onAfterAddOptionItem:function(){},_addOptionItem:function(d){var c;this.dropDown?(c=new A({option:d,parent:this.dropDownMenu}),this.dropDownMenu.addChild(c)):(c=new C({option:d,parent:this}),this.wrapperDiv.appendChild(c.domNode));this.onAfterAddOptionItem(c,d)},_refreshState:function(){this.validate(this.focused)},
onChange:function(){this._refreshState()},reset:function(){this.inherited(arguments);Q.hide(this.domNode)},_updateSelection:function(){this.inherited(arguments);this._handleOnChange(this.value);o.forEach(this._getChildren(),function(m){m._updateBox()});y.empty(this.containerNode);var d=this;o.forEach(this.value,function(m){m=y.create("option",{value:m,label:m,selected:"selected"});y.place(m,d.containerNode)});if(this.dropDown&&this.dropDownButton){var c=0,e=[];o.forEach(this.options,function(m){if(m.selected){c++;
var b="";0<m.label.indexOf("<")?(labelLenth=m.label.indexOf("<"),b=m.label.substr(0,labelLenth)):b=m.label;e.push(b)}});var s=this.dropDownButton.titleNode.lastChild,j=e.join(",");-1!=j.indexOf("\u5168\u90e8")&&(j="\u5168\u90e8");this.dropDownButton.set("label",this.multiple?j:label);s.value=j;s.title=j}},_getChildren:function(){return this.dropDown?this.dropDownMenu.getChildren():o.map(this.wrapperDiv.childNodes,function(d){return R.byNode(d)})},invertSelection:function(){this.multiple&&(o.forEach(this.options,
function(d){d.selected=!d.selected}),this._updateSelection())},_setDisabledAttr:function(d){this.inherited(arguments);this.dropDown&&this.dropDownButton.set("disabled",d);o.forEach(this._getChildren(),function(c){c&&c.set&&c.set("disabled",d)})},_setReadOnlyAttr:function(d){this.inherited(arguments);"readOnly"in this.attributeMap&&this._attrToDom("readOnly",d);this.readOnly=d;o.forEach(this._getChildren(),function(c){c&&c.set&&c.set("readOnly",d)})},uninitialize:function(){Q.hide(this.domNode);o.forEach(this._getChildren(),
function(d){d.destroyRecursive()});this.inherited(arguments)}})})},"bond/bondPortfolio/view/groupManagerForGroup":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./groupManagerForGroup.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dojox/slickgrid/sogrid,dojox/store/GridWSStore,dojo/io-query,dojo/dom,dijit/registry,bond/bondPortfolio/view/_helper/util,bond/bondPortfolio/view/bondGrp_adjust,dojox/store/LocalStorage,bond/bondPortfolio/view/_helper/MessageDialog".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G,A,d,c){var r=-1,s,X=new d({idProperty:"id",namespace:"bondPortfolio"});return j("bond.bondPortfolio.view.groupManagerForGroup",[o,w,u,E],{templateString:S,postCreate:function(){this.inherited(arguments);var m=this,b=new O({}),d=1;b.query({service:"rpc",so:"jso-all-bondpermissions.jar","function":"gw.sh.func.BondPermissionsRequest",paraencode:"base64",parameter:(window.external.base64encode||btoa)('{"username":"'+bondPortfolioConfig.currentUserID+
'","moduleid":"612","dataid":"2"}'),response_times:1,cache_timeout:0,response_mode:0,request_timeout:-1}).then(function(b){d="-1"!=b.res_type?0:1;X.put({id:"userId",name:bondPortfolioConfig.currentUserID});X.put({id:"permission",name:d})});var e={createPersonId:bondPortfolioConfig.currentUserID,cacheDate:G.date2str(new Date,"yyyyMMddHHmmss")};(new O({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getAllGroup.dzh?"+
P.objectToQuery(e)),response_times:1,response_mode:0}).then(function(b){m.handleTableGrid(b);b=dijit.byId("mytree2");b.set("path",["node",b.path[0].children[0],b.path[0].children[0].children[0]]);targetNode=["node",b.path[0].children[0],b.path[0].children[0].children[1]]});m.insertGroupButton.on("click",function(){for(var d=m.groupName.get("value"),e=!0,x=0;x<s.store.data.length;x++)if(s.store.data[x].groupName==d){e=!1;break}if(e){var e=m.createPersonName.get("value"),x=m.datetype.get("value"),j=
m.groupType.get("value"),o=m.bondHoleType.get("value"),a=m.memo.get("value"),w=bondPortfolioConfig.currentUserID,u="",u=-1==r?"/groupManager/insertGroup.dzh?":"/groupManager/updateGroup.dzh?";b.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+u+P.objectToQuery({groupId:r,groupName:d,createDate:new Date,createPersonName:e,createPersonId:w,datetype:x,groupType:j,bondHoleType:o,memo:a})),response_times:1,response_mode:0}).then(function(b){m.handleResult(b);
s.store.data=b;s.refresh(b);myFormDialog.hide()})}else(new c).showDialog("\u8be5\u7ec4\u5408\u5df2\u5b58\u5728")});m.buttonThree.on("click",function(){r=-1;m.creatDateDialog.innerHTML=G.date2str(new Date,"yyyy-MM-dd");m.groupName.set("value","");m.createPersonName.set("value","");m.datetype.set("value","CNIBEX");m.groupType.set("value",0);m.bondHoleType.set("value",0);m.memo.set("value","");myFormDialog.show()});m.updateGroupButton.on("click",function(){updateDialog.hide();var c=m.update_person.get("value"),
d=m.update_groupType.get("value"),e=m.update_bondHoleType.get("value"),x=m.update_memo.get("value"),c={groupId:r,createPersonId:bondPortfolioConfig.currentUserID,createPersonName:c,groupType:d,memo:x,updateDate:G.date2str(new Date,"yyyyMMdd000000"),bondHoleType:e};b.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/updateGroup.dzh?"+P.objectToQuery(c)),response_times:1,response_mode:0}).then(function(b){m.handleResult(b);
s.store.data=b;s.refresh(b)})})},bindCellClick:function(m,b){m.on("click",function(c,d){var e=c.target.getAttribute("clickFn");e&&y.hitch(b,function(){this[e](c,d,m)})()})},updateButton:function(m,b,c){r=c.data[b.row].groupId;this.update_date.innerHTML=c.data[b.row].createDate;this.update_name.innerHTML=c.data[b.row].groupName;this.update_person.set("value",c.data[b.row].createPersonName);this.update_dateType.innerHTML=c.data[b.row].datetype;this.update_groupType.set("value",c.data[b.row].groupType);
this.update_bondHoleType.set("value","\u5230\u671f"==c.data[b.row].bondHoleType?"0":"1");this.update_memo.set("value",c.data[b.row].memo);updateDialog.show()},removeButton:function(c,b,d){var e=this;confirm("\u786e\u5b9a\u5220\u9664\u7ec4\u5408 "+d.data[b.row].groupName+" ?")&&(c=d.data.splice(b.row,1),d.refresh(),c&&c[0]&&(c={groupId:c[0].groupId,createPersonId:bondPortfolioConfig.currentUserID},(new O({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+
btoa(bondPortfolioConfig.soUrl+"/groupManager/deleteGroup.dzh?"+P.objectToQuery(c)),response_times:1,response_mode:0}).then(function(b){e.handleResult(b);d.store.data=b;d.refresh(b)})))},linkButton:function(c,b,d){r=d.data[b.row].groupId;C.byId("mytree2");X.put({id:"groupId",name:r});c=dijit.byId("mytree2");c.set("path",["node",c.path[0].children[0],c.path[0].children[0].children[1]]);mytopContentPaneGrid.setContent(new A)},handleTableGrid:function(c){var b=this.container;this.handleResult(c);c=new h({data:c});
s=new U({store:c,columns:[{id:"groupName",name:"\u7ec4\u5408\u540d\u79f0",field:"groupName",formatter:function(b,c,d){return'<a href="#" clickFn="linkButton">'+d+"</a>"},width:10,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"createDate",name:"\u521b\u5efa\u65e5\u671f",field:"createDate",width:8,sortable:!0,headerCssClass:"font-center",cssClass:"font-center"},{id:"createPersonName",name:"\u521b\u5efa\u4eba",field:"createPersonName",width:8,sortable:!0,headerCssClass:"font-center",
cssClass:"font-left"},{id:"groupType",name:"\u7ec4\u5408\u7c7b\u578b\t",field:"groupType",width:10,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"datetype",name:"\u4ea4\u6613\u65e5\u671f\u7c7b\u578b",field:"datetype",width:10,headerCssClass:"font-center",cssClass:"font-center"},{id:"bondHoleType",name:"\u542b\u6743\u503a\u6301\u6709",field:"bondHoleType",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-left"},{id:"memo",name:"\u7ec4\u5408\u5907\u6ce8",field:"memo",
width:36,sortable:!1,headerCssClass:"font-center",cssClass:"font-left"},{id:"pdf2",name:"",field:"pdf2",formatter:function(){return'<a href="#" clickFn="updateButton">\u4fee\u6539</a>'},width:6,sortable:!1,cssClass:"font-center"},{id:"pdf3",name:"",field:"pdf3",formatter:function(){return'<a href="#" clickFn="removeButton">\u5220\u9664</a>'},width:6,sortable:!1,cssClass:"font-center"}],options:{forceFitColumns:!0,enableColumnReorder:!1,rowHeight:20}});s.placeAt(b);this.bindCellClick(s,this)},handleResult:function(c){for(i=
0;i<c.length;i++){c[i].groupType=0==c[i].groupType?"\u4ec5\u81ea\u5df1\u53ef\u89c1":"\u516c\u5f00";c[i].bondHoleType=0==c[i].bondHoleType?"\u5230\u671f":"\u884c\u6743\u65e5";c[i].datetype="CNIBEX"==c[i].datetype?"\u94f6\u884c\u95f4":"\u4ea4\u6613\u6240";var b=c[i].createDate.substring(0,4)+"-"+c[i].createDate.substring(4,6)+"-"+c[i].createDate.substring(6,8);c[i].createDate=b}return c}})})},"url:bond/bondPortfolio/view/groupManagerForGroup.html":'<div data-dojo-attach-point="containerNode" >\r\n\t<div class="vbox" style="height:100%">\r\n\t\t<div  class="build_list" style="height:35px">\r\n\t\t\t<div data-dojo-type="dijit/Dialog" data-dojo-id="myFormDialog" style="width:30%" title="\u65b0\u5efa\u7ec4\u5408">\r\n\t\t\t\t<div class="dijitDialogPaneContentArea">\r\n\t\t\t\t        <table cellspacing="0" cellpadding="0" class="local_table_01">\r\n\t\t\t\t           <tr>\r\n\t\t\t\t           \t\t<td>\u521b\u5efa\u65e5\u671f</td>\r\n\t\t\t\t           \t\t<td><div data-dojo-attach-point="creatDateDialog" ></div></td>\r\n\t\t\t\t           </tr>\r\n                            <tr>\r\n                                <td>\u7ec4\u5408\u540d\u79f0</td>\r\n                                <td><input data-dojo-attach-point="groupName" style="width:100%" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="" /></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>\u521b\u5efa\u4eba</td>\r\n                                <td><input data-dojo-attach-point="createPersonName" style="width:100%" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="" /></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>\u4ea4\u6613\u65e5\u671f\u7c7b\u578b</td>\r\n                                <td>\r\n                                    <div data-dojo-type="dijit/form/Select" data-dojo-attach-point="datetype" >\r\n                                        <option  value="CNIBEX">\u94f6\u884c\u95f4\u4ea4\u6613\u65e5</option>\r\n                                        <option  value="CNSESH">\u4ea4\u6613\u6240\u4ea4\u6613\u65e5</option>\r\n\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>\u662f\u5426\u5171\u4eab</td>\r\n                                <td>\r\n                                    <div data-dojo-type="dijit/form/Select" data-dojo-attach-point="groupType" disabled="true"  >\r\n                                        <option value="0">\u4ec5\u81ea\u5df1\u53ef\u89c1</option>\r\n                                        <option value="1">\u516c\u5f00</option>\r\n\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>\u542b\u6743\u503a\u6301\u6709</td>\r\n                                <td>\r\n                                    <div data-dojo-type="dijit/form/Select" data-dojo-attach-point="bondHoleType"  >\r\n                                        <option value="0">\u5230\u671f</option>\r\n                                        <option value="1">\u884c\u6743\u65e5</option>\r\n\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>\u7ec4\u5408\u5907\u6ce8</td>\r\n                                <td>\r\n                                    <textarea data-dojo-attach-point="memo"  data-dojo-type="dijit/form/Textarea"></textarea>\r\n                                </td>\r\n                            </tr>\r\n\r\n                        </table>\r\n                </div>\r\n                <div class="dijitDialogPaneActionBar">\r\n                    <button data-dojo-type="dijit/form/Button" type="button" data-dojo-attach-point="insertGroupButton" >\r\n                        \u63d0\u4ea4\r\n                    </button>\r\n                    <button data-dojo-type="dijit/form/Button" type="button" onClick="myFormDialog.hide()">\r\n                        \u53d6\u6d88\r\n                    </button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n            <div data-dojo-type="dijit/Dialog" data-dojo-id="updateDialog" style="width:30%" title="\u4fee\u6539\u7ec4\u5408">\r\n                <div class="dijitDialogPaneContentArea">\r\n                    <table cellspacing="0" cellpadding="0" class="local_table_01">\r\n                        <tr>\r\n                            <td>\u521b\u5efa\u65e5\u671f</td>\r\n                            <td><div data-dojo-attach-point="update_date" ></div></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u7ec4\u5408\u540d\u79f0</td>\r\n                            <td><div data-dojo-attach-point="update_name" ></div></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u521b\u5efa\u4eba</td>\r\n                            <td><input data-dojo-attach-point="update_person" style="width:100%" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="" /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u4ea4\u6613\u65e5\u671f\u7c7b\u578b</td>\r\n                            <td><div data-dojo-attach-point="update_dateType" ></div></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u662f\u5426\u5171\u4eab</td>\r\n                            <td>\r\n                                <div data-dojo-type="dijit/form/Select" data-dojo-attach-point="update_groupType" disabled="true">\r\n                                    <option value="0">\u4ec5\u81ea\u5df1\u53ef\u89c1</option>\r\n                                    <option value="1">\u516c\u5f00</option>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u542b\u6743\u503a\u6301\u6709</td>\r\n                            <td>\r\n                                <div data-dojo-type="dijit/form/Select" data-dojo-attach-point="update_bondHoleType" >\r\n                                    <option value="0">\u5230\u671f</option>\r\n                                    <option value="1">\u884c\u6743\u65e5</option>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\u7ec4\u5408\u5907\u6ce8</td>\r\n                            <td>\r\n                                <textarea data-dojo-attach-point="update_memo"  data-dojo-type="dijit/form/Textarea"></textarea>\r\n                            </td>\r\n                        </tr>\r\n\r\n                    </table>\r\n                </div>\r\n                <div class="dijitDialogPaneActionBar">\r\n                    <button data-dojo-type="dijit/form/Button" type="button" data-dojo-attach-point="updateGroupButton" >\r\n                        \u63d0\u4ea4\r\n                    </button>\r\n                    <button data-dojo-type="dijit/form/Button" type="button" onClick="updateDialog.hide()">\r\n                        \u53d6\u6d88\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n\t\t\t<button data-dojo-attach-point="buttonThree"  data-dojo-type="dijit/form/Button" type="button">\r\n\t\t\t\t   \u65b0\u5efa\u7ec4\u5408\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:100%">\r\n\t\t\t<div class="vbox" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden;">\r\n\t\t\t\t<div  class="spacer" data-dojo-attach-point="container"  data-dojo-type="dijit/layout/ContentPane">\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id="pagerDiv"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n',
"bond/bondPortfolio/view/_helper/util":function(){define(["dojo/date/locale"],function(h){return{getTime:function(e){return e.substring(8,10)+":"+e.substring(10,12)},saveAsExcel:function(e,j,o,w,u){var e=e||"\u5927\u667a\u6167\u6570\u636e\u5bfc\u51fa",j=j||"",o=o||e,h=w.data,u=u||w.getColumns(),w=[],y=h.length,v=["<html xmlns:x='urn:schemas-microsoft-com:office:excel'><head><\!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>"];v.push(o);v.push("</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\><meta http-equiv='content-type' content='text/html; charset=gbk'><style>.text { font-family:Arial;font-size:10pt;mso-number-format:'@';}</style></head>");
v.push("<body>");v.push("<table width='100%' border='1' cellpadding='0' bordercolorlight='#999999' bordercolordark='#FFFFFF' cellspacing='0' align='center'>");v.push(j);v.push("<tr>");j=0;for(o=u.length;j<o;j++)u[j].field&&(w.push(u[j].field),v.push("<th><div>"),v.push(u[j].name),v.push("</div></th>"));v.push("</tr>");u=w.length;for(j=0;j<y;j++){v.push("<tr>");for(o=0;o<u;o++)v.push("<td>"),"traderID"==w[o]?v.push(h[j].traderName):v.push(h[j][w[o]]),v.push("</td>");v.push("</tr>")}v.push("</table>");
v.push("</body>");window.external.saveas?window.external.saveas(v.join(""),e,"xls"):alert("\u8bf7\u5728\u5927\u667a\u6167\u5ba2\u6237\u7aef\u4f7f\u7528")},generateTimeStamp:function(){var e=new Date,j=e.getFullYear(),o=e.getMonth()+1,w=e.getDate(),u=e.getHours(),h=e.getMinutes(),y=e.getSeconds(),e=e.getMilliseconds();return j+"-"+o+"-"+w+"_"+u+"-"+h+"-"+y+"-"+e},dateAdd:function(){},date2str:function(e,j){return h.format(e,{datePattern:j,selector:"date"})},str2date:function(e){var j=new Date,e=4<=
e.indexOf("-")?e.replace("-",""):e;j.setFullYear(e.slice(0,4),1*e.slice(4,6)-1,e.slice(6,8));return j},getCurrentUserID:function(){var e;if(bondPortfolioConfig.currentUserID)e=bondPortfolioConfig.currentUserID;else if(window.external&&window.external.getDZHProperty)e=window.external.getDZHProperty("userid"),bondPortfolioConfig.currentUserID=e;return e},addThousandSeparator:function(e){array=e.split(".");for(e=/(-?\d+)(\d{3})/;e.test(array[0]);)array[0]=array[0].replace(e,"$1,$2");for(var e=array[0],
j=1;j<array.length;j++)e+="."+array[j];return e},deleteThousandSeparator:function(e){e=e.split(",");return parseFloat(e.join(""))}}})},"bond/bondPortfolio/view/bondGrp_adjust":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/text!./bondGrp_adjust.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dojo/io-query,dojox/store/GridWSStore,dojox/store/WebSocket,dijit/form/FilteringSelect,bond/bondPortfolio/view/_helper/util,dojo/dom,bond/bondPortfolio/view/_helper/CustomKeyboardSpirit,dojox/store/LocalStorage,dojo/dom-construct,bond/bondPortfolio/view/_helper/MessageDialog,dojo/number".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G,A,d,c,r){var s=-1,X=1,m=!1,b=null,x="",ba,Y,T,B,D,L,a,H,N,I,ea,z=new A({idProperty:"id",namespace:"bondPortfolio"});return j("bond.bondPortfolio.view.bondGrp_adjust",[o,w,u,E],{templateString:R,postCreate:function(){var q=this;q.btn_BS.hidden=!1;q.btn_weight.hidden=!0;q.minDiv.hidden=!0;X=z.get("permission").name;selDate=M.date2str(new Date,"yyyyMMdd000000");q.posDate.set("value",new Date);var a=q.groupNameSel,c=dijit.byId("groupSelect");c&&
c.destroy();var f=new P({id:"groupSelect",name:"name",value:"",store:[],searchAttr:"name",style:"width:98.5%"});f.placeAt(a);f.on("change",function(){null!=f.item?(s=f.item.id,z.put({id:"groupId",name:s}),holdType=f.item.hold,tradeType=f.item.trade.slice(2,4),m=!0,q.getDate(M.date2str(q.posDate.get("value"),"yyyyMMdd000000"),tradeType)):(b.store.data=[],q.gridShowRefresh(),s=-1,z.put({id:"groupId",name:s}))});a={createPersonId:bondPortfolioConfig.currentUserID,cacheDate:M.date2str(new Date,"yyyyMMddHHmmss")};
(new O).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getAllGroup.dzh?"+V.objectToQuery(a)),response_times:1,response_mode:0}).then(function(b){var a=[];if(b[0].result)for(var c=0;c<b[0].result.datas.length;c++)a.push({name:b[0].result.datas[c][1],id:b[0].result.datas[c][0],trade:b[0].result.datas[c][8],hold:b[0].result.datas[c][9]});b=new h({data:a});f.store=b;q.gridInit(0);q.dijitEvent();q.getKBSpiritStore();
s=z.get("groupId").name;-1!=s&&null!=s&&""!=s&&(f.set("value",s),""==f.value&&(s=-1,z.put({id:"groupId",name:s})))})},gridInit:function(q){var a=this.mainArea;a.removeChild(b);if(null==b)gStore=new h;else{for(var c=0;c<b.store.data.length;c++)0>=b.store.data[c].amount?(b.store.data.splice(c,1),c--):b.store.data[c].numId=c+1;gStore=b.store}options={forceFitColumns:!0,enableColumnReorder:!1,rowHeight:20};columns=[{id:"numId",name:"\u5e8f\u53f7",field:"numId",width:6,headerCssClass:"font-center",cssClass:"font-center"},
{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:14,headerCssClass:"font-center",cssClass:"font-left"},{id:"bondName",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",width:14,headerCssClass:"font-center",cssClass:"font-left"},{id:"positionWeight",name:"\u6301\u4ed3\u6743\u91cd(%)",field:"positionWeight",width:12,headerCssClass:"font-center",cssClass:"font-right"},{id:"amount",name:"\u6301\u4ed3\u6570\u91cf",field:"amount",width:10,headerCssClass:"font-center",cssClass:"font-right"},
{id:"costPrice",name:"\u6210\u672c\u4ef7",field:"costPrice",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"dirtyPrice",name:"\u6700\u65b0\u5168\u4ef7",field:"dirtyPrice",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"rate",name:"\u5e94\u8ba1\u5229\u606f",field:"rate",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"netPrice",name:"\u6700\u65b0\u51c0\u4ef7",field:"netPrice",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"yield",
name:"\u5230\u671f\u6536\u76ca\u7387",field:"yield",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"dateSource",name:"\u6570\u636e\u6765\u6e90",field:"dateSource",width:12,headerCssClass:"font-center",cssClass:"font-center"},{id:"positionValue",name:"\u6301\u4ed3\u5e02\u503c",field:"positionValue",width:14,headerCssClass:"font-center",cssClass:"font-right"},{id:"delBtn",name:"",field:"delBtn",formatter:function(){return'<a href="#" clickFn="deleteBond">\u5220\u9664</a>'},width:6,
headerCssClass:"font-center",cssClass:"font-center"}];0==q?b=new S({store:gStore,columns:columns,options:options}):1==q?(columns[1]={id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",formatter:function(b){return'<div id="keyboardS_'+b+'"></div>'},width:14,headerCssClass:"font-center",cssClass:"font-left"},columns[4]={id:"amount",name:"\u6301\u4ed3\u6570\u91cf",field:"amount",formatter:function(b,q,a,c,J){return'<div><input id="dataAmount_'+b+'" class="width_ctrl_all" type="text" value="'+
a+'" targetobj="'+J.bondCode+'" changeFn="getAmount" style="text-align:right"/></div>'},width:10,headerCssClass:"font-center",cssClass:"font-right"},columns[5]={id:"costPrice",name:"\u6210\u672c\u4ef7",field:"costPrice",formatter:function(b,q,a,c,J){return'<div><input id="dataCost_'+b+'" class="width_ctrl_all" type="text" value="'+a+'" targetobj="'+J.bondCode+'" changeFn="getCost" style="text-align:right"/></div>'},width:10,headerCssClass:"font-center",cssClass:"font-right"},gStore.data.push({numId:gStore.data.length+
1,bondName:"",amount:0,bondCode:"",fullCode:"",netPrice:0,costPrice:0,costPrice_N:0,dirtyPrice:0,dirtyPrice_N:0,rate:0,yield:0,positionValue:0,positionWeight:0,dateSource:""}),b=new S({store:gStore,columns:columns,options:options,setFocus:function(){if(1==this.activePosX&&null!=this.activeRow){var b="dataCode_"+this.activeRow;C.byId(b).focus()}else 4==this.activePosX&&null!=this.activeRow?(b="dataAmount_"+this.activeRow,C.byId(b).focus()):5==this.activePosX&&null!=this.activeRow?(b="dataCost_"+this.activeRow,
C.byId(b).focus()):this.$focusSink.focus()}})):(columns[3]={id:"positionWeight",name:"\u6301\u4ed3\u6743\u91cd(%)",field:"positionWeight",formatter:function(b,q,a,c,J){return'<div><input id="dataWeight_'+b+'" class="width_ctrl_all" type="text" value="'+a+'" targetobj="'+J.bondCode+'" changeFn="getWeight" style="text-align:right"/></div>'},width:12,headerCssClass:"font-center",cssClass:"font-right"},b=new S({store:gStore,columns:columns,options:options,setFocus:function(){3==this.activePosX&&null!=
this.activeRow?C.byId("dataWeight_"+this.activeRow).focus():this.$focusSink.focus()}}));b.placeAt(a);if(1==q)for(q=0;q<b.store.data.length;q++)this.setKeyBoardSpirit(q,b.store.data[q].bondCode);this.bindCellClick(b,this)},bindCellClick:function(b,a){b.on("keydown",function(c){var f=c.target,k=c.target.getAttribute("changeFn");if(k){var t=c.target.id.slice(c.target.id.length-1);y.hitch(a,function(){this[k](c,t,b,f)})()}});b.on("click",function(c,f){if(0<=f.row&&12==f.cell){var k=c.target,t=c.target.getAttribute("clickFn");
t&&y.hitch(a,function(){this[t](c,f.row,b,k)})()}})},getCost:function(b,a,c,f){var k=this,t=f.value;f.onkeypress=function(){t=f.value};f.onkeyup=function(){1==k.inputCheck(f)?(c.store.data[a].costPrice_N=1*f.value,c.store.data[a].costPrice=(1*f.value).toFixed(4),z.put({id:"check",name:1})):f.value=t};f.onblur=function(){f.value*=1;1*f.value!=1*f.getAttribute("value")&&"\u8bf7\u8f93\u5165\u503a\u5238"!=f.getAttribute("targetobj")&&k.gridShowRefresh()}},getAmount:function(q,a,c,f){var k=this,t=f.value;
f.onkeypress=function(){t=f.value};f.onkeyup=function(){if(1==k.inputCheck(f)&&0>f.value.indexOf(".")){var q=r.parse(f.value);k.assets.innerHTML=1*k.assets.innerHTML-r.parse(b.store.data[a].positionValue);b.store.data[a].amount=f.value;b.store.data[a].positionValue=q*b.store.data[a].dirtyPrice_N;k.assets.innerHTML=1*k.assets.innerHTML+b.store.data[a].positionValue;k.posVal.innerHTML=(1*k.assets.innerHTML-1*k.cashVal.innerHTML).toFixed(4);k.posWght.innerHTML=(100*(k.posVal.innerHTML/k.assets.innerHTML)).toFixed(2);
k.cashWght.innerHTML=(100*(k.cashVal.innerHTML/k.assets.innerHTML)).toFixed(2);b.store.data[a].positionValue=r.format(b.store.data[a].positionValue,{pattern:"#,##0.0000"});for(q=0;q<b.store.data.length;q++)b.store.data[q].positionWeight=(100*(r.parse(b.store.data[q].positionValue)/k.assets.innerHTML)).toFixed(2);z.put({id:"check",name:1})}else f.value=t};f.onblur=function(){f.value=r.parse(f.value);if(1*f.value!=1*f.getAttribute("value")&&"\u8bf7\u8f93\u5165\u503a\u5238"!=f.getAttribute("targetobj"))b.store.data[a].amount=
r.format(f.value,{pattern:"#,##0"}),k.gridShowRefresh()}},getWeight:function(q,a,d,f){var k=this,t=f.value;f.onkeypress=function(){t=f.value};f.onkeyup=function(){1==k.inputCheck(f)?100>=1*k.posWght.innerHTML+1*f.value-1*f.getAttribute("value")?(k.posVal.innerHTML=1*k.posVal.innerHTML-r.parse(b.store.data[a].positionValue),b.store.data[a].amount=Math.round(f.value/100*k.assets.innerHTML/b.store.data[a].dirtyPrice_N/k.minVal.value)*k.minVal.value,b.store.data[a].positionValue=(b.store.data[a].amount*
b.store.data[a].dirtyPrice_N).toFixed(4),b.store.data[a].positionWeight=(100*(b.store.data[a].positionValue/k.assets.innerHTML)).toFixed(2),k.posVal.innerHTML=(1*k.posVal.innerHTML+1*b.store.data[a].positionValue).toFixed(4),k.cashVal.innerHTML=(1*k.assets.innerHTML-1*k.posVal.innerHTML).toFixed(4),k.posWght.innerHTML=(100*(k.posVal.innerHTML/k.assets.innerHTML)).toFixed(2),k.cashWght.innerHTML=(100*(k.cashVal.innerHTML/k.assets.innerHTML)).toFixed(2),b.store.data[a].amount=r.format(b.store.data[a].amount,
{pattern:"#,##0"}),b.store.data[a].positionValue=r.format(b.store.data[a].positionValue,{pattern:"#,##0.0000"}),z.put({id:"check",name:1})):((new c).showDialog("\u8d85\u51fa\u6b63\u5e38\u6bd4\u4f8b\uff01"),f.value=t):f.value=t};f.onblur=function(){k.posVal.innerHTML=1*k.posVal.innerHTML-r.parse(b.store.data[a].positionValue);b.store.data[a].amount=Math.round(f.value/100*k.assets.innerHTML/b.store.data[a].dirtyPrice_N/k.minVal.value)*k.minVal.value;b.store.data[a].positionValue=(b.store.data[a].amount*
b.store.data[a].dirtyPrice_N).toFixed(4);b.store.data[a].positionWeight=(100*(b.store.data[a].positionValue/k.assets.innerHTML)).toFixed(2);k.posVal.innerHTML=(1*k.posVal.innerHTML+1*b.store.data[a].positionValue).toFixed(4);k.cashVal.innerHTML=(1*k.assets.innerHTML-1*k.posVal.innerHTML).toFixed(4);k.posWght.innerHTML=(100*(k.posVal.innerHTML/k.assets.innerHTML)).toFixed(2);k.cashWght.innerHTML=(100*(k.cashVal.innerHTML/k.assets.innerHTML)).toFixed(2);b.store.data[a].amount=r.format(b.store.data[a].amount,
{pattern:"#,##0"});b.store.data[a].positionValue=r.format(b.store.data[a].positionValue,{pattern:"#,##0.0000"});z.put({id:"check",name:1});b.refresh(b.store.data)}},deleteBond:function(q,c){if(this.type_amount.checked){if(c<b.store.data.length-1){var d=r.parse(b.store.data[c].positionValue);b.store.data.splice(c,1);this.posVal.innerHTML=(1*this.posVal.innerHTML-d).toFixed(4);this.assets.innerHTML=(1*this.posVal.innerHTML+1*this.cashVal.innerHTML).toFixed(4);this.posWght.innerHTML=(100*(this.posVal.innerHTML/
this.assets.innerHTML)).toFixed(2);this.cashWght.innerHTML=(100*(this.cashVal.innerHTML/this.assets.innerHTML)).toFixed(2);for(d=0;d<b.store.data.length;d++)b.store.data[d].positionWeight=(100*(r.parse(b.store.data[d].positionValue)/this.assets.innerHTML)).toFixed(2);this.gridShowRefresh()}}else if(this.type_weight.checked)this.posVal.innerHTML=(1*this.posVal.innerHTML-r.parse(b.store.data[c].positionValue)).toFixed(4),this.cashVal.innerHTML=(1*this.assets.innerHTML-1*this.posVal.innerHTML).toFixed(4),
this.posWght.innerHTML=(100*(this.posVal.innerHTML/this.assets.innerHTML)).toFixed(2),this.cashWght.innerHTML=(100*(this.cashVal.innerHTML/this.assets.innerHTML)).toFixed(2),b.store.data.splice(c,1),b.refresh(b.store.data);else{dijit.byId("sale_Bond").set("value",b.store.data[c].bondCode);x=b.store.data[c].fullCode;ba=r.parse(b.store.data[c].amount);for(d=0;d<bondList.length;d++)if(bondList[d].code==x){Y=bondList[d].redate;T=bondList[d].reprice;B=bondList[d].type;break}D=b.store.data[c].netPrice;
L=b.store.data[c].rate;a=1*b.store.data[c].dirtyPrice_N;H=1*b.store.data[c].dirtyPrice_N;N=b.store.data[c].yield;I=b.store.data[c].dateSource;this.sale_Amt.set("value",r.parse(b.store.data[c].amount));this.sale_Net.set("value",b.store.data[c].netPrice);this.sale_Dirty.set("value",b.store.data[c].dirtyPrice);this.sale_Yield.set("value",b.store.data[c].yield);this.sale_Rate.innerHTML=b.store.data[c].rate;this.sale_Value.innerHTML=b.store.data[c].positionValue;this.myDialogSale.show();this.selectBuySale(0)}},
inputCheck:function(b){return!isNaN(b.value)&&0<=1*b.value&&null!=b.value&&"\u8bf7\u8f93\u5165\u503a\u5238"!=b.getAttribute("targetobj")?1:0},setKeyBoardSpirit:function(a,m){var ca=this,f="keyboardS_"+a,k="dataCode_"+a,t=dijit.byId(k);t&&t.destroy();t=d.toDom('<div id="'+k+'"></div>');d.place(t,f);bondCustomKeyboardSpirit.keyboardValue=selDate.slice(0,8);(new G({style:"width:100%",value:m,onChange:function(){if(this.item&&this.item.bondName)C.byId(k).innerText=this.item.code.slice(2,this.item.code.length-
5);if(null!=this.item){for(var f=0,t=0;t<b.store.data.length;t++)if(b.store.data[t].fullCode==this.item.code){f=1;break}0==f?ca.keyBoardChange(this.item,a):((new c).showDialog("\u8be5\u503a\u5238\u5df2\u5b58\u5728\u4e8e\u7ec4\u5408\u4e2d\uff01"),dijit.byId(k).set("value",dijit.byId(k)._resetValue))}},onBlur:function(){dijit.byId(k).set("value",b.store.data[a].bondCode)}},k)).startup()},gridShow:function(a,c,d){var f=this,a={gbpmId:a,positionDate:c,userType:X,holdType:d,cacheDate:M.date2str(new Date,
"yyyyMMddHHmmss")};(new W({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getGroupById.dzh?"+V.objectToQuery(a)),response_times:1,response_mode:0}).then(function(a){for(var c=[],q=[],d={positionValue:0,positionWeight:0},m={positionValue:0,positionWeight:0},ca=1,e=0;e<a.length;e++)if("000000"==a[e].bondCode)d=a[e];else if("mktVal"==a[e].bondCode)m=a[e];else{var J={};J.numId=ca;J.bondName=a[e].bondName;
J.amount=r.format(a[e].amount,{pattern:"#,##0"});J.bondCode=a[e].bondCode.slice(2,a[e].bondCode.length-5);J.fullCode=a[e].bondCode;J.positionWeight=(100*a[e].positionWeight).toFixed(2);J.netPrice=(1*a[e].netPrice).toFixed(4);J.costPrice=(1*a[e].costPrice).toFixed(4);J.costPrice_N=1*a[e].costPrice;J.dirtyPrice=(1*a[e].dirtyPrice).toFixed(4);J.dirtyPrice_N=1*a[e].dirtyPrice;J.rate=(1*a[e].rate).toFixed(4);J.yield=(1*a[e].yield).toFixed(4);J.positionValue=r.format(a[e].positionValue,{pattern:"#,##0.0000"});
switch(a[e].dateSource){case "3":J.dateSource="\u5386\u53f2\u6210\u4ea4";break;case "2":J.dateSource="\u4e2d\u503a\u4f30\u503c";break;case "1":J.dateSource="\u5b9e\u65f6\u6210\u4ea4";break;default:J.dateSource=""}c.push(J);ca+=1}q.push(d);q.push(m);f.type_amount.checked&&c.push({numId:c.length+1,bondName:"",amount:0,bondCode:"",fullCode:"",netPrice:0,costPrice:0,costPrice_N:0,dirtyPrice:0,dirtyPrice_N:0,rate:0,yield:0,positionValue:0,positionWeight:0,dateSource:""});b.store.data=c;b.refresh(c);f.posVal.innerHTML=
(1*q[1].positionValue).toFixed(4);f.posWght.innerHTML=(100*q[1].positionWeight).toFixed(2);f.assets.innerHTML=(1*q[0].positionValue+1*q[1].positionValue).toFixed(4);f.cashWght.innerHTML=(100*q[0].positionWeight).toFixed(2);f.cashVal.innerHTML=(1*q[0].positionValue).toFixed(4);z.put({id:"check",name:0});if(f.type_amount.checked)for(a=0;a<b.store.data.length;a++)f.setKeyBoardSpirit(a,b.store.data[a].bondCode)})},gridShowRefresh:function(){b.refresh(b.store.data);if(this.type_amount.checked)for(var a=
0;a<b.store.data.length;a++)this.setKeyBoardSpirit(a,b.store.data[a].bondCode)},dijitEvent:function(){var a=this,e=a.buyBtn,ca=a.saleBtn,f=a.avgBtn,k=0,t=a.saveBtn,j=a.resetBtn,fa=a.type_BS,ga=a.type_amount,o=a.type_weight,w=a.btn_BS,u=a.btn_weight,n=a.cashAmt,h=a.inAmt,Z=a.outAmt,I=a.myDialogCash,g=a.cashFormBtn,p=a.cashFormBtn2,z=a.myDialogBuy,l=a.myDialogSale,v=a.buyFormBtn,y=a.buyFormBtn2,E=a.buy_Bond_Keyboard,X=a.buy_Amt,D=a.buy_Net,A=a.buy_Dirty,K=a.buy_Yield,S=a.saleFormBtn,U=a.saleFormBtn2,
O=a.sale_Bond_Keyboard,Q=a.sale_Amt,R=a.sale_Net,L=a.sale_Dirty,N=a.sale_Yield,P=a.myDialogAvg,F=a.avg_value,aa=a.avg_wght,V=a.avgFormBtn,W=a.avgFormBtn2;a.cashBtn.on("click",function(){-1!=s&&null!=s&&""!=s&&(n.set("value",a.cashVal.innerHTML),h.set("value",""),Z.set("value",""),I.show())});g.on("click",function(){if(!isNaN(n.value)&&0<=n.value&&""!=n.value&&null!=n.value){I.isValid();I.hide();a.cashVal.innerHTML=(1*n.get("value")).toFixed(4);a.assets.innerHTML=(1*a.cashVal.innerHTML+1*a.posVal.innerHTML).toFixed(4);
a.cashWght.innerHTML=(100*(a.cashVal.innerHTML/a.assets.innerHTML)).toFixed(2);a.posWght.innerHTML=(100*(a.posVal.innerHTML/a.assets.innerHTML)).toFixed(2);for(var c=0;c<b.store.data.length;c++)b.store.data[c].positionWeight=(100*(r.parse(b.store.data[c].positionValue)/a.assets.innerHTML)).toFixed(2);a.gridShowRefresh()}});p.on("click",function(){I.hide()});n.on("keyPress",function(){k=n.value});n.on("keyUp",function(){!isNaN(h.value)&&0<=1*n.value&&null!=n.value?1*n.value>=1*a.cashVal.innerHTML?
(h.set("value",1*n.value-1*a.cashVal.innerHTML),Z.set("value","")):(Z.set("value",1*a.cashVal.innerHTML-1*n.value),h.set("value","")):n.set("value",k)});h.on("keyPress",function(){k=h.value});h.on("keyUp",function(){!isNaN(h.value)&&0<=1*h.value&&1*Z.value<=1*a.cashVal.innerHTML+1*h.value&&null!=h.value?n.set("value",1*a.cashVal.innerHTML+1*h.value-1*Z.value):h.set("value",k)});Z.on("keyPress",function(){k=Z.value});Z.on("keyUp",function(){!isNaN(Z.value)&&0<=1*Z.value&&1*Z.value<=1*a.cashVal.innerHTML+
1*h.value&&null!=Z.value?n.set("value",1*a.cashVal.innerHTML+1*h.value-1*Z.value):Z.set("value",k)});e.on("click",function(){if(-1!=s&&null!=s&&""!=s)0<1*a.cashVal.innerHTML?(x="",dijit.byId("buy_Bond").set("value",""),a.buy_Value.innerHTML=0,X.set("value",""),D.set("value",""),A.set("value",""),H=0,K.set("value",""),a.buy_Rate.innerHTML="",z.show(),a.selectBuySale(1)):(new c).showDialog("\u73b0\u91d1\u4e0d\u8db3")});X.on("change",function(){if(!isNaN(A.get("value")*X.get("value")))a.buy_Value.innerHTML=
(H*X.get("value")).toFixed(4)});D.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,B,0,D.get("value"),1)});D.on("blur",function(){a.bondPriceInfo(x,B,0,D.get("value"),1)});A.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,B,1,A.get("value"),1)});A.on("blur",function(){a.bondPriceInfo(x,B,1,A.get("value"),1)});A.on("change",function(){if(!isNaN(A.get("value")*X.get("value")))a.buy_Value.innerHTML=(H*X.get("value")).toFixed(4)});K.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,
B,2,K.get("value")/100,1)});K.on("blur",function(){a.bondPriceInfo(x,B,2,K.get("value")/100,1)});v.on("click",function(){""!=x&&(1*a.buy_Value.innerHTML<1*a.cashVal.innerHTML?(z.isValid(),z.hide(),a.buyOp()):(new c).showDialog("\u4e70\u5165\u91d1\u989d\u4e0d\u80fd\u5927\u4e8e\u6301\u6709\u73b0\u91d1"))});y.on("click",function(){z.hide()});(e=dijit.byId("buy_Bond"))&&e.destroy();e=d.toDom('<div id="buy_Bond"></div>');d.place(e,E);(new G({style:"width:100%",onChange:function(){if(this.item&&this.item.code)C.byId("buy_Bond").value=
this.item.code.slice(2,this.item.code.length-5);if(null!=this.item)x=this.item.code,ea=this.item.name,B=this.item.type,Y=this.item.redate,T=this.item.reprice,a.bondPriceInfo(this.item.code,4,0,0,1)},onBlur:function(){C.byId("buy_Bond").value=x.slice(2,x.length-5)}},"buy_Bond")).startup();ca.on("click",function(){if(-1!=s&&null!=s&&""!=s)0!=b.store.data.length?(x="",dijit.byId("sale_Bond").set("value",""),a.sale_Value.innerHTML=0,Q.set("value",""),R.set("value",""),L.set("value",""),H=0,N.set("value",
""),a.sale_Rate.innerHTML="",l.show(),a.selectBuySale(0)):(new c).showDialog("\u7ec4\u5408\u4e2d\u6ca1\u6709\u503a\u5238")});Q.on("change",function(){if(!isNaN(L.get("value")*Q.get("value")))a.sale_Value.innerHTML=(H*Q.get("value")).toFixed(4)});R.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,B,0,R.get("value"),0)});R.on("blur",function(){a.bondPriceInfo(x,B,0,R.get("value"),0)});L.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,B,1,L.get("value"),0)});L.on("blur",function(){a.bondPriceInfo(x,
B,1,L.get("value"),0)});L.on("change",function(){if(!isNaN(L.get("value")*Q.get("value")))a.sale_Value.innerHTML=(H*Q.get("value")).toFixed(4)});N.on("keyPress",function(b){13==b.keyCode&&a.bondPriceInfo(x,B,2,N.get("value")/100,0)});N.on("blur",function(){a.bondPriceInfo(x,B,2,N.get("value")/100,0)});S.on("click",function(){""!=x&&(1*ba>=1*Q.get("value")?(l.isValid(),l.hide(),a.saleOp()):(new c).showDialog("\u5356\u51fa\u6570\u91cf\u4e0d\u80fd\u5927\u4e8e\u6301\u6709\u6570\u91cf"))});U.on("click",
function(){l.hide()});(ca=dijit.byId("sale_Bond"))&&ca.destroy();ca=d.toDom('<div id="sale_Bond"></div>');d.place(ca,O);(new G({style:"width:100%",onChange:function(){if(this.item&&this.item.code)C.byId("sale_Bond").value=this.item.code.slice(2,this.item.code.length-5);if(null!=this.item){for(var g=0,f=0;f<b.store.data.length;f++)if(b.store.data[f].fullCode==this.item.code){ba=r.parse(b.store.data[f].amount);x=this.item.code;ea=this.item.name;B=this.item.type;Y=this.item.redate;T=this.item.reprice;
g=1;break}1==g?a.bondPriceInfo(this.item.code,4,0,0,0):(new c).showDialog("\u7ec4\u5408\u4e2d\u6ca1\u6709\u8be5\u503a\u5238\uff01")}},onBlur:function(){C.byId("sale_Bond").value=x.slice(2,x.length-5)}},"sale_Bond")).startup();f.on("click",function(){-1!=s&&null!=s&&""!=s&&0<1*a.assets.innerHTML&&P.show()});var da=1*F.value;F.on("keyDown",function(){da=1*F.value});F.on("keyUp",function(){!isNaN(F.value)&&0<=1*F.value&&null!=F.value?""==F.value?(aa.set("value",0),F.set("value",0)):1*F.value<=1*a.assets.innerHTML?
aa.set("value",(100*(F.get("value")/a.assets.innerHTML)).toFixed(2)):((new c).showDialog("\u8d85\u51fa\u603b\u8d44\u4ea7"),F.set("value",da)):F.set("value",da)});var ha=1*aa.value;aa.on("keyDown",function(){ha=1*aa.value});aa.on("keyUp",function(){!isNaN(aa.value)&&0<=1*aa.value&&null!=aa.value?""==aa.value?(aa.set("value",0),F.set("value",0)):100>=aa.value?F.set("value",(a.assets.innerHTML*aa.value/100).toFixed(4)):((new c).showDialog("\u8d85\u51fa\u6b63\u5e38\u6bd4\u4f8b"),aa.set("value",ha)):aa.set("value",
ha)});V.on("click",function(){100>=1*aa.get("value")&&0<=1*aa.get("value")?(P.isValid(),P.hide(),a.avgAdjust()):(new c).showDialog("\u8d85\u51fa\u6b63\u5e38\u6bd4\u4f8b")});W.on("click",function(){P.hide()});t.on("click",function(){-1!=s&&null!=s&&""!=s&&a.submitRes()});j.on("click",function(){-1!=s&&null!=s&&""!=s&&a.gridShow(s,selDate,holdType)});fa.on("click",function(){w.hidden=!1;u.hidden=!0;a.minDiv.hidden=!0;a.gridInit(0)});ga.on("click",function(){w.hidden=!0;u.hidden=!0;a.minDiv.hidden=!0;
a.gridInit(1)});o.on("click",function(){w.hidden=!0;u.hidden=!1;a.minDiv.hidden=!1;a.gridInit(2)});var ia=this.posDate;ia.on("change",function(){if(m){var b=M.date2str(a.posDate.get("value"),"yyyyMMdd000000"),g=M.date2str(new Date,"yyyyMMdd000000");1*b<=1*g?a.getDate(M.date2str(a.posDate.get("value"),"yyyyMMdd000000"),tradeType):(b=M.str2date(selDate),(new c).showDialog("\u4e0d\u53ef\u5927\u4e8e\u5f53\u524d\u65e5\u671f"),ia.set("value",b))}})},buyOp:function(){var c,d=1*this.posVal.innerHTML,e=0;
c=1*this.cashVal.innerHTML-this.buy_Dirty.get("value")*this.buy_Amt.get("value");for(var f=0;f<b.store.data.length;f++)if(b.store.data[f].fullCode==x){e=r.parse(b.store.data[f].amount);d-=r.parse(b.store.data[f].positionValue);b.store.data[f].costPrice_N=(b.store.data[f].costPrice_N*e+this.buy_Dirty.get("value")*this.buy_Amt.get("value"))/(e+1*this.buy_Amt.get("value"));b.store.data[f].costPrice=b.store.data[f].costPrice_N.toFixed(4);b.store.data[f].amount=e+1*this.buy_Amt.get("value");b.store.data[f].positionValue=
b.store.data[f].amount*b.store.data[f].dirtyPrice_N;d+=b.store.data[f].positionValue;b.store.data[f].amount=r.format(b.store.data[f].amount,{pattern:"#,##0"});b.store.data[f].positionValue=r.format(b.store.data[f].positionValue,{pattern:"#,##0.0000"});e=1;break}if(0==e){f={};f.numId=b.store.data.length+1;f.bondName=ea;f.amount=this.buy_Amt.get("value");f.bondCode=x.slice(2,x.length-5);f.fullCode=x;f.netPrice=D;f.costPrice=this.buy_Dirty.get("value");f.costPrice_N=this.buy_Dirty.get("value");f.dirtyPrice=
a.toFixed(4);f.dirtyPrice_N=1*a;f.rate=L;f.yield=N;f.positionValue=f.amount*f.dirtyPrice_N;d+=f.positionValue;f.amount=r.format(this.buy_Amt.get("value"),{pattern:"#,##0"});f.positionValue=r.format(f.positionValue,{pattern:"#,##0.0000"});switch(I){case "3":f.dateSource="\u5386\u53f2\u6210\u4ea4";break;case "2":f.dateSource="\u4e2d\u503a\u4f30\u503c";break;case "1":f.dateSource="\u5b9e\u65f6\u6210\u4ea4";break;default:f.dateSource=""}b.store.data.push(f)}this.cashVal.innerHTML=c.toFixed(4);this.posVal.innerHTML=
d.toFixed(4);this.assets.innerHTML=(c+d).toFixed(4);this.posWght.innerHTML=(100*(d/(c+d))).toFixed(2);this.cashWght.innerHTML=(100*(c/(c+d))).toFixed(2);for(f=0;f<b.store.data.length;f++)b.store.data[f].positionWeight=(100*(r.parse(b.store.data[f].positionValue)/(c+d))).toFixed(2);b.refresh(b.store.data);z.put({id:"check",name:1})},saleOp:function(){var a,c;a=1*this.cashVal.innerHTML+this.sale_Dirty.get("value")*this.sale_Amt.get("value");if(1*ba==1*this.sale_Amt.get("value"))for(var d=0;d<b.store.data.length;d++){if(b.store.data[d].fullCode==
x){c=1*this.posVal.innerHTML-r.parse(b.store.data[d].positionValue);b.store.data.splice(d,1);break}}else for(d=0;d<b.store.data.length;d++)if(b.store.data[d].fullCode==x){var f=r.parse(b.store.data[d].amount);c=1*this.posVal.innerHTML-r.parse(b.store.data[d].positionValue);b.store.data[d].costPrice_N=(b.store.data[d].costPrice_N*f-this.sale_Dirty.get("value")*this.sale_Amt.get("value"))/(f-1*this.sale_Amt.get("value"));b.store.data[d].costPrice=b.store.data[d].costPrice_N.toFixed(4);b.store.data[d].amount=
f-1*this.sale_Amt.get("value");b.store.data[d].positionValue=b.store.data[d].amount*b.store.data[d].dirtyPrice_N;c+=b.store.data[d].positionValue;b.store.data[d].amount=r.format(b.store.data[d].amount,{pattern:"#,##0"});b.store.data[d].positionValue=r.format(b.store.data[d].positionValue,{pattern:"#,##0.0000"});break}this.cashVal.innerHTML=a.toFixed(4);this.posVal.innerHTML=c.toFixed(4);this.assets.innerHTML=(a+c).toFixed(4);this.posWght.innerHTML=(100*(c/(a+c))).toFixed(2);this.cashWght.innerHTML=
(100*(a/(a+c))).toFixed(2);for(d=0;d<b.store.data.length;d++)b.store.data[d].positionWeight=(100*(r.parse(b.store.data[d].positionValue)/(a+c))).toFixed(2);b.refresh(b.store.data);z.put({id:"check",name:1})},selectBuySale:function(a){1==a?this.buy_Date.innerHTML=M.date2str(this.posDate.get("value"),"yyyy-MM-dd"):this.sale_Date.innerHTML=M.date2str(this.posDate.get("value"),"yyyy-MM-dd");bondCustomKeyboardSpirit.keyboardValue=selDate.slice(0,8)},bondPriceInfo:function(b,c,d,f,e){var t=this;if(".bond"==
b.slice(-5)){var m=new O;4==c?t.getBondFullPrice(b).then(function(b){var c=b[0].result.datas;1==e?(t.buy_Net.set("value",(1*c[0][1]).toFixed(4)),t.buy_Rate.innerHTML=(1*c[0][2]).toFixed(4),t.buy_Dirty.set("value",(1*c[0][3]).toFixed(4)),t.buy_Yield.set("value",(1*c[0][4]).toFixed(4))):(t.sale_Net.set("value",(1*c[0][1]).toFixed(4)),t.sale_Rate.innerHTML=(1*c[0][2]).toFixed(4),t.sale_Dirty.set("value",(1*c[0][3]).toFixed(4)),t.sale_Yield.set("value",(1*c[0][4]).toFixed(4)));D=(1*c[0][1]).toFixed(4);
L=(1*c[0][2]).toFixed(4);a=1*c[0][3];H=1*b[0].result.datas[0][3];N=(1*c[0][4]).toFixed(4);I=c[0][7]}):(b={bondCode:b,bondType:c,date:selDate.slice(0,8),price:f,pType:d,exePrice:T,exeDate:Y.slice(0,8)},m.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getSingleBondPrice.dzh?"+V.objectToQuery(b)),response_times:1,response_mode:0}).then(function(a){1==e?(t.buy_Net.set("value",(1*a[0].result.datas[0][1]).toFixed(4)),
t.buy_Rate.innerHTML=(1*a[0].result.datas[0][2]).toFixed(4),t.buy_Dirty.set("value",(1*a[0].result.datas[0][3]).toFixed(4)),t.buy_Yield.set("value",(100*a[0].result.datas[0][4]).toFixed(4))):(t.sale_Net.set("value",(1*a[0].result.datas[0][1]).toFixed(4)),t.sale_Rate.innerHTML=(1*a[0].result.datas[0][2]).toFixed(4),t.sale_Dirty.set("value",(1*a[0].result.datas[0][3]).toFixed(4)),t.sale_Yield.set("value",(100*a[0].result.datas[0][4]).toFixed(4)));H=1*a[0].result.datas[0][3]}))}},keyBoardChange:function(a,
c){var d=this;".bond"==a.code.slice(-5)&&d.getBondFullPrice(a.code).then(function(f){f=f[0].result.datas;d.assets.innerHTML=(1*d.assets.innerHTML-r.parse(b.store.data[c].positionValue)).toFixed(4);b.store.data[c].bondCode=a.code.slice(2,a.code.length-5);b.store.data[c].fullCode=a.code;b.store.data[c].bondName=a.name;b.store.data[c].amount=0;b.store.data[c].costPrice=(1*f[0][3]).toFixed(4);b.store.data[c].costPrice_N=1*f[0][3];b.store.data[c].netPrice=(1*f[0][1]).toFixed(4);b.store.data[c].dirtyPrice=
(1*f[0][3]).toFixed(4);b.store.data[c].dirtyPrice_N=1*f[0][3];b.store.data[c].rate=(1*f[0][2]).toFixed(4);b.store.data[c].yield=(1*f[0][4]).toFixed(4);switch(f[0][7]){case "3":b.store.data[c].dateSource="\u5386\u53f2\u6210\u4ea4";break;case "2":b.store.data[c].dateSource="\u4e2d\u503a\u4f30\u503c";break;case "1":b.store.data[c].dateSource="\u5b9e\u65f6\u6210\u4ea4";break;default:b.store.data[c].dateSource=""}for(f=b.store.data[c].positionValue=0;f<b.store.data.length;f++)0<1*d.assets.innerHTML?b.store.data[c].positionWeight=
(100*(r.parse(b.store.data[c].positionValue)/d.assets.innerHTML)).toFixed(2):(b.store.data[c].positionWeight="0",d.assets.innerHTML=b.store.data[c].positionValue);c==b.store.data.length-1&&b.store.data.push({numId:b.store.data.length+1,bondName:"",amount:0,bondCode:"",fullCode:"",netPrice:0,costPrice:0,costPrice_N:0,dirtyPrice:0,dirtyPrice_N:0,rate:0,yield:0,positionValue:0,positionWeight:0,dateSource:""});b.refresh(b.store.data);d.posVal.innerHTML=(1*d.assets.innerHTML-1*d.cashVal.innerHTML).toFixed(4);
d.posWght.innerHTML=0<1*d.assets.innerHTML?(100*(d.posVal.innerHTML/d.assets.innerHTML)).toFixed(2):0;d.cashWght.innerHTML=0<1*d.assets.innerHTML?(100*(d.cashVal.innerHTML/d.assets.innerHTML)).toFixed(2):0;z.put({id:"check",name:1});for(f=0;f<b.store.data.length;f++)d.setKeyBoardSpirit(f,b.store.data[f].bondCode)})},getBondFullPrice:function(a){return(new O).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getBondSOBaseInfo.dzh?"+
V.objectToQuery({bondCode:a,stdate:selDate,userType:X,holdType:holdType})),response_times:1,response_mode:0})},avgAdjust:function(){for(var a=this.avg_wght.get("value")/b.store.data.length,c=0,d=0;d<b.store.data.length;d++)b.store.data[d].amount=Math.round(a/100*this.assets.innerHTML/b.store.data[d].dirtyPrice_N/this.minVal.value)*this.minVal.value,b.store.data[d].positionValue=b.store.data[d].amount*b.store.data[d].dirtyPrice_N,b.store.data[d].positionWeight=(100*(b.store.data[d].positionValue/this.assets.innerHTML)).toFixed(2),
c+=b.store.data[d].amount*b.store.data[d].dirtyPrice_N,b.store.data[d].amount=r.format(b.store.data[d].amount,{pattern:"#,##0"}),b.store.data[d].positionValue=r.format(b.store.data[d].positionValue,{pattern:"#,##0.0000"});b.refresh(b.store.data);this.posVal.innerHTML=c.toFixed(4);this.posWght.innerHTML=(100*(c/this.assets.innerHTML)).toFixed(2);this.cashVal.innerHTML=(1*this.assets.innerHTML-c).toFixed(4);this.cashWght.innerHTML=(100*(this.cashVal.innerHTML/this.assets.innerHTML)).toFixed(2);z.put({id:"check",
name:1})},getDate:function(a,b){var d=this,f={date:a,type:b};(new O).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getTradeDate.dzh?"+V.objectToQuery(f)),response_times:1,response_mode:0}).then(function(b){b=b[0].result.datas[0][0];if(b==a)selDate=M.date2str(d.posDate.get("value"),"yyyyMMdd000000");else{var f=M.str2date(b);(new c).showDialog("\u6240\u9009\u8c03\u4ed3\u65e5\u671f\u4e0d\u6b63\u786e\uff0c\u5c06\u8c03\u6574\u4e3a\u6700\u8fd1\u4e00\u4e2a\u6b63\u786e\u65e5\u671f");
m=!1;d.posDate.set("value",f);m=!0;selDate=b}d.gridShow(s,selDate,holdType)})},submitRes:function(){for(var a=new O,c="",d="",f="",e="",t=0;t<b.store.data.length;t++)""!=b.store.data[t].fullCode&&null!=b.store.data[t].fullCode&&0<r.parse(b.store.data[t].amount)&&(c=c+b.store.data[t].fullCode+",",d=d+r.parse(b.store.data[t].amount)+",",f=f+b.store.data[t].netPrice+",",e=e+b.store.data[t].costPrice_N+",");d+=this.cashVal.innerHTML;a.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",
paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/changeGroup.dzh?"+V.objectToQuery({gbpmId:s,bondCodes:c+"000000",amounts:d,netPrices:f+"0",costPrices:e+"1",positionDate:selDate,changeType:1})),response_times:1,response_mode:0});z.put({id:"check",name:0})},getKBSpiritStore:function(){("undefined"==typeof bondList||0==bondList.length)&&(new W).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+
"/groupManager/getBondInfo"),response_times:1,response_mode:0}).then(function(a){bondList=a})}})})},"url:bond/bondPortfolio/view/bondGrp_adjust.html":'<div data-dojo-attach-point="containerNode" >\r\n<div class="vbox" style="height:100%">\r\n<div class="build_list" style="height:80px;">\r\n    <table cellpadding="0" cellspacing="0" class="table_01">\r\n        <tr>\r\n            <td>\u7ec4\u5408</td>\r\n            <td>\r\n                <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="groupNameSel" class="width_ctrl3">\r\n                </div>\r\n            </td>\r\n            <td>\u8c03\u4ed3\u65e5\u671f</td>\r\n            <td>\r\n                <input type="text" data-dojo-attach-point="posDate" value="2013-06-26" class="width_ctrl3"\r\n                       data-dojo-type="dijit/form/DateTextBox" required="true" />\r\n            </td>\r\n            <td>\r\n                <input data-dojo-type="dijit/form/RadioButton" data-dojo-attach-point="type_BS" data-dojo-props="checked:true"/>\r\n                <span>\u4e70\u5356\u8c03\u4ed3</span>\r\n            </td>\r\n            <td>\r\n                <input data-dojo-type="dijit/form/RadioButton" data-dojo-attach-point="type_amount"/>\r\n                <span>\u6570\u91cf\u8c03\u4ed3</span>\r\n            </td>\r\n            <td>\r\n                <input data-dojo-type="dijit/form/RadioButton" data-dojo-attach-point="type_weight"/>\r\n                <span>\u6743\u91cd\u8c03\u4ed3</span>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n\r\n    <table style="margin-top:5px;">\r\n        <tr class="width_ctrl_all">\r\n            <td style="width:10%;padding-left:70%">\r\n                <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="cashBtn" type="button">\r\n                    \u73b0\u91d1\u8c03\u6574\r\n                </button>\r\n            </td>\r\n            <td colspan="4" style="width:18%;padding-left:1%">\r\n                <div data-dojo-attach-point="btn_BS">\r\n                    <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="buyBtn" type="button">\r\n                        \u4e70\u5165\r\n                    </button>\r\n                    <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saleBtn" type="button">\r\n                        \u5356\u51fa\r\n                    </button>\r\n                </div>\r\n                <\!--<div data-dojo-attach-point="btn_amount">--\>\r\n                <\!--<button data-dojo-type="dijit/form/Button" data-dojo-attach-point="addBtn" type="button">--\>\r\n                <\!--\u65b0\u589e--\>\r\n                <\!--</button>--\>\r\n                <\!--</div>--\>\r\n                <div data-dojo-attach-point="btn_weight">\r\n                    <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="avgBtn" type="button">\r\n                        \u4e00\u952e\u5e73\u5747\u6301\u4ed3\r\n                    </button>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n\r\n    <table style="height:25px; width:95%; margin-top:5px;margin-left:5px;">\r\n        <tr style="width:100%;">\r\n            <td class="local_td01">\u603b\u8d44\u4ea7\uff1a</td>\r\n            <td data-dojo-attach-point="assets" class="local_td02">0.0000</td>\r\n            <td class="local_td01">\u6301\u4ed3\u603b\u5e02\u503c\uff1a</td>\r\n            <td data-dojo-attach-point="posVal" class="local_td02">0.0000</td>\r\n            <td class="local_td01">\u6301\u4ed3\u603b\u6743\u91cd(%)\uff1a</td>\r\n            <td data-dojo-attach-point="posWght" class="local_td02">0</td>\r\n            <td class="local_td01">\u73b0\u91d1\uff1a</td>\r\n            <td data-dojo-attach-point="cashVal" class="local_td02">0</td>\r\n            <td class="local_td01">\u73b0\u91d1\u6743\u91cd(%)\uff1a</td>\r\n            <td data-dojo-attach-point="cashWght" class="local_td02">0</td>\r\n            <td style="width:20%;">\r\n                <div data-dojo-attach-point="minDiv">\r\n                    <span style="width:60%;">\u6301\u4ed3\u6570\u91cf\u6700\u5c0f\uff1a</span>\r\n                    <div data-dojo-attach-point="minVal" data-dojo-type="dijit/form/ComboBox" style="width:40%">\r\n                        <option value="1">1</option>\r\n                        <option value="10">10</option>\r\n                        <option value="100">100</option>\r\n                    </div>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n\r\n\r\n    <\!--\u4e70\u5165\u64cd\u4f5c--\>\r\n    <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="myDialogBuy" style="text-align:center;width:30%"  title="\u4e70\u5165">\r\n        <div class="dijitDialogPaneContentArea">\r\n            <table cellspacing="0" cellpadding="0" class="local_table_03">\r\n                <tr>\r\n                    <td>\u4ea4\u6613\u65e5\u671f</td>\r\n                    <td><span data-dojo-attach-point="buy_Date"></span></td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u503a\u5238\u4ee3\u7801\u6216\u7b80\u79f0</td>\r\n                    <td>\r\n                        <div data-dojo-attach-point="buy_Bond_Keyboard" style="width: 100%">\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u4e70\u5165\u51c0\u4ef7</td>\r\n                    <td><input data-dojo-attach-point="buy_Net" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" /></td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5e94\u8ba1\u5229\u606f</td>\r\n                    <td>\r\n                        <span data-dojo-attach-point="buy_Rate" ></span>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u4e70\u5165\u5168\u4ef7</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="buy_Dirty" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5230\u671f\u6536\u76ca\u7387</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="buy_Yield" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u4e70\u5165\u5f20\u6570(\u5f20)</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="buy_Amt" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u4ea4\u6613\u91d1\u989d(\u5143)</td>\r\n                    <td>\r\n                        <span data-dojo-attach-point="buy_Value" >0</span>\r\n                    </td>\r\n                </tr>\r\n\r\n            </table>\r\n        </div>\r\n        <div class="dijitDialogPaneActionBar">\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="buyFormBtn" type="button">\r\n                \u63d0\u4ea4\r\n            </button>\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="buyFormBtn2" type="button">\r\n                \u53d6\u6d88\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <\!--\u5356\u51fa\u64cd\u4f5c--\>\r\n    <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="myDialogSale" style="text-align:center;width:30%"  title="\u5356\u51fa">\r\n        <div class="dijitDialogPaneContentArea">\r\n            <table cellspacing="0" cellpadding="0" class="local_table_03">\r\n                <tr>\r\n                    <td>\u4ea4\u6613\u65e5\u671f</td>\r\n                    <td><span data-dojo-attach-point="sale_Date"></span></td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u503a\u5238\u4ee3\u7801\u6216\u7b80\u79f0</td>\r\n                    <td>\r\n                        <div data-dojo-attach-point="sale_Bond_Keyboard" style="width: 100%">\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5356\u51fa\u51c0\u4ef7</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="sale_Net" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5e94\u8ba1\u5229\u606f</td>\r\n                    <td>\r\n                        <span data-dojo-attach-point="sale_Rate" ></span>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5356\u51fa\u5168\u4ef7</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="sale_Dirty" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5230\u671f\u6536\u76ca\u7387</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="sale_Yield" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u5356\u51fa\u5f20\u6570(\u5f20)</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="sale_Amt" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u4ea4\u6613\u91d1\u989d(\u5143)</td>\r\n                    <td>\r\n                        <span data-dojo-attach-point="sale_Value" >0</span>\r\n                    </td>\r\n                </tr>\r\n\r\n            </table>\r\n        </div>\r\n        <div class="dijitDialogPaneActionBar">\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saleFormBtn" type="button">\r\n                \u63d0\u4ea4\r\n            </button>\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saleFormBtn2" type="button">\r\n                \u53d6\u6d88\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <\!--\u73b0\u91d1\u8c03\u6574--\>\r\n    <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="myDialogCash" style="text-align:center;width:20%"  title="\u73b0\u91d1\u8c03\u6574">\r\n        <div class="dijitDialogPaneContentArea">\r\n            <table cellspacing="0" cellpadding="0" class="local_table_03">\r\n                <tr>\r\n                    <td>\u8f6c\u5165</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="inAmt" data-dojo-type="dijit/form/TextBox"\r\n                               data-dojo-props="intermediateChanges:true" value="0" class="width_ctrl_all"/>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u8f6c\u51fa</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="outAmt" data-dojo-type="dijit/form/TextBox"\r\n                               data-dojo-props="intermediateChanges:true" value="0" class="width_ctrl_all"/>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u73b0\u91d1</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="cashAmt" data-dojo-type="dijit/form/TextBox"\r\n                               data-dojo-props="intermediateChanges:true" value="0" class="width_ctrl_all"/>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div class="dijitDialogPaneActionBar">\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="cashFormBtn" type="button">\r\n                \u63d0\u4ea4\r\n            </button>\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="cashFormBtn2" type="button">\r\n                \u53d6\u6d88\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <\!--\u4e00\u952e\u6301\u4ed3\u8c03\u6574--\>\r\n    <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="myDialogAvg" style="text-align:center:width:30%"  title="\u4e00\u952e\u6301\u4ed3\u8c03\u6574">\r\n        <div class="dijitDialogPaneContentArea">\r\n            <table cellspacing="0" cellpadding="0" class="local_table_03">\r\n                <tr>\r\n                    <td>\u6301\u4ed3\u603b\u5e02\u503c</td>\r\n                    <td><input data-dojo-attach-point="avg_value" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" /></td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\u6301\u4ed3\u603b\u6743\u91cd</td>\r\n                    <td>\r\n                        <input data-dojo-attach-point="avg_wght" class="width_ctrl_all" data-dojo-type="dijit/form/TextBox" data-dojo-props="intermediateChanges:true" value="0" />\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div class="dijitDialogPaneActionBar">\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="avgFormBtn" type="button">\r\n                \u63d0\u4ea4\r\n            </button>\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="avgFormBtn2" type="button">\r\n                \u53d6\u6d88\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n<div data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:100%">\r\n    <div class="vbox" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden;">\r\n        <div class="spacer" data-dojo-attach-point="mainArea"  data-dojo-type="dijit/layout/ContentPane">\r\n\r\n        </div>\r\n        <div id="operateDiv" style="text-align: center">\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveBtn" type="button" style="padding-top:5px;height:30px;">\r\n                \u4fdd\u5b58\u4fee\u6539\r\n            </button>\r\n            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="resetBtn" type="button" style="padding-top:5px;height:30px;">\r\n                \u64a4\u9500\u4fee\u6539\r\n            </button>\r\n            <\!--<button data-dojo-type="dijit/form/Button" data-dojo-attach-point="backBtn" type="button">--\>\r\n                <\!--\u5220\u9664\u4fee\u6539--\>\r\n            <\!--</button>--\>\r\n        </div>\r\n    </div>\r\n</div>\r\n</div>\r\n</div>\r\n',
"bond/bondPortfolio/view/_helper/MessageDialog":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/dom,dijit/registry,dojo/text!./MessageDialog.html".split(","),function(h,e,j,o,w,u,E,y){return h("bond.bondQuotation.view._helper.MessageDialog",[e,j,o,w],{templateString:y,postMixInProperties:function(){},postCreate:function(){},showDialog:function(e){this.tipInfo.innerHTML=e;this.dialogConfirm.show()}})})},
"url:bond/bondPortfolio/view/_helper/MessageDialog.html":'<div data-dojo-attach-point="containerNode" class="spacer">\r\n\t<div data-dojo-id="dialogConfirm" data-dojo-attach-point="dialogConfirm" data-dojo-type="dijit/Dialog"  data-dojo-props="title:\'\u63d0\u793a\u4fe1\u606f\'" style="display:none;width:450px;">\r\n\t\t<div class="vbox" style="height: 100px;">\r\n            <div style="height:  -webkit-calc(100% - 25px);overflow-y: auto; padding:2px 5px;">\r\n                <div data-dojo-attach-point="tipInfo" class="spacerx" style="text-align: left; line-height:20px;"></div>\r\n            </div>\r\n\r\n\t\t\t<div class="spacerx" style="text-align: center; line-height:10px;">\r\n\t\t\t\t<button data-dojo-type="dijit/form/Button" type="button" onclick="dialogConfirm.onCancel()">\u5173\u95ed</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>',
"bond/bondPortfolio/view/bondGrp_adjustHis":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./bondGrp_adjustHis.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dojox/store/GridWSStore,dijit/form/FilteringSelect,dojo/io-query,dojox/store/LocalStorage,bond/bondPortfolio/view/_helper/util,dojo/number".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G){var A,d=-1;return j("bond.bondPortfolio.view.bondGrp_adjustHis",[o,w,u,E],{templateString:S,postMixInProperties:function(){this.inherited(arguments);y.mixin(this,R)},postCreate:function(){var c=this,e=c.myGroupQuery,s=new W({}),j=new M({idProperty:"id",namespace:"bondPortfolio"});userId=j.get("userId").name;var m=dijit.byId("stateSelect");m&&m.destroy();var b=new O({id:"stateSelect",name:"state",value:"",store:[],searchAttr:"name"});b.placeAt(e);
s.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getAllGroup.dzh?"+P.objectToQuery({createPersonId:userId,cacheDate:new Date})),response_times:1,response_mode:0}).then(function(e){for(var m=[],s=0;s<e.length;s++){var r={};r.name=e[s].groupName;r.id=e[s].groupId;m.push(r)}e=new h({data:m});b.store=e;b.on("change",function(){if(null!=b.item){var e=C.date2str(c.stdateQuery.get("value"),"yyyyMMdd"),
m=C.date2str(c.sedateQuery.get("value"),"yyyyMMdd");d=dijit.byId("stateSelect").get("value");j.put({id:"groupId",name:d});c.handleQueryList(d,e,m)}else A.store.data=[],A.refresh(A.store.data),d=-1,j.put({id:"groupId",name:d})});c.gridInit();dataOpCheck=0;c.stdateQuery.set("value",c.getDicMonth(new Date,"3"));c.sedateQuery.set("value",C.date2str(new Date,"yyyy-MM-dd"));dataOpCheck=1;d=j.get("groupId").name;-1!=d&&null!=d&&""!=d&&(b.set("value",d),""==b.value&&(d=-1,j.put({id:"groupId",name:d})))})},
gridInit:function(){var c=this;options={forceFitColumns:!0,enableColumnReorder:!1,rowHeight:20};mstore=new h;A=new U({store:mstore,columns:[{id:"id",name:"\u8c03\u4ed3\u65e5\u671f",field:"changeDate",width:12,sortable:!0,headerCssClass:"font-center",cssClass:"font-center"},{id:"publicper",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:12,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"unitname",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",width:12,sortable:!0,headerCssClass:"font-center",
cssClass:"font-left"},{id:"dscode",name:"\u8c03\u6574\u524d\u6301\u4ed3",field:"previousPosition",width:10,headerCssClass:"font-center",cssClass:"font-right"},{id:"catecode",name:"\u8c03\u6574\u540e\u6301\u4ed3",field:"afterPosition",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"code",name:"\u6301\u4ed3\u6570\u91cf\u8c03\u6574",field:"amountChange",width:12,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"dsname",name:"\u8c03\u6574\u524d\u6210\u672c",
field:"previousCost",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"nest",name:"\u8c03\u6574\u540e\u6210\u672c",field:"afterCost",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"mony",name:"\u6210\u672c\u8c03\u6574",field:"costChange",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"dacm",name:"\u6301\u4ed3\u91d1\u989d\u8c03\u6574",field:"moneyChange",width:16,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},
{id:"wor",name:"\u8c03\u6574\u7c7b\u578b",field:"type",width:10,sortable:!1,headerCssClass:"font-center",cssClass:"font-left"}],options:options});A.placeAt("container");c.stdateQuery.on("change",function(){if(1==dataOpCheck){var d=C.date2str(c.stdateQuery.get("value"),"yyyyMMdd"),e=C.date2str(c.sedateQuery.get("value"),"yyyyMMdd");c.handleQueryList(dijit.byId("stateSelect").get("value"),d,e)}});c.sedateQuery.on("change",function(){if(1==dataOpCheck){var d=C.date2str(c.stdateQuery.get("value"),"yyyyMMdd"),
e=C.date2str(c.sedateQuery.get("value"),"yyyyMMdd");c.handleQueryList(dijit.byId("stateSelect").get("value"),d,e)}});c.saveAsExcel.on("click",function(){0<A.store.data.length&&c.saveData()})},handleQueryList:function(c,d,e){var j=this;(new W({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupManager/getPositionChange.dzh?"+P.objectToQuery({gbpmId:c,stdate:d,sedate:e,cacheDate:new Date})),response_times:1,
response_mode:0}).then(function(c){j.handleresultList(c);A.refresh(c)})},handleresultList:function(c){for(i=0;i<c.length;i++){var d=c[i].changeDate.substring(0,4)+"-"+c[i].changeDate.substring(4,6)+"-"+c[i].changeDate.substring(6,8);c[i].changeDate=d;c[i].bondCode=c[i].bondCode.slice(0,c[i].bondCode.length-5);c[i].moneyChange=G.format(1*c[i].moneyChange,{pattern:"#,##0.0000"});c[i].previousPosition=G.format(1*c[i].previousPosition,{pattern:"#,##0"});c[i].afterPosition=G.format(1*c[i].afterPosition,
{pattern:"#,##0"});c[i].amountChange=G.format(1*c[i].amountChange,{pattern:"#,##0"});c[i].previousCost=(1*c[i].previousCost).toFixed(4);c[i].afterCost=(1*c[i].afterCost).toFixed(4);c[i].costChange=(1*c[i].costChange).toFixed(4);if("1"==c[i].type)c[i].type="\u5efa\u4ed3";else if("2"==c[i].type)c[i].type="\u6e05\u4ed3";else if("3"==c[i].type)c[i].type="\u589e\u4ed3";else if("4"==c[i].type)c[i].type="\u51cf\u4ed3";else if("5"==c[i].type)c[i].type="\u4ed8\u606f";else if("6"==c[i].type)c[i].type="\u8fd8\u672c\u4ed8\u606f";
else if("7"==c[i].type)c[i].type="\u5230\u671f"}return A.store.data=c},getDicMonth:function(c,d){c.setMonth(c.getMonth()-d);var e=c.getFullYear(),j=c.getDate(),d=c.getMonth()+1;10>d&&(d="0"+d);10>j&&(j="0"+j);return e+"-"+d+"-"+j},getDicDate:function(c,d){var e=initDate(c);e.setDate(e.getDate()-d);var d=e.getDate(),j=e.getYear(),e=e.getMonth()+1;10>e&&(e="0"+e);10>d&&(d="0"+d);return j+"-"+e+"-"+d},saveData:function(){var c="<tr><td colspan='"+(+A.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u6301\u4ed3\u53d8\u52a8</td></tr>";
C.saveAsExcel("\u6301\u4ed3\u53d8\u52a8"+C.generateTimeStamp(),c,"\u6301\u4ed3\u53d8\u52a8",A,A.getColumns())}})})},"url:bond/bondPortfolio/view/bondGrp_adjustHis.html":'<div data-dojo-attach-point="containerNode" >\r\n\t<div class="vbox" style="height:100%;">\r\n\r\n\t\t<div class="build_list" style="height:35px">\r\n\t\t\t\t<table cellspacing="0" cellpadding="0" class="table_01">\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>\u7ec4\u5408</td> \r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="myGroupQuery" class="width_ctrl3">\r\n\t\t\t\t   \t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n                        <td>\u8d77\u59cb\u65e5\u671f</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<input data-dojo-attach-point="stdateQuery" class="width_ctrl5" value="2013-06-27" data-dojo-type="dijit/form/DateTextBox" />\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\u622a\u6b62\u65e5\u671f</td>\r\n                        <td>\r\n\t\t\t\t\t\t\t<input data-dojo-attach-point="sedateQuery" class="width_ctrl5" value="2013-07-27" data-dojo-type="dijit/form/DateTextBox" />\r\n\t\t\t\t\t\t</td>\r\n                        <td>\r\n                            <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveAsExcel" type="button">\r\n                                \u5bfc\u51fa\u6570\u636e\r\n                            </button>\r\n                        </td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t</div>\r\n\r\n\t\t<div data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:100%;">\r\n\t\t\t<div class="vbox" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden;">\r\n\t\t\t\t<div  class="spacer" id="container"  data-dojo-type="dijit/layout/ContentPane"></div>\r\n\r\n\t\t\t</div>\r\n\t\t</div>\t\r\n\t</div>\r\n</div>\r\n',
"bond/bondPortfolio/view/bondGrp_Mon_Cha_O":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./bondGrp_Mon_Cha_O.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dijit/layout/TabContainer,dojox/layout/TableContainer,dijit/form/Button,dijit/form/SimpleTextarea,dijit/form/Textarea,dijit/form/DateTextBox,dojox/form/CheckedMultiSelect,dojox/slickgrid/treegrid,dojox/store/TreeGridStore,dojox/slickgrid/formatters,dojo/json,dojo/dom,dijit/registry,dojox/store/GridWSStore,dijit/form/FilteringSelect,dojo/date/locale,dojox/store/LocalStorage,bond/bondPortfolio/view/_helper/MessageDialog,bond/bondPortfolio/view/_helper/util".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G,A,d,c,r,s,X,m,b,x,ba,Y,T,B){var D,L=0,a,H,N;return j("bond.bondPortfolio.view.bondGrp_Mon_Cha_O",[o,w,u,E],{templateString:S,postMixInProperties:function(){this.inherited(arguments);y.mixin(this,R)},postCreate:function(){L=0;var a=this;a.saveAsExcel.on("click",function(){0<D.store.data.length&&a.saveData()});var c=a.calendar;c.set("value",new Date);N=c.get("value");c.on("change",function(){if(0!=L){var b=ba.format(a.calendar.get("value"),{datePattern:"yyyyMMdd000000",
selector:"date"}),d=ba.format(new Date,{datePattern:"yyyyMMdd000000",selector:"date"});b>d?((new T).showDialog("\u4e0d\u53ef\u5927\u4e8e\u5f53\u524d\u65e5\u671f"),c.set("value",N)):(N=c.get("value"),a.queryResult())}});a.ddlClass.on("change",function(){a.createTable()});var d=a.ddlGroup,e=new b({}),m=new Y({idProperty:"id",namespace:"bondPortfolio"}),j=m.get("userId").name,f=m.get("groupId");e.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+
btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getAllGroupManagerForShare.dzh?userId="+j+"&a="+ba.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){for(var c=[],e=0;e<b.length;e++){var m={};m.name=b[e].groupName;m.id=b[e].groupId;m.bondHoleType=b[e].bondHoleType;c.push(m)}e="";if(null==f){if(0!=b.length)e=b[0].groupId}else e=f.name;b=new h({data:c});H=new x({name:"state",value:e,store:b,searchAttr:"name"});H.placeAt(d);a.queryResult();
H.on("change",function(){a.queryResult()})})},queryResult:function(){var c=this,d=H.get("value"),e=ba.format(c.calendar.get("value"),{datePattern:"yyyyMMdd000000",selector:"date"}),m=new Y({idProperty:"id",namespace:"bondPortfolio"});m.put({id:"groupId",name:d});for(var m=m.get("permission").name,j=H.store.data,h=0,f=0;f<j.length;f++)if(j[f].id==d)h=j[f].bondHoleType;(new b({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+
"/groupMonitor/groupCharacterOneDay.dzh?gbpmId="+d+"&positionDate="+e+"&holdType="+h+"&userType="+m+"&a="+ba.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){a=b;c.createTable()})},createTable:function(){jdata={identifier:"id",label:"name",items:[{}]};if(0!=a.length){for(var b=this.ddlClass.get("value"),e,m,j,h,T,f,k,t,w,fa,ga,o,u,x,n=[],v,Z,$="1",g=0;g<a.length;g++){var p=a[g][b];switch(a[g].dateSource){case "1":a[g].dateSource=
"\u5b9e\u65f6\u6210\u4ea4";break;case "2":a[g].dateSource="\u4e2d\u503a\u4f30\u503c";break;case "3":a[g].dateSource="\u5386\u53f2\u6210\u4ea4"}if(0<parseFloat(a[g].residualMaturity)&&1>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="1\u5e74\u4ee5\u5185";if(1<parseFloat(a[g].residualMaturity)&&3>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="1-3\u5e74";if(3<parseFloat(a[g].residualMaturity)&&5>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="3-5\u5e74";if(5<
parseFloat(a[g].residualMaturity)&&7>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="5-7\u5e74";if(7<parseFloat(a[g].residualMaturity)&&10>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="7-10\u5e74";if(10<parseFloat(a[g].residualMaturity)&&15>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="10-15\u5e74";if(15<parseFloat(a[g].residualMaturity)&&20>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="15-20\u5e74";if(20<parseFloat(a[g].residualMaturity)&&
35>=parseFloat(a[g].residualMaturity))a[g].residualMaturityName="20-35\u5e74";if(35<parseFloat(a[g].residualMaturity))a[g].residualMaturityName="35\u5e74\u4ee5\u4e0a";if("null"==a[g].nbcr)a[g].nbcr="\u65e0";0==g?(e=parseFloat(a[g].weight),m=parseFloat(a[g].yield)*parseFloat(a[g].weight)/100,j=""!=a[g].portfolioType?parseFloat(a[g].residualMaturity)*parseFloat(a[g].weight)/100:0,h=parseFloat(a[g].macaulayDuration)*parseFloat(a[g].weight)/100,T=parseFloat(a[g].macaulayDurationProffer)*parseFloat(a[g].weight)/
100,f=parseFloat(a[g].convexity)*parseFloat(a[g].weight)/100,k=parseFloat(a[g].convexityProffer)*parseFloat(a[g].weight)/100,t=parseFloat(a[g].marginZ)*parseFloat(a[g].weight)/100,w=parseFloat(a[g].marginZProffer)*parseFloat(a[g].weight)/100,fa=parseFloat(a[g].marginI)*parseFloat(a[g].weight)/100,ga=parseFloat(a[g].marginIProffer)*parseFloat(a[g].weight)/100,o=parseFloat(a[g].cashMacaulayDuration)*parseFloat(a[g].weight)/100,u=parseFloat(a[g].value),x=parseFloat(a[g].amountDenomination)):(e=parseFloat(e)+
parseFloat(a[g].weight),m=parseFloat(m)+parseFloat(a[g].yield)*parseFloat(a[g].weight)/100,""!=a[g].portfolioType&&(j=parseFloat(j)+parseFloat(a[g].residualMaturity)*parseFloat(a[g].weight)/100),h=parseFloat(h)+parseFloat(a[g].macaulayDuration)*parseFloat(a[g].weight)/100,T=parseFloat(T)+parseFloat(a[g].macaulayDurationProffer)*parseFloat(a[g].weight)/100,f=parseFloat(f)+parseFloat(a[g].convexity)*parseFloat(a[g].weight)/100,k=parseFloat(k)+parseFloat(a[g].convexityProffer)*parseFloat(a[g].weight)/
100,t=parseFloat(t)+parseFloat(a[g].marginZ)*parseFloat(a[g].weight)/100,w=parseFloat(w)+parseFloat(a[g].marginZProffer)*parseFloat(a[g].weight)/100,fa=parseFloat(fa)+parseFloat(a[g].marginI)*parseFloat(a[g].weight)/100,ga=parseFloat(ga)+parseFloat(a[g].marginIProffer)*parseFloat(a[g].weight)/100,o=parseFloat(o)+parseFloat(a[g].cashMacaulayDuration)*parseFloat(a[g].weight)/100,u=parseFloat(u)+parseFloat(a[g].value),x=parseFloat(x)+parseFloat(a[g].amountDenomination));if(""==a[g].portfolioType)v=parseFloat(a[g].weight),
Z=parseFloat(a[g].value);else{for(var A=0,l=0;l<n.length;l++){var y=n[l][b];if(p==y){n[l].weight=parseFloat(n[l].weight)+parseFloat(a[g].weight);n[l].yield=parseFloat(n[l].yield)+parseFloat(a[g].yield)*parseFloat(a[g].weight);n[l].residualMaturity=parseFloat(n[l].residualMaturity)+parseFloat(a[g].residualMaturity)*parseFloat(a[g].weight);n[l].macaulayDuration=parseFloat(n[l].macaulayDuration)+parseFloat(a[g].macaulayDuration)*parseFloat(a[g].weight);n[l].macaulayDurationProffer=parseFloat(n[l].macaulayDurationProffer)+
parseFloat(a[g].macaulayDurationProffer)*parseFloat(a[g].weight);n[l].convexity=parseFloat(n[l].convexity)+parseFloat(a[g].convexity)*parseFloat(a[g].weight);n[l].convexityProffer=parseFloat(n[l].convexityProffer)+parseFloat(a[g].convexityProffer)*parseFloat(a[g].weight);n[l].marginZ=parseFloat(n[l].marginZ)+parseFloat(a[g].marginZ)*parseFloat(a[g].weight);n[l].marginZProffer=parseFloat(n[l].marginZProffer)+parseFloat(a[g].marginZProffer)*parseFloat(a[g].weight);n[l].marginI=parseFloat(n[l].marginI)+
parseFloat(a[g].marginI)*parseFloat(a[g].weight);n[l].marginIProffer=parseFloat(n[l].marginIProffer)+parseFloat(a[g].marginIProffer)*parseFloat(a[g].weight);n[l].cashMacaulayDuration=parseFloat(n[l].cashMacaulayDuration)+parseFloat(a[g].cashMacaulayDuration)*parseFloat(a[g].weight);n[l].value=parseFloat(n[l].value)+parseFloat(a[g].value);n[l].amountDenomination=parseFloat(n[l].amountDenomination)+parseFloat(a[g].amountDenomination);a[g].id=n[l].id.toString()+g.toString();n[l].child=n[l].child+',{"_reference":"'+
a[g].id+'"}';A=1;break}}if(0==A)l={},l[b]=a[g][b],l.weight=parseFloat(a[g].weight),l.yield=parseFloat(a[g].yield)*parseFloat(a[g].weight),l.residualMaturity=parseFloat(a[g].residualMaturity)*parseFloat(a[g].weight),l.macaulayDuration=parseFloat(a[g].macaulayDuration)*parseFloat(a[g].weight),l.macaulayDurationProffer=parseFloat(a[g].macaulayDurationProffer)*parseFloat(a[g].weight),l.convexity=parseFloat(a[g].convexity)*parseFloat(a[g].weight),l.convexityProffer=parseFloat(a[g].convexityProffer)*parseFloat(a[g].weight),
l.marginZ=parseFloat(a[g].marginZ)*parseFloat(a[g].weight),l.marginZProffer=parseFloat(a[g].marginZProffer)*parseFloat(a[g].weight),l.marginI=parseFloat(a[g].marginI)*parseFloat(a[g].weight),l.marginIProffer=parseFloat(a[g].marginIProffer)*parseFloat(a[g].weight),l.cashMacaulayDuration=parseFloat(a[g].cashMacaulayDuration)*parseFloat(a[g].weight),l.value=parseFloat(a[g].value),l.amountDenomination=parseFloat(a[g].amountDenomination),l.id=$,a[g].id=l.id.toString()+g.toString(),l.child='{"_reference":"'+
a[g].id+'"}',$=(parseInt($)+1).toString(),n.push(l)}}for(g=0;g<n.length-1;g++)for(l=g+1;l<n.length;l++)n[g][b]>n[l][b]&&($=n[g],n[g]=n[l],n[l]=$);$='{"identifier": "id","label": "name","items":[';for(g=0;g<n.length;g++)if(p=n[g][b],"bondCode"==b)for(l=0;l<a.length;l++)y=a[l][b],y==p&&($=$+'{"portfolioType":"'+a[l].bondCode.substr(2,a[l].bondCode.length-7)+'","bondCode":"'+a[l].bondCode.substr(2,a[l].bondCode.length-7)+'","market":"'+a[l].market+'","name":"'+a[l].name+'","weight":"'+(parseFloat(a[l].weight)/
(e/100)).toFixed(2)+'","dateSource":"'+a[l].dateSource+'","netPrice":"'+parseFloat(a[l].netPrice).toFixed(4)+'","accrual":"'+parseFloat(a[l].accrual).toFixed(4)+'","fullPrice":"'+parseFloat(a[l].fullPrice).toFixed(4)+'","yield":"'+parseFloat(a[l].yield).toFixed(4)+'","residualMaturity":"'+parseFloat(a[l].residualMaturity).toFixed(2)+'","macaulayDuration":"'+parseFloat(a[l].macaulayDuration).toFixed(4)+'","macaulayDurationProffer":"'+parseFloat(a[l].macaulayDurationProffer).toFixed(4)+'","convexity":"'+
parseFloat(a[l].convexity).toFixed(4)+'","convexityProffer":"'+parseFloat(a[l].convexityProffer).toFixed(4)+'","marginZ":"'+parseFloat(a[l].marginZ).toFixed(4)+'","marginZProffer":"'+parseFloat(a[l].marginZProffer).toFixed(4)+'","marginI":"'+parseFloat(a[l].marginI).toFixed(4)+'","marginIProffer":"'+parseFloat(a[l].marginIProffer).toFixed(4)+'","cashMacaulayDuration":"'+B.addThousandSeparator(parseFloat(a[l].cashMacaulayDuration).toFixed(4))+'","value":"'+B.addThousandSeparator(parseFloat(a[l].value).toFixed(4))+
'","amountDenomination":"'+B.addThousandSeparator(parseFloat(a[l].amountDenomination).toFixed(4))+'","type":"level0","id":"'+a[l].id+'"},');else{n[g].weight/=e/100;$=$+'{"portfolioType":"'+p+'","bondCode":"","market":"","name":"","weight":"'+n[g].weight.toFixed(2)+'","dateSource":"","netPrice":"","accrual":"","fullPrice":"","yield":'+(n[g].yield/n[g].weight).toFixed(4)+',"residualMaturity":"'+(n[g].residualMaturity/n[g].weight).toFixed(2)+'","macaulayDuration":"'+(n[g].macaulayDuration/n[g].weight).toFixed(4)+
'","macaulayDurationProffer":"'+(n[g].macaulayDurationProffer/n[g].weight).toFixed(4)+'","convexity":"'+(n[g].convexity/n[g].weight).toFixed(4)+'","convexityProffer":"'+(n[g].convexityProffer/n[g].weight).toFixed(4)+'","marginZ":"'+(n[g].marginZ/n[g].weight).toFixed(4)+'","marginZProffer":"'+(n[g].marginZProffer/n[g].weight).toFixed(4)+'","marginI":"'+(n[g].marginI/n[g].weight).toFixed(4)+'","marginIProffer":"'+(n[g].marginIProffer/n[g].weight).toFixed(4)+'","cashMacaulayDuration":"'+B.addThousandSeparator((n[g].cashMacaulayDuration/
n[g].weight).toFixed(4))+'","value":"'+B.addThousandSeparator(n[g].value.toFixed(4))+'","amountDenomination":"'+B.addThousandSeparator(n[g].amountDenomination.toFixed(4))+'","type":"level0","children":['+n[g].child+"]},";for(l=0;l<a.length;l++)y=a[l][b],y==p&&($=$+'{"portfolioType":"","bondCode":"'+a[l].bondCode.substr(2,a[l].bondCode.length-7)+'","market":"'+a[l].market+'","name":"'+a[l].name+'","weight":"'+(parseFloat(a[l].weight)/(e/100)).toFixed(2)+'","dateSource":"'+a[l].dateSource+'","netPrice":"'+
parseFloat(a[l].netPrice).toFixed(4)+'","accrual":"'+parseFloat(a[l].accrual).toFixed(4)+'","fullPrice":"'+parseFloat(a[l].fullPrice).toFixed(4)+'","yield":"'+parseFloat(a[l].yield).toFixed(4)+'","residualMaturity":"'+parseFloat(a[l].residualMaturity).toFixed(2)+'","macaulayDuration":"'+parseFloat(a[l].macaulayDuration).toFixed(4)+'","macaulayDurationProffer":"'+parseFloat(a[l].macaulayDurationProffer).toFixed(4)+'","convexity":"'+parseFloat(a[l].convexity).toFixed(4)+'","convexityProffer":"'+parseFloat(a[l].convexityProffer).toFixed(4)+
'","marginZ":"'+parseFloat(a[l].marginZ).toFixed(4)+'","marginZProffer":"'+parseFloat(a[l].marginZProffer).toFixed(4)+'","marginI":"'+parseFloat(a[l].marginI).toFixed(4)+'","marginIProffer":"'+parseFloat(a[l].marginIProffer).toFixed(4)+'","cashMacaulayDuration":"'+B.addThousandSeparator(parseFloat(a[l].cashMacaulayDuration).toFixed(4))+'","value":"'+B.addThousandSeparator(parseFloat(a[l].value).toFixed(4))+'","amountDenomination":"'+B.addThousandSeparator(parseFloat(a[l].amountDenomination).toFixed(4))+
'","type":"level1","id":"'+a[l].id+'"},')}$=$+'{"portfolioType":"\u73b0\u91d1","bondCode":"","market":"","name":"","weight":"'+(v/(e/100)).toFixed(2)+'","dateSource":"","netPrice":"","accrual":"","fullPrice":"","yield":"","residualMaturity":"","macaulayDuration":"","macaulayDurationProffer":"","convexity":"","convexityProffer":"","marginZ":"","marginZProffer":"","marginI":"","marginIProffer":"","cashMacaulayDuration":"","value":"'+B.addThousandSeparator(Z.toFixed(4))+'","amountDenomination":"","type":"level0"}';
$=$+',{"portfolioType":"\u603b\u8d44\u4ea7","bondCode":"","market":"","name":"","weight":100,"dateSource":"","netPrice":"","accrual":"","fullPrice":"","yield":"'+m.toFixed(4)+'","residualMaturity":"'+j.toFixed(2)+'","macaulayDuration":"'+h.toFixed(4)+'","macaulayDurationProffer":"'+T.toFixed(4)+'","convexity":"'+f.toFixed(4)+'","convexityProffer":"'+k.toFixed(4)+'","marginZ":"'+t.toFixed(4)+'","marginZProffer":"'+w.toFixed(4)+'","marginI":"'+fa.toFixed(4)+'","marginIProffer":"'+ga.toFixed(4)+'","cashMacaulayDuration":"'+
B.addThousandSeparator(o.toFixed(4))+'","value":"'+B.addThousandSeparator(u.toFixed(4))+'","amountDenomination":"'+B.addThousandSeparator(x.toFixed(4))+'","type":"level0"}';jdata=s.parse($+"]}")}e=[{id:"portfolioType",name:"\u8d44\u4ea7\u7c7b\u578b",field:"portfolioType",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left",formatter:r.treeGridFormatter},{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},
{id:"name",name:"\u8bc1\u5238\u7b80\u79f0",field:"name",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"market",name:"\u5e02\u573a",field:"market",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"weight",name:"\u6743\u91cd(%)",field:"weight",width:94,headerCssClass:"font-center",cssClass:"font-right"},{id:"dateSource",name:"\u6570\u636e\u6765\u6e90",field:"dateSource",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-center"},
{id:"netPrice",name:"\u51c0\u4ef7",field:"netPrice",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"accrual",name:"\u5e94\u8ba1\u5229\u606f",field:"accrual",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"fullPrice",name:"\u5168\u4ef7",field:"fullPrice",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"yield",name:"\u6536\u76ca\u7387(%)",field:"yield",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},
{id:"residualMaturity",name:"\u5269\u4f59\u671f\u9650(\u5e74)",field:"residualMaturity",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"macaulayDuration",name:"\u4e45\u671f",field:"macaulayDuration",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"macaulayDurationProffer",name:"\u4e45\u671f\u8d21\u732e\u5ea6",field:"macaulayDurationProffer",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"convexity",name:"\u51f8\u6027",
field:"convexity",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"convexityProffer",name:"\u51f8\u6027\u8d21\u732e\u5ea6",field:"convexityProffer",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"cashMacaulayDuration",name:"\u73b0\u91d1\u4e45\u671f",field:"cashMacaulayDuration",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"value",name:"\u5e02\u503c(\u5143)",field:"value",width:120,sortable:!1,headerCssClass:"font-center",
cssClass:"font-right"},{id:"amountDenomination",name:"\u6301\u4ed3\u9762\u989d(\u4e07)",field:"amountDenomination",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"}];m={enableColumnReorder:!1,rowHeight:20,frozenColumn:2,frozenRow:0};"bondCode"==b&&e.splice(1,1);if(0==L)D=new d({store:new c({data:jdata}),columns:e,options:m}),grid1=new d({store:new c({data:jdata}),columns:e,options:m}),D.placeAt(this.container),L=1;else{m=new c({data:jdata});D.store.setData(m.data);switch(b){case "portfolioType":e[0].name=
"\u503a\u5238\u7c7b\u578b";break;case "market":e[0].name="\u5e02\u573a";break;case "nbcr":e[0].name="\u4fe1\u7528\u8bc4\u7ea7";break;case "imethod":e[0].name="\u8ba1\u606f\u65b9\u5f0f";break;case "residualMaturityName":e[0].name="\u6309\u5269\u4f59\u5e74\u9650";break;case "bondCode":e[0].name="\u503a\u5238\u4ee3\u7801"}D.setColumns(e);D.refresh(m.data)}},saveData:function(){var a="<tr><td colspan='"+(+D.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u7ec4\u5408\u7279\u5f81</td></tr>";
B.saveAsExcel("\u7ec4\u5408\u7279\u5f81"+B.generateTimeStamp(),a,"\u7ec4\u5408\u7279\u5f81",D,D.getColumns())}})})},"url:bond/bondPortfolio/view/bondGrp_Mon_Cha_O.html":'<div data-dojo-attach-point="containerNode" >\t\r\n\t<div class="vbox" style="height:100%">\t\t\r\n\t\t<div class="build_list list_box2">\r\n\t\t\t<table cellspacing="0" cellpadding="0" class="table_01">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\u7ec4\u5408</td> \r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="ddlGroup" >\r\n\t\t\t   \t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<label>\u65e5\u671f</label>\r\n\t\t\t\t\t\t<input data-dojo-attach-point="calendar" class="width_ctrl5" value="2013-06-27" data-dojo-type="dijit/form/DateTextBox" required="true" />\r\n\t\t\t\t\t</td>\r\n                    <td>\u5206\u7c7b</td>\r\n\t\t\t\t\t<td>\r\n\r\n                        <div data-dojo-type="dijit/form/FilteringSelect" data-dojo-attach-point="ddlClass" class="width_ctrl_all" >\r\n                            <option value="bondCode">\u65e0\u5206\u7c7b</option>\r\n                            <option value="portfolioType" selected=\'1\'>\u6309\u503a\u5238\u7c7b\u578b</option>\r\n                            <option value="imethod">\u6309\u8ba1\u606f\u65b9\u5f0f</option>\r\n                            <option value="residualMaturityName">\u6309\u5269\u4f59\u5e74\u9650</option>\r\n                            <option value="nbcr">\u6309\u4fe1\u7528\u8bc4\u7ea7</option>\r\n                            <option value="market">\u6309\u5e02\u573a</option>\r\n                        </div>\r\n\t\t\t\t\t</td>\r\n                    <td>\r\n                        <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveAsExcel" type="button">\r\n                            \u5bfc\u51fa\u6570\u636e\r\n                        </button>\r\n                    </td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div data-dojo-type="dijit/layout/TabContainer" class="spacer" style="width: 100%;height:100%" data-dojo-props="tabPosition:\'bottom\', selectedchild:\'btab1\', tabStrip:true" >\r\n\t        <div data-dojo-type="dijit/layout/ContentPane" title="\u5355\u65e5\u5206\u6790" data-dojo-attach-point="btab1">\r\n\t           <div class="vbox" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden;">\r\n\t\t\t\t\t<div  class="spacer" data-dojo-attach-point="container"  data-dojo-type="dijit/layout/ContentPane"></div>\r\n\t\t\t\t</div>\r\n\t        </div>\r\n\t    </div>\r\n\t </div>   \r\n</div>\r\n',
"dojox/slickgrid/treegrid":function(){define("dojox/slickgrid/treegrid",["dojo/_base/lang","./slickgrid","dojo/_base/declare"],function(h,e,j){return j("dojox.grid.TreeGrid",[e],{startup:function(){this.inherited(arguments);this.own(this.on("click",h.hitch(this,function(e,j){var h=e.target.classList,E=j.row,y=this.data;if(h.contains("toggle")){var v=h.contains("expand")?"collapse":"expand";h.remove("collapse");h.remove("expand");h.add(v);y[E]._collapsed=v;this.renderQuery()}})))}})})},"dojox/store/TreeGridStore":function(){define("dojox/store/TreeGridStore",
["dojo/_base/declare","dojo/store/Memory","dojo/store/util/TreeGridQueryEngine"],function(h,e,j){return h("dojox.store.TreeGridStore",e,{queryEngine:j,constructor:function(e){for(var j in e)this[j]=e[j];this.setData(this.convert(this.data)||[])},convert:function(e){for(var j=[],h=e.items,E=h.length,e=[],y={},v=0;v<E;v++){var K=h[v];"level0"==K.type&&e.push(K);y[K.id]=K}for(var F=function(e,h,o){var u=e.children;if(null!=u){var v=y[u[h]._reference];v.parent=e;v.indentation=o;v._collapsed="expand";
j.push(v);v.children?F(y[u[h]._reference],0,o+1):v._collapsed="leaf";h<u.length-1&&F(e,h+1,o)}},v=0,h=e.length;v<h;v++)K=e[v],K.parent=null,K.indentation=0,K._collapsed="expand",j.push(K),F(K,0,1);return j}})})},"dojo/store/util/TreeGridQueryEngine":function(){define(["../../_base/array"],function(h){return function(e){function j(j){j=h.filter(j,e);j.total=j.length;return j}switch(typeof e){default:throw Error("Can not query with a "+typeof e);case "object":case "undefined":var o=e,e=function(e){if(null!=
e.parent)for(var j=e.parent;j;){if("collapse"==j._collapsed)return!1;j=j.parent}for(var h in o)if((j=o[h])&&j.test){if(!j.test(e[h],e))return!1}else if(j!=e[h])return!1;return!0};break;case "string":if(!this[e])throw Error("No filter function "+e+" was found in store");e=this[e];case "function":}j.matches=e;return j}})},"bond/bondPortfolio/view/bondGrp_Mon_Dis":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./bondGrp_Mon_Dis.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dijit/layout/TabContainer,dojox/charting/widget/Chart,dojox/charting/axis2d/Default,dojox/charting/axis2d/comments,dojox/charting/axis2d/legend,dojox/charting/plot2d/Grid,dojox/charting/plot2d/Pie,dojox/charting/action2d/Tooltip,dojox/charting/action2d/Highlight,dojox/charting/action2d/MoveSlice,dojox/charting/themes/CustomColor,dojo/parser,dojox/charting/widget/exportChart,dijit/layout/BorderContainer,dijit/layout/ContentPane,dojox/store/GridWSStore,dijit/form/FilteringSelect,dojo/date/locale,dojox/store/LocalStorage,dojox/charting/themes/WhiteCustom,bond/bondPortfolio/view/_helper/MessageDialog,bond/bondPortfolio/view/_helper/util".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G,A,d,c,r,s,X,m,b,x,ba,Y,T,B,D,L,a){var H,N,I=0,ea,z,q,J,ca,f,k;return j("bond.bondPortfolio.view.bondGrp_Mon_Dis",[o,w,u,E],{templateString:S,postMixInProperties:function(){this.inherited(arguments);y.mixin(this,R)},postCreate:function(){I=0;var a=this;a.saveAsExcel.on("click",function(){0<H.store.data.length&&a.saveData()});var b=a.calendar;b.set("value",new Date);k=b.get("value");b.on("change",function(){if(0!=I){var c=T.format(a.calendar.get("value"),
{datePattern:"yyyyMMdd000000",selector:"date"}),d=T.format(new Date,{datePattern:"yyyyMMdd000000",selector:"date"});c>d?((new L).showDialog("\u4e0d\u53ef\u5927\u4e8e\u5f53\u524d\u65e5\u671f"),b.set("value",k)):(k=b.get("value"),a.queryResult())}});var c=a.ddlGroup,d=new ba({}),e=new B({idProperty:"id",namespace:"bondPortfolio"}),f=e.get("userId").name,m=e.get("groupId");d.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+
"/groupMonitor/getAllGroupManagerForShare.dzh?userId="+f+"&a="+T.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){for(var d=[],e=0;e<b.length;e++){var f={};f.name=b[e].groupName;f.id=b[e].groupId;f.bondHoleType=b[e].bondHoleType;d.push(f)}e="";if(null==m){if(0!=b.length)e=b[0].groupId}else e=m.name;b=new h({data:d});N=new Y({name:"state",value:e,store:b,searchAttr:"name"});N.placeAt(c);N.on("change",function(){a.queryResult()});a.queryResult()})},
queryResult:function(){var a=this,b=N.get("value"),c=new B({idProperty:"id",namespace:"bondPortfolio"}),d=c.get("permission").name;c.put({id:"groupId",name:b});for(var e=N.store.data,f=c=0;f<e.length;f++)if(e[f].id==b)c=e[f].bondHoleType;e=T.format(a.calendar.get("value"),{datePattern:"yyyyMMdd000000",selector:"date"});(new ba({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupMonitor/groupDistribution.dzh?gbpmId="+
b+"&positionDate="+e+"&holdType="+c+"&userType="+d+"&a="+T.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){a.createTable(b);a.createChart(b)})},createTable:function(a){var b=[];if(0!=a.length){for(var c,d=0;d<a.length;d++){a[d].bondCode="2"==a[d].bondCode?"\u73b0\u91d1":a[d].bondCode.substr(2,a[d].bondCode.length-7);if("null"==a[d].cgrate)a[d].cgrate="--";if("null"==a[d].nbcr)a[d].nbcr="--";a[d].weight=parseFloat(a[d].weight).toFixed(2);
a[d].redate="19000101000000"==a[d].redate||"null"==a[d].redate?"--":a[d].redate.substr(0,4)+"-"+a[d].redate.substr(4,2)+"-"+a[d].redate.substr(6,2);a[d].rsdate="19000101000000"==a[d].rsdate||"null"==a[d].rsdate?"--":a[d].rsdate.substr(0,4)+"-"+a[d].rsdate.substr(4,2)+"-"+a[d].rsdate.substr(6,2);"\u73b0\u91d1"==a[d].bondCode?(a[d].name="",a[d].portfolioType="",a[d].icrate="",a[d].pycount="",a[d].redate="",a[d].rsdate="",c=a[d]):b.push(a[d])}b.push(c)}2!=I?(mstore=new h({data:b}),H=new U({store:mstore,
columns:[{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"name",name:"\u8bc1\u5238\u7b80\u79f0",field:"name",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"market",name:"\u5e02\u573a",field:"market",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"portfolioType",name:"\u8d44\u4ea7\u7c7b\u578b",field:"portfolioType",width:94,sortable:!0,headerCssClass:"font-center",
cssClass:"font-left"},{id:"weight",name:"\u6743\u91cd(%)",field:"weight",width:94,headerCssClass:"font-center",cssClass:"font-right"},{id:"pmethod",name:"\u4ed8\u606f\u65b9\u5f0f",field:"pmethod",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-left"},{id:"imethod",name:"\u8ba1\u606f\u65b9\u5f0f",field:"imethod",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-left"},{id:"icrate",name:"\u606f\u7968(\u5143/\u6bcf\u767e\u5143\u9762\u989d)",field:"icrate",width:94,sortable:!1,
headerCssClass:"font-center",cssClass:"font-right"},{id:"pycount",name:"\u5e74\u4ed8\u606f\u6b21\u6570",field:"pycount",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"cgrate",name:"\u53d1\u884c\u4eba\u8bc4\u7ea7",field:"cgrate",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"nbcr",name:"\u503a\u5238\u8bc4\u7ea7",field:"nbcr",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"redate",name:"\u8d4e\u56de\u65e5",field:"redate",
width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"rsdate",name:"\u56de\u552e\u65e5",field:"rsdate",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"}],options:{enableColumnReorder:!1,rowHeight:20,frozenColumn:1,frozenRow:0}}),H.placeAt(this.container),I++):(H.store.data=b,H.refresh(b))},createChart:function(a){2!=I&&(ea=this.initChart(this.pies1,"\u6309\u503a\u5238\u7c7b\u578b\u5206\u7c7b"),z=this.initChart(this.pies2,"\u6309\u8ba1\u606f\u65b9\u5f0f\u5206\u7c7b"),
q=this.initChart(this.pies3,"\u6309\u5269\u4f59\u5e74\u9650\u5206\u7c7b"),J=this.initChart(this.pies4,"\u6309\u503a\u5238\u8bc4\u7ea7\u5206\u7c7b"),ca=this.initChart(this.pies5,"\u6309\u5e02\u573a\u5206\u7c7b"),f=this.initChart(this.pies6,"\u6309\u4ed8\u606f\u65b9\u5f0f\u5206\u7c7b"),I++);var b=[[],[],[],[],[],[]];0!=a.length&&(b=this.addData(a));ea.addSeries("Series A",b[0]);ea.render();this.pies1Panel.resize();z.addSeries("Series A",b[1]);z.render();this.pies2Panel.resize();q.addSeries("Series A",
b[2]);q.render();this.pies3Panel.resize();J.addSeries("Series A",b[3]);J.render();this.pies4Panel.resize();ca.addSeries("Series A",b[4]);ca.render();this.pies5Panel.resize();f.addSeries("Series A",b[5]);f.render();this.pies6Panel.resize()},initChart:function(a,b){var c=new O({margins:{l:0,t:0,r:0,b:0},titleText:b,titlePos:"top",titleGap:10,titleFont:"normal normal normal 10pt Arial",titleFontColor:"black"},a);c.addPlot("default",{type:A,labelOffset:5,radius:260,fontColor:"#676162",labelWiring:"red",
labelStyle:"columns",hollow:!1});c.addAxis("comments",{type:"comments",footnotes:"\u811a\u6ce8",footnotesFont:"normal normal normal 6pt Arial",footnotesFontColor:"red",writer:"\u5f20\u4e09",writerFont:"normal normal normal 6pt Arial",writerFontColor:"red",sources:"\u4e16\u534e\u8d22\u8baf",sourcesFont:"normal normal normal 6pt Arial",sourcesFontColor:"red"});c.addAxis("legend",{type:"legend",position:"top"});c.setTheme(D);new d(c.chart,"default");return c},addData:function(a){for(var b="#F29200,#6CC6D6,#F9D7CC,#F6D85D,#656463,#CB4443,#4DB242,#3D70AE".split(","),
c=[],d=[],e=[],f=[],m=[],j=[],h=[],k=0;k<a.length;k++){for(var q=0,g=0;g<d.length;g++)if(d[g].name==a[k].portfolioType)d[g].y=(parseFloat(a[k].weight)+parseFloat(d[g].y)).toFixed(2),d[g].text=a[k].portfolioType+"("+p.y+"%)",q=1;if(0==q){var p={};p.y=parseFloat(a[k].weight).toFixed(2);""==a[k].portfolioType?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):(p.name=a[k].portfolioType,p.text=a[k].portfolioType+"("+p.y+"%)");p.stroke={color:"white"};p.fill=b[d.length];d.push(p)}for(g=q=0;g<e.length;g++)if(e[g].name==
a[k].imethod)e[g].y=(parseFloat(a[k].weight)+parseFloat(e[g].y)).toFixed(2),e[g].text=a[k].imethod+"("+p.y+"%)",q=1;if(0==q)p={},p.y=parseFloat(a[k].weight).toFixed(2),""==a[k].imethod?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):(p.name=a[k].imethod,p.text=a[k].imethod+"("+p.y+"%)"),p.stroke={color:"white"},p.fill=b[e.length],e.push(p);for(g=q=0;g<f.length;g++)if(f[g].name==a[k].residualMaturity)f[g].y=(parseFloat(a[k].weight)+parseFloat(f[g].y)).toFixed(2),f[g].text=a[k].residualMaturity+
"("+p.y+"%)",q=1;if(0==q)p={},p.y=parseFloat(a[k].weight).toFixed(2),""==a[k].residualMaturity?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):(p.name=a[k].residualMaturity,p.text=a[k].residualMaturity+"("+p.y+"%)"),p.stroke={color:"white"},p.fill=b[f.length],f.push(p);q=0;if("--"==a[k].nbcr&&"\u73b0\u91d1"!=a[k].bondCode)a[k].nbcr="\u5176\u4ed6";for(g=0;g<m.length;g++)if(m[g].name==a[k].nbcr)m[g].y=(parseFloat(a[k].weight)+parseFloat(m[g].y)).toFixed(2),m[g].text=a[k].nbcr+"("+p.y+"%)",q=
1;if(0==q)p={},p.y=parseFloat(a[k].weight).toFixed(2),""==a[k].nbcr?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):(p.name=a[k].nbcr,p.text=a[k].nbcr+"("+p.y+"%)"),p.stroke={color:"white"},p.fill=b[m.length],m.push(p);for(g=q=0;g<j.length;g++)if(j[g].name==a[k].market)j[g].y=(parseFloat(a[k].weight)+parseFloat(j[g].y)).toFixed(2),j[g].text=a[k].market+"("+p.y+"%)",q=1;if(0==q)p={},p.y=parseFloat(a[k].weight).toFixed(2),""==a[k].market?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):
(p.name=a[k].market,p.text=a[k].market+"("+p.y+"%)"),p.stroke={color:"white"},p.fill=b[j.length],j.push(p);for(g=q=0;g<h.length;g++)if(h[g].name==a[k].pmethod)h[g].y=(parseFloat(a[k].weight)+parseFloat(h[g].y)).toFixed(2),h[g].text=a[k].pmethod+"("+p.y+"%)",q=1;if(0==q)p={},p.y=parseFloat(a[k].weight).toFixed(2),""==a[k].pmethod?(p.name="\u73b0\u91d1",p.text="\u73b0\u91d1("+p.y+"%)"):(p.name=a[k].pmethod,p.text=a[k].pmethod+"("+p.y+"%)"),p.stroke={color:"white"},p.fill=b[h.length],h.push(p)}c.push(d);
c.push(e);c.push(f);c.push(m);c.push(j);c.push(h);return c},saveData:function(){var b="<tr><td colspan='"+(+H.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u7ec4\u5408\u5206\u5e03</td></tr>";a.saveAsExcel("\u7ec4\u5408\u5206\u5e03"+a.generateTimeStamp(),b,"\u7ec4\u5408\u5206\u5e03",H,H.getColumns())}})})},"url:bond/bondPortfolio/view/bondGrp_Mon_Dis.html":'<div data-dojo-attach-point="containerNode" >\r\n\t<div class="vbox" style="height:100%">\r\n\t\t<div class="build_list list_box2">\r\n\t\t\t<table cellspacing="0" cellpadding="0" class="table_01">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\u7ec4\u5408</td> \r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="ddlGroup" >\r\n\t\t\t   \t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<label>\u65e5\u671f</label>\r\n\t\t\t\t\t\t<input data-dojo-attach-point="calendar" class="width_ctrl5" value="2013-06-27" data-dojo-type="dijit/form/DateTextBox" required="true" />\r\n\t\t\t\t\t</td>\r\n                    <td>\r\n                        <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveAsExcel" type="button">\r\n                            \u5bfc\u51fa\u6570\u636e\r\n                        </button>\r\n                    </td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\r\n\t\t<div data-dojo-type="dijit/layout/TabContainer" class="spacer" style="width: 100%;" data-dojo-props="tabPosition:\'bottom\', selectedchild:\'btab3\', tabStrip:true" >\r\n\t\t\t<div data-dojo-type="dijit/layout/ContentPane" title="\u5206\u5e03\u56fe"  data-dojo-props="selected:true">\r\n                <\!--<div data-dojo-type="dijit/layout/ContentPane" title="\u5206\u5e03\u56fe"  data-dojo-props="selected:true" style="background-color:#D3D8D7">--\>\r\n\t\t\t\t<div class="hbox" style="width:100%; height:100%">\r\n\t\t\t\t\t<div class="spacer vbox box_from_ctrl" style="width:50%; height:100%">\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies1Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7" >\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies1" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies2Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7">\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies2" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies3Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7">\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies3" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="spacer vbox box_from_ctrl" style="width:50%; height:100%">\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies4Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7">\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies4" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies5Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7">\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies5" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="pies6Panel" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="height:33%;border-color: #D3D8D7">\r\n\t\t\t\t\t\t\t<div data-dojo-attach-point="pies6" style="width:100%; height:96%" ></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t        <div data-dojo-type="dijit/layout/ContentPane" title="\u6301\u4ed3\u660e\u7ec6">\r\n\t           <div class="vbox" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden;">\r\n\t\t\t\t\t<div  class="spacer" data-dojo-attach-point="container"  data-dojo-type="dijit/layout/ContentPane"></div>\r\n\t\t\t\t</div>\r\n\t        </div>\r\n\t    </div>\r\n\r\n\t</div>\r\n</div>\r\n',
"bond/bondPortfolio/view/bondGrp_Mon_realT":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./bondGrp_Mon_realT.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dojox/store/GridWSStore,dijit/form/FilteringSelect,dojox/store/LocalStorage,dojo/date/locale,bond/bondPortfolio/view/_helper/util".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C){var G,A;return j("bond.bondPortfolio.view.bondGrp_Mon_realT",[o,w,u,E],{templateString:S,startup:function(){this.inherited(arguments);var d=this;d.saveAsExcel.on("click",function(){0<G.store.data.length&&d.saveData()});var c=d.ddlGroup,e=new W({}),j=new P({idProperty:"id",namespace:"bondPortfolio"}),o=j.get("userId").name,m=j.get("groupId");e.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+
btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getAllGroupManagerForShare.dzh?userId="+o+"&a="+M.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){for(var e=[],o=0;o<b.length;o++){var r={};r.name=b[o].groupName;r.id=b[o].groupId;r.bondHoleType=b[o].bondHoleType;e.push(r)}o="";if(null==m){if(0!=b.length)o=b[0].groupId}else o=m.name;b=new h({data:e});A=new O({name:"state",value:o,store:b,searchAttr:"name"});A.placeAt(c);b=d.container;
G=new U({store:new h({}),columns:[{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"name",name:"\u503a\u5238\u7b80\u79f0",field:"name",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"market",name:"\u5e02\u573a",field:"market",width:94,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"dateSource",name:"\u6570\u636e\u6765\u6e90",field:"dateSource",width:94,sortable:!0,
headerCssClass:"font-center",cssClass:"font-center"},{id:"netPrice",name:"\u6700\u65b0\u51c0\u4ef7",field:"netPrice",width:94,headerCssClass:"font-center",cssClass:"font-right"},{id:"accrual",name:"\u5e94\u8ba1\u5229\u606f",field:"accrual",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"fullPrice",name:"\u6700\u65b0\u5168\u4ef7",field:"fullPrice",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"yield",name:"\u6536\u76ca\u7387(%)",field:"yield",
width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"residualMaturity",name:"\u5269\u4f59\u671f\u9650",field:"residualMaturity",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"amout",name:"\u6301\u4ed3\u6570\u91cf",field:"amout",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"value",name:"\u6301\u4ed3\u5e02\u503c(\u5143)",field:"value",width:120,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"weight",
name:"\u6700\u65b0\u6743\u91cd(%)",field:"weight",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"redound",name:"\u603b\u56de\u62a5(\u5143)",field:"redound",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"rateReturn",name:"\u56de\u62a5\u7387(%)",field:"rateReturn",width:94,sortable:!1,headerCssClass:"font-center",cssClass:"font-right"},{id:"costPrice",name:"\u6210\u672c\u4ef7(\u5143)",field:"costPrice",width:94,sortable:!1,headerCssClass:"font-center",
cssClass:"font-right"}],options:{enableColumnReorder:!1,rowHeight:20,frozenColumn:1,frozenRow:0}});G.placeAt(b);d.createTable();A.on("change",function(){d.createTable()});b=window.setInterval(function(){d.createTable()},6E4);j.put({id:"timedTask",name:b})})},createTable:function(){var d=new P({idProperty:"id",namespace:"bondPortfolio"}),c=d.get("permission").name,e=A.get("value");d.put({id:"groupId",name:e});for(var j=A.store.data,h=d=0;h<j.length;h++)if(j[h].id==e)d=j[h].bondHoleType;j=M.format(new Date,
{datePattern:"yyyyMMdd000000",selector:"date"});(new W({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupMonitor/realtimeMonitor.dzh?gbpmId="+e+"&positionDate="+j+"&holdType="+d+"&userType="+c+"&a="+M.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(c){var b=[];if(0!=c.length){for(var d,e,j,h=0;h<c.length;h++){if("1"==c[h].bondCode||"2"==
c[h].bondCode||"3"==c[h].bondCode)c[h].bondCode=c[h].name,c[h].name="",c[h].dateSource="",c[h].netPrice="",c[h].accrual="",c[h].fullPrice="",c[h].yield="",c[h].residualMaturity="",c[h].amout="",c[h].costPrice="",c[h].updateTime="",c[h].redound="",c[h].rateReturn="";else{c[h].bondCode=c[h].bondCode.substr(2,c[h].bondCode.length-7);switch(c[h].dateSource){case "1":c[h].dateSource="\u5b9e\u65f6\u6210\u4ea4";break;case "2":c[h].dateSource="\u4e2d\u503a\u4f30\u503c";break;case "3":c[h].dateSource="\u5386\u53f2\u6210\u4ea4"}c[h].netPrice=
parseFloat(c[h].netPrice).toFixed(4);c[h].accrual=parseFloat(c[h].accrual).toFixed(4);c[h].fullPrice=parseFloat(c[h].fullPrice).toFixed(4);c[h].yield=parseFloat(c[h].yield).toFixed(4);c[h].residualMaturity=parseFloat(c[h].residualMaturity).toFixed(2);c[h].amout=C.addThousandSeparator(parseFloat(c[h].amout).toFixed(0));c[h].costPrice=parseFloat(c[h].costPrice).toFixed(4);c[h].redound=C.addThousandSeparator(parseFloat(c[h].redound).toFixed(2));c[h].rateReturn=parseFloat(c[h].rateReturn).toFixed(4)}c[h].value=
C.addThousandSeparator(parseFloat(c[h].value).toFixed(4));c[h].weight=parseFloat(c[h].weight).toFixed(2);var o=0;"\u73b0\u91d1"==c[h].bondCode&&(d=c[h],o=1);"\u603b\u8d44\u4ea7"==c[h].bondCode&&(e=c[h],o=1);"\u603b\u6301\u4ed3"==c[h].bondCode&&(j=c[h],o=1);0==o&&b.push(c[h])}b.push(d);b.push(j);b.push(e)}G.store.data=b;G.refresh(b)})},saveData:function(){var d="<tr><td colspan='"+(+G.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5b9e\u65f6\u76d1\u63a7</td></tr>";
C.saveAsExcel("\u5b9e\u65f6\u76d1\u63a7"+C.generateTimeStamp(),d,"\u5b9e\u65f6\u76d1\u63a7",G,G.getColumns())}})})},"url:bond/bondPortfolio/view/bondGrp_Mon_realT.html":'<div data-dojo-attach-point="containerNode">\r\n    <div class="vbox" style="height: 100%">\r\n        <div class="build_list list_box2" >\r\n            <table cellspacing="0" cellpadding="0" class="table_01">\r\n                <tr>\r\n                    <td>\u7ec4\u5408</td>\r\n                    <td>\r\n                        <div data-dojo-attach-point="ddlGroup" >\r\n                        </div>\r\n                    </td>\r\n                    <td>\r\n                        <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveAsExcel" type="button">\r\n                            \u5bfc\u51fa\u6570\u636e\r\n                        </button>\r\n                    </td>\r\n                    <\!--<td>--\>\r\n                        <\!--<button data-dojo-type="dijit/form/Button" type="submit" data-dojo-attach-point="btnRefresh">--\>\r\n                        <\!--\u5237\u65b0--\>\r\n                        <\!--</button>--\>\r\n                    <\!--</td>--\>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="bottomTabA" data-dojo-props="" style="height:100%;" class="spacer">\r\n            <div data-dojo-type="dijit/layout/ContentPane" title="\u76f8\u5173\u503a\u5238" >\r\n                <div  data-dojo-attach-point="container" data-dojo-type="dijit/layout/ContentPane" class="spacer" style="overflow: hidden">\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n',
"bond/bondPortfolio/view/bondGrp_Mon_CashF":function(){define("dojo/store/Memory,dojo/request,dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./bondGrp_Mon_CashF.html,dojox/slickgrid/slickgrid,dijit/Dialog,dojox/slickgrid/controls/pager,dijit/layout/TabContainer,dojox/charting/widget/Chart,dojox/charting/axis2d/Default,dojox/charting/axis2d/comments,dojox/charting/axis2d/legend,dojox/charting/plot2d/StackedColumns,dojox/charting/plot2d/Grid,dojox/charting/action2d/Tooltip,dojox/charting/action2d/Highlight,dojox/charting/themes/CustomColor,dojo/parser,dojox/charting/widget/exportChart,dijit/layout/BorderContainer,dijit/layout/ContentPane,dojox/store/GridWSStore,dijit/form/FilteringSelect,dojo/date/locale,dojox/store/LocalStorage,dojox/charting/themes/WhiteCustom,bond/bondPortfolio/view/_helper/util".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G,A,d,c,r,s,X,m,b,x,ba,Y,T,B,D){var L,a,H,N=0,I,ea,z=[];return j("bond.bondPortfolio.view.bondGrp_Mon_CashF",[o,w,u,E],{templateString:S,postMixInProperties:function(){this.inherited(arguments);y.mixin(this,R)},postCreate:function(){N=0;var a=this,a=this;a.saveAsExcel.on("click",function(){0<L.store.data.length&&a.saveData()});var b=a.calendarS;b.set("value",new Date);b.on("change",function(){0!=N&&a.queryResult()});var b=new Date,c=a.calendarE;
c.set("value",new Date(b.getFullYear()+5,b.getMonth(),b.getDate()));c.on("change",function(){0!=N&&a.queryResult()});a.ddlfrequency.on("change",function(){a.queryResult()});var d=a.ddlGroup,b=new x({}),c=new T({idProperty:"id",namespace:"bondPortfolio"}),e=c.get("userId").name,j=c.get("groupId");b.query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getAllGroupManagerForShare.dzh?userId="+e+"&a="+Y.format(new Date,
{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(b){for(var c=[],e=0;e<b.length;e++){var k={};k.name=b[e].groupName;k.id=b[e].groupId;k.bondHoleType=b[e].bondHoleType;c.push(k)}e="";if(null==j){if(0!=b.length)e=b[0].groupId}else e=j.name;b=new h({data:c});H=new ba({name:"state",value:e,store:b,searchAttr:"name"});H.placeAt(d);H.on("change",function(){a.queryResult()});a.queryResult()})},queryResult:function(){var b=this,d=H.get("value"),e=b.ddlfrequency.get("value"),
f=Y.format(new Date,{datePattern:"yyyyMMdd000000",selector:"date"}),k=Y.format(b.calendarS.get("value"),{datePattern:"yyyyMMdd000000",selector:"date"}),j=Y.format(b.calendarE.get("value"),{datePattern:"yyyyMMdd000000",selector:"date"}),m="",m="1"==e?btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getCashFlowForDaily.dzh?gbpmId="+d+"&positionDate="+f+"&stdate="+k+"&sedate="+j+"&a="+Y.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})):btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getCashFlow.dzh?gbpmId="+
d+"&positionDate="+f+"&stdate="+k+"&sedate="+j+"&frequency="+e+"&a="+Y.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"}));(new x({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+btoa(bondPortfolioConfig.soUrl+"/groupMonitor/getCashFlowForDetail.dzh?gbpmId="+d+"&positionDate="+f+"&stdate="+k+"&sedate="+j+"&a="+Y.format(new Date,{datePattern:"yyyyMMddHHmmss",selector:"date"})),response_times:1,response_mode:0}).then(function(a){z=
a});(new x({})).query({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",parameter:"Z2V0,"+m,response_times:1,response_mode:0}).then(function(d){if(0!=d.length)if("1"==e)for(var f=0;f<d.length;f++)d[f].stdate=d[f].date,d[f].sedate=d[f].date,d[f].date=d[f].date.substr(0,4)+"/"+d[f].date.substr(4,2)+"/"+d[f].date.substr(6,2),d[f].cash=D.addThousandSeparator(parseFloat(d[f].cash).toFixed(4)),d[f].income=D.addThousandSeparator(parseFloat(d[f].income).toFixed(4)),d[f].payment=
D.addThousandSeparator(parseFloat(d[f].payment).toFixed(4));else for(f=0;f<d.length;f++)d[f].date=d[f].stdate.substr(0,4)+"/"+d[f].stdate.substr(4,2)+"/"+d[f].stdate.substr(6,2)+"-"+d[f].sedate.substr(0,4)+"/"+d[f].sedate.substr(4,2)+"/"+d[f].sedate.substr(6,2),d[f].cash=D.addThousandSeparator(parseFloat(d[f].cash).toFixed(4)),d[f].income=D.addThousandSeparator(parseFloat(d[f].income).toFixed(4)),d[f].payment=D.addThousandSeparator(parseFloat(d[f].payment).toFixed(4));0==N?(f=new h({data:d}),L=new U({store:f,
columns:[{id:"date",name:"\u65e5\u671f",field:"date",width:25,sortable:!0,headerCssClass:"font-center",cssClass:"font-center"},{id:"cash",name:"\u73b0\u91d1\u6d41",field:"cash",width:25,sortable:!0,headerCssClass:"font-center",cssClass:"font-right"},{id:"income",name:"\u606f\u7968\u6536\u5165",field:"income",width:25,sortable:!0,headerCssClass:"font-center",cssClass:"font-right"},{id:"payment",name:"\u672c\u91d1\u5151\u4ed8",field:"payment",width:25,sortable:!0,headerCssClass:"font-center",cssClass:"font-right"}],
options:{enableColumnReorder:!1,rowHeight:20,forceFitColumns:!0},setFocus:function(){null!=this.activeRow&&b.gridSelectChange(this.store.data[this.activeRow].stdate,this.store.data[this.activeRow].sedate)}}),L.placeAt(b.container),f=new h({data:{}}),a=new U({store:f,columns:[{id:"date",name:"\u65e5\u671f",field:"date",width:14,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:14,sortable:!0,headerCssClass:"font-center",
cssClass:"font-left"},{id:"marketName",name:"\u5e02\u573a",field:"marketName",width:14,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"bondName",name:"\u8bc1\u5238\u7b80\u79f0",field:"bondName",width:14,sortable:!0,headerCssClass:"font-center",cssClass:"font-left"},{id:"cash",name:"\u73b0\u91d1\u6d41",field:"cash",width:14,sortable:!0,headerCssClass:"font-center",cssClass:"font-right"},{id:"income",name:"\u606f\u7968\u6536\u5165",field:"income",width:15,sortable:!0,headerCssClass:"font-center",
cssClass:"font-right"},{id:"payment",name:"\u672c\u91d1\u5151\u4ed8",field:"payment",width:15,sortable:!0,headerCssClass:"font-center",cssClass:"font-right"}],options:{enableColumnReorder:!1,rowHeight:20,forceFitColumns:!0}}),a.placeAt(b.container2),I=new O({margins:{l:20,t:10,r:10,b:10},titlePos:"top",titleGap:25,titleFont:"normal normal normal 1pt Arial",titleFontColor:"orange"},b.bars),I.addPlot("default",{type:G,gap:10,maxAndMin:!1,drawData:!0}),I.addPlot("Grid",{type:"Grid",lineDashed:!0,hAxis:"x",
vAxis:"y",vMinorLines:!1,vMajorLines:!0,hMinorLines:!1,hMajorLines:!0}),I.addAxis("y",{vertical:!0,natural:!0,font:"normal normal normal 10pt Arial",titleGap:10,titleFont:"normal normal normal 32pt \u9ed1\u4f53",titleFontColor:"red"}),I.addAxis("comments",{type:"comments",footnotes:"\u811a\u6ce8",footnotesFont:"normal normal normal 6pt Arial",footnotesFontColor:"red",writer:"\u5f20\u4e09",writerFont:"normal normal normal 6pt Arial",writerFontColor:"red",sources:"\u4e16\u534e\u8d22\u8baf",sourcesFont:"normal normal normal 6pt Arial",
sourcesFontColor:"red"}),I.addAxis("legend",{type:"legend",position:"top",isShow:!0,font:"normal normal normal 9pt Arial",fontColor:"red",maxWidthScale:0.6,border:!1}),I.setTheme(B),new c(I.chart,"default"),N=1):(L.store.data=d,L.refresh(d));0!=d.length?b.gridSelectChange(d[0].stdate,d[0].sedate):b.gridSelectChange("","");b.chartRefresh(d)})},chartRefresh:function(a){ea=[{value:0,text:""}];for(var b=[],c=[],e=0;e<a.length;e++){var h={};h.value=e+1;h.text=a[e].date;ea.push(h);b.push(D.deleteThousandSeparator(a[e].income));
c.push(D.deleteThousandSeparator(a[e].payment))}I.addAxis("x",{labels:ea,minorTicks:!1,font:"normal normal normal 10pt Arial",majorTick:{color:"#676162",width:1},majorTickStep:1,titleOrientation:"away",titleGap:10,titleFont:"normal normal normal 32pt Arial",titleFontColor:"red"});I.addSeries("\u672c\u91d1\u5151\u4ed8",b,{fill:"#CB4443"});I.addSeries("\u606f\u7968\u6536\u5165",c,{fill:"#3D70AE"});new d(I.chart,"default",{text:function(a){return'<table cellpadding="1" cellspacing="0" border="0" style="font-size:0.9em;"><tr><td>'+
a.run.name+':</td><td align="left"><strong>'+(a.run&&a.run.data&&a.run.data[a.index])+'</strong></td></tr><tr><td>\u65e5\u671f:</td><td align="left"><strong>'+ea[a.index+1].text+"</strong></td></tr></table>"}});I.render()},gridSelectChange:function(b,c){var d=[];if(0==z.length)d=z;else for(var e=0;e<z.length;e++)if(z[e].date<=c&&z[e].date>=b){var h={};h.date=z[e].date.substr(0,4)+"/"+z[e].date.substr(4,2)+"/"+z[e].date.substr(6,2);h.bondCode=z[e].bondCode.substr(2,z[e].bondCode.length-7);h.marketName=
z[e].marketName;h.bondName=z[e].bondName;h.cash=D.addThousandSeparator(parseFloat(z[e].cash).toFixed(4));h.income=D.addThousandSeparator(parseFloat(z[e].income).toFixed(4));h.payment=D.addThousandSeparator(parseFloat(z[e].payment).toFixed(4));d.push(h)}a.store.data=d;a.refresh(d)},saveData:function(){var a="<tr><td colspan='"+(+L.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u7ec4\u5408\u73b0\u91d1\u6d41</td></tr>";D.saveAsExcel("\u7ec4\u5408\u73b0\u91d1\u6d41"+
D.generateTimeStamp(),a,"\u7ec4\u5408\u73b0\u91d1\u6d41",L,L.getColumns())}})})},"url:bond/bondPortfolio/view/bondGrp_Mon_CashF.html":'<div data-dojo-attach-point="containerNode" >\r\n\t<div class="vbox" style="height:100%">\r\n\t\t<div class="build_list list_box2">\r\n\t\t\t<table cellspacing="0" cellpadding="0" class="table_01">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\u7ec4\u5408</td> \r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div data-dojo-attach-point="ddlGroup">\r\n\t\t\t   \t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<label >\u8d77\u59cb\u65e5\u671f</label>\r\n\t\t\t\t\t\t<input data-dojo-attach-point="calendarS" class="width_ctrl5" value="2013-06-27" data-dojo-type="dijit/form/DateTextBox" required="true" />\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<label >\u622a\u6b62\u65e5\u671f</label>\r\n\t\t\t\t\t\t<input data-dojo-attach-point="calendarE" class="width_ctrl5" value="2013-06-27" data-dojo-type="dijit/form/DateTextBox" required="true" />\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\u7edf\u8ba1\u9891\u7387\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div data-dojo-type="dijit/form/FilteringSelect" data-dojo-attach-point="ddlfrequency" style="width: 100px;">\r\n\t\t\t\t\t\t\t<option value="1">\u65e5</option>\r\n\t\t\t   \t\t\t    <option value="2" selected=\'1\'>\u6708</option>\r\n                            <option value="3">\u5b63</option>\r\n                            <option value="4">\u5e74</option>\r\n\t\t\t   \t\t\t</div>\r\n\t\t\t\t\t</td>\r\n                    <td>\r\n                        <button data-dojo-type="dijit/form/Button" data-dojo-attach-point="saveAsExcel" type="button">\r\n                            \u5bfc\u51fa\u6570\u636e\r\n                        </button>\r\n                    </td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class="vbox spacer" style="height:100%; width:100%">\r\n\t\t\t <div class="vbox spacer" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden; height:50%;">\r\n\t\t\t\t<div  class="spacer1" data-dojo-attach-point="container"  data-dojo-type="dijit/layout/ContentPane">\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="chart_title" style="height:24px; line-height:24px;" >\r\n\t\t\t\t\t\u7edf\u8ba1\u9891\u7387\uff1a<span>\u6708</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\t\r\n\t\t\t<div class="vbox spacer" data-dojo-type="dijit/layout/ContentPane" style="overflow: hidden; height:50%;" >\r\n\t\t\t\t<div  data-dojo-type="dijit/layout/TabContainer" style="height:100%;width: 100%;" data-dojo-props="tabPosition:\'bottom\', selectedchild:\'btab3\', tabStrip:true" >\r\n\t\t\t\t\t<div data-dojo-type="dijit/layout/ContentPane" title="\u73b0\u91d1\u6d41\u5206\u5e03\u56fe" data-dojo-props="selected:true">\r\n\t\t\t\t\t\t<div data-dojo-attach-point="bars" style="height:100%;"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t        <div data-dojo-type="dijit/layout/ContentPane" title="\u73b0\u91d1\u6d41\u660e\u7ec6" >\r\n\t\t\t        \t<div data-dojo-attach-point="container2" data-dojo-type="dijit/layout/ContentPane" style="height:100%;"></div>\r\n\t\t\t        </div>\r\n\t\t\t    </div>\r\n\t\t    </div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n',
"bond/bondPortfolio/view/topbar":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dojo/_base/array,dojo/_base/lang,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/i18n!../nls/src,dojo/text!./topbar.html".split(","),function(h,e,j,o,w,u,E,y,v,K,F){return h("bond.bondPortfolio.view.topbar",[e,j,o],{templateString:F,postMixInProperties:function(){this.inherited(arguments);u.mixin(this,K)}})})},"url:bond/bondPortfolio/view/topbar.html":'<div data-dojo-attach-point="containerNode" class="hbox dijitTopBar">\n\t<div class="spacer"></div>\n\t<div style="line-height: 25px;">\u503a\u5238\u7ec4\u5408\u7ba1\u7406</div>\n</div>',
"bond/bondPortfolio/view/treeNavigation":function(){define("dojo/_base/declare,dijit/registry,dijit/Menu,dijit/MenuItem,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/_base/lang,dojo/_base/array,dojo/_base/event,dojo/on,dojo/dom-class,dojo/dom-attr,dojo/text!./treeNavigation.html,dojo/data/ItemFileWriteStore,dojox/widget/Standby,dojox/store/WebSocket,dojox/store/GridWSStore,dojo/dom,bond/bondPortfolio/view/groupManagerForGroup,dojox/store/LocalStorage,bond/bondPortfolio/view/_helper/MessageDialog".split(","),
function(h,e,j,o,w,u,E,y,v,K,F,da,R,S,U,Q,V,W,O,P,M,C,G){return h("bond.bondPortfolio.view.treeNavigation",[w,u,E,y],{templateString:U,postCreate:function(){localStore=new C({idProperty:"id",namespace:"bondPortfolio"});localStore.put({id:"check",name:0})},startup:function(){this.inherited(arguments);cStore=e.byId("mytree2").model.store;e.byId("mytree2").on("click",v.hitch(this,this.openRight));this.openDefault()},openDefault:function(){mytopContentPaneGrid.setContent(new M)},openRight:function(e){var d=
new C({idProperty:"id",namespace:"bondPortfolio"});null!=d.get("timedTask")&&window.clearInterval(d.get("timedTask").name);var c=mytopContentPaneGrid.domNode.childNodes.item().id.slice(24),c=c.slice(0,c.indexOf(c.split("_")[c.split("_").length-1])-1),h=e.cls[0].split("/")[3];if(c!=h)d=d.get("check").name,"bondGrp_adjust"==c&&1==d?((new G).showDialog("\u6301\u4ed3\u53d8\u52a8\u672a\u4fdd\u5b58\uff01"),dijit.byId("mytree2").set("path",targetNode)):require(e.cls,function(c){mytopContentPaneGrid.setContent(new c)})}})})},
"url:bond/bondPortfolio/view/treeNavigation.html":'<div data-dojo-attach-point="containerNode">\r\n\t<div data-dojo-type="dijit/layout/ContentPane" style="width:100%;height: 100%;background:white">\r\n\t\t\t<div data-dojo-type="dijit/layout/ContentPane" data-dojo-props=\'selected:true\'>\r\n\r\n\t\t\t\t\t<div data-dojo-type="dijit/layout/ContentPane"><\!-- \u8fd9\u91cc\u52a0ContentPane\u9632\u6b62\u6811\u7684\u5c55\u5f00\u5f71\u54cd\u4e0a\u5c42\u7684ContentPane--\>\r\n\t\t\t\t\t\t<div data-dojo-type="dojo/data/ItemFileWriteStore" data-dojo-id="continentStore2"\r\n\t\t\t\t\t\t\t\t  data-dojo-props="url:\'./resources/treeData.json\'"></div>\r\n\t\t\t\t\t\t<div data-dojo-type="dijit/tree/ForestStoreModel" data-dojo-id="continentModel2"\r\n\t\t\t\t\t\t\t\t  data-dojo-props="store:continentStore2, query:{type:\'level0\'},\r\n\t\t\t\t\t\t\t\t   childrenAttrs:[\'children\'],rootId:\'node\'"></div>\r\n\t\t\t\t\t\t<div data-dojo-type="dijit/Tree" id="mytree2"\r\n\t\t\t\t\t\t\t\tdata-dojo-props="model: continentModel2,openOnClick:true,path:[\'node\'],showRoot:false,autoExpand:true,showIcon:false">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t</div>\r\n</div>\t\t\t\t\r\n',
"*now":function(h){h(['dojo/i18n!*preload*bond/bondPortfolio/nls/src*["en-us","zh-cn","ROOT"]'])}}});
define("bond/bondPortfolio/src","dojo/parser,dojo/dom-style,bond/bondPortfolio/view/_helper/CustomKeyboardSpirit,bond/bondPortfolio/view/_helper/MCheckedMultiSelect,bond/bondPortfolio/view/groupManagerForGroup,bond/bondPortfolio/view/bondGrp_adjust,bond/bondPortfolio/view/bondGrp_adjustHis,bond/bondPortfolio/view/bondGrp_Mon_Cha_O,bond/bondPortfolio/view/bondGrp_Mon_Dis,bond/bondPortfolio/view/bondGrp_Mon_realT,bond/bondPortfolio/view/bondGrp_Mon_CashF,bond/bondPortfolio/view/topbar,bond/bondPortfolio/view/treeNavigation".split(","),function(h){return function(){h.parse().then(function(){})}});