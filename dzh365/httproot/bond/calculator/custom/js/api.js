var debug_url="";var bond_code="";var pay_type=0;var type=0;var bond_name="";var market="";var splitterHeight=$("#tab-splitter").height();var tabMainHeight_Initial=$("#tab-main").height();var tabMainHeight_Normal=tabMainHeight_Initial;var tabSecondaryHeight_Normal="-webkit-calc( 100% - "+tabMainHeight_Normal+"px - "+splitterHeight+"px )";var tabSecondaryHeight_Temp;var distance=0;var ZZDGZ_trade_date_prefix="ZZDGZ_trade_date_";var ZZDGZ_settlement_way_prefix="ZZDGZ_settlement_way_";var ZZDGZ_pay_date_prefix="ZZDGZ_pay_date_";var LSHS_trade_date_prefix="LSHS_trade_date_";var LSHS_settlement_way_prefix="LSHS_settlement_way_";var LSHS_pay_date_prefix="LSHS_pay_date_";var JSHS_trade_date_prefix="JSHS_trade_date_";var JSHS_settlement_way_prefix="JSHS_settlement_way_";var JSHS_pay_date_prefix="JSHS_pay_date_";var datatable_JBZL=null;var datatable_XJL=null;var datatable_JRBJ_type_0=null;var datatable_JRBJ_type_1=null;var datatable_JRHQ=null;var datatable_JYYLSHQ=null;var datatable_JYYZZDGZ=null;var datatable_SSJG_0=null;var datatable_SSJG_1=null;var datatable_SSJG_2=null;var datatable_SSJG_3=null;var JBZL_Array=[[["债券代码","--","债券简称","--"],["上市市场","--","发行价","--"],["起息日","--","到期日","--"],["发行年限","--","票面利率","--"],["下一次付息日","--","年付息次数","--"],["距离下次付息(天)","--","每年付息日","--"],["发行规模(亿元)","--","剩余年限(年)","--"],["票面利率","--","最新债券评级","--"]],[["债券代码","--","债券简称","--"],["上市市场","--","发行价","--"],["起息日","--","到期日","--"],["基准利率类型","--","基本利差","--"],["基准利率","--","票面利率","--"],["发行年限","--","年付息次数","--"],["下一次付息日","--","距离下次付息(天)","--"],["每年付息日","--","发行规模(亿元)","--"],["最新债券评级","--","最新主体评级","--"]],[["债券代码","--","债券简称","--"],["上市市场","--","发行价","--"],["起息日","--","到期日","--"],["发行年限","--","票面利率","--"],["下一次付息日","--","年付息次数","--"],["距离下次付息(天)","--","每年付息日","--"],["发行规模(亿元)","--","剩余年限(年)","--"],["最新债券评级","--","最新主体评级","--"],["首次赎回日","--","首次回售日","--"],["赎回价格","--","回售价格","--"],["赎回条款","--","回售条款","--"],["利率条款","--","票面利率选择权条款","--"]],[["债券代码","--","债券简称","--"],["上市市场","--","发行价","--"],["起息日","--","到期日","--"],["基准利率类型","--","基本利差","--"],["基准利率","--","票面利率","--"],["发行年限","--","年付息次数","--"],["下一次付息日","--","距离下次付息(天)","--"],["发行规模(亿元)","--","剩余年限(年)","--"],["最新债券评级","--","最新主体评级","--"],["每年付息日","--","",""],["首次赎回日","--","首次回售日","--"],["赎回价格","--","回售价格","--"],["赎回条款","--","回售条款","--"],["利率条款","--","票面利率选择权条款","--"]]];var XJL_Array=[];for(var i=0;i<14;i++){XJL_Array.push({date:"",interest:"",principal:"",cashFlow:""})}var JRBJ_Array_type_0=[];var JRBJ_Array_type_1=[];var JRHQ_Array_type_0=[];var JRHQ_Array_type_1=[];var JYYLSHQ_Array=[];var JYYZZDGZ_Array=[];var SSJG_Array_0=[];var SSJG_Array_1=[];var SSJG_Array_2=[];var SSJG_Array_3=[];var LSHS_default_html=["<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>","<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>"];var JSHS_default_html=['<tr><td><input type="radio"name="convert_type"value="netPrice"><input id="netPrice_0"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td id="accruedInterest_0">--</td></tr><tr><td><input type="radio"name="convert_type"value="fullPrice"><input id="fullPrice_0"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY4"><input id="bondYieldY4_0"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY1"><input id="bondYieldY1_0"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY3"><input id="bondYieldY3_0"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td id="msDuration_0">--</td></tr><tr><td id="xzDuration_0">--</td></tr><tr><td id="convexity_0">--</td></tr><tr><td id="basePointValue_0">--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><input type="radio"name="convert_type"value="netPrice"><input id="netPrice_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td id="accruedInterest_1">--</td></tr><tr><td><input type="radio"name="convert_type"value="fullPrice"><input id="fullPrice_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY4"><input id="bondYieldY4_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY1"><input id="bondYieldY1_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY3"><input id="bondYieldY3_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="interestMarginBP"><input id="interestMarginBP_1"type="text"class="unified-item rounded item-special"value=""></td></tr><tr><td id="marginDuration_1">--</td></tr><tr><td id="marginConvexity_1">--</td></tr><tr><td id="rateDuration_1">--</td></tr><tr><td id="rateConvexity_1">--</td></tr><tr><td id="basePointValue_1">--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><input type="radio"name="convert_type"value="netPrice"><input type="text"id="netPrice_2"class="unified-item rounded item-special"value=""></td></tr><tr><td id="accruedInterest_2">--</td></tr><tr><td><input type="radio"name="convert_type"value="fullPrice"><input type="text"id="fullPrice_2"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY4"><input type="text"id="bondYieldY4_2"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY1"><input type="text"id="bondYieldY1_2"class="unified-item rounded item-special"value=""></td></tr><tr><td id="msDuration_2">--</td></tr><tr><td id="xzDuration_2">--</td></tr><tr><td id="convexity_2">--</td></tr><tr><td id="basePointValue_2">--</td></tr><tr><td><input type="radio"name="convert_type"value="exerciseBondYieldY8"><input type="text"id="exerciseBondYieldY8_2"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="exerciseBondYieldY5"><input type="text"id="exerciseBondYieldY5_2"class="unified-item rounded item-special"value=""></td></tr><tr><td id="exerciseMacaulayDuration_2">--</td></tr><tr><td id="exerciseCorrectDuration_2">--</td></tr><tr><td id="exerciseConvexity_2">--</td></tr><tr><td id="exerciseBasePointValue_2">--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><input type="radio"name="convert_type"value="netPrice"><input type="text"id="netPrice_3"class="unified-item rounded item-special"value=""></td></tr><tr><td id="accruedInterest_3">--</td></tr><tr><td><input type="radio"name="convert_type"value="fullPrice"><input type="text"id="fullPrice_3"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY4"><input type="text"id="bondYieldY4_3"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="bondYieldY1"><input type="text"id="bondYieldY1_3"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="interestMarginBP"><input type="text"id="interestMarginBP_3"class="unified-item rounded item-special"value=""></td></tr><tr><td id="marginDuration_3">--</td></tr><tr><td id="marginConvexity_3">--</td></tr><tr><td id="rateDuration_3">--</td></tr><tr><td id="rateConvexity_3">--</td></tr><tr><td id="basePointValue_3">--</td></tr><tr><td><input type="radio"name="convert_type"value="exerciseBondYieldY8"><input type="text"id="exerciseBondYieldY8_3"class="unified-item rounded item-special"value=""></td></tr><tr><td><input type="radio"name="convert_type"value="exerciseBondYieldY5"><input type="text"id="exerciseBondYieldY5_3"class="unified-item rounded item-special"value=""></td></tr><tr><td id="exerciseInterestMarginY5_3">--</td></tr><tr><td id="exerciseMarginDuration_3">--</td></tr><tr><td id="exerciseMarginConvexity_3">--</td></tr><tr><td id="exerciseRateDuration_3">--</td></tr><tr><td id="exerciseRateConvexity_3">--</td></tr><tr><td id="exerciseBasePointValue_3">--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>'];var no_permission='<span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span>';var has_permission=false;var has_checked=false;var ZZDGZ_default_html=["<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>","<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>","<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>","<tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td>--</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>"];if(window.external.getDZHProperty){var userid=window.external.getDZHProperty("userid");var codeBase=btoa('{"username" : "'+userid+'", "moduleid" : "612", "dataid" : "2"}');var url="service=rpc&so=jso-all-bondpermissions.jar&function=gw.sh.func.BondPermissionsRequest&paraencode=base64&parameter="+codeBase+"&response_times=1&response_mode=0";Socket.send(url,function(a){if(a.results!=null){has_permission=true}else{has_permission=false;ZZDGZ_default_html=['<tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission"title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>','<tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td><span class="no_permission" title="没有权限，若想查看，请联系您的客户经理！"></span></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>']}has_checked=true;if(pay_type==0){set_ZZDGZ_0()}else{if(pay_type==1){set_ZZDGZ_1()}else{if(pay_type==2){set_ZZDGZ_TJ_2();set_ZZDGZ_FTJ_2()}else{if(pay_type==3){set_ZZDGZ_TJ_3();set_ZZDGZ_FTJ_3()}}}}})}var xls_name="大智慧数据导出";var xls_header='<html xmlns:x="urn:schemas-microsoft-com:office:excel"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>'+xls_name+'</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type"content="text/html; charset=gbk"><style>.text{font-family:Arial;font-size:10pt;mso-number-format:"@"}</style></head><body>';var xls_footer="</body></html>";var XJL_Array_xls=[];var JRBJ_Array_type_0_xls=[];var JRBJ_Array_type_1_xls=[];var JRHQ_Array_xls=[];var JYYLSHQ_Array_xls=[];var JYYZZDGZ_Array_xls=[];var SSJG_Array_xls_0=[];var SSJG_Array_xls_1=[];var SSJG_Array_xls_2=[];var SSJG_Array_xls_3=[];var JBZL_cols=[{col1:"债券代码全称",col2:"债券代码",col3:"债券简称",col4:"上市市场",col5:"发行价",col6:"起息日",col7:"到期日",col8:"发行年限",col9:"票面利率",col10:"下一次付息日",col11:"年付息次数",col12:"距离下次付息(天)",col13:"每年付息日",col14:"发行规模(亿元)",col15:"剩余年限(年)",col16:"最新债券评级",col17:"最新主体评级"},{col1:"债券代码全称",col2:"债券代码",col3:"债券简称",col4:"上市市场",col5:"发行价",col6:"起息日",col7:"到期日",col8:"基准利率类型",col9:"基本利差",col10:"基准利率",col11:"票面利率",col12:"发行年限",col13:"年付息次数",col14:"下一次付息日",col15:"距离下次付息(天)",col17:"发行规模(亿元)",col18:"剩余年限",col19:"最新债券评级",col20:"最新主体评级",col21:"每年付息日"},{col1:"债券代码全称",col2:"债券代码",col3:"债券简称",col4:"上市市场",col5:"发行价",col6:"起息日",col7:"到期日",col8:"发行年限",col9:"票面利率",col10:"下一次付息日",col11:"年付息次数",col12:"距离下次付息(天)",col13:"每年付息日",col14:"发行规模(亿元)",col15:"剩余年限(年)",col16:"最新债券评级",col17:"最新主体评级",col18:"首次赎回日",col19:"首次回售日",col20:"赎回价格",col21:"回售价格",col22:"赎回条款",col23:"回售条款",col24:"利率条款",col25:"票面利率选择权条款"},{col1:"债券代码全称",col2:"债券代码",col3:"债券简称",col4:"上市市场",col5:"发行价",col6:"起息日",col7:"到期日",col8:"基准利率类型",col9:"基本利差",col10:"基准利率",col11:"票面利率",col12:"发行年限",col13:"年付息次数",col14:"下一次付息日",col15:"距离下次付息(天)",col16:"发行规模(亿元)",col17:"剩余年限(年)",col18:"最新债券评级",col19:"最新主体评级",col20:"每年付息日",col21:"首次赎回日",col22:"首次回售日",col23:"赎回价格",col24:"回售价格",col25:"赎回条款",col26:"回售条款",col27:"利率条款",col28:"票面利率选择权条款"}];$("#search_txt").focus(function(){if($(this).prop("value")=="请输入债券代码或简称..."){$(this).css("color","#000");$(this).prop("value","")}});$("#search_txt").autocomplete("searchKeyWordsUrl",{minChars:0,delay:300,cacheLength:500,max:20,minWidth:281,scrollHeight:300,websocket:true,matchCase:true,matchContains:false,websocketType:"jg",extraParams:{v:function(){return $("#search_txt").val()}},matchContains:false,websocketOption:"opt",formatItem:function(a){return'<span id="'+a.bondCode+'">'+a.code+"　"+a.bondName+"　"+a.market+"　"+a.payType+"</span>"},createUrlFun:function(a){a=a.toUpperCase();a=$.trim(a);return encodeURI(debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCodeBySolr.dzh?param="+a)}}).result(function(a,b){removeRowBg();$("#search_txt").css("color","#000");datatable_JBZL=$("#datatable_JBZL").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JBZL_Array[b.payTypeInt]});datatable_JBZL.fnAdjustColumnSizing();if(datatable_XJL!=null){datatable_XJL.fnClearTable()}if(datatable_JRBJ_type_0!=null){datatable_JRBJ_type_0.fnClearTable()}if(datatable_JRBJ_type_1!=null){datatable_JRBJ_type_1.fnClearTable()}if(datatable_JRHQ!=null){datatable_JRHQ.fnClearTable()}if(datatable_JYYLSHQ!=null){datatable_JYYLSHQ.fnClearTable()}if(datatable_JYYZZDGZ!=null){datatable_JYYZZDGZ.fnClearTable()}XJL_Array_xls=[];JRBJ_Array_type_0_xls=[];JRBJ_Array_type_1_xls=[];JRHQ_Array_xls=[];JYYLSHQ_Array_xls=[];JYYZZDGZ_Array_xls=[];SSJG_Array_xls_0=[];SSJG_Array_xls_1=[];SSJG_Array_xls_2=[];SSJG_Array_xls_3=[];switch(b.payTypeInt){case"0":$("#conversion-0").show();$("#conversion-1, #conversion-2, #conversion-3").hide();$("#SSJG_0").css({visibility:"visible",height:"100%"});$("#SSJG_1, #SSJG_2, #SSJG_3").css({visibility:"hidden",height:"0"});break;case"1":$("#conversion-1").show();$("#conversion-0, #conversion-2, #conversion-3").hide();$("#SSJG_1").css({visibility:"visible",height:"100%"});$("#SSJG_0, #SSJG_2, #SSJG_3").css({visibility:"hidden",height:"0"});break;case"2":$("#conversion-2").show();$("#conversion-0, #conversion-1, #conversion-3").hide();$("#SSJG_2").css({visibility:"visible",height:"100%"});$("#SSJG_0, #SSJG_1, #SSJG_3").css({visibility:"hidden",height:"0"});break;case"3":$("#conversion-3").show();$("#conversion-0, #conversion-1, #conversion-2").hide();$("#SSJG_3").css({visibility:"visible",height:"100%"});$("#SSJG_0, #SSJG_1, #SSJG_2").css({visibility:"hidden",height:"0"});break}$(".item-date").val("");if(b.type==0){$("#JRBJ_type_1_xls").hide();$("#JRBJ_type_0_xls").show();$("#JRBJ_type_0").css("height","100%");$("#JRBJ_type_1").css("height","0")}else{if(b.type==1){$("#JRBJ_type_0_xls").hide();$("#JRBJ_type_1_xls").show();$("#JRBJ_type_0").css("height","0");$("#JRBJ_type_1").css("height","100%")}}bond_code=b.bondCode;pay_type=b.payTypeInt;type=b.type;bond_name=b.bondName;market=b.market;$("#search_txt").val(b.code+"　"+b.bondName+"　"+b.market+"　"+b.payType);$("#JSHS_trade_date_"+b.payTypeInt).datepicker("setDate",new Date());set_JSR($("#"+JSHS_settlement_way_prefix+b.payTypeInt).val(),$("#"+JSHS_trade_date_prefix+b.payTypeInt).val(),JSHS_pay_date_prefix+b.payTypeInt);$("#"+ZZDGZ_trade_date_prefix+b.payTypeInt).val("");if(b.payTypeInt==0||b.payTypeInt==1){$("#ZZDGZ_default_"+b.payTypeInt).html(ZZDGZ_default_html[b.payTypeInt])}else{if(b.payTypeInt==2||b.payTypeInt==3){$("#ZZDGZ_default_TJ_"+b.payTypeInt).html(ZZDGZ_default_html[b.payTypeInt]);$("#ZZDGZ_default_FTJ_"+b.payTypeInt).html(ZZDGZ_default_html[b.payTypeInt])}}$("#LSHS_default_"+b.payTypeInt).html(LSHS_default_html[b.payTypeInt]);$("#JSHS_default_"+b.payTypeInt).html(JSHS_default_html[b.payTypeInt]);JSHS_blur();set_JRBJ_JRHQ();set_JYYLSHQ();set_JYYZZDGZ();set_JBZL();set_XJL();set_LSHS();if(b.payTypeInt==0){set_ZZDGZ_0()}else{if(b.payTypeInt==1){set_ZZDGZ_1()}else{if(b.payTypeInt==2){set_ZZDGZ_TJ_2();set_ZZDGZ_FTJ_2()}else{if(b.payTypeInt==3){set_ZZDGZ_TJ_3();set_ZZDGZ_FTJ_3()}}}}if(b.payTypeInt==0){$("#tab-main").height(371);$("#tab-secondary").height("-webkit-calc(100% - 371px - 6px)");tabMainHeight_Initial=371;tabMainHeight_Normal=371}else{if(b.payTypeInt==1){$("#tab-main").height(420);$("#tab-secondary").height("-webkit-calc(100% - 420px - 6px)");tabMainHeight_Initial=420;tabMainHeight_Normal=420}else{if(b.payTypeInt==2){$("#tab-main").height(480);$("#tab-secondary").height("-webkit-calc(100% - 480px - 6px)");tabMainHeight_Initial=480;tabMainHeight_Normal=480}else{if(b.payTypeInt==3){$("#tab-main").height(550);$("#tab-secondary").height("-webkit-calc(100% - 550px - 6px)");tabMainHeight_Initial=550;tabMainHeight_Normal=550}}}}distance=0;tabSecondaryHeight_Temp=undefined;tabSecondaryHeight_Normal="-webkit-calc( 100% - "+tabMainHeight_Normal+"px - "+splitterHeight+"px )";addRowBg();select_radio()});$("#search_select").click(function(){$("#search_txt").focus();$("#search_txt").trigger("keydown");$("#search_txt").css("color","#000");$("#search_txt").val("");$("#search_txt").trigger("click")});$("#search_txt").click(function(){this.select()});function set_JSR(a,d,c){a=a!=undefined?a:1;d=d!=undefined?d.replace(/-/g,""):"";var b=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondPayDate.dzh?type="+a+"&tdata="+d;Socket.send(b,function(f){if(f.results!=null&&f.results.length>0){var e=f.results[0];$("#"+c).html(e.col1.replace(/\//g,"-"))}})}function set_ZZDGZ_0(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfo.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<10;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_单利(%)"]+"</td></tr>");c.push("<tr><td>"+e["麦氏久期"]+"</td></tr>");c.push("<tr><td>"+e["修正久期"]+"</td></tr>");c.push("<tr><td>"+e["凸性"]+"</td></tr>");c.push("<tr><td>"+e["基点价值"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_"+pay_type).html(f);addRowBg()})}function set_ZZDGZ_1(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfo.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<12;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_单利(%)"]+"</td></tr>");c.push("<tr><td>"+e["有效利差(BP)_复利"]+"</td></tr>");c.push("<tr><td>"+e["利差久期"]+"</td></tr>");c.push("<tr><td>"+e["利差凸性"]+"</td></tr>");c.push("<tr><td>"+e["利率久期"]+"</td></tr>");c.push("<tr><td>"+e["利率凸性"]+"</td></tr>");c.push("<tr><td>"+e["利差基点价值(元)"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_"+pay_type).html(f);addRowBg()})}function set_ZZDGZ_TJ_2(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+"TJ_"+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfoForRmd.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+"TJ_"+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+"TJ_"+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+"TJ_"+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<15;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期麦氏久期"]+"</td></tr>");c.push("<tr><td>"+e["到期修正久期"]+"</td></tr>");c.push("<tr><td>"+e["到期凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期基点价值(元)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权麦氏久期"]+"</td></tr>");c.push("<tr><td>"+e["行权修正久期"]+"</td></tr>");c.push("<tr><td>"+e["行权凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权基点价值"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_TJ_"+pay_type).html(f);addRowBg()})}function set_ZZDGZ_FTJ_2(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+"FTJ_"+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfoForNotRmd.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+"FTJ_"+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+"FTJ_"+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+"FTJ_"+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<15;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期麦氏久期"]+"</td></tr>");c.push("<tr><td>"+e["到期修正久期"]+"</td></tr>");c.push("<tr><td>"+e["到期凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期基点价值(元)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权麦氏久期"]+"</td></tr>");c.push("<tr><td>"+e["行权修正久期"]+"</td></tr>");c.push("<tr><td>"+e["行权凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权基点价值"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_FTJ_"+pay_type).html(f);addRowBg()})}function set_ZZDGZ_TJ_3(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+"TJ_"+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfoForRmd.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+"TJ_"+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+"TJ_"+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+"TJ_"+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<19;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期有效利差(BP)_复利"]+"</td></tr>");c.push("<tr><td>"+e["到期利差久期"]+"</td></tr>");c.push("<tr><td>"+e["到期利差凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期利率久期"]+"</td></tr>");c.push("<tr><td>"+e["到期利率凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期利差基点价值"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权有效利差(BP)_复利"]+"</td></tr>");c.push("<tr><td>"+e["行权利差久期"]+"</td></tr>");c.push("<tr><td>"+e["行权利差凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权利率久期"]+"</td></tr>");c.push("<tr><td>"+e["行权利率凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权利差基点价值"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_TJ_"+pay_type).html(f);addRowBg()})}function set_ZZDGZ_FTJ_3(){var b="";b=$("#"+ZZDGZ_trade_date_prefix+"FTJ_"+pay_type).val();b=b!=""&&b!=undefined?b.replace(/-/g,"")+"000000":"";var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondCBDInfoForNotRmd.dzh?bondCode="+bond_code+"&tradeDate="+b+"&payType="+pay_type;Socket.send(a,function(g){var f=ZZDGZ_default_html[pay_type];var e=[];if(g.results!=null&&g.results.length>0){e=g.results[0];if(b==""){$("#"+ZZDGZ_trade_date_prefix+"FTJ_"+pay_type).val(format_date(e["交易日"]))}$("#"+ZZDGZ_settlement_way_prefix+"FTJ_"+pay_type).html(e["计算方式"]);$("#"+ZZDGZ_pay_date_prefix+"FTJ_"+pay_type).html(e["结算日"]);if(has_checked==true&&has_permission==false){var f="";var c=[];for($i=0;$i<19;$i++){c.push("<tr><td>"+no_permission+"</td></tr>")}c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}else{if(has_checked==true&&has_permission==true){var f="";var c=[];c.push("<tr><td>"+e["净价"]+"</td></tr>");c.push("<tr><td>"+e["应计利息"]+"</td></tr>");c.push("<tr><td>"+e["全价"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["到期有效利差(BP)_复利"]+"</td></tr>");c.push("<tr><td>"+e["到期利差久期"]+"</td></tr>");c.push("<tr><td>"+e["到期利差凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期利率久期"]+"</td></tr>");c.push("<tr><td>"+e["到期利率凸性"]+"</td></tr>");c.push("<tr><td>"+e["到期利差基点价值"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_央行(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权收益率_复利(%)"]+"</td></tr>");c.push("<tr><td>"+e["行权有效利差(BP)_复利"]+"</td></tr>");c.push("<tr><td>"+e["行权利差久期"]+"</td></tr>");c.push("<tr><td>"+e["行权利差凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权利率久期"]+"</td></tr>");c.push("<tr><td>"+e["行权利率凸性"]+"</td></tr>");c.push("<tr><td>"+e["行权利差基点价值"]+"</td></tr>");c.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=c.join("");c=[]}}}$("#ZZDGZ_default_FTJ_"+pay_type).html(f);addRowBg()})}$("#"+ZZDGZ_trade_date_prefix+"0").bind("change",function(){set_ZZDGZ_0()});$("#"+ZZDGZ_trade_date_prefix+"1").bind("change",function(){set_ZZDGZ_1()});$("#"+ZZDGZ_trade_date_prefix+"TJ_2").bind("change",function(){set_ZZDGZ_TJ_2()});$("#"+ZZDGZ_trade_date_prefix+"FTJ_2").bind("change",function(){set_ZZDGZ_FTJ_2()});$("#"+ZZDGZ_trade_date_prefix+"TJ_3").bind("change",function(){set_ZZDGZ_TJ_3()});$("#"+ZZDGZ_trade_date_prefix+"FTJ_3").bind("change",function(){set_ZZDGZ_FTJ_3()});function set_LSHS(){if(pay_type==0||pay_type==1){var c="";var a=1;c=$("#"+LSHS_trade_date_prefix+pay_type).val();c=c!=""&&c!=undefined?c.replace(/-/g,""):"";a=$("#"+LSHS_settlement_way_prefix+pay_type).val();a=a!=""&&a!=undefined?a:1;var b=debug_url+"/bond/bondCounter/bondComplexCalcController/getHistoryConvertForGXAndFX.dzh?secode="+bond_code+"&tradeDate="+c+"&settlementWay="+a+"&payType="+pay_type;Socket.send(b,function(g){var f=JSHS_default_html[pay_type];if(g.results!=null&&g.results.length>0){var h=g.results[0];if(c==""){$("#"+LSHS_trade_date_prefix+pay_type).val(format_date(h.tradeDate))}set_JSR($("#"+LSHS_settlement_way_prefix+pay_type).val(),$("#"+LSHS_trade_date_prefix+pay_type).val(),LSHS_pay_date_prefix+pay_type);if(pay_type==0){var f="";var e=[];e.push("<tr><td>"+h.netPrice+"</td></tr>");e.push("<tr><td>"+h.accruedInterest+"</td></tr>");e.push("<tr><td>"+h.fullPrice+"</td></tr>");e.push("<tr><td>"+h.bondYieldY1+"</td></tr>");e.push("<tr><td>"+h.bondYieldY4+"</td></tr>");e.push("<tr><td>"+h.bondYieldY3+"</td></tr>");e.push("<tr><td>"+h.msDuration+"</td></tr>");e.push("<tr><td>"+h.xzDuration+"</td></tr>");e.push("<tr><td>"+h.convexity+"</td></tr>");e.push("<tr><td>"+h.basePointValue+"</td></tr>");e.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=e.join("");e=[]}else{if(pay_type==1){var f="";var e=[];e.push("<tr><td>"+h.netPrice+"</td></tr>");e.push("<tr><td>"+h.accruedInterest+"</td></tr>");e.push("<tr><td>"+h.fullPrice+"</td></tr>");e.push("<tr><td>"+h.bondYieldY1+"</td></tr>");e.push("<tr><td>"+h.bondYieldY4+"</td></tr>");e.push("<tr><td>"+h.bondYieldY3+"</td></tr>");e.push("<tr><td>"+h.interestMarginBP+"</td></tr>");e.push("<tr><td>"+h.marginDuration+"</td></tr>");e.push("<tr><td>"+h.marginConvexity+"</td></tr>");e.push("<tr><td>"+h.rateDuration+"</td></tr>");e.push("<tr><td>"+h.rateConvexity+"</td></tr>");e.push("<tr><td>"+h.basePointValue+"</td></tr>");e.push("<tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr>");f=e.join("");e=[]}}$("#LSHS_default_"+pay_type).html(f);addRowBg()}})}}$("#"+LSHS_trade_date_prefix+"0, #"+LSHS_trade_date_prefix+"1").bind("change",function(){set_LSHS();set_JSR($("#"+LSHS_settlement_way_prefix+pay_type).val(),$(this).val(),LSHS_pay_date_prefix+pay_type)});$("#"+LSHS_settlement_way_prefix+"0, #"+LSHS_settlement_way_prefix+"1").bind("change",function(){set_LSHS();set_JSR($(this).val(),$("#"+LSHS_trade_date_prefix+pay_type).val(),LSHS_pay_date_prefix+pay_type)});function set_JSHS(){var e="";var b=1;var d="";var a="";e=$("#"+JSHS_trade_date_prefix+pay_type).val();e=e!=""&&e!=undefined?e.replace(/-/g,""):"";b=$("#"+JSHS_settlement_way_prefix+pay_type).val();b=b!=""&&b!=undefined?b:1;d=$("#conversion-"+pay_type+" input[type='radio']:checked").val();d=d!=""&&d!=undefined?d:"";a=$("#"+d+"_"+pay_type).val();a=a!=""&&a!=undefined?a:"";var c=debug_url+"/bond/bondCounter/bondComplexCalcController/getSupposeConvert.dzh?secode="+bond_code+"&tradeDate="+e+"&settlementWay="+b+"&convertType="+d+"&convertValue="+a+"&payType="+pay_type;Socket.send(c,function(g){if(g.results!=null&&g.results.length>0){var f=g.results[0];if(pay_type==0){$("#netPrice_"+pay_type).val(f.netPrice);$("#accruedInterest_"+pay_type).html(f.accruedInterest);$("#fullPrice_"+pay_type).val(f.fullPrice);$("#bondYieldY4_"+pay_type).val(f.bondYieldY4);$("#bondYieldY1_"+pay_type).val(f.bondYieldY1);$("#bondYieldY3_"+pay_type).val(f.bondYieldY3);$("#msDuration_"+pay_type).html(f.msDuration);$("#xzDuration_"+pay_type).html(f.xzDuration);$("#convexity_"+pay_type).html(f.convexity);$("#basePointValue_"+pay_type).html(f.basePointValue)}else{if(pay_type==1){$("#netPrice_"+pay_type).val(f.netPrice);$("#accruedInterest_"+pay_type).html(f.fullPrice);$("#fullPrice_"+pay_type).val(f.accruedInterest);$("#bondYieldY4_"+pay_type).val(f.bondYieldY4);$("#bondYieldY1_"+pay_type).val(f.bondYieldY1);$("#bondYieldY3_"+pay_type).val(f.bondYieldY3);$("#interestMarginBP_"+pay_type).val(f.interestMarginBP);$("#marginDuration_"+pay_type).html(f.marginDuration);$("#marginConvexity_"+pay_type).html(f.marginConvexity);$("#rateDuration_"+pay_type).html(f.rateDuration);$("#rateConvexity_"+pay_type).html(f.rateConvexity);$("#basePointValue_"+pay_type).html(f.basePointValue)}else{if(pay_type==2){$("#netPrice_"+pay_type).val(f.netPrice);$("#accruedInterest_"+pay_type).html(f.accruedInterest);$("#fullPrice_"+pay_type).val(f.fullPrice);$("#bondYieldY4_"+pay_type).val(f.bondYieldY4);$("#bondYieldY1_"+pay_type).val(f.bondYieldY1);$("#msDuration_"+pay_type).html(f.msDuration);$("#xzDuration_"+pay_type).html(f.xzDuration);$("#convexity_"+pay_type).html(f.convexity);$("#basePointValue_"+pay_type).html(f.basePointValue);$("#exerciseBondYieldY8_"+pay_type).val(f.exerciseBondYieldY8);$("#exerciseBondYieldY5_"+pay_type).val(f.exerciseBondYieldY5);$("#exerciseMacaulayDuration_"+pay_type).html(f.exerciseMacaulayDuration);$("#exerciseCorrectDuration_"+pay_type).html(f.exerciseCorrectDuration);$("#exerciseConvexity_"+pay_type).html(f.exerciseConvexity);$("#exerciseBasePointValue_"+pay_type).html(f.exerciseBasePointValue)}else{if(pay_type==3){$("#netPrice_"+pay_type).val(f.netPrice);$("#accruedInterest_"+pay_type).html(f.fullPrice);$("#fullPrice_"+pay_type).val(f.accruedInterest);$("#bondYieldY4_"+pay_type).val(f.bondYieldY4);$("#bondYieldY1_"+pay_type).val(f.bondYieldY1);$("#interestMarginBP_"+pay_type).val(f.interestMarginBP);$("#marginDuration_"+pay_type).html(f.marginDuration);$("#marginConvexity_"+pay_type).html(f.marginConvexity);$("#rateDuration_"+pay_type).html(f.rateDuration);$("#rateConvexity_"+pay_type).html(f.rateConvexity);$("#basePointValue_"+pay_type).html(f.basePointValue);$("#exerciseBondYieldY8_"+pay_type).val(f.exerciseBondYieldY8);$("#exerciseBondYieldY5_"+pay_type).val(f.exerciseBondYieldY5);$("#exerciseInterestMarginY5_"+pay_type).html(f.exerciseInterestMarginY5);$("#exerciseMarginDuration_"+pay_type).html(f.exerciseMarginDuration);$("#exerciseMarginConvexity_"+pay_type).html(f.exerciseMarginConvexity);$("#exerciseRateDuration_"+pay_type).html(f.exerciseRateDuration);$("#exerciseRateConvexity_"+pay_type).html(f.exerciseRateConvexity);$("#exerciseBasePointValue_"+pay_type).html(f.exerciseBasePointValue)}}}}}})}function select_radio(){$('.data-left input[type="text"]').bind("focus",function(){$(this).prev().prop("checked",true)})}select_radio();$("#"+JSHS_trade_date_prefix+"0, #"+JSHS_trade_date_prefix+"1, #"+JSHS_trade_date_prefix+"2, #"+JSHS_trade_date_prefix+"3").bind("change",function(){set_JSHS();set_JSR($("#"+JSHS_settlement_way_prefix+pay_type).val(),$(this).val(),JSHS_pay_date_prefix+pay_type)});$("#"+JSHS_settlement_way_prefix+"0, #"+JSHS_settlement_way_prefix+"1, #"+JSHS_settlement_way_prefix+"2, #"+JSHS_settlement_way_prefix+"3").bind("change",function(){set_JSHS();set_JSR($(this).val(),$("#"+JSHS_trade_date_prefix+pay_type).val(),JSHS_pay_date_prefix+pay_type)});$(window).keydown(function(a){if(a.keyCode==13){$('.data-left input[name="convert_type"]:checked').next().trigger("blur")}});function JSHS_blur(){$('.data-left input[type="text"]').blur(function(){JSHS_cal()})}function JSHS_cal(){var b=$(".data-left input[name='convert_type']:checked");var c=b.val();var a=b.next().val();if(a==""){return false}switch(c){case"netPrice":case"fullPrice":if(a<0||a>200){alert("请输入 [0, 200] 区间内的价格");return false}break;case"bondYieldY4":case"bondYieldY1":case"bondYieldY3":case"exerciseBondYieldY8":case"exerciseBondYieldY5":if(a<-10||a>50){alert("请输入 [-10, 50] 区间内的收益率");return false}break}if(b.val()!=undefined){set_JSHS()}}function set_JBZL(){var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getBondBasicInfo.dzh?bondCode="+bond_code+"&payType="+pay_type;Socket.send(a,function(h){if(h.results!=null&&h.results.length>0){var n=[];var l=h.results[0];var g={};for(var e in l){if(e=="col1"){continue}if(e=="col4"){l[e]=market}if(pay_type==0){if(e=="col13"){if(l[e].length>14){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,14)+"...</span>"}}}else{if(pay_type==1){if(e=="col21"){if(l[e].length>14){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,14)+"...</span>"}}if(e=="col8"){if(l[e].length>7){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,7)+"...</span>"}}}else{if(pay_type==2){if(e=="col13"){if(l[e].length>14){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,14)+"...</span>"}}if(l[e]!=""&&(e=="col22"||e=="col23"||e=="col24"||e=="col25")){l[e]='<div id="dialog_'+e+"_"+pay_type+'" title="'+JBZL_cols[pay_type][e]+'" style="display:none;"><p>'+l[e]+'</p></div><a id="btn_dialog_'+e+"_"+pay_type+'">查看</a>'}if(e=="col19"){l[e]=l[e]}}else{if(pay_type==3){if(e=="col20"){if(l[e].length>14){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,14)+"...</span>"}}if(e=="col8"){if(l[e].length>7){l[e]='<span title="'+l[e]+'">'+l[e].substring(0,7)+"...</span>"}}if(l[e]!=""&&(e=="col25"||e=="col26"||e=="col27"||e=="col28")){l[e]='<div id="dialog_'+e+"_"+pay_type+'" title="'+JBZL_cols[pay_type][e]+'" style="display:none;"><p>'+l[e]+'</p></div><a id="btn_dialog_'+e+"_"+pay_type+'">查看</a>'}if(e=="col21"||e=="col22"){l[e]=l[e]}}}}}g[e]=l[e]}var b=0;for(var e in g){if(g[e]==""){g[e]="--"}b++}var f=0;var c=[];for(var e in g){c.push(JBZL_cols[pay_type][e],g[e]);if(pay_type==3&&e=="col20"){c.push("","");b++;f++}if(f%2==1){n.push(c);c=[]}else{if(f==b-1){c.push("","");n.push(c)}}f++}datatable_JBZL=$("#datatable_JBZL").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:n});n=[];$("#dialog_col22_2").dialog({autoOpen:false});$("#btn_dialog_col22_2").click(function(){$("#dialog_col22_2").dialog("open")});$("#dialog_col23_2").dialog({autoOpen:false});$("#btn_dialog_col23_2").click(function(){$("#dialog_col23_2").dialog("open")});$("#dialog_col24_2").dialog({autoOpen:false});$("#btn_dialog_col24_2").click(function(){$("#dialog_col24_2").dialog("open")});$("#dialog_col25_2").dialog({autoOpen:false});$("#btn_dialog_col25_2").click(function(){$("#dialog_col25_2").dialog("open")});$("#dialog_col25_3").dialog({autoOpen:false});$("#btn_dialog_col25_3").click(function(){$("#dialog_col25_3").dialog("open")});$("#dialog_col26_3").dialog({autoOpen:false});$("#btn_dialog_col26_3").click(function(){$("#dialog_col26_3").dialog("open")});$("#dialog_col27_3").dialog({autoOpen:false});$("#btn_dialog_col27_3").click(function(){$("#dialog_col27_3").dialog("open")});$("#dialog_col28_3").dialog({autoOpen:false});$("#btn_dialog_col28_3").click(function(){$("#dialog_col28_3").dialog("open")})}})}function set_XJL(){var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getCashFlow.dzh?secode="+bond_code+"&payType="+pay_type;Socket.send(a,function(f){if(f.results!=null){XJL_Array=[];XJL_Array=f.results!=null&&f.results.length>0?f.results:[];XJL_Array_xls=XJL_Array;var b=15;if(XJL_Array.length>15){b=XJL_Array.length-15+5}else{if(XJL_Array.length<15){b=15-XJL_Array.length+5}}for(var e=0;e<b;e++){if(pay_type==0||pay_type==2){XJL_Array.push({date:"",interest:"",principal:"",cashFlow:""})}else{if(pay_type==1||pay_type==3){XJL_Array.push({date:"",cashFlow:"",baseRate:"",couponRate:""})}}}var c=[];if(pay_type==0||pay_type==2){c=[{sTitle:"日期",mData:"date"},{sTitle:"利息",mData:"interest"},{sTitle:"本金",mData:"principal"},{sTitle:"现金流/百元",mData:"cashFlow"}]}else{if(pay_type==1||pay_type==3){c=[{sTitle:"日期",mData:"date"},{sTitle:"现金流/百元",mData:"cashFlow"},{sTitle:"基准利率(%)",mData:"baseRate"},{sTitle:"票面利率(%)",mData:"couponRate"}]}}datatable_XJL=$("#datatable_XJL").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:XJL_Array,aoColumns:c});XJL_Array=[]}})}function export_XJL(){if(XJL_Array_xls.length>0){if(window.external.saveas){var d=[];var c="债券现金流"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push("<thead>");d.push("<tr>");if(pay_type==0||pay_type==2){d.push("<td>日期</td>");d.push("<td>利息</td>");d.push("<td>本金</td>");d.push("<td>现金流/百元</td>")}else{if(pay_type==1||pay_type==3){d.push("<td>日期</td>");d.push("<td>现金流/百元</td>");d.push("<td>基准利率(%)</td>");d.push("<td>票面利率(%)</td>")}}d.push("</tr>");d.push("</thead>");d.push("<tbody>");for(var b=0;b<XJL_Array_xls.length;b++){d.push("<tr>");for(var a in XJL_Array_xls[b]){d.push("<td>"+XJL_Array_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#XJL_xls").bind("click",function(){export_XJL()});function set_JRBJ_JRHQ(){var b=bond_code.substring(0,bond_code.lastIndexOf(".")!=-1?bond_code.lastIndexOf("."):bond_code.length);if(type==0){var a="service=did&did=100211&where=obj="+bond_code+"&response_times=1";Socket.send(a,function(l){if(l.results!=null&&l.results.length>0&&l.results[0]["data"]["datas"].length>0){var c=l.results[0]["data"]["datas"];var e={};var n=l.results[0]["data"]["head"];var f=[];for(var k=0;k<c.length;k++){var m={};for(var h=0;h<c[k].length;h++){m[n[h]]=c[k][h]}f.push(m)}f.reverse();for(var k=0;k<f.length;k++){e.updateTime=format_time(f[k]["updateTime"]);e.buyinitiator=f[k]["buyinitiator"];e.JJ=format_number(f[k]["buyvol"]/10000,4);e.buyclean=format_number(f[k]["buyclean"],4);e.buyyield=format_number(f[k]["buyyield"],4);e.JJCE=format_number(f[k]["buyclean"]-f[k]["sellclean"],4);e.SYLCE=format_number((f[k]["buyyield"]-f[k]["sellyield"])*100,4);e.sellyield=format_number(f[k]["sellyield"],4);e.sellclean=format_number(f[k]["sellclean"],4);e.sellvol=format_number(f[k]["sellvol"]/10000,4);e.sellinitiator=f[k]["sellinitiator"];JRBJ_Array_type_0.push(e);e={}}JRBJ_Array_type_0_xls=JRBJ_Array_type_0;var g=[{mData:"updateTime"},{mData:"buyinitiator"},{mData:"JJ"},{mData:"buyclean"},{mData:"buyyield"},{mData:"JJCE"},{mData:"SYLCE"},{mData:"sellyield"},{mData:"sellclean"},{mData:"sellvol"},{mData:"sellinitiator"}];datatable_JRBJ_type_0=$("#datatable_JRBJ_type_0").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JRBJ_Array_type_0,aoColumns:g});JRBJ_Array_type_0=[]}})}else{if(type==1){var a="service=quote&type=dyna&k_split=0&where=obj="+b+"&response_times=-1";Socket.send(a,function(k){if(k.results!=null&&k.results.length>0){var g={};g.buyprice=k.results[0]["buyprice"];g.buyvolume=k.results[0]["buyvolume"];g.sellprice=k.results[0]["sellprice"];g.sellvolume=k.results[0]["sellvolume"];var h=["买一","买二","买三","买四","买五"];var c=["卖一","卖二","卖三","卖四","卖五"];for(var f=0;f<5;f++){var j=[];j.push(h[f]);j.push(format_number(g.buyprice[f],4));j.push(format_number(g.buyvolume[f],4));j.push(c[f]);j.push(format_number(g.sellprice[f],4));j.push(format_number(g.sellvolume[f],4));JRBJ_Array_type_1.push(j)}for(var e=0;e<JRBJ_Array_type_1.length;e++){for(var m=0;m<JRBJ_Array_type_1[e].length;m++){if(JRBJ_Array_type_1[e][m]==0){JRBJ_Array_type_1[e][m]="--"}}}JRBJ_Array_type_1_xls=JRBJ_Array_type_1;datatable_JRBJ_type_1=$("#datatable_JRBJ_type_1").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JRBJ_Array_type_1});JRBJ_Array_type_1=[]}})}}if(type==0){var a="service=did&did=100007&where=obj="+bond_code+"&response_times=1";Socket.send(a,function(g){if(g.results!=null&&g.results.length>0){var h=g.results;var f={};for(var e=0;e<h.length;e++){f.obj=format_code(h[e].obj);f.name=bond_name;f.newclean=format_number(h[e].newclean,4);f.openclean=format_number(h[e].openclean,4);f.changeclean=h[e].changeclean==0?"--":format_number(h[e].changeclean,4);if(h[e]["changeclean"]==0){f.ZDF="--"}else{f.ZDF=h[e].lastcloseclean!=0?format_number(h[e].changeclean/h[e].lastcloseclean*100,4):"--"}f.highclean=format_number(h[e].highclean,4);f.lowclean=format_number(h[e].lowclean,4);f.lastcloseclean=format_number(h[e].lastcloseclean,4);JRHQ_Array_type_0.push(f);f={}}JRHQ_Array_xls=JRHQ_Array_type_0;var c=[{mData:"obj"},{mData:"name"},{mData:"newclean"},{mData:"openclean"},{mData:"changeclean"},{mData:"ZDF"},{mData:"highclean"},{mData:"lowclean"},{mData:"lastcloseclean"}];datatable_JRHQ=$("#datatable_JRHQ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JRHQ_Array_type_0,aoColumns:c});JRHQ_Array_type_0=[]}})}else{if(type==1){var a="service=quote&type=dyna&k_split=0&where=obj="+b+"&response_times=-1";Socket.send(a,function(g){if(g.results!=null&&g.results.length>0){var h=g.results;var f={};for(var e=0;e<h.length;e++){f.obj=format_code(h[e].obj);f.name=bond_name;f["new"]=h[e]["new"]==0?"--":format_number(h[e]["new"],4);f.open=h[e].open==0?"--":format_number(h[e].open,4);if(h[e]["new"]==0){f.ZD="--";f.ZDF="--"}else{f.ZD=format_number(h[e]["new"]-h[e].lastclose,4);f.ZDF=h[e].lastclose!=0?format_number((h[e]["new"]-h[e].lastclose)/h[e].lastclose*100,4):"--"}f.high=h[e].high==0?"--":format_number(h[e].high,4);f.low=h[e].low==0?"--":format_number(h[e].low,4);f.lastclose=format_number(h[e].lastclose,4);JRHQ_Array_type_1.push(f);f={}}JRHQ_Array_xls=JRHQ_Array_type_1;var c=[{mData:"obj"},{mData:"name"},{mData:"new"},{mData:"open"},{mData:"ZD"},{mData:"ZDF"},{mData:"high"},{mData:"low"},{mData:"lastclose"}];datatable_JRHQ=$("#datatable_JRHQ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JRHQ_Array_type_1,aoColumns:c});JRHQ_Array_type_1=[]}})}}}function export_JRBJ_type_0(){if(JRBJ_Array_type_0_xls.length>0){if(window.external.saveas){var d=[];var c="今日报价"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push('<thead><tr><th rowspan="2">报价时间</th><th colspan="4">买入</th><th colspan="2">差价</th><th colspan="4">卖出信息</th></tr><tr><th>报价方</th><th>面额(万元)</th><th>净价</th><th>收益率(%)</th><th>净价差额</th><th>收益率差额(BP)</th><th>收益率(%)</th><th>净价</th><th>面额(万元)</th><th>报价方</th></tr></thead>');d.push("<tbody>");for(var b=0;b<JRBJ_Array_type_0_xls.length;b++){d.push("<tr>");for(var a in JRBJ_Array_type_0_xls[b]){d.push("<td>"+JRBJ_Array_type_0_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#JRBJ_type_0_xls").bind("click",function(){export_JRBJ_type_0()});function export_JRBJ_type_1(){if(JRBJ_Array_type_1_xls.length>0){if(window.external.saveas){var d=[];var c="今日报价"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push("<thead>");d.push("<tr>");d.push("<td>交易方向</td>");d.push("<td>价格</td>");d.push("<td>数量(手)</td>");d.push("<td>交易方向</td>");d.push("<td>价格</td>");d.push("<td>数量(手)</td>");d.push("</tr>");d.push("</thead>");d.push("<tbody>");for(var b=0;b<JRBJ_Array_type_1_xls.length;b++){d.push("<tr>");for(var a=0;a<JRBJ_Array_type_1_xls[b].length;a++){d.push("<td>"+JRBJ_Array_type_1_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#JRBJ_type_1_xls").bind("click",function(){export_JRBJ_type_1()});function export_JRHQ(){if(JRHQ_Array_xls.length>0){if(window.external.saveas){var d=[];var c="今日行情"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push("<thead>");d.push("<tr>");d.push("<td>债券代码</td>");d.push("<td>债券简称</td>");d.push("<td>最新价</td>");d.push("<td>开盘价</td>");d.push("<td>涨跌</td>");d.push("<td>涨跌幅</td>");d.push("<td>最高价</td>");d.push("<td>最低价</td>");d.push("<td>昨收盘</td>");d.push("</tr>");d.push("</thead>");d.push("<tbody>");for(var b=0;b<JRHQ_Array_xls.length;b++){d.push("<tr>");for(var a in JRHQ_Array_xls[b]){d.push("<td>"+JRHQ_Array_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#JRHQ_xls").bind("click",function(){export_JRHQ()});function set_JYYLSHQ(){var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getOneMonthDayQuotation.dzh?bondCode="+bond_code;Socket.send(a,function(e){if(e.results!=null&&e.results.length>0){var f=e.results;var c={};for(var b=0;b<f.length;b++){c.bond_code=f[b]["债券代码"];c.name=f[b]["债券简称"];c.CJRQ=f[b]["成交日期"];c.ZXJJ=f[b]["收盘净价"];c.ZXSYL=f[b]["收盘收益率"];c.CJJE=f[b]["成交金额(万元)"];c.ZDF=f[b]["涨跌幅"];c.JQPJJJ=f[b]["加权平均净价"];c.JQPJSYL=f[b]["加权平均收益率"];c.KPJJ=f[b]["开盘净价"];c.ZGJJ=f[b]["最高净价"];c.ZDJJ=f[b]["最低净价"];JYYLSHQ_Array.push(c);c={}}JYYLSHQ_Array_xls=JYYLSHQ_Array;datatable_JYYLSHQ=$("#datatable_JYYLSHQ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:JYYLSHQ_Array,aoColumns:[{mData:"bond_code"},{mData:"name"},{mData:"CJRQ"},{mData:"ZXJJ"},{mData:"ZXSYL"},{mData:"CJJE"},{mData:"ZDF"},{mData:"JQPJJJ"},{mData:"JQPJSYL"},{mData:"KPJJ"},{mData:"ZGJJ"},{mData:"ZDJJ"}]});JYYLSHQ_Array=[]}})}function export_JYYLSHQ(){if(JYYLSHQ_Array_xls.length>0){if(window.external.saveas){var d=[];var c="近一月历史行情"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push("<thead>");d.push("<tr>");d.push("<td>债券代码</td>");d.push("<td>债券简称</td>");d.push("<td>日期</td>");d.push("<td>最新净价</td>");d.push("<td>最新收益率</td>");d.push("<td>成交金额(万元)</td>");d.push("<td>涨跌幅(%)</td>");d.push("<td>加权平均净价</td>");d.push("<td>加权平均收益率</td>");d.push("<td>开盘净价</td>");d.push("<td>最高净价</td>");d.push("<td>最低净价</td>");d.push("</tr>");d.push("</thead>");d.push("<tbody>");for(var b=0;b<JYYLSHQ_Array_xls.length;b++){d.push("<tr>");for(var a in JYYLSHQ_Array_xls[b]){d.push("<td>"+JYYLSHQ_Array_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#JYYLSHQ_xls").bind("click",function(){export_JYYLSHQ()});function set_JYYZZDGZ(){var a=debug_url+"/bond/bondCounter/bondComplexCalcController/getOneMonthCBDValue.dzh?bondCode="+bond_code;Socket.send(a,function(e){if(e.results!=null&&e.results.length>0){var f=e.results;var c={};if(has_checked==true&&has_permission==false){for(var b=0;b<f.length;b++){c.bond_code="--";c.name="--";c.RQ="--";c.LLJJ="--";c.LLQJ="--";c.YJLX="--";c.SYQX="--";c.DQSYL="--";c.XZJQ="--";c.TX="--";c.LCJQ="--";c.LCTX="--";c.LLJQ="--";c.LLTX="--";JYYZZDGZ_Array.push(c);c={}}}else{if(has_checked==true&&has_permission==true){for(var b=0;b<f.length;b++){c.bond_code=f[b]["债券代码"];c.name=f[b]["债券简称"];c.RQ=f[b]["日期"];c.LLJJ=f[b]["理论净价"];c.LLQJ=f[b]["理论全价"];c.YJLX=f[b]["应计利息"];c.SYQX=f[b]["剩余期限"];c.DQSYL=f[b]["到期收益率"];c.XZJQ=f[b]["修正久期"];c.TX=f[b]["凸性"];c.LCJQ=f[b]["利差久期"];c.LCTX=f[b]["利差凸性"];c.LLJQ=f[b]["利率久期"];c.LLTX=f[b]["利率凸性"];JYYZZDGZ_Array.push(c);c={}}}}JYYZZDGZ_Array_xls=JYYZZDGZ_Array;datatable_JYYZZDGZ=$("#datatable_JYYZZDGZ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:JYYZZDGZ_Array,aoColumns:[{mData:"bond_code"},{mData:"name"},{mData:"RQ"},{mData:"LLJJ"},{mData:"LLQJ"},{mData:"YJLX"},{mData:"SYQX"},{mData:"DQSYL"},{mData:"XZJQ"},{mData:"TX"},{mData:"LCJQ"},{mData:"LCTX"},{mData:"LLJQ"},{mData:"LLTX"}]});JYYZZDGZ_Array=[]}})}function export_JYYZZDGZ(){if(JYYZZDGZ_Array_xls.length>0){if(window.external.saveas){var d=[];var c="近一月中债登估值"+(new Date()).getTime()+parseInt(Math.random()*100000);d.push(xls_header);d.push("<table>");d.push("<thead>");d.push("<tr>");d.push("<td>债券代码</td>");d.push("<td>债券简称</td>");d.push("<td>日期</td>");d.push("<td>理论净价</td>");d.push("<td>理论全价</td>");d.push("<td>应计利息</td>");d.push("<td>剩余年限</td>");d.push("<td>到期收益率</td>");d.push("<td>修正久期</td>");d.push("<td>凸性</td>");d.push("<td>利差久期</td>");d.push("<td>利差凸性</td>");d.push("<td>利率久期</td>");d.push("<td>利率凸性</td>");d.push("</tr>");d.push("</thead>");d.push("<tbody>");for(var b=0;b<JYYZZDGZ_Array_xls.length;b++){d.push("<tr>");for(var a in JYYZZDGZ_Array_xls[b]){d.push("<td>"+JYYZZDGZ_Array_xls[b][a]+"</td>")}d.push("</tr>")}d.push("</tbody>");d.push("</table>");d.push(xls_footer);window.external.saveas(d.join(""),c,"xls");d=[]}else{alert("请在大智慧客户端使用")}}}$("#JYYZZDGZ_xls").bind("click",function(){export_JYYZZDGZ()});function set_SSJG(){var e="";var b=1;var d="";var a="";e=$("#"+JSHS_trade_date_prefix+pay_type).val();e=e!=""&&e!=undefined?e.replace(/-/g,""):"";b=$("#"+JSHS_settlement_way_prefix+pay_type).val();b=b!=""&&b!=undefined?b:1;d=$("#conversion-"+pay_type+" input[type='radio']:checked").val();d=d!=""&&d!=undefined?d:"";a=$("#"+d+"_"+pay_type).val();a=a!=""&&a!=undefined?a:"";var c=debug_url+"/bond/bondCounter/bondComplexCalcController/getTryCalcResult.dzh?secode="+bond_code+"&tradeDate="+e+"&settlementWay="+b+"&convertType="+d+"&convertValue="+a+"&payType="+pay_type+"&bondName="+bond_name;Socket.send(c,function(h){if(h.results!=null&&h.results.length>0){if(pay_type==0){var j=h.results;var g={};for(var f=0;f<j.length;f++){g.bondCode=j[f]["bondCode"];g.bondName=j[f]["bondName"];g.settlementDate=j[f]["settlementDate"];g.netPrice=j[f]["netPrice"];g.accruedInterest=j[f]["accruedInterest"];g.fullPrice=j[f]["fullPrice"];g.bondYieldY4=j[f]["bondYieldY4"];g.bondYieldY1=j[f]["bondYieldY1"];g.bondYieldY3=j[f]["bondYieldY3"];g.msDuration=j[f]["msDuration"];g.xzDuration=j[f]["xzDuration"];g.convexity=j[f]["convexity"];g.JDJZ=j[f]["basePointValue"];g.tradeDate=j[f]["tradeDate"];SSJG_Array_0.push(g);g={}}SSJG_Array_xls_0=SSJG_Array_0;datatable_SSJG_0=$("#datatable_SSJG_0").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:SSJG_Array_0,aoColumns:[{mData:"bondCode"},{mData:"bondName"},{mData:"settlementDate"},{mData:"netPrice"},{mData:"accruedInterest"},{mData:"fullPrice"},{mData:"bondYieldY4"},{mData:"bondYieldY1"},{mData:"bondYieldY3"},{mData:"msDuration"},{mData:"xzDuration"},{mData:"convexity"},{mData:"JDJZ"},{mData:"tradeDate"}]});SSJG_Array_0=[]}else{if(pay_type==1){var j=h.results;var g={};for(var f=0;f<j.length;f++){g.bondCode=j[f]["bondCode"];g.bondName=j[f]["bondName"];g.settlementDate=j[f]["settlementDate"];g.netPrice=j[f]["netPrice"];g.accruedInterest=j[f]["fullPrice"];g.fullPrice=j[f]["accruedInterest"];g.bondYieldY4=j[f]["bondYieldY4"];g.bondYieldY1=j[f]["bondYieldY1"];g.bondYieldY3=j[f]["bondYieldY3"];g.interestMarginBP=j[f]["interestMarginBP"];g.marginDuration=j[f]["marginDuration"];g.marginConvexity=j[f]["marginConvexity"];g.rateDuration=j[f]["rateDuration"];g.rateConvexity=j[f]["rateConvexity"];g.basePointValue=j[f]["basePointValue"];g.tradeDate=j[f]["tradeDate"];SSJG_Array_1.push(g);g={}}SSJG_Array_xls_1=SSJG_Array_1;datatable_SSJG_1=$("#datatable_SSJG_1").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:SSJG_Array_1,aoColumns:[{mData:"bondCode"},{mData:"bondName"},{mData:"settlementDate"},{mData:"netPrice"},{mData:"accruedInterest"},{mData:"fullPrice"},{mData:"bondYieldY4"},{mData:"bondYieldY1"},{mData:"bondYieldY3"},{mData:"interestMarginBP"},{mData:"marginDuration"},{mData:"marginConvexity"},{mData:"rateDuration"},{mData:"rateConvexity"},{mData:"basePointValue"},{mData:"tradeDate"}]});SSJG_Array_1=[]}else{if(pay_type==2){var j=h.results;var g={};for(var f=0;f<j.length;f++){g.bondCode=j[f]["bondCode"];g.bondName=j[f]["bondName"];g.settlementDate=j[f]["settlementDate"];g.netPrice=j[f]["netPrice"];g.accruedInterest=j[f]["accruedInterest"];g.fullPrice=j[f]["fullPrice"];g.bondYieldY4=j[f]["bondYieldY4"];g.bondYieldY1=j[f]["bondYieldY1"];g.msDuration=j[f]["msDuration"];g.xzDuration=j[f]["xzDuration"];g.convexity=j[f]["convexity"];g.JDJZ=j[f]["basePointValue"];g.exerciseDate=j[f]["exerciseDate"];g.exercisePrice=j[f]["exercisePrice"];g.exerciseBondYieldY8=j[f]["exerciseBondYieldY8"];g.exerciseBondYieldY5=j[f]["exerciseBondYieldY5"];g.exerciseMacaulayDuration=j[f]["exerciseMacaulayDuration"];g.exerciseCorrectDuration=j[f]["exerciseCorrectDuration"];g.exerciseConvexity=j[f]["exerciseConvexity"];g.exerciseBasePointValue=j[f]["exerciseBasePointValue"];g.tradeDate=j[f]["tradeDate"];SSJG_Array_2.push(g);g={}}SSJG_Array_xls_2=SSJG_Array_2;datatable_SSJG_2=$("#datatable_SSJG_2").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:SSJG_Array_2,aoColumns:[{mData:"bondCode"},{mData:"bondName"},{mData:"settlementDate"},{mData:"netPrice"},{mData:"accruedInterest"},{mData:"fullPrice"},{mData:"bondYieldY4"},{mData:"bondYieldY1"},{mData:"msDuration"},{mData:"xzDuration"},{mData:"convexity"},{mData:"JDJZ"},{mData:"exerciseDate"},{mData:"exercisePrice"},{mData:"exerciseBondYieldY8"},{mData:"exerciseBondYieldY5"},{mData:"exerciseMacaulayDuration"},{mData:"exerciseCorrectDuration"},{mData:"exerciseConvexity"},{mData:"exerciseBasePointValue"},{mData:"tradeDate"}]});SSJG_Array_2=[]}else{if(pay_type==3){var j=h.results;var g={};for(var f=0;f<j.length;f++){g.bondCode=j[f]["bondCode"];g.bondName=j[f]["bondName"];g.settlementDate=j[f]["settlementDate"];g.netPrice=j[f]["netPrice"];g.accruedInterest=j[f]["fullPrice"];g.fullPrice=j[f]["accruedInterest"];g.bondYieldY4=j[f]["bondYieldY4"];g.bondYieldY1=j[f]["bondYieldY1"];g.DQYXLC_BP_FL=j[f]["interestMarginBP"];g.marginDuration=j[f]["rateDuration"];g.marginConvexity=j[f]["marginConvexity"];g.rateDuration=j[f]["marginDuration"];g.convexity=j[f]["rateConvexity"];g.DQLCJDJZ=j[f]["basePointValue"];g.exerciseDate=j[f]["exerciseDate"];g.exercisePrice=j[f]["exercisePrice"];g.exerciseBondYieldY8=j[f]["exerciseBondYieldY8"];g.exerciseBondYieldY5=j[f]["exerciseBondYieldY5"];g.exerciseInterestMarginY5=j[f]["exerciseInterestMarginY5"];g.exerciseMarginDuration=j[f]["exerciseMarginDuration"];g.exerciseMarginConvexity=j[f]["exerciseMarginConvexity"];g.exerciseRateDuration=j[f]["exerciseRateDuration"];g.exerciseRateConvexity=j[f]["exerciseRateConvexity"];g.exerciseBasePointValue=j[f]["exerciseBasePointValue"];g.tradeDate=j[f]["tradeDate"];SSJG_Array_3.push(g);g={}}SSJG_Array_xls_3=SSJG_Array_3;datatable_SSJG_3=$("#datatable_SSJG_3").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,bScrollCollapse:true,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",oLanguage:{sEmptyTable:"无数据"},bDestroy:true,aaData:SSJG_Array_3,aoColumns:[{mData:"bondCode"},{mData:"bondName"},{mData:"settlementDate"},{mData:"netPrice"},{mData:"accruedInterest"},{mData:"fullPrice"},{mData:"bondYieldY4"},{mData:"bondYieldY1"},{mData:"DQYXLC_BP_FL"},{mData:"rateDuration"},{mData:"marginConvexity"},{mData:"marginDuration"},{mData:"convexity"},{mData:"DQLCJDJZ"},{mData:"exerciseDate"},{mData:"exercisePrice"},{mData:"exerciseBondYieldY8"},{mData:"exerciseBondYieldY5"},{mData:"exerciseInterestMarginY5"},{mData:"exerciseMarginDuration"},{mData:"exerciseMarginConvexity"},{mData:"exerciseRateDuration"},{mData:"exerciseRateConvexity"},{mData:"exerciseBasePointValue"},{mData:"tradeDate"}]});SSJG_Array_3=[]}}}}}})}$("#save_SSJG").bind("click",function(){set_SSJG();$(".tab-bar li").removeClass("active");$(".tab-bar li").last().addClass("active");$(".tab-content li").removeClass("active");$(".tab-content li").last().addClass("active");if($("#tab-secondary").height()==0){$("#tab-splitter-virtual .tab-splitter-controller").trigger("click")}});function export_SSJG(){var c=[];switch(pay_type){case"0":c=SSJG_Array_xls_0;break;case"1":c=SSJG_Array_xls_1;break;case"2":c=SSJG_Array_xls_2;break;case"3":c=SSJG_Array_xls_3;break}if(c.length>0){if(window.external.saveas){var e=[];var d="试算结果"+(new Date()).getTime()+parseInt(Math.random()*100000);e.push(xls_header);e.push("<table>");e.push("<thead><tr>");e.push($("#SSJG_"+pay_type+" .dataTables_scrollHead .header-detail").html());e.push("</tr></thead>");e.push("<tbody>");for(var b=0;b<c.length;b++){e.push("<tr>");for(var a in c[b]){e.push("<td>"+c[b][a]+"</td>")}e.push("</tr>")}e.push("</tbody>");e.push("</table>");e.push(xls_footer);window.external.saveas(e.join(""),d,"xls");e=[]}else{alert("请在大智慧客户端使用")}}}$("#SSJG_xls_0, #SSJG_xls_1, #SSJG_xls_2, #SSJG_xls_3").bind("click",function(){export_SSJG()});function clear_SSJG(){Socket.send(debug_url+"/bond/bondCounter/bondComplexCalcController/removeTryCalcResultCache.dzh",function(a){})}datatable_JBZL=$("#datatable_JBZL").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:JBZL_Array[0]});datatable_JBZL.fnAdjustColumnSizing();datatable_XJL=$("#datatable_XJL").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:XJL_Array,aoColumns:[{mData:"date"},{mData:"interest"},{mData:"principal"},{mData:"cashFlow"}]});datatable_XJL.fnAdjustColumnSizing();datatable_JRBJ_type_0=$("#datatable_JRBJ_type_0").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_JRBJ_type_0.fnAdjustColumnSizing();datatable_JRBJ_type_1=$("#datatable_JRBJ_type_1").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_JRBJ_type_1.fnAdjustColumnSizing();datatable_JRHQ=$("#datatable_JRHQ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_JRHQ.fnAdjustColumnSizing();datatable_JYYLSHQ=$("#datatable_JYYLSHQ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_JYYLSHQ.fnAdjustColumnSizing();datatable_JYYZZDGZ=$("#datatable_JYYZZDGZ").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_JYYZZDGZ.fnAdjustColumnSizing();datatable_SSJG_0=$("#datatable_SSJG_0").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_SSJG_0.fnAdjustColumnSizing();datatable_SSJG_1=$("#datatable_SSJG_1").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_SSJG_1.fnAdjustColumnSizing();datatable_SSJG_2=$("#datatable_SSJG_2").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_SSJG_2.fnAdjustColumnSizing();datatable_SSJG_3=$("#datatable_SSJG_3").dataTable({bLengthChange:false,bFilter:false,bInfo:false,bPaginate:false,bAutoWidth:true,bSort:false,sScrollX:"-webkit-calc(100% - 15px)",sScrollY:"-webkit-calc(100% - 26px)",bScrollCollapse:true,oLanguage:{sEmptyTable:'<p align="center">无数据<p>'},bDestroy:true,aaData:[]});datatable_SSJG_3.fnAdjustColumnSizing();var originalWindowWidth=$(window).width();$(window).bind("resize",function(){datatable_JBZL.fnAdjustColumnSizing();datatable_XJL.fnAdjustColumnSizing();if($(window).width()!=originalWindowWidth){datatable_JRBJ_type_0.fnAdjustColumnSizing();datatable_JRBJ_type_1.fnAdjustColumnSizing();datatable_JRHQ.fnAdjustColumnSizing();datatable_JYYLSHQ.fnAdjustColumnSizing();datatable_JYYZZDGZ.fnAdjustColumnSizing();datatable_SSJG_0.fnAdjustColumnSizing();datatable_SSJG_1.fnAdjustColumnSizing();datatable_SSJG_2.fnAdjustColumnSizing();datatable_SSJG_3.fnAdjustColumnSizing();originalWindowWidth=$(window).width()}});clear_SSJG();