/*
	Copyright (c) 2012-2013,   To get sources and documentation, please visit:

		http://dms.gw.com.cn
*/

//>>built
require({cache:{"bond/bondQuotation/view/main":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/text!./main.html,dojo/dom-geometry,bond/bondQuotation/view/_helper/GridSOSubStore,bond/bondQuotation/view/_helper/util,dojo/_base/array,dojo/dom,bond/bondQuotation/view/_helper/imUtil,dojo/on,dojo/dom-style,dojo/query,dojo/NodeList-data,dojo/json,dojo/topic".split(","),function(n,l,j,b,e,f,i,h,r,t,p,k,q,
s,c,d,a,g){return n("bond/bondQuotation/view/main",[l,j,e,b],{templateString:f,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){var a=this;this.inherited(arguments);q(p.byId("rateNoteParent"),"click",function(a){var a=a.target.innerText,g=c("#rateNoteParent>li:nth-child(1)"),b=c("#rateNoteParent>li:nth-child(2)"),x=c("#rateBroadcasting"),d=c("#rateCommunity");"\u5e7f\u64ad"==a?(g.addClass("select"),b.removeClass("select"),
x.addClass("vbox"),d.removeClass("vbox").addClass("none")):"\u5708\u5b50"==a&&(g.removeClass("select"),b.addClass("select"),x.removeClass("vbox").addClass("none"),d.addClass("vbox"))});a.showBoardcasting();g.subscribe("bondQuotation/broadCastTopic",function(){a.showBoardcasting()});a.bindRightNoteEvents()},resize:function(a){a&&i.setMarginBox(this.domNode,{w:a.w,y:a.y});this.inherited(arguments)},showBoardcasting:function(){_this=this;(new h).query(r.getSocketParams(bondForumConfig.soUrl+"bondQuotation/broadcastInfo.dzh")).then(function(a){if(a&&
0<a.length){var g="";t.forEach(a,function(a){a=['<div class="hbox broadcasting">','   <div class="spacer title" >','       <div class="hbox"><span class="left_title">'+a.agency+'</span><span  class="spacer">'+r.formatTime(a.time)+"</span></div>",'       <div title="'+a.content+'">'+a.content+"</div>",'       <div class="hbox"><span class="left_title">'+a.name+'</span><span class="spacer">'+a.phone+"</span></div>","   </div>","</div>"];g+=a.join("")})}p.byId("rateBroadcasting").innerHTML=g})},bindRightNoteEvents:function(){q(p.byId("rateCommunity"),
"click",function(a){(a=a.target.getAttribute("data-img-attr"))&&k.openClusterWnd(k.getCurrentUserID(),a)})}})})},"url:bond/bondQuotation/view/main.html":'<div data-dojo-attach-point="containerNode">\r\n    <div class="hbox spacer">\r\n        <div class="spacer vbox border_left">\r\n            <div class="dijitRegionalPane top_menu01">\r\n                <span data-dojo-type="dijit/layout/StackController" id="controller" containerId="myStackContainer">\r\n                </span>\r\n            </div>\r\n            <div id="myStackContainer" data-dojo-type="dijit/layout/StackContainer" class="spacer">\r\n\r\n\r\n                <\!--********************************* begin  \u73b0\u5238\u90e8\u5206***********************************--\>\r\n                <div id="rateBondPane" data-dojo-type="dijit/layout/ContentPane" title="\u73b0\u5238">\r\n                    <div data-dojo-type="dijit/layout/BorderContainer" data-dojo-props="design:\'headline\'">\r\n                        <\!--\u4e0a\u90e8\u7684\u7b5b\u9009\u6761\u4ef6\uff0c\u52a8\u6001\u8868\u683c\u53ca\u70ed\u95e8\u7fa4--\>\r\n                        <div id="rateTable" data-dojo-type="dijit/layout/ContentPane"\r\n                             data-dojo-props="splitter:false, region:\'center\'" style="overflow: hidden">\r\n                            <\!--\u5916\u90e8\u7ec4\u4ef6--\>\r\n                            <div data-dojo-type="bond/bondQuotation/view/rate/topRateBondQuote"></div>\r\n                        </div>\r\n\r\n                        <\!--\u4e0b\u90e8\u7684\u62a5\u4ef7\u90e8\u5206--\>\r\n                        <div id="rateTabPane" data-dojo-type="dijit/layout/ContentPane"\r\n                             data-dojo-props="splitter:false,region:\'bottom\'" class="borderBottom">\r\n                            <\!--\u5916\u90e8\u7ec4\u4ef6--\>\r\n                            <div data-dojo-type="bond/bondQuotation/view/rate/bottomRateBondQuote"></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <\!--********************************* end  \u73b0\u5238\u90e8\u5206***********************************--\>\r\n\r\n                <\!--********************************* begin  \u8d44\u91d1\u90e8\u5206***********************************--\>\r\n                <div id="capitalBondPane" data-dojo-type="dijit/layout/ContentPane" title="\u8d44\u91d1">\r\n                    <div data-dojo-type="dijit/layout/BorderContainer" data-dojo-props="design:\'headline\'">\r\n\r\n                        <div id="capitalTable" data-dojo-type="dijit/layout/ContentPane"\r\n                             data-dojo-props="splitter:false, region:\'center\'" style="overflow: hidden">\r\n                            <\!--\u5916\u90e8\u7ec4\u4ef6--\>\r\n                            <div data-dojo-type="bond/bondQuotation/view/capital/topCapitalBondQuote"></div>\r\n                        </div>\r\n\r\n                        <div id="capitalTabPane" data-dojo-type="dijit/layout/ContentPane"\r\n                             data-dojo-props="splitter:false, region:\'bottom\'" class="borderBottom">\r\n                            <\!--\u5916\u90e8\u7ec4\u4ef6--\>\r\n                            <div data-dojo-type="bond/bondQuotation/view/capital/bottomCapitalBondQuote"></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <\!--********************************* end  \u8d44\u91d1\u90e8\u5206***********************************--\>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="global_split_right_width vbox border_right">\r\n            <div class="hbox dijitRegionalPane pub_title">\r\n                <div class="spacer"></div>\r\n                <div style="padding-top: 3px;">\u4ea4\u6613\u5458\u793e\u533a</div>\r\n                <div class="spacer"></div>\r\n            </div>\r\n            <div class="hbox">\r\n                <ul class="spacer hbox" id="rateNoteParent">\r\n                    <li class="spacer hbox select"><a class="spacer community_header" href="javascript:void(0);">\u5e7f\u64ad</a>\r\n                    </li>\r\n                    <li class="spacer hbox"><a class="spacer community_header" href="javascript:void(0);">\u5708\u5b50</a></li>\r\n                    <\!--<li class="spacer hbox"><a class="spacer community_header" href="javascript:void(0);">\u667a\u6167\u540c\u884c</a></li>--\>\r\n                </ul>\r\n            </div>\r\n            <div id="rateBroadcasting" class="spacer vbox" style="overflow-y: auto;overflow-x:hidden;">\r\n                <\!--<div class="hbox broadcasting">--\>\r\n                    <\!--<div class="spacer title" >--\>\r\n                        <\!--<div class="hbox"><span class="left_title">\u5de5\u5546\u94f6\u884c</span><span  class="spacer">2013/05/29</span></div>--\>\r\n                        <\!--<div title="\u5de5\u5546\u94f6\u884c\u6d4b\u8bd5\u5e7f\u64ad,\u65b0\u53d1\u884c\u503a\u5238\u62a5\u4ef7\u8bf4\u660e">\u5de5\u5546\u94f6\u884c\u6d4b\u8bd5\u5e7f\u64ad,\u65b0\u53d1\u884c\u503a\u5238\u62a5\u4ef7\u8bf4\u660e</div>--\>\r\n                        <\!--<div class="hbox"><span class="left_title">cory</span><span class="spacer">021-31336</span></div>--\>\r\n                    <\!--</div>--\>\r\n                <\!--</div>--\>\r\n            </div>\r\n            <div id="rateCommunity" class="spacer none" style="overflow-y: auto;">\r\n\r\n                <div class="hbox community">\r\n                    <div class="title_mark">\r\n                        <a href="javascript:void(0);">\r\n                            <img data-img-attr="100001" src="resources/images/qq_info_pic.jpg"/> </a>\r\n                    </div>\r\n\r\n                    <div class="spacer title" >\r\n                        <div>\u73b0\u5238\u4ea4\u6613</div>\r\n                        <div>\u4eba\u6570:155</div>\r\n                        <div>\u6700\u65b0\u6d88\u606f\uff1a\u6b22\u8fce\u65b0\u6210\u5458\u84dd\u5c0f\u84dd</div>\r\n                    </div>\r\n                </div>\r\n                <div class="hbox community">\r\n                    <div class="title_mark">\r\n                        <a href="javascript:void(0);">\r\n                            <img data-img-attr="100002" src="resources/images/qq_info_pic.jpg"/> </a>\r\n                    </div>\r\n\r\n                    <div class="spacer title" >\r\n                        <div>\u8d44\u91d1\u4ea4\u6613</div>\r\n                        <div>\u4eba\u6570:155</div>\r\n                        <div>\u6700\u65b0\u6d88\u606f\uff1a\u6b22\u8fce\u65b0\u6210\u5458\u84dd\u5c0f\u84dd</div>\r\n                    </div>\r\n                </div>\r\n                <div class="hbox community">\r\n                   <div class="title_mark">\r\n                        <a href="javascript:void(0);">\r\n                            <img data-img-attr="100003" src="resources/images/qq_info_pic.jpg"/> </a>\r\n                    </div>\r\n\r\n                    <div class="spacer title" >\r\n                        <div>\u503a\u5e02\u65b0\u95fb</div>\r\n                        <div>\u4eba\u6570:155</div>\r\n                        <div>\u6700\u65b0\u6d88\u606f\uff1a\u6b22\u8fce\u65b0\u6210\u5458\u84dd\u5c0f\u84dd</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <\!--<div id="rateOccupation" class="spacer none">--\>\r\n                <\!--<div class="global_text top_text_overflow">\u5f85\u7eed \u540c\u884c1.....</div>--\>\r\n                <\!--<div class="global_text top_text_overflow">\u5f85\u7eed \u540c\u884c2.....</div>--\>\r\n                <\!--<div class="global_text top_text_overflow">\u5f85\u7eed \u540c\u884c3.....</div>--\>\r\n                <\!--<div class="global_text top_text_overflow">\u5f85\u7eed \u540c\u884c4.....</div>--\>\r\n            <\!--</div>--\>\r\n        </div>\r\n    </div>\r\n</div>\r\n',
"bond/bondQuotation/view/_helper/GridSOSubStore":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/json,dojo/Deferred,dojo/store/util/QueryResults,dojo/store/Observable,dojo/_base/array,dojo/io-query,dojo/topic,dojox/store/GridSOStore".split(","),function(n,l,j,b,e,f,i,h,r,t){return n("bond/bondQuotation/view/_helper/GridSOSubStore",t,{convert:function(b){var f=this.inherited(arguments),e=f.result;if(e&&e.datas&&e.head){for(var f=e.datas,e=e.head,h=[],c=0,d=f.length;c<d;c++){for(var a={},
g=0,x=e.length;g<x;g++)a[e[g]]=f[c][g];h.push(a)}f=h}else f=[];return f}})})},"bond/bondQuotation/view/_helper/util":function(){define("dojo/json,dojo/_base/lang,dojo/_base/array,bond/bondQuotation/view/_helper/htmlFormatter,dojo/_base/event,bond/bondQuotation/view/_helper/MessageDialog,bond/bondQuotation/view/_helper/imUtil,dijit/TooltipDialog,dijit/popup,dojo/text!bond/bondQuotation/resources/dialog/popup/traderInfo.html,dojo/string,dojo/on,dojo/dom-style,dojo/dom-attr,dojo/dom,dojox/store/MultiResultStore".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s){var c={},d=new b;c.getWindowSize=function(){return window.screen};c.getLeftTableAvailableSize=function(){return window.screen.availWidth-250};c.typeOf=function(a){var g=Object.prototype.toString,b={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return b[typeof a]||b[g.call(a)]||(a?"object":"null")};c.getCharCode=
function(a){return"number"==typeof a.charCode?a.charCode:a.keyCode};c.checkNumberOrFloat=function(a){return/^([1-9]\d*|0(?!\.0+$))(\.\d{1,4})?$/.test(a)};c.checkInput=function(a){var g=a.target.getAttribute("checkType");if(g){var b=c.getCharCode(a),d=String.fromCharCode(b);switch(g){case "validNumber":!/\d/.test(d)&&9<b&&!a.ctrlKey&&e.stop(a);break;case "validFloat":!/\d|[.]/.test(d)&&9<b&&!a.ctrlKey&&e.stop(a)}}};c.encodeObjArrayToString=function(a){a=j.map(a,function(a){var b={},c;for(c in a)b[c]=
a[c];return b});return n.stringify(a)};c.getSocketParams=function(a){a={parameter:"Z2V0,"+btoa(a)};return l.delegate({service:"rpc",so:"javadataproxy.jar","function":"gw/UIMain",paraencode:"base64",response_times:1,response_mode:0},a)};c.bindCellClick=function(a,g){a.on("click",function(b,c){var d=b.target.getAttribute("clickFn");d&&l.hitch(g,function(){this[d](b,c,a)})()})};c.openPopupPanel=function(a){function g(a){for(var g=!1,a=a.target;"HTML"!=a.tagName;)if(a=a.parentElement,c&&c.domNode&&a==
c.domNode){g=!0;break}return g}var b=this,c;a.on("mouseover",function(a){var a=a.target,g=a.getAttribute("trader");if(g){dijit.byId("myTooltipDialog")&&dijit.byId("myTooltipDialog").destroy();var b=i.queryContatInfoByKey('{"ID":"'+g+'","RealName":"","Company":""}');if(b){var b=b[0],b=p.substitute(t,{RealName:b.RealName||"--",Company:b.Company||"--",Telphone:b.Telphone||"--",Mobile:b.Mobile||"--",UserName:b.UserName||"--",QQ:b.QQ||"--"}),d=i.downloadUserLogo(g);c=new h({id:"myTooltipDialog",style:"width: 340px;",
content:b});r.open({popup:c,around:a});d&&q.set("imPic","background-image","url("+d+")");i.getCurrentUserID()==g&&(s.set("addFriend","disabled","disabled"),s.set("sendImMsg","disabled","disabled"));k(dijit.byId("myTooltipDialog"),"click",function(a){console.warn(a);a=a.target;"openChatWnd"==a.getAttribute("clickFn")?i.openChatWnd(g):"addFriend"==a.getAttribute("clickFn")&&i.addFriend("",g)})}}});k(document.body,"mousemove",function(a){if(c)if("openImDialog"==a.target.getAttribute("clickfn"))clearTimeout(b.timer),
delete b.timer;else if(g(a))clearTimeout(b.timer),delete b.timer;else if(!b.timer&&c)b.timer=setTimeout(function(){r.close(c);c.destroy()},150)})};c.getRateAndCreditQuoteLabel=function(){return"tradeDirection,bondCode,bondName,amount,price,quotationYield,remark,bondTerm,rating,traderID,counterpartyTraderID".split(",")};c.getCapitalQuoteLabel=function(){return"tradeDirection,bondTerm,bondTermUnit,amount,pawn,remark".split(",")};c.quoteAddConvert=function(a,g,b){for(var c=[],d=1,f=g.length-1;d<f;d++){for(var e=
g[d],h={},o=1,m=e.length-1;o<m;o++)if(h[a[o-1]]=e[o],b)for(var i in b)h[i]=b[i];c.push(h)}return c};c.filterNeedQuote=function(a,g){var b=[];if(a&&a.length&&1<a.length){b.push(a[0]);for(var d=!0,e=[],h=1,i=a.length;h<i;h++){var j=a[h];if(h!=i-1&&(1==g||2==g)){var o=j[3];if(!j[2]||!o)continue;if((o=j[4])&&(0>+o||1E6<+o))d=!1,console.warn("\u8f93\u5165\u91d1\u989d"+o+"\u4e0d\u5408\u6cd5!"),e.push("\u7b2c"+h+"\u884c\u8f93\u5165\u91d1\u989d"+o+"\u4e0d\u5408\u6cd5!");if((o=j[5])&&(!c.checkNumberOrFloat(o)||
0>+o||200<+o))d=!1,console.warn("\u8f93\u5165\u4ef7\u683c"+o+"\u4e0d\u5408\u6cd5!"),e.push("\u7b2c"+h+"\u884c\u8f93\u5165\u4ef7\u683c"+o+"\u4e0d\u5408\u6cd5!");if((o=j[6])&&(!c.checkNumberOrFloat(o)||0>+o||100<+o))d=!1,console.warn("\u8f93\u5165\u6536\u76ca\u7387"+o+"\u4e0d\u5408\u6cd5!"),e.push("\u7b2c"+h+"\u884c\u8f93\u5165\u6536\u76ca\u7387"+o+"\u4e0d\u5408\u6cd5!")}else if(h!=i-1&&3==g){var m=j[2],o=j[4];if(!m&&!o)continue;else if(!m&&o||m&&!o)d=!1,e.push("\u7b2c"+h+"\u884c\u671f\u9650\u548c\u91d1\u989d\u4e3a\u5fc5\u586b\u9879");
else{if(0>+m||365<+m)d=!1,console.warn("\u8f93\u5165\u671f\u9650"+m+"\u4e0d\u5408\u6cd5!"),e.push("\u7b2c"+h+"\u884c\u8f93\u5165\u671f\u9650"+m+"\u4e0d\u5408\u6cd5!");if(0>+o||1E6<+o)d=!1,console.warn("\u8f93\u5165\u91d1\u989d"+o+"\u4e0d\u5408\u6cd5!"),e.push("\u7b2c"+h+"\u884c\u8f93\u5165\u91d1\u989d"+o+"\u4e0d\u5408\u6cd5!")}}b.push(j)}if(1>=b.length||!d)b=[];0==b.length&&(new f).showDialog("\u6570\u636e\u9a8c\u8bc1\u5931\u8d25\uff1a<br/> "+e.join("; "));return b}};c.arrayFilter=function(a,g,b){for(var c=
[],d=[],e=[],f=0,h=g.length;f<h;f++){var o=0,m=g[f][b];2==+g[f].actType&&(o+=4);for(var i=0,k=a.length;i<k;i++)if(m==a[i][b]){o++;break}0==o?c.push(g[f]):4<=o?(d.push(m),4<o&&e.push(m)):e.push(m)}c=[].concat(c,a);return c=j.filter(c,function(a){return-1==j.indexOf(d,a[b])})};c.initConfig=function(a,g,b){"array"!=c.typeOf(a)?console.error("\u521d\u59cb\u5316\u4ee3\u7801\u5217\u8868\u51fa\u9519!"):(g[b+"_init"]=a,a=j.map(a,function(a){return{bondCode:a.bondCode,bondName:a.bondName}}),g[b+"_codeList"]=
a)};c.getInfoByCode=function(a,g){var b=[];return b=j.filter(a,function(a){return a.bondCode==g})};c.filterArrayWithQuote=function(a,b,d,e){var f=d||c.getCurrentUserID();return j.filter(a,function(a){if(e!=+a.quotationType)return!1;var c=a[b];if(1!=a.postTarget&&!c)throw console.error("\u7f3a\u5c11\u5b57\u6bb5:"+b),Error("filterArrayWithQuote\u65b9\u6cd5\u8c03\u7528\u51fa\u9519");a=a[b].split(",");return j.some(a,function(a){return a==f})})};c.filterPrivateArray=function(a){return j.filter(a,function(a){return 2!=
+a.postTarget})};c.filterRateCreditArrayWithQueryCondition=function(a,b,d,e,f){var h=[];a&&!(0>=a.length)&&(h=j.filter(a,function(a){if(d!=+a.quotationType)return!1;var h=b.area||-1;if(2==+h){if(0<e.length&&-1==j.indexOf(e,a.bondCode))return!1}else if(3==+h&&!j.some(f,function(b){return b.counterpartyTraderID==a.traderID}))return!1;h=b.bondType||-1;if(-1==j.indexOf(h,a.bondType)&&-1==j.indexOf(h,"all"))return!1;var h=b.compStage,o=[1,3,,5,,7,,10,,,15];o[15]=20;o[20]=25;o[25]=999;var m=h.length;if(0<
m&&-1==j.indexOf(h,"all")){var i=+a.decompensated;if(i<h[0]||i>o[+h[m-1]])return o=null,!1;for(var k=!1,l=0;l<m;l++){var u=+h[l];i>=u&&i<=o[u]&&(k=!0)}o=null;if(!k)return!1}h=b.couponType;o=a.couponType;if(h&&0<h.length&&-1==j.indexOf(h,"all")&&-1==j.indexOf(h,o))return!1;h=b.marketTime;o=a.listingDate;if(h&&0<h.length&&-1==j.indexOf(h,"all")){var v=c.getSubDays(o);if(!j.some(h,function(a){if(1==a)return 1>=v;if(2==a)return 7>=v;if(3==a)return 14>=v;if(4==a)return 30>=v;if(5==a)return 30<v}))return!1}return(h=
b.filterBondCode)&&h!=a.bondCode?!1:!0}),j.forEach(h,function(a){a.favFlg=-1!=j.indexOf(e,a.bondCode)?1:0}));return h};c.getSubDays=function(a){a=new Date(a.substring(0,4)+"/"+a.substring(4,6)+"/"+a.substring(6,8));return((new Date).getTime()-a.getTime())/1E3/60/60/24};c.getNowTime=function(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,a=a.getDate();10>c&&(c="0"+c);10>a&&(a="0"+a);return b+"-"+c+"-"+a};c.getTime=function(a){return a.substring(8,10)+":"+a.substring(10,12)};c.filterCapitalArrayWithQueryCondition=
function(a,b,c){var d=[];a&&!(0>=a.length)&&(d=j.filter(a,function(a){if(c!=+a.quotationType)return!1;var d=b.capitalDirection;return d&&"all"!=d&&d!=a.tradeDirection?!1:(d=b.capitalGuaranty)&&"\u4e0d\u9650"!=d&&d!=a.pawn?!1:!0}));return d};c.getMoreIndexTreeData=function(){return{identifier:"name",label:"description",items:[{name:"\u57fa\u7840\u6307\u6807",description:"\u57fa\u7840\u6307\u6807",children:[{name:"bondType",description:"\u503a\u5238\u7c7b\u578b"},{name:"couponType",description:"\u606f\u7968\u7c7b\u578b"},
{name:"circulation",description:"\u53d1\u884c\u91cf(\u4ebf\u5143)"},{name:"listingDate",description:"\u4e0a\u5e02\u65e5\u671f"},{name:"topicRating",description:"\u4e3b\u4f53\u8bc4\u7ea7"},{name:"issuerName",description:"\u53d1\u503a\u4eba\u540d\u79f0"},{name:"issuePrice",description:"\u53d1\u884c\u4ef7\u683c"},{name:"interestPayment",description:"\u4ed8\u606f\u65b9\u5f0f"},{name:"couponRate",description:"\u7968\u9762\uff08\u53d1\u884c\u53c2\u8003\uff09\u5229\u7387(%)"},{name:"baseInterestRateType",
description:"\u7968\u9762\u5229\u7387\u7c7b\u578b"},{name:"benchmarkSpread",description:"\u57fa\u51c6\u5229\u5dee"},{name:"expirationDate",description:"\u5230\u671f\u65e5\u671f"},{name:"issuePeriod",description:"\u53d1\u884c\u671f\u9650(\u5e74)"},{name:"guarantorName",description:"\u62c5\u4fdd\u4eba\u540d\u79f0"},{name:"guarantorRating",description:"\u62c5\u4fdd\u4eba\u8bc4\u7ea7"},{name:"valueDate",description:"\u8d77\u606f\u65e5"},{name:"annualPaymentDate",description:"\u6bcf\u5e74\u4ed8\u606f\u65e5"},
{name:"crossMarket",description:"\u662f\u5426\u8de8\u5e02\u573a"}]}]}};c.addRateCreditColumnsDef=function(a,b){var c=[];b&&0<b.length&&(j.forEach(b,function(a){switch(a){case "bondType":c.push({id:"bondType",name:"\u503a\u5238\u7c7b\u578b",field:"bondType",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "couponType":c.push({id:"couponType",name:"\u606f\u7968\u7c7b\u578b",formatter:d.couponTypeFormat,field:"couponType",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});
break;case "circulation":c.push({id:"circulation",name:"\u53d1\u884c\u91cf(\u4ebf\u5143)",field:"circulation",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "listingDate":c.push({id:"listingDate",name:"\u4e0a\u5e02\u65e5\u671f",field:"listingDate",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "topicRating":c.push({id:"topicRating",name:"\u4e3b\u4f53\u8bc4\u7ea7",field:"topicRating",width:80,cssClass:"font-gray font-center",
headerCssClass:"font-center"});break;case "issuerName":c.push({id:"issuerName",name:"\u53d1\u503a\u4eba\u540d\u79f0",field:"issuerName",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "issuePrice":c.push({id:"issuePrice",name:"\u53d1\u884c\u4ef7\u683c",field:"issuePrice",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "interestPayment":c.push({id:"interestPayment",name:"\u4ed8\u606f\u65b9\u5f0f",field:"interestPayment",width:80,
cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "couponRate":c.push({id:"couponRate",name:"\u7968\u9762\uff08\u53d1\u884c\u53c2\u8003\uff09\u5229\u7387(%)",field:"couponRate",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "baseInterestRateType":c.push({id:"baseInterestRateType",name:"\u7968\u9762\u5229\u7387\u7c7b\u578b",field:"baseInterestRateType",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "benchmarkSpread":c.push({id:"benchmarkSpread",
name:"\u57fa\u51c6\u5229\u5dee",field:"benchmarkSpread",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "expirationDate":c.push({id:"expirationDate",name:"\u5230\u671f\u65e5\u671f",field:"expirationDate",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "issuePeriod":c.push({id:"issuePeriod",name:"\u53d1\u884c\u671f\u9650(\u5e74)",field:"issuePeriod",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;
case "guarantorName":c.push({id:"guarantorName",name:"\u62c5\u4fdd\u4eba\u540d\u79f0",field:"guarantorName",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "guarantorRating":c.push({id:"guarantorRating",name:"\u62c5\u4fdd\u4eba\u8bc4\u7ea7",field:"guarantorRating",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "valueDate":c.push({id:"valueDate",name:"\u8d77\u606f\u65e5",field:"valueDate",width:80,cssClass:"font-gray font-center",
headerCssClass:"font-center"});break;case "annualPaymentDate":c.push({id:"annualPaymentDate",name:"\u6bcf\u5e74\u4ed8\u606f\u65e5",field:"annualPaymentDate",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"});break;case "crossMarket":c.push({id:"crossMarket",name:"\u662f\u5426\u8de8\u5e02\u573a",field:"crossMarket",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"})}}),a=a.concat(c));return a};c.saveAsExcel=function(a,b,c,d,e){var a=a||"\u5927\u667a\u6167\u6570\u636e\u5bfc\u51fa",
b=b||"",c=c||a,f=d.data,e=e||d.getColumns(),d=[],h=f.length,i=["<html xmlns:x='urn:schemas-microsoft-com:office:excel'><head><\!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>"];i.push(c);i.push("</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\><meta http-equiv='content-type' content='text/html; charset=gbk'><style>.text { font-family:Arial;font-size:10pt;mso-number-format:'@';}</style></head>");
i.push("<body>");i.push("<table width='100%' border='1' cellpadding='0' bordercolorlight='#999999' bordercolordark='#FFFFFF' cellspacing='0' align='center'>");i.push(b);i.push("<tr>");b=0;for(c=e.length;b<c;b++)e[b].field&&(d.push(e[b].field),i.push("<th><div>"),i.push(e[b].name),i.push("</div></th>"));i.push("</tr>");e=d.length;for(b=0;b<h;b++){i.push("<tr>");for(c=0;c<e;c++)i.push("<td>"),i.push(f[b][d[c]]),i.push("</td>");i.push("</tr>")}i.push("</table>");i.push("</body>");window.external.saveas?
window.external.saveas(i.join(""),a,"xls"):alert("\u8bf7\u5728\u5927\u667a\u6167\u5ba2\u6237\u7aef\u4f7f\u7528")};c.generateTimeStamp=function(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate(),e=a.getHours(),f=a.getMinutes(),h=a.getSeconds(),a=a.getMilliseconds();return b+"-"+c+"-"+d+"_"+e+"-"+f+"-"+h+"-"+a};c.checkPermission=function(a){var b=!0;!a||"NULL"==a?((new f).showDialog("\u60a8\u597d\uff0c\u60a8\u5c1a\u672a\u5f00\u901a\u62a5\u4ef7\u529f\u80fd\uff0c\u8bf7\u8054\u7cfb\u5ba2\u6237\u7ecf\u7406\u3002"),
b=!1):(a=a.split(","),j.some(a,function(a){return 2==a})?b=!0:(j.some(a,function(a){return 1==a}),(new f).showDialog("\u60a8\u597d\uff0c\u60a8\u5c1a\u672a\u5f00\u901a\u62a5\u4ef7\u529f\u80fd\uff0c\u8bf7\u8054\u7cfb\u5ba2\u6237\u7ecf\u7406\u3002"),b=!1));return b};c.formatTime=function(a){return a?a.substring(0,4)+"/"+a.substring(4,6)+"/"+a.substring(6,8)+" "+a.substring(8,10)+":"+a.substring(10,12):""};return c})},"bond/bondQuotation/view/_helper/htmlFormatter":function(){define(["dojo/_base/declare",
"dojo/json","bond/bondQuotation/view/_helper/imUtil","bond/bondQuotation/view/_helper/util","dojo/_base/array"],function(n,l,j){return n([],{index:function(b){return parseInt(b+1)},couponTypeFormat:function(b,e,f){b=f;1==f?b="\u8d34\u73b0":2==f?b="\u56fa\u5b9a\u5229\u7387":3==f&&(b="\u6d6e\u52a8\u5229\u7387");return b},nullToMidline:function(b,e,f){b=f;if("null"==f||!f)b="--";return b},nullToNone:function(b,e,f){b=f;if("null"==f||!f)b="";return b},timeFormat:function(b,e,f){(b=f)&&"null"!=f&&(b=f.substring(8,
10)+":"+f.substring(10,12));return b},tarderFormat:function(b,e,f,i,h){b="#f09000";e=f;h.traderName&&"null"!=h.traderName&&(e=h.traderName);h=j.querySingleUserStatus(f);null!=h&&(f!=j.getCurrentUserID()?(b={1:"green","0":"gray"}[h],f={1:'<img trader="'+f+'" style="width:15px;height:20px;vertical-align: middle;" src="resources/images/user_online.png"  clickFn="openImDialog"/>',"0":'<img trader="'+f+'" style="width:15px;height:20px;vertical-align: middle;" src="resources/images/user_offline.png"  clickFn="openImDialog" />'}[h],
e='<a href="javascript:void(0);" class="im_user_open" style="text-decoration:none; color:'+b+';">'+e+"</a>"+f):e=e+'<img trader="'+f+'" style="width:15px;height:20px; vertical-align: middle;" src="resources/images/user_online.png"/>');return"<div>"+e+"</div>"},capitalBondTermFormat:function(b,e,f,i,h){b=f;switch(h.bondTermUnit){case "1":b+="\u5929";break;case "2":b+="\u5468";break;case "3":b+="\u6708"}return b},userStatusFormat:function(b,e,f){b="#f09000";return'<span style="color:'+(1==f?"green":
"gray")+';">'+(1==f?"\u5728\u7ebf":0==f?"\u79bb\u7ebf":"")+"</span>"},bondInfoLinkFormat:function(b,e,f){return'<a target="_blank" style="text-decoration:none;" href=\''+("http://127.0.0.1:30719/bond/f9/redirect.html?obj="+("IB"+f+".bond")+"&f9="+bondForumConfig.f9Url)+"'>"+f+"</a>"},bondInfoLinkFormat2:function(b,e,f,i,h){return'<a  target="_blank" style="text-decoration:none;" href="'+("http://127.0.0.1:30719/bond/f9/redirect.html?obj="+("IB"+h.bondCode+".bond")+"&f9="+bondForumConfig.f9Url)+'" >'+
f+"</a>"},rateFavFormat:function(b,e,f){b="";return 1==f?' <img style="width:18px;height:18px;vertical-align: middle;" src="resources/images/fav_y.png" />':' <img style="width:18px;height:18px;vertical-align: middle;" src="resources/images/fav_n.png"  clickFn="addQuoteToFav"/>'}})})},"bond/bondQuotation/view/_helper/imUtil":function(){define(["dojo/json","bond/bondQuotation/view/_helper/MessageDialog","dojo/_base/array"],function(n,l){var j={getCurrentUserID:function(){var b;if(bondForumConfig&&bondForumConfig.currentUserID)b=
bondForumConfig.currentUserID;else if(window.external&&window.external.getDZHProperty)b=window.external.getDZHProperty("userid"),bondForumConfig.currentUserID=b;return b||"dzhcpz221"},utf8encode:function(b){for(var b=b.replace(/\r\n/g,"\n"),e="",f=0;f<b.length;f++){var i=b.charCodeAt(f);128>i?e+=String.fromCharCode(i):(127<i&&2048>i?e+=escape(String.fromCharCode(i>>6|192)):(e+=escape(String.fromCharCode(i>>12|224)),e+=escape(String.fromCharCode(i>>6&63|128))),e+=escape(String.fromCharCode(i&63|128)))}return e},
openClusterWnd:function(b,e){b&&e?window.external&&window.external.execDzhCommand?1==window.external.execDzhCommand("GwimObject","GwimObject","OpenClusterWnd",b,e,!1)&&console.warn("\u7528\u6237ID\u6216\u7fa4ID\u4e3a\u7a7a! szUserId: "+b+", szClusterId:"+e):console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u5f39\u51fa\u7fa4\u7a97\u53e3"):console.error("\u53c2\u6570\u9519\u8bef szUserId: "+b+", szClusterId:"+e)},openChatWnd:function(b){b?window.external&&window.external.execDzhCommand?
window.external.execDzhCommand("GwimObject","GwimObject","OpenChatWnd",b,"",!1):console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u5f39\u51fa\u804a\u5929\u7a97\u53e3"):console.error("\u53c2\u6570\u9519\u8bef userId:"+b)},generateTime:function(){var b=new Date,e=b.getFullYear(),f=b.getMonth()+1,i=b.getDate(),h=b.getHours(),j=b.getMinutes(),l=b.getSeconds();b.getMilliseconds();return e+"-"+f+"-"+i+" "+h+":"+j+":"+l},sendQuoteInfo:function(b,e,f,i){var h="id,traderID,\u62a5\u4ef7\u65f6\u95f4,\u4ea4\u6613\u65b9\u5411,\u503a\u5238\u4ee3\u7801,\u503a\u5238\u7b80\u79f0,\u5907\u6ce8,\u671f\u9650,\u671f\u9650\u5355\u4f4d,\u4ef7\u683c,\u91d1\u989d,\u62a5\u4ef7\u6536\u76ca\u7387,\u62a5\u4ef7\u7c7b\u578b,\u72b6\u6001,\u52a8\u4f5c\u7c7b\u578b,\u4ea4\u6613\u5458\u540d\u5b57,\u62a5\u4ef7\u673a\u6784,\u8bc4\u7ea7,counterpartyTraderID,\u503a\u5238\u7c7b\u578b,\u62b5\u62bc\u7269,\u4ee3\u507f\u671f,\u4e0a\u5e02\u65e5\u671f,\u606f\u7968\u7c7b\u578b,\u53d1\u884c\u671f\u9650,\u53d1\u884c\u91cf(\u4ebf\u5143),\u4e3b\u4f53\u8bc4\u7ea7,\u53d1\u503a\u4eba\u540d\u79f0,\u53d1\u884c\u4ef7\u683c,\u4ed8\u606f\u65b9\u5f0f,\u7968\u9762(\u53d1\u884c)\u5229\u7387,\u57fa\u51c6\u5229\u7387\u7c7b\u578b,\u57fa\u51c6\u5229\u5dee,\u5230\u671f\u65e5\u671f,\u62c5\u4fdd\u4eba\u540d\u79f0,\u62c5\u4fdd\u4eba\u8bc4\u7ea7,\u8d77\u606f\u65e5,\u6bcf\u5e74\u4ed8\u606f\u65e5,\u662f\u5426\u8de8\u5e02\u573a,\u5e94\u8ba1\u5229\u606f,postTarget".split(","),
r={};b||e||f?window.external&&window.external.execDzhCommand?(b[0].result.head=h,r=b[0],r=n.stringify(r),b=window.external.execDzhCommand("GwimObject","GwimObject","SendQuoteInfo",r,j.generateTime(),e,f,i||"",!1),0!=b&&(console.error("\u53d1\u9001\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a "+b),(new l).showDialog("\u53d1\u9001\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a "+b))):console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f"):console.error("\u53d1\u9001\u62a5\u4ef7\u8f93\u5165\u53c2\u6570\u6709\u8bef!")},
querySingleUserStatus:function(b){var e;if(!b||""==b)console.error("\u67e5\u8be2\u7528\u6237\u72b6\u6001\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+b);else if(window.external&&window.external.execDzhCommand){var f=window.external.execDzhCommand("GwimObject","GwimObject","QueryUsersStatus",b,1,!1);f?(f=n.parse(f))&&"0"==f.GWIM_RET&&(e=f.GWIM_VALUE.UserStatus[b]):console.error("im\u8fd4\u56de\u503c\u4e3a\u7a7a,\u65e0\u6cd5\u4eceim\u83b7\u53d6\u7528\u6237["+b+"]\u7684\u72b6\u6001\u4fe1\u606f!")}else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\u67e5\u8be2\u7528\u6237\u72b6\u6001\u529f\u80fd");
return e},queryUsersStatus:function(b,e){var f;if(!b||""==b||!e||""==e)console.error("\u6279\u91cf\u67e5\u8be2\u7528\u6237\u72b6\u6001\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a,userIds:"+b+", size:"+e);else if(window.external&&window.external.execDzhCommand){var i=window.external.execDzhCommand("GwimObject","GwimObject","QueryUsersStatus",b,e,!1);i?(i=n.parse(i))&&"0"==i.GWIM_RET&&(f=i.GWIM_VALUE.UserStatus):console.error("im\u8fd4\u56de\u503c\u4e3a\u7a7a,\u65e0\u6cd5\u4eceim\u83b7\u53d6\u591a\u7528\u6237["+
b+"]\u7684\u72b6\u6001\u4fe1\u606f!")}else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\u67e5\u8be2\u7528\u6237\u72b6\u6001\u529f\u80fd");return f},queryContactInfoInGlobal:function(b){var e;if(!b||""==b)console.error("\u5168\u5c40\u8303\u56f4\u67e5\u8be2\u7528\u6237\u8d44\u6599\uff0c\u53c2\u6570\u4e0d\u5bf9:"+b);else if(window.external&&window.external.execDzhCommand)if(b=window.external.execDzhCommand("GwimObject","GwimObject","QueryContactInfoInGlobal",
b,!1))try{var f=n.parse(b);0!=f.GWIM_RET?console.error("queryContactInfoInGlobal \u83b7\u53d6\u5931\u8d25,\u8fd4\u56de\u503c\u4e3a\uff1a\uff1a\n"+b):e=f.GWIM_VALUE}catch(i){console.error("queryContactInfoInGlobal \u89e3\u6790\u5931\u8d25!")}else console.error("\u5168\u5c40\u8303\u56f4\u67e5\u8be2\u7528\u6237\u8d44\u6599_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c");else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return e},queryContatInfoByKey:function(b){var e;
if(!b||""==b)console.error("\u5168\u5c40\u8303\u56f4\u6761\u4ef6\u641c\u7d22\u7528\u6237\u8d44\u6599\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+b);else if(window.external&&window.external.execDzhCommand)if(b=window.external.execDzhCommand("GwimObject","GwimObject","QueryContatInfoByKey",b,!1))try{var f=n.parse(b);0!=f.GWIM_RET?console.error("queryContatInfoByKey \u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+b):e=f.GWIM_VALUE}catch(i){console.error("queryContatInfoByKey\u89e3\u6790\u5931\u8d25!")}else console.error("\u5168\u5c40\u8303\u56f4\u6761\u4ef6\u641c\u7d22\u7528\u6237\u8d44\u6599_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c");
else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return e},queryClusterInfoInGlobal:function(b){var e;if(!b||""==b)console.error("\u5168\u5c40\u8303\u56fd\u67e5\u8be2\u7fa4\u8d44\u6599\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+b);else if(window.external&&window.external.execDzhCommand)if(b=window.external.execDzhCommand("GwimObject","GwimObject","QueryContatInfoByKey",b,!1)){var f=n.parse(b);0!=f.GWIM_RET?console.error("queryClusterInfoInGlobal \u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+
b):e=f.GWIM_VALUE}else console.error("\u5168\u5c40\u8303\u56fd\u67e5\u8be2\u7fa4\u8d44\u6599_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c");else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return e},queryClustersInfo:function(b,e){var f;if(!b||""==b)console.error("\u6279\u91cf\u67e5\u8be2\u7fa4\u4fe1\u606f\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+b);else if(window.external&&window.external.execDzhCommand){var i=window.external.execDzhCommand("GwimObject",
"GwimObject","QueryClustersInfo",b,e,!1);if(i){var h=n.parse(i);0!=h.GWIM_RET?console.error("queryClustersInfo \u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+i):f=h.GWIM_VALUE}else console.error("\u6279\u91cf\u67e5\u8be2\u7fa4\u4fe1\u606f_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c")}else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return f},queryUserGroup:function(b,e){var f;if(!b||""==b)console.error("\u6279\u91cf\u67e5\u8be2\u597d\u53cb\u5206\u7ec4\u4fe1\u606f\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+
b);else if(window.external&&window.external.execDzhCommand){var i=window.external.execDzhCommand("GwimObject","GwimObject","QueryUserGroup",b,e,!1);if(i){var h=n.parse(i);0!=h.GWIM_RET?console.error("queryUserGroup \u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+i):f=h.GWIM_VALUE}else console.error("\u67e5\u8be2\u597d\u53cb\u5206\u7ec4\u4fe1\u606f_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c")}else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");
return f},downloadUserLogo:function(b){var e;!b||""==b?console.error("\u83b7\u53d6\u7528\u6237\u56fe\u50cf(BASE64\u7f16\u7801)\uff0c\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a:"+b):window.external&&window.external.execDzhCommand?(b=window.external.execDzhCommand("GwimObject","GwimObject","DownloadUserLogo",b,!1))?(b=n.parse(b),0!=b.GWIM_RET?console.error("downloadUserLogo \u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+b.GWIM_RET):e=b.GWIM_VALUE.LogoData):console.error("\u83b7\u53d6\u7528\u6237\u56fe\u50cf_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c"):
console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return e},addFriend:function(b,e){var f;if(!e||""==e)console.error("\u6dfb\u52a0\u597d\u53cb\uff0c\u597d\u53cbid\u4e0d\u80fd\u4e3a\u7a7a:"+e);else if(window.external&&window.external.execDzhCommand){var i=window.external.execDzhCommand("GwimObject","GwimObject","AddFriend",b||"",e,!1);i?(i=n.parse(i),0!=i.GWIM_RET?console.error("\u83b7\u53d6\u5931\u8d25\uff0c\u8fd4\u56de\u503c\u4e3a\uff1a \n"+i.GWIM_RET):
f=i.GWIM_VALUE):console.error("\u6dfb\u52a0\u597d\u53cb_\u67e5\u8be2\u672a\u83b7\u53d6\u8fd4\u56de\u503c")}else console.error("\u5fc5\u987b\u5728\u7ec8\u7aef\u4e0b\u624d\u80fd\u6b63\u5e38\u53d1\u9001\u6d88\u606f");return f}};return j})},"bond/bondQuotation/view/_helper/MessageDialog":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/dom,dijit/registry,dojo/text!./MessageDialog.html".split(","),function(n,
l,j,b,e,f,i,h){return n("bond.bondQuotation.view._helper.MessageDialog",[l,j,b,e],{templateString:h,postMixInProperties:function(){},postCreate:function(){},showDialog:function(b){this.tipInfo.innerHTML=b;this.dialogConfirm.show()}})})},"url:bond/bondQuotation/view/_helper/MessageDialog.html":'<div data-dojo-attach-point="containerNode" class="spacer">\r\n\t<div data-dojo-id="dialogConfirm" data-dojo-attach-point="dialogConfirm" data-dojo-type="dijit/Dialog"  data-dojo-props="title:\'\u63d0\u793a\u4fe1\u606f\'" style="display:none;width:400px;">\r\n\t\t<div class="vbox" style="height: 100px;">\r\n            <div style="height:  -webkit-calc(100% - 25px);overflow-y: auto; padding:2px 5px;">\r\n                <div data-dojo-attach-point="tipInfo" class="spacerx" style="text-align: center; line-height:50px;"></div>\r\n            </div>\r\n\r\n\t\t\t<div class="spacerx" style="text-align: center; line-height:25px;">\r\n\t\t\t\t<button data-dojo-type="dijit/form/Button" type="button" onclick="dialogConfirm.onCancel()">\u5173\u95ed</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>',
"url:bond/bondQuotation/resources/dialog/popup/traderInfo.html":'<div class="tooltipDialog">\r\n    <div>\r\n        <div class="inlineBlock">\r\n            <div class="titleLine">\r\n                <div><span>\u59d3\u540d\uff1a</span></div>\r\n                <div><span>${RealName}</span></div>\r\n            </div>\r\n\r\n            <div class="titleLine">\r\n                <div><span>\u516c\u53f8\uff1a</span></div>\r\n                <div><span>${Company}</span></div>\r\n            </div>\r\n\r\n            <div class="titleLine">\r\n                <div><span>\u8054\u7cfb\u7535\u8bdd\uff1a</span></div>\r\n                <div><span>${Telphone}</span></div>\r\n            </div>\r\n\r\n            <div class="titleLine">\r\n                <div><span>\u624b\u673a\uff1a</span></div>\r\n                <div><span>${Mobile}</span></div>\r\n            </div>\r\n\r\n            <div class="titleLine">\r\n                <div><span>\u667a\u6167\u901a\u5e10\u53f7\uff1a</span></div>\r\n                <div><span>${UserName}</span></div>\r\n            </div>\r\n\r\n            <div class="titleLine">\r\n                <div><span>QQ\u53f7\uff1a</span></div>\r\n                <div><span>${QQ}</span></div>\r\n            </div>\r\n        </div>\r\n        <div class="inlineBlock"><div id="imPic" class="imPic"></div></div>\r\n    </div>\r\n\r\n    <div><input type="button" id="addFriend"  clickFn="addFriend" value="\u52a0\u4e3a\u597d\u53cb"> <input type="button" id="sendImMsg"  clickFn="openChatWnd" value="\u53d1\u6d88\u606f"></div>\r\n</div>',
"bond/bondQuotation/view/_helper/WebSocketHelper":function(){define([],function(){return{Topic:function(){function n(l){var j=[];this.getName=function(){return l};this.addHandler=function(b){j.push(b)};this.fire=function(b){j.forEach(function(e){e(b)})};this.removeHandler=function(b){for(var e=0,f=j.length;e<f;e++)if(b==j[e]){j.splice(e,1);break}}}return function(){function l(b){for(var e=0,f=j.length;e<f;e++)if(b===j[e].getName())return j[e];j.push(new n(b));return j[e]}var j=[];this.publish=function(b,
e){l(b).fire(e)};this.subscribe=function(b,e){l(b).addHandler(e)}}}(),Socket:function(n,l,j){l=new WebSocket("ws://"+l+":"+j);l.onmessage=function(b){n.publish("socketMsg",b)};l.onclose=function(b){n.publish("socketClose",b)};l.onopen=function(b){n.publish("socketOpen",b)};l.onerror=function(b){n.publish("socketError",b)};return l}}})},"bond/bondQuotation/view/_helper/CustomKeyboardSpirit":function(){define("dojo/_base/lang,dojo/_base/declare,dojo/_base/array,dojo/on,dojo/_base/window,dojo/aspect,dijit/form/ComboBox,dojox/store/GridWSStore,dojo/json".split(","),
function(n,l,j,b,e,f,i,h){return l("bond.bondQuotation.view._helper.CustomKeyboardSpirit",[i],{hasDownArrow:!1,autoComplete:!1,labelType:"html",labelAttr:"bondName",searchAttr:"bondCode",selectOnClick:!0,soUrl:bondForumConfig.soUrl+"bondQuotation/rateBondCode.dzh",labelFunc:function(b){return b[this.labelAttr]+" "+b[this.searchAttr]},onSearch:function(b,e,f){f.direction=!0;this.dropDown.clearResultList()},postMixInProperties:function(){this.store=new h;f.before(this.store,"query",n.hitch(this,this.beforeQuery));
f.after(this.store,"convert",n.hitch(this,this.afterQuery));this.inherited(arguments)},afterQuery:function(b){var e=this.get("value");return j.filter(b,function(b){return-1!=b.bondCode.indexOf(e)}).slice(0,10)},beforeQuery:function(b){this.get("value");var e="Z2V0,"+btoa(this.soUrl);b.service="rpc";b.so="javadataproxy.jar";b.parameter=e;b["function"]="gw/UIMain";b.paraencode="base64";b.response_times=1;b.response_mode=0;delete b.bondCode},startup:function(){this._setHasDownArrowAttr(this.hasDownArrow);
this.inherited(arguments)}})})},"bond/bondQuotation/view/_helper/MCheckedMultiSelect":function(){define("dojo/on,dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/_base/event,dojo/dom-geometry,dojo/dom-class,dojo/dom-construct,dojo/i18n,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/registry,dijit/Menu,dijit/MenuItem,dijit/Tooltip,dijit/form/_FormSelectWidget,dijit/form/ComboButton,dojo/text!dojox/form/resources/_CheckedMultiSelectMenuItem.html,dojo/text!dojox/form/resources/_CheckedMultiSelectItem.html,dojo/text!dojox/form/resources/CheckedMultiSelect.html,dojo/i18n!dojox/form/nls/CheckedMultiSelect,dijit/form/CheckBox,dojo/css!dijit/themes/claro/CheckedMultiSelect.css".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s,c,d,a,g,x,y,z){var D=l("dojox.form._CheckedMultiSelectItem",[t,p,k],{templateString:y,baseClass:"dojoxMultiSelectItem",option:null,parent:null,disabled:!1,readOnly:!1,postMixInProperties:function(){this._type=this.parent.multiple?{type:"checkbox",baseClass:"dijitCheckBox"}:{type:"radio",baseClass:"dijitRadio"};this.disabled=this.option.disabled=this.option.disabled||!1;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=
this.option.label},_changeBox:function(){if(!this.get("disabled")&&!this.get("readOnly"))this.parent.multiple?this.option.selected=this.checkBox.get("value")&&!0:this.parent.set("value",this.option.value),this.parent._updateSelection(),this.parent.focus()},_onClick:function(a){this.get("disabled")||this.get("readOnly")?e.stop(a):this.checkBox._onClick(a)},_updateBox:function(){this.checkBox.set("value",this.option.selected)},_setDisabledAttr:function(a){this.disabled=a||this.option.disabled;this.checkBox.set("disabled",
this.disabled);i.toggle(this.domNode,"dojoxMultiSelectDisabled",this.disabled)},_setReadOnlyAttr:function(a){this.checkBox.set("readOnly",a);this.readOnly=a}}),B=l("dojox.form._CheckedMultiSelectMenu",s,{multiple:!1,buildRendering:function(){this.inherited(arguments);var a=this.menuTableNode=this.domNode,b=this.domNode=h.create("div",{style:{overflowX:"hidden",overflowY:"scroll"}});a.parentNode&&a.parentNode.replaceChild(b,a);i.remove(a,"dijitMenuTable");b.className=a.className+" dojoxCheckedMultiSelectMenu";
a.className="dijitReset dijitMenuTable";a.setAttribute("role","listbox");b.setAttribute("role","presentation");b.appendChild(a)},resize:function(a){if(a&&(f.setMarginBox(this.domNode,a),"w"in a))this.menuTableNode.style.width="100%"},onClose:function(){this.inherited(arguments);if(this.menuTableNode)this.menuTableNode.style.width=""},onItemClick:function(a){function c(a){b.forEach(f.getChildren(),function(b){b.option.selected=a})}function d(){var a=f.getChildren().slice(1),g=f.getChildren()[0];b.every(a,
function(a){return a.option.selected})?c(!0):g.option.selected=!1}"undefined"==typeof this.isShowingNow&&this._markActive();var g=a.option,e=g.selected,f=this;/all|\u5168\u90e8/gi.test(g.value)?e?c(!0):c(!1):d();this.focusChild(a);if(a.disabled||a.readOnly)return!1;if(!this.multiple)this.onExecute()}}),A=l("dojox.form._CheckedMultiSelectMenuItem",c,{templateString:x,option:null,parent:null,_iconClass:"",postMixInProperties:function(){this.parent.multiple?(this._iconClass="dojoxCheckedMultiSelectMenuCheckBoxItemIcon",
this._type={type:"checkbox"}):(this._iconClass="",this._type={type:"hidden"});this.disabled=this.option.disabled;this.checked=this.option.selected;this.label=this.option.label;this.readOnly=this.option.readOnly;this.inherited(arguments)},onChange:function(){},_updateBox:function(){i.toggle(this.domNode,"dojoxCheckedMultiSelectMenuItemChecked",!!this.option.selected);this.domNode.setAttribute("aria-checked",this.option.selected);this.inputNode.checked=this.option.selected;this.parent.multiple||i.toggle(this.domNode,
"dijitSelectSelectedOption",!!this.option.selected)},_onClick:function(a){if(!this.disabled&&!this.readOnly)if(this.parent.multiple)this.option.selected=!this.option.selected,this.parent.onChange(),this.onChange(this.option.selected);else if(!this.option.selected)b.forEach(this.parent.getChildren(),function(a){a.option.selected=!1}),this.option.selected=!0,this.parent.onChange(),this.onChange(this.option.selected);this.inherited(arguments)}});return l("bond.bondQuotation.view._helper.MCheckedMultiSelect",
a,{templateString:z,baseClass:"dojoxCheckedMultiSelect",required:!1,invalidMessage:"$_unset_$",_message:"",multiple:!0,dropDown:!0,labelText:"",tooltipPosition:[],setStore:function(a,c,d){this.inherited(arguments);var g=function(a){var c=[];b.forEach(a,function(a){a.selected&&c.push(a.value)});c.length&&this.set("value",c);this._updateSelection()},e=this.store.query(this.query,this.queryOptions);j.isArray(e)?g.call(this,e):e.then(j.hicth(this,g))},postMixInProperties:function(){this.inherited(arguments);
this._nlsResources=r.getLocalization("dojox.form","CheckedMultiSelect",this.lang);if("$_unset_$"==this.invalidMessage)this.invalidMessage=this._nlsResources.invalidMessage},_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this.value=this.options[0<=a?a:0].value}if(this.dropDown)i.toggle(this.selectNode,"dojoxCheckedMultiSelectHidden"),this.dropDownMenu=new B({id:this.id+"_menu",style:"display: none;",multiple:this.multiple,
onChange:j.hitch(this,"_updateSelection")})},postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.inherited(arguments);if(this.dropDown){this.dropDownButton=new g({label:this.labelText,dropDown:this.dropDownMenu,baseClass:"dojoxCheckedMultiSelectButton",maxHeight:this.maxHeight},this.comboButtonNode);var a=this.dropDownButton.titleNode,b=h.create("input",{"class":"dijitReset dijitInline dijitButtonText dojoxCheckedMultiSelectButton",readOnly:!0}),c=function(a){a.stopPropagation()};
this.own(n(b,"keypress",c),n(b,"keydown",c),n(b,"keyup",c),n(b,"mousedown",c),n(b,"mouseup",c),n(b,"click",c));a.lastChild.style.display="none";a.appendChild(b);a.lastChild.style.width=this.width-25+"px";this._updateSelection()}},_onMouseDown:function(a){e.stop(a)},validator:function(){return!this.required?!0:b.some(this.getOptions(),function(a){return a.selected&&null!=a.value&&0!=a.value.toString().length})},validate:function(a){d.hide(this.domNode);(a=this.isValid(a))||this.displayMessage(this.invalidMessage);
return a},isValid:function(){return this.validator()},getErrorMessage:function(){return this.invalidMessage},displayMessage:function(a){d.hide(this.domNode);a&&d.show(a,this.domNode,this.tooltipPosition)},onAfterAddOptionItem:function(){},_addOptionItem:function(a){var b;this.dropDown?(b=new A({option:a,parent:this.dropDownMenu}),this.dropDownMenu.addChild(b)):(b=new D({option:a,parent:this}),this.wrapperDiv.appendChild(b.domNode));this.onAfterAddOptionItem(b,a)},_refreshState:function(){this.validate(this.focused)},
onChange:function(){this._refreshState()},reset:function(){this.inherited(arguments);d.hide(this.domNode)},_updateSelection:function(){this.inherited(arguments);this._handleOnChange(this.value);b.forEach(this._getChildren(),function(a){a._updateBox()});h.empty(this.containerNode);var a=this;b.forEach(this.value,function(b){b=h.create("option",{value:b,label:b,selected:"selected"});h.place(b,a.containerNode)});if(this.dropDown&&this.dropDownButton){var c=0,g=[];b.forEach(this.options,function(a){if(a.selected){c++;
var b="";0<a.label.indexOf("<")?(labelLenth=a.label.indexOf("<"),b=a.label.substr(0,labelLenth)):b=a.label;g.push(b)}});var d=this.dropDownButton.titleNode.lastChild,e=g.join(",");-1!=e.indexOf("\u5168\u90e8")&&(e="\u5168\u90e8");this.dropDownButton.set("label",this.multiple?e:label);d.value=e;d.title=e}},_getChildren:function(){return this.dropDown?this.dropDownMenu.getChildren():b.map(this.wrapperDiv.childNodes,function(a){return q.byNode(a)})},invertSelection:function(){this.multiple&&(b.forEach(this.options,
function(a){a.selected=!a.selected}),this._updateSelection())},_setDisabledAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDownButton.set("disabled",a);b.forEach(this._getChildren(),function(b){b&&b.set&&b.set("disabled",a)})},_setReadOnlyAttr:function(a){this.inherited(arguments);"readOnly"in this.attributeMap&&this._attrToDom("readOnly",a);this.readOnly=a;b.forEach(this._getChildren(),function(b){b&&b.set&&b.set("readOnly",a)})},uninitialize:function(){d.hide(this.domNode);b.forEach(this._getChildren(),
function(a){a.destroyRecursive()});this.inherited(arguments)}})})},"bond/bondQuotation/view/rate/bottomRateBondQuote":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/text!./bottomRateBondQuote.html,dojo/text!./bottomRateBondQuoteTemplete.html,dojo/query,dojo/dom-class,dojo/on,dojo/_base/array,dojo/json,dojo/dom,dojo/dom-construct,dijit/Dialog,dijit/registry,bond/bondQuotation/view/_helper/htmlFormatter,dojox/slickgrid/slickgrid,dojo/store/Memory,dojo/topic,dojo/dom-geometry,dojo/_base/lang,dojo/_base/event,bond/bondQuotation/view/rate/rateCommonDialog,bond/bondQuotation/view/_helper/MessageDialog,bond/bondQuotation/view/_helper/util,dojox/store/WebSocket,dojo/io-query,bond/bondQuotation/view/_helper/GridSOSubStore,bond/bondQuotation/view/_helper/CustomKeyboardSpirit,bond/bondQuotation/view/_helper/imUtil".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s,c,d,a,g,x,y,z,D,B,A,o,m,E,F,C,u,v){var w=new a;return n("bond.bondQuotation.view.rate.bottomRateBondQuote",[l,j,b,e],{templateString:f,startup:function(){this.inherited(arguments);this.bindQuoteStackEvents()},bindQuoteStackEvents:function(){var a=this;a.dijitLineCount=6;dijit.byId("quoteStackBtns").getChildren().forEach(function(b){var c=b.label;"\u5bfc\u51fa\u5230Excel"!=c&&(a.initialQuote(b,c),b.on("click",function(){h(".button_selected").forEach(function(a){r.remove(a,
"button_selected")});"\u6211\u8981\u62a5\u4ef7"==b.label?(r.add(dijit.byId("rateNeedBtn").domNode,"button_selected"),h("#needQuote").addClass("vbox"),h("#myReceiveQuote").removeClass("vbox").addClass("none"),h("#myQuote").removeClass("vbox").addClass("none"),dijit.byId("quoteExcel").set("style",{visibility:"hidden"}).set("searchKey","needQuote"),a.resize()):"\u6211\u6536\u5230\u7684\u62a5\u4ef7"==b.label?(r.add(dijit.byId("rateMyReceiveBtn").domNode,"button_selected"),h("#needQuote").removeClass("vbox").addClass("none"),
h("#myReceiveQuote").addClass("vbox"),h("#myQuote").removeClass("vbox").addClass("none"),dijit.byId("quoteExcel").set("style",{visibility:"visible "}).set("searchKey","myReceiveQuote"),a.resize()):"\u6211\u7684\u62a5\u4ef7"==b.label&&(r.add(dijit.byId("rateMyBtn").domNode,"button_selected"),h("#needQuote").removeClass("vbox").addClass("none"),h("#myReceiveQuote").removeClass("vbox").addClass("none"),h("#myQuote").addClass("vbox"),dijit.byId("quoteExcel").set("style",{visibility:"visible "}).set("searchKey",
"myQuote"),a.resize())}))});t(dijit.byId("quoteExcel"),"click",function(){a.bindExcelExport()})},initialQuote:function(a,b){"\u6211\u8981\u62a5\u4ef7"==b?(r.add(a.containerNode,"highlighBtn"),dijit.byId("quoteExcel").set("style",{visibility:"hidden"}).set("searchKey","needQuote"),this.initialNeedQuote()):"\u6211\u6536\u5230\u7684\u62a5\u4ef7"==b?setTimeout(D.hitch(this,"initialReceiveQuote"),100):"\u6211\u7684\u62a5\u4ef7"==b&&setTimeout(D.hitch(this,"initialMyQuote"),100)},initialNeedQuote:function(){var a=
this;q.byId("tableParent").innerHTML=i;for(var b=1;6>b;b++)a.initRateCodeSpirit("rateCodeSpirit",b,"\u521d\u59cb\u5316\u663e\u793a");t(a.needQuoteSubmit,"click",function(){if(m.checkPermission(bondForumConfig.permission))if(q.byId("rateForm").checkValidity()){var b=1==dijit.byId("bondRateNeedQuoteTarget").get("value")?3:1;a.needQuoteSubmitFunc(b)}else(new o).showDialog("\u6570\u636e\u9a8c\u8bc1\u672a\u901a\u8fc7\uff0c\u8bf7\u67e5\u770b\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b\u53ca\u683c\u5f0f!")});
a.needQuoteClearFunc();a.needQuoteAddAndDeleteLineFunc()},needQuoteSubmitFunc:function(a){var b=[];h("#myTable tr").forEach(function(a){a=p.map(a.children,function(a){if("th"==a.nodeName||"TH"==a.nodeName)return a.innerText;if(a.children&&0==a.children.length)return"--"!=a.innerText?a.innerText:"";if(a.children&&0<a.children.length){var b=a.children[0].id;return b?(a=b.substring(7,b.length),dijit.byId(a).get("value")):a.children[0].value}});b.push(a)});b=m.filterNeedQuote(b,1);if(0==b.length)return"error";
var c=[];p.forEach(bondForumConfig.rateCounterparty,function(a){c.push(a.counterpartyTraderID)});c=c.join(",");if(0==c.length||1==a)c=void 0,a=1;s.place(i,"myTable","replace");for(var g=1;6>g;g++)this.initRateCodeSpirit("rateCodeSpirit",g,"\u63d0\u4ea4\u540e\uff0c\u521d\u59cb\u5316\u663e\u793a");var g=m.getRateAndCreditQuoteLabel(),d=bondForumConfig.userInfo,e=v.getCurrentUserID();d&&(e=d.RealName);g=m.quoteAddConvert(g,b,{traderID:v.getCurrentUserID(),quoteAgency:"dzh",traderName:e,counterpartyTraderID:c||
""});a={postTarget:a,quoteInfoAdd:encodeURI(k.stringify(g)),t:(new Date).getTime()};(new E).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addRate.dzh?"+F.objectToQuery(a))).then(function(a){c&&setTimeout(function(){v.sendQuoteInfo(a,v.getCurrentUserID(),c)},50)})},initRateCodeSpirit:function(a,b){var c=a+b,g=dijit.byId(c);g&&g.destroy();(new u({onChange:function(){if(this.item&&this.item.bondName)q.byId(this.id.replace(a,"rateCodeName")).innerText=this.item.bondName}},c)).startup()},
needQuoteClearFunc:function(){var a=this;t(a.needQuoteClear,"click",function(){s.place(i,"myTable","replace");for(var b=1;6>b;b++)a.initRateCodeSpirit("rateCodeSpirit",b,"\u6e05\u7a7a\u540e\u663e\u793a")})},needQuoteAddAndDeleteLineFunc:function(){var a=this;t(q.byId("tableParent"),"click",function(a){B.stop(a);var b=a.target,a=b.getAttribute("opFunc");if("addItem"!=a&&"delItem"==a){var a=h(b).closest("tr"),c=h(b).closest("tbody"),b=a[0].children[2].children[0].id,b=b.substring(7,b.length);dijit.byId(b).destroy();
b=a[0].children[0].innerText;c=c[0].children.length-2;s.destroy(a[0]);if(b!=c){a=0;for(c-=b;a<c;a++){var g=h("#myTable tr:nth-child("+(+b+a+1)+")")[0].children[0];g.innerText=+g.innerText-1}}}});t(dijit.byId("addItem"),"click",function(){var b=h("#myTable tr").length,c=a.dijitLineCount,b=s.toDom("<tr><td>"+(b-1)+'</td><td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td><td style="overflow-x: hidden;"><div id="'+("rateCodeSpirit"+c)+'"></div></td> <td id="rateCodeName'+
c+'"></td><td><input class="td_input_text" type="text" checkType="validNumber"/></td><td><input class="td_input_text" type="text" checkType="validFloat"/></td><td><input class="td_input_text" type="text" checkType="validFloat"/></td><td><input class="td_input_text" type="text"/></td><td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td></tr>');s.place(b,"addItemTr","before");a.initRateCodeSpirit("rateCodeSpirit",c,"\u65b0\u589e\u663e\u793a");a.dijitLineCount+=1});t(q.byId("tableParent"),
"change",function(){});t(q.byId("tableParent"),"keypress",function(a){m.checkInput(a)})},initialReceiveQuote:function(){var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:40,formatter:w.index,resizable:!1,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:w.timeFormat,width:70,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",field:"quoteAgency",
sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,formatter:w.tarderFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",sortable:!0,width:80,formatter:w.bondInfoLinkFormat,
cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"bondName",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",sortable:!0,width:120,formatter:w.bondInfoLinkFormat2,cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"bondTerm",name:"\u503a\u5238\u671f\u9650(\u5e74)",field:"bondTerm",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"rating",name:"\u503a\u5238\u8bc4\u7ea7",field:"rating",sortable:!0,formatter:w.nullToMidline,width:80,
cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"remark",name:"\u5907\u6ce8",field:"remark",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"}],a=this.rateMyReceiveQuoteGrid=new g({store:new x,columns:a,options:{forceFitColumns:!0,hideBorder:"body"}},"rateMyReceiveTable");a.startup();this.bottomReceiveFlg=0;this.bindReceiveInitData(a);this.bindReceiveQuoteHandler(a);m.bindCellClick(a,this);m.openPopupPanel(a)},openImDialog:function(a,b,c){v.openChatWnd(c.data[b.row].traderID)},
bindReceiveInitData:function(a){var b=this;(new C).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/rateList.dzh?t="+(new Date).getTime())).then(function(c){if(c)var g=v.getCurrentUserID(),c=m.filterArrayWithQuote(c,"counterpartyTraderID",g,1);c=m.arrayFilter(c||[],a.pushData||[],"id");c=m.filterPrivateArray(c);b.bottomReceiveFlg+=1;if(0!=c.length)a.store.data=c,a.refresh(c)})},bindReceiveQuoteHandler:function(a){var b=this;b.receiveQuoteHandler=y.subscribe("bondQuote/rateBond",function(c){var g=
a.data,d=k.parse(c.data).result;if(d){for(var c=d.head,e=d.datas,d=[],w=0,f=e.length;w<f;w++){for(var h={},i=0,y=c.length;i<y;i++)h[c[i]]=e[w][i];d.push(h)}c=v.getCurrentUserID();c=m.filterArrayWithQuote(d,"counterpartyTraderID",c,1);0<b.bottomReceiveFlg?(g=m.arrayFilter(g||[],c||[],"id"),a.store.data=g,a.refresh(g),a.pushData=null):a.pushData=a.pushData?[].concat(c,a.pushData):c}})},initialMyQuote:function(){var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:40,formatter:w.index,resizable:!1,cssClass:"font-gray font-center",
headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:w.timeFormat,width:70,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",field:"quoteAgency",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",
name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",sortable:!0,width:80,formatter:w.bondInfoLinkFormat,cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"bondName",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",sortable:!0,width:100,formatter:w.bondInfoLinkFormat2,cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"bondTerm",
name:"\u503a\u5238\u671f\u9650(\u5e74)",field:"bondTerm",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"rating",name:"\u503a\u5238\u8bc4\u7ea7",field:"rating",sortable:!0,formatter:w.nullToMidline,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"remark",name:"\u5907\u6ce8",field:"remark",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"operate",name:"\u64cd\u4f5c",field:"operate",width:80,
cssClass:"font-gray font-center",headerCssClass:"font-center",formatter:function(){return'<input type="image" class="slickgrid_deleteIcon" src="./resources/images/ico-delete.gif" clickFn="myQuoteDelRow">'}}],b={forceFitColumns:!0,hideBorder:"body"},c=m.getLeftTableAvailableSize(),c=parseInt(c/80);a.length>c&&(b={forceFitColumns:!1});a=this.rateMyReceiveQuoteGrid=new g({store:new x,columns:a,options:b},"rateMyQuoteTable");a.startup();this.initMyQuoteData(a);this.bindMyQuoteHandler(a);this.bindMyQuoteRowDelete(a)},
initMyQuoteData:function(a){(new C).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyQuoteInfo.dzh?traderID="+v.getCurrentUserID()+"&type=1&t="+(new Date).getTime())).then(function(b){a.store.data=b;a.refresh(b)})},bindMyQuoteHandler:function(a){this.myQuoteHandler=y.subscribe("bondQuote/rateBond",function(b){var c=a.data,g=k.parse(b.data).result;if(g){for(var b=g.head,d=g.datas,g=[],e=0,w=d.length;e<w;e++){for(var f={},h=0,i=b.length;h<i;h++)f[b[h]]=d[e][h];f.actType&&2!=f.actType&&
g.push(f)}b=v.getCurrentUserID();g=m.filterArrayWithQuote(g,"traderID",b,1);c=g.concat(c);a.store.data=c;a.refresh(c)}})},bindMyQuoteRowDelete:function(a){var b=this;a.on("click",function(c,g){var d=c.target.getAttribute("clickFn");d&&D.hitch(b,function(){this[d](c,g,a)})()})},myQuoteDelRow:function(a,b,c){a=c.data.splice(b.row,1);c.refresh();this.processDelRowToBackend(a,c)},processDelRowToBackend:function(a){if(a&&a[0])a=a[0].id,(new C).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/deleteRate.dzh?id="+
a+"&t="+(new Date).getTime())).then(function(){})},bindExcelExport:function(){var a=dijit.byId("quoteExcel"),b;"myReceiveQuote"==a.get("searchKey")?(a=dijit.byId("rateMyReceiveTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u73b0\u5238\u6211\u6536\u5230\u7684\u62a5\u4ef7</td></tr>",m.saveAsExcel("\u5927\u667a\u6167_\u73b0\u5238_\u6211\u6536\u5230\u7684\u62a5\u4ef7_"+m.generateTimeStamp(),
b,"\u73b0\u5238",a,a.getColumns())):"myQuote"==a.get("searchKey")&&(a=dijit.byId("rateMyQuoteTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u73b0\u5238\u6211\u7684\u62a5\u4ef7</td></tr>",m.saveAsExcel("\u5927\u667a\u6167_\u73b0\u5238_\u6211\u7684\u62a5\u4ef7_"+m.generateTimeStamp(),b,"\u73b0\u5238",a,a.getColumns()))},resize:function(a){a&&z.setMarginBox(this.domNode,{w:a.w,
y:a.y});this.inherited(arguments)}})})},"url:bond/bondQuotation/view/rate/bottomRateBondQuote.html":'<div data-dojo-attach-point="containerNode" class="vbox spacer globalHeight">\r\n    <div class="spacer hbox " data-dojo-type="dijit/layout/ContentPane" style="overflow-y: hidden;">\r\n        <div class="spacer vbox " data-dojo-type="dijit/layout/ContentPane" style="overflow-x:auto;">\r\n            <div class="hbox">\r\n                <div class="hbox bottomQuoteBtn bottom_width dijitRegionalPane spacer" data-dojo-type="dijit/layout/ContentPane"\r\n                     id="quoteStackBtns">\r\n                    <button id="rateNeedBtn" data-dojo-type="dijit/form/Button" class="button_selected" data-dojo-props="searchKey:\'\'">\u6211\u8981\u62a5\u4ef7</button>\r\n                    <button id="rateMyReceiveBtn" data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'">\u6211\u6536\u5230\u7684\u62a5\u4ef7</button>\r\n                    <button id="rateMyBtn" data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'">\u6211\u7684\u62a5\u4ef7</button>\r\n                    <button data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'" id="quoteExcel"\r\n                            class="end_pack_align_box">\u5bfc\u51fa\u5230Excel\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u8981\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="needQuote_height"  id="needQuote">\r\n                <div >\r\n                    <form id="rateForm" class="myTable_style">\r\n                        <\!--\u6211\u8981\u62a5\u4ef7\u8f93\u5165\u8868\u683c--\>\r\n                        <div id="tableParent" >\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class="bottom_width border_box hbox" style="padding:0 0 5px 0; -webkit-box-pack: center;">\r\n                        <div class="end_pack_align_box contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u63d0\u4ea4\'"\r\n                                 data-dojo-attach-point="needQuoteSubmit"></div>\r\n                        </div>\r\n                        <\!--\u7528\u4e8e\u63a7\u5236\u4e8c\u4e2a\u6309\u94ae\u7684\u95f4\u77e9--\>\r\n\r\n                        <div class="sp_add contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u65b0\u589e\'"\r\n                                 opfunc="addItem" id="addItem"></div>\r\n                        </div>\r\n\r\n                        <div class="start_pack_align_box contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u6e05\u7a7a\'"\r\n                                 data-dojo-attach-point="needQuoteClear"></div>\r\n                        </div>\r\n\r\n                        <div class="contrl_box" >\r\n                            <input id="bondRateNeedQuoteTarget" type="checkbox"\r\n                                   data-dojo-type="dijit/form/CheckBox" value="1" checked="false"/>\r\n                            <label for="bondRateNeedQuoteTarget">\u53d1\u9001\u5230\u4ea4\u6613\u5bf9\u624b</label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u6536\u5230\u7684\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="spacer  none" id="myReceiveQuote">\r\n                <div class="vbox spacer " data-dojo-type="dijit/layout/ContentPane">\r\n                    <div id="rateMyReceiveTableParent" data-dojo-type="dijit/layout/ContentPane"  class="myGrid">\r\n                        <div id="rateMyReceiveTable"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u7684\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="spacer  none" id="myQuote">\r\n                <div class="vbox spacer " data-dojo-type="dijit/layout/ContentPane">\r\n                    <div id="rateMyQuoteTableParent" data-dojo-type="dijit/layout/ContentPane"  class="myGrid">\r\n                        <div id="rateMyQuoteTable"></div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>',
"url:bond/bondQuotation/view/rate/bottomRateBondQuoteTemplete.html":'<table border=1 class="table bottom_width" id="myTable">\r\n    <tbody>\r\n    <tr>\r\n        <th>\u5e8f\u53f7</th>\r\n        <th>\u65b9\u5411</th>\r\n        <th>\u503a\u5238\u4ee3\u7801</th>\r\n        <th>\u503a\u5238\u7b80\u79f0</th>\r\n        <th>\u91d1\u989d(\u4e07)</th>\r\n        <th>\u4ef7\u683c(\u5143)</th>\r\n        <th>\u6536\u76ca\u7387(%)</th>\r\n        <th>\u5907\u6ce8</th>\r\n        <th>\u64cd\u4f5c</th>\r\n    </tr>\r\n\r\n    <tr>\r\n        <td>1</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td style="overflow-x: hidden;"><div id="rateCodeSpirit1"></div></td>\r\n        <td id="rateCodeName1"></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"/></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat" /></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat" /></td>\r\n        <td><input class="td_input_text" type="text"  /></td>\r\n        <td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>\r\n    </tr>\r\n    <tr>\r\n        <td>2</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td style="overflow-x: hidden;"><div id="rateCodeSpirit2"></div></td>\r\n        <td  id="rateCodeName2"></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"  /></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat" /></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat" /></td>\r\n        <td><input class="td_input_text" type="text" /></td>\r\n        <td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>\r\n    </tr>\r\n    <\!--<tr>--\>\r\n        <\!--<td>3</td>--\>\r\n        <\!--<td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>--\>\r\n        <\!--<td style="overflow-x: hidden;"><div id="rateCodeSpirit3"></div></td>--\>\r\n        <\!--<td  id="rateCodeName3"></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber"/></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validFloat" /></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validFloat" /></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" /></td>--\>\r\n        <\!--<td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>--\>\r\n    <\!--</tr>--\>\r\n    <\!--<tr>--\>\r\n        <\!--<td>4</td>--\>\r\n        <\!--<td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>--\>\r\n        <\!--<td style="overflow-x: hidden;"><div id="rateCodeSpirit4"></div></td>--\>\r\n        <\!--<td  id="rateCodeName4"></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber"  /></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validFloat"/></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validFloat" /></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text"/></td>--\>\r\n        <\!--<td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>--\>\r\n    <\!--</tr>--\>\r\n    <tr id="addItemTr" style="display: none;">\r\n        <td>\u53c2\u7167\u884c</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td style="overflow-x: hidden;"><div id="rateCodeSpirit5"></div></td>\r\n        <td  id="rateCodeName5"></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"   noValidate /></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat"  noValidate /></td>\r\n        <td><input class="td_input_text" type="text" checkType="validFloat" noValidate /></td>\r\n        <td><input class="td_input_text" type="text"  noValidate/></td>\r\n        <td><input type="image" src="./resources/images/ico-add.gif" opFunc="addItem"></td>\r\n    </tr>\r\n    </tbody>\r\n</table>',
"bond/bondQuotation/view/rate/rateCommonDialog":function(){define("dijit/Dialog,dojo/on,dojox/slickgrid/slickgrid,dojo/store/Memory,../_helper/util,../_helper/htmlFormatter,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/io-query,dojo/_base/lang,dijit/registry,dojo/_base/array,bond/bondQuotation/view/_helper/imUtil".split(","),function(n,l,j,b,e,f,i,h,r,t,p,k){var f=new f,q=[{CheckBoxSelectColumn:!0,cssClass:"font-center",toolTip:"\u9009\u4e2d/\u53d6\u6d88\u5168\u9009",width:60,showTitleCheckBox:!0,
headerCssClass:"font-center"},{id:"indexNo",name:"\u5e8f\u53f7",width:60,formatter:f.index,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyTraderID",name:"\u5e10\u53f7",field:"counterpartyTraderID",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyTraderName",name:"\u59d3\u540d",field:"counterpartyTraderName",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyAgencyName",name:"\u516c\u53f8",
field:"counterpartyAgencyName",formatter:f.nullToNone,width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"loginState",name:"\u5728\u7ebf\u72b6\u6001",formatter:f.userStatusFormat,field:"loginState",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyPhone",name:"\u7535\u8bdd",formatter:f.nullToNone,field:"counterpartyPhone",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],s={createRateCounterparty:function(){var b=
s,d=dijit.byId("rateCounterpartyDialog");d||(d=new n({id:"rateCounterpartyDialog",title:"\u6211\u7684\u4ea4\u6613\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/topRateCounterpartyDialog.html",onDownloadEnd:function(){l(dijit.byId("rateCounterpartyOk"),"click",function(){dijit.byId("rateCounterpartyDialog").onCancel();b.storeCounterpartyData()});b.createMyCounterpartyTable();l(dijit.byId("rateCounterpartyAdd"),"click",function(){b.createAddMyCounterpartyDialog()})},
onShow:function(){}}));d.show()},createMyCounterpartyTable:function(){var c=s,d=[].concat(q),d=new j({store:new b,columns:d,options:{forceFitColumns:!0}},"rateCounterpartyTable");d.startup();c.bindInitCounterparty(d);c.bindClear(d)},bindInitCounterparty:function(b){(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyCounterparty.dzh?traderID="+k.getCurrentUserID()+"&quotationType=1&t="+(new Date).getTime())).then(function(d){if(d&&0<d.length){var a=p.map(d,function(a){return a.counterpartyTraderID}).join(","),
g=k.queryContactInfoInGlobal(a),a=p.map(d,function(a){var b=p.filter(g,function(b){return b.UserName==a.counterpartyTraderID});a.loginState=b?b[0].Status:0;return a});b.refresh(a);bondForumConfig.rateCounterparty=d}else b.refresh([])})},bindClear:function(b){l(dijit.byId("rateCounterpartyClear"),"click",function(){b.refresh([])})},storeCounterpartyData:function(){var b=dijit.byId("rateCounterpartyTable"),d=b.getSelectedRows(),a=[],g=k.getCurrentUserID();if(0<d.length){var f=b.data;p.forEach(d,function(b){b=
f[+b];a.push({traderID:g,counterpartyTraderID:b.counterpartyTraderID,counterpartyTraderName:b.counterpartyTraderName,counterpartyAgencyName:b.counterpartyAgencyName,counterpartyPhone:b.counterpartyPhone})});b=e.encodeObjArrayToString(a);b={quotationType:1,myCounterparty:encodeURI(b),t:(new Date).getTime()};(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addMyCounterparty.dzh?"+h.objectToQuery(b))).then(function(){bondForumConfig.rateCounterparty=a})}},createAddMyCounterpartyDialog:function(){var b=
s,d=dijit.byId("rateCounterpartyAddDialog");d||(d=new n({id:"rateCounterpartyAddDialog",title:"\u6dfb\u52a0\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/topRateCounterpartyAddDialog.html",onDownloadEnd:function(){l(dijit.byId("rateCounterpartyAddOk"),"click",function(){dijit.byId("rateCounterpartyAddDialog").onCancel();b.saveSelectCounterpartyData(1)});l(dijit.byId("rateCounterpartyAddOk2"),"click",function(){dijit.byId("rateCounterpartyAddDialog").onCancel();
b.saveSelectCounterpartyData(2)});var a=dijit.byId("rateCounterpartyAddNodeContainer");a.watch("selectedChildWidget",function(){});l(a.tablist,"selectChild",r.hitch(b,"switchTab"));b.createCounterpartyTable1();b.createCounterpartyTable2();b.bindSearchByContition()}}));d.show()},switchTab:function(b){var d=s;"\u6761\u4ef6\u67e5\u627e"!=b.title&&"\u4eceIM\u8054\u7cfb\u4eba\u6dfb\u52a0"==b.title&&d.selectCounterparty2()},createCounterpartyTable1:function(){var c=[].concat(q);(new j({store:new b,columns:c,
options:{forceFitColumns:!0}},"rateCounterpartyTable1")).startup()},bindSearchByContition:function(){var b=s;l(dijit.byId("rateCounterpartyAddSearch"),"click",function(){var d=dijit.byId("rateCounterpartyAddAccount").get("value"),a=dijit.byId("rateCounterpartyAddName").get("value"),g=dijit.byId("rateCounterpartyAddComp").get("value"),d=JSON.stringify({ID:d,RealName:a,Company:g});(d=k.queryContatInfoByKey(d))&&b.selectCounterparty1(d)})},selectCounterparty1:function(b){var d=dijit.byId("rateCounterpartyTable1"),
b=p.map(b,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}});d.refresh(b)},createCounterpartyTable2:function(){var c=[].concat(q);(new j({store:new b,columns:c,options:{forceFitColumns:!0}},"rateCounterpartyTable2")).startup()},selectCounterparty2:function(){var b=dijit.byId("rateCounterpartyTable2"),d=k.queryUserGroup(k.getCurrentUserID(),1);d?(d=d.GroupInfo["\u6211\u7684\u597d\u53cb"].join(","),
d=k.queryContactInfoInGlobal(d),d=p.map(d,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),b.refresh(d)):b.refresh([])},saveSelectCounterpartyData:function(b){var d;d=1==b?dijit.byId("rateCounterpartyTable1"):dijit.byId("rateCounterpartyTable2");var b=d.getSelectedRows(),a=d.data;if(0<b.length){d=dijit.byId("rateCounterpartyTable");var g=d.data,e=[];p.forEach(b,function(b){var c=
a[+b];p.some(g,function(a){return a.counterpartyTraderID==c.counterpartyTraderID})||e.push(c)});d.refresh(g.concat(e))}}};return s})},"bond/bondQuotation/view/rate/topRateBondQuote":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/text!./topRateBondQuote.html,bond/bondQuotation/view/_helper/htmlFormatter,dojox/slickgrid/slickgrid,dojo/store/Memory,dojo/topic,dojo/dom-geometry,dojo/on,dojo/_base/lang,dijit/Dialog,dojo/dom-style,../_helper/util,bond/bondQuotation/view/rate/rateCounterparty,dijit/tree/CheckboxTree,dojo/data/ItemFileWriteStore,dijit/tree/CheckboxForestStoreModel,dojo/_base/array,dojox/store/WebSocket,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/query,dojo/NodeList-data,dojo/dom,dojo/io-query,bond/bondQuotation/view/_helper/MessageDialog,bond/bondQuotation/view/_helper/imUtil".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s,c,d,a,g,x,y,z,D,B,A,o,m,E,F,C){var u=new i;return n("bond.bondQuotation.view.rate.topRateBondQuote",[l,j,b,e],{templateString:f,startup:function(){var b=this;setTimeout(q.hitch(b,"createQuoteTable"),20);b.emitSearch();k(b.rateSearchBtn,"click",function(){b.dynaSearchTable()});k(dijit.byId("rateMoreFavorite"),"click",function(){b.createRateMoreFavorite()});k(dijit.byId("rateAddCounterparty"),"click",function(){a.createRateCounterparty()});k(dijit.byId("rateMoreFilter"),
"click",function(){b.createRateMoreFilter()});k(dijit.byId("rateMoreIndex"),"click",function(){b.ceateRateMoreIndex()});k(dijit.byId("rateTopExcelExport"),"click",function(){b.bindExcelExport()})},dynaSearchTable:function(){this.getSearchCondition();this.quoteHandler.remove();this.quoteGrid.destroy();this.quoteGrid=null;this.quoteTableParent.set("content",'<div id="quoteTable"></div>');this.createQuoteTable()},emitSearch:function(){var a=this;dijit.byId("area").on("change",function(){console.warn("my value: ",
this.get("value"));a.dynaSearchTable()});dijit.byId("bondType").on("change",function(){console.warn("my value: ",this.get("value"));a.dynaSearchTable()});dijit.byId("compStage").on("change",function(){console.warn("my value: ",this.get("value"));a.dynaSearchTable()})},getSearchCondition:function(){var a=A("#rateTable"),b=dijit.byId("area").get("value");a.data("area",b);b=dijit.byId("bondType").get("value");a.data("bondType",b);b=dijit.byId("compStage").get("value");a.data("compStage",b);a.data("couponType");
a.data("marketTime");a.data("filterBondCode")},createRateMoreFilter:function(){var a=this,b=dijit.byId("rateMoreFilterDialog");b||(b=new s({id:"rateMoreFilterDialog",title:"\u66f4\u591a\u7b5b\u9009",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/topRateMoreFilterDialog.html",onDownloadEnd:function(){k(dijit.byId("rateMoreFilterOK"),"click",function(){dijit.byId("rateMoreFilterDialog").onCancel();var b=dijit.byId("rateMoreFilterCouponType").get("value"),c=dijit.byId("rateMoreFilterMarketTime").get("value"),
g=dijit.byId("rateMoreFilterBondCode").get("value");A("#rateTable").data("couponType",b).data("marketTime",c).data("filterBondCode",g);a.dynaSearchTable()})},onShow:function(){}}));b.show()},ceateRateMoreIndex:function(){var a=this,b=dijit.byId("rateMoreIndexDialog");b||(b=new s({id:"rateMoreIndexDialog",title:"\u66f4\u591a\u6307\u6807",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/topRateMoreIndexDialog.html",onDownloadEnd:function(){k(dijit.byId("rateMoreIndexOK"),"click",
function(){dijit.byId("rateMoreIndexDialog").onCancel();a.dynaSearchTable()});a.initRateMoreIndexTree()}}));b.show()},initRateMoreIndexTree:function(){var a=d.getMoreIndexTreeData(),b=new x({data:a}),a=new y({store:b,childrenAttrs:["children"]});(new g({id:"tree",model:a,showRoot:!1,openOnClick:!1,setCheckboxOnClick:!0},"rateMoreIndexTree")).startup();var c="\u6700\u65b0\u6210\u4ea4,\u4e70\u5165\u4fe1\u606f,\u4e70\u5356\u4ef7\u5dee,\u5356\u51fa\u4fe1\u606f,\u542b\u6743\u503a\u884c\u6743\u6307\u6807,\u57fa\u7840\u6307\u6807".split(",");
dojo.connect(a,"onChange",function(){var a=[];b.fetch({query:{checked:!0},queryOptions:{deep:!0},onItem:function(g){var d=b.getValue(g,"name");z.some(c,function(a){return a==d})||a.push(d)}});A("#rateTable").data("moreIndex",a)})},createRateMoreFavorite:function(){var a=this,b=dijit.byId("rateMoreFavoriteDialog");b||(b=new s({id:"rateMoreFavoriteDialog",title:"\u6536\u85cf",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/topRateFavoriteDialog.html",onDownloadEnd:function(){setTimeout(q.hitch(a,
function(){k(dijit.byId("rateFavoriteSearchOK"),"click",function(){dijit.byId("rateMoreFavoriteDialog").onCancel();a.storeSelectFavCodes()});a.createFavoriteTable()}),0)},onShow:function(){}}));b.show()},createFavoriteTable:function(){var a=[{CheckBoxSelectColumn:!0,cssClass:"font-center",toolTip:"\u9009\u4e2d/\u53d6\u6d88\u5168\u9009",width:60,showTitleCheckBox:!0,headerCssClass:"font-center"},{id:"indexNo",name:"\u5e8f\u5217",width:80,formatter:u.index,cssClass:"font-yellow font-center",headerCssClass:"font-center"},
{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",width:80,formatter:u.bondInfoLinkFormat,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"bondName",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"action",name:"\u52a8\u4f5c",field:"action",formatter:function(){return'<input type="image" class="slickgrid_deleteIcon" src="./resources/images/ico-delete.gif" clickFn="myFavDelRow">'},width:80,
cssClass:"font-yellow font-center",headerCssClass:"font-center"}],a=this.quoteGrid=new h({store:new r,columns:a,options:{forceFitColumns:!0}},"rateBondFavoriteTable");a.startup();this.initFavoriteTable(a);this.bindFavoriteSearch(a);this.bindMyFavRowDelete(a)},initFavoriteTable:function(a){(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/myFavoriteBond.dzh?traderID="+C.getCurrentUserID()+"&quotationType=1&t="+(new Date).getTime())).then(function(b){b&&0<b.length?(a.refresh(b),b=
z.map(b,function(a){return a.bondCode}),bondForumConfig.favRateBondCodes=b):a.refresh([])})},bindFavoriteSearch:function(a){k(dijit.byId("rateFavBondSearch"),"click",function(){var b={bondCode:dijit.byId("rateFavBondCode").get("value")};(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/bondSearch.dzh?quotationType=1&"+E.objectToQuery(b)+"&t="+(new Date).getTime())).then(function(b){b&&0<b.length?a.refresh(b):a.refresh([])})})},storeSelectFavCodes:function(){var a=dijit.byId("rateBondFavoriteTable"),
b=a.getSelectedRows();if(0<b.length){var c=a.data,g=[],e=C.getCurrentUserID();z.forEach(b,function(a){g.push({traderID:e,bondCode:c[+a].bondCode})});var f=bondForumConfig.favRateBondCodes,h=[],i=[];z.forEach(g,function(a){-1==z.indexOf(f,a.bondCode)&&(h.push(a.bondCode),i.push(a))});(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addFavoriteBond.dzh?quotationType=1&favoriteBondList="+JSON.stringify(i)+"&t="+(new Date).getTime())).then(function(){});bondForumConfig.favRateBondCodes=
f=f.concat(h)}},bindMyFavRowDelete:function(a){var b=this;a.on("click",function(c,g){var d=c.target.getAttribute("clickFn");d&&q.hitch(b,function(){this[d](c,g,a)})()})},myFavDelRow:function(a,b,c){a=c.data.splice(b.row,1);c.refresh();this.processDelRowToBackend(a,c)},processDelRowToBackend:function(a){if(a&&a[0]){var b=a[0].id;if(b){var c=a[0].bondCode;(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/deleteFavoriteBond.dzh?id="+b+"&t="+(new Date).getTime())).then(function(){var a=
z.filter(bondForumConfig.favRateBondCodes,function(a){return a==c});bondForumConfig.favRateBondCodes=a})}}},createQuoteTable:function(){this.getSearchCondition();var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:40,formatter:u.index,resizable:!1,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:u.timeFormat,width:70,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",
field:"quoteAgency",width:80,sortable:!0,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,formatter:u.tarderFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"bondCode",name:"\u503a\u5238\u4ee3\u7801",field:"bondCode",sortable:!0,
formatter:u.bondInfoLinkFormat,width:80,cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"bondName",name:"\u503a\u5238\u7b80\u79f0",field:"bondName",sortable:!0,formatter:u.bondInfoLinkFormat2,width:100,cssClass:"font-gray font-left",headerCssClass:"font-center"},{id:"favFlg",name:"",field:"favFlg",width:40,resizable:!1,sortable:!0,formatter:u.rateFavFormat,cssClass:"font-gray font-center",headerCssClass:"font-center header_fav"},{id:"bondTerm",name:"\u503a\u5238\u671f\u9650(\u5e74)",
field:"bondTerm",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center "},{id:"rating",name:"\u503a\u5238\u8bc4\u7ea7",field:"rating",sortable:!0,formatter:u.nullToMidline,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],b=A("#rateTable").data("moreIndex")[0],a=d.addRateCreditColumnsDef(a,b),a=a.concat([{id:"remark",name:"\u5907\u6ce8",field:"remark",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"}]),b={forceFitColumns:!0,
hideBorder:"body"},c=d.getLeftTableAvailableSize(),c=parseInt(c/80);a.length>c&&(b={forceFitColumns:!1,hideBorder:"body",frozenColumn:6});a=this.quoteGrid=new h({store:new r,columns:a,options:b},"quoteTable");a.startup();this.topRateFlg=0;this.bindInitData(a);this.bindTopicHandler(a);d.bindCellClick(a,this);this.resize();d.openPopupPanel(a)},addQuoteToFav:function(a,b,c){var a=c.data[b.row].bondCode,a=[{traderID:C.getCurrentUserID(),bondCode:a}],g=bondForumConfig.favRateBondCodes,e=[],f=[];z.forEach(a,
function(a){-1==z.indexOf(g,a.bondCode)&&(e.push(a.bondCode),f.push(a))});(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addFavoriteBond.dzh?quotationType=1&favoriteBondList="+JSON.stringify(f))).then(function(){});bondForumConfig.favRateBondCodes=g=g.concat(e);this.dynaSearchTable()},openImDialog:function(a,b,c){C.openChatWnd(c.data[b.row].traderID)},bindInitData:function(a){var b=this;(new B).query(d.getSocketParams(bondForumConfig.soUrl+"bondQuotation/rateList.dzh?t="+(new Date).getTime())).then(function(c){c=
d.arrayFilter(c||[],a.pushData||[],"id");c=d.filterPrivateArray(c);b.topRateFlg+=1;if(0!=c.length){var g=A("#rateTable").data()[0],c=d.filterRateCreditArrayWithQueryCondition(c,g,1,bondForumConfig.favRateBondCodes,bondForumConfig.rateCounterparty);a.store.data=c;a.refresh(c)}})},bindTopicHandler:function(a){var b=this;b.quoteHandler=t.subscribe("bondQuote/rateBond",function(c){var g=a.data,e=JSON.parse(c.data).result;if(e){for(var c=e.head,f=e.datas,e=[],h=0,i=f.length;h<i;h++){for(var y={},j=0,k=
c.length;j<k;j++)y[c[j]]=f[h][j];e.push(y)}c=A("#rateTable").data()[0];c=d.filterRateCreditArrayWithQueryCondition(e,c,1,bondForumConfig.favRateBondCodes,bondForumConfig.rateCounterparty);0<b.topRateFlg?(g=d.arrayFilter(g||[],c||[],"id"),g=d.filterPrivateArray(g),a.store.data=g,a.refresh(g),a.pushData=null):a.pushData=a.pushData?[].concat(c,a.pushData):c}})},bindExcelExport:function(){var a=dijit.byId("quoteTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u73b0\u5238\u52a8\u6001\u62a5\u4ef7</td></tr>";
d.saveAsExcel("\u5927\u667a\u6167_\u73b0\u5238\u4e0a\u90e8_"+d.generateTimeStamp(),b,"\u73b0\u5238",a,a.getColumns())},resize:function(a){a&&p.setMarginBox(this.domNode,{w:a.w,y:a.y});this.inherited(arguments)}})})},"url:bond/bondQuotation/view/rate/topRateBondQuote.html":'<div data-dojo-attach-point="containerNode" class="border_box spacer hbox">\r\n    <div class="vbox globalWidth globalHeight" id="de_table">\r\n        <\!-- begin  \u9009\u62e9\u6761\u4ef6\u7b5b\u9009\u6761--\>\r\n        <div class="border_box">\r\n            <div class="hbox dijitRegionalPane spacer top_menu02" >\r\n                <div class="spacer">\r\n\r\n                    <\!--\u65b0\u4fee\u6539,\u8303\u56f4\u529f\u80fd\u53bb\u9664,\u6b64\u5904\u9690\u85cf--\>\r\n                    <label for="area" style="display:none;">\u8303\u56f4</label>\r\n                    <div data-dojo-type="dijit/form/Select" id="area" style="width:95px;color:black; display:none;">\r\n                        <option value="1" selected>\u5168\u90e8</option>\r\n                        <option value="2" selected>\u6536\u85cf\u7684\u503a\u5238</option>\r\n                        <option value="3" selected>\u4ea4\u6613\u5bf9\u624b\u65b9</option>\r\n                    </div>\r\n\r\n\r\n                    <label for="bondType">\u503a\u5238\u7c7b\u578b</label>\r\n                    <select id="bondType" data-dojo-type="bond/bondQuotation/view/_helper/MCheckedMultiSelect">\r\n                        <option value="all" selected="selected">\u5168\u90e8</option>\r\n                        <option value="1" selected="selected">\u56fd\u503a</option>\r\n                        <option value="2" selected="selected">\u592e\u884c\u7968\u636e</option>\r\n                        <option value="10" selected="selected">\u5730\u65b9\u653f\u5e9c\u503a</option>\r\n                        <option value="3" selected="selected">\u653f\u7b56\u6027\u91d1\u878d\u503a</option>\r\n                        <option value="4" selected="selected">\u5546\u4e1a\u94f6\u884c\u503a</option>\r\n                        <option value="5" selected="selected">\u975e\u94f6\u884c\u91d1\u878d\u503a</option>\r\n                        <option value="6" selected="selected">\u666e\u901a\u4f01\u4e1a\u503a</option>\r\n                        <option value="11" selected="selected">\u4e2d\u671f\u7968\u636e</option>\r\n                        <option value="12" selected="selected">\u77ed\u671f\u878d\u8d44\u5238</option>\r\n                        <option value="13" selected="selected">\u516c\u53f8\u503a</option>\r\n                        <option value="7" selected="selected">\u53ef\u8f6c\u6362\u503a\u5238</option>\r\n                        <option value="8" selected="selected">\u56fd\u9645\u5f00\u53d1\u503a\u5238</option>\r\n                        <option value="9" selected="selected">\u53ef\u4ea4\u6362\u503a\u5238</option>\r\n                        <option value="14" selected="selected">\u5206\u79bb\u5f0f\u53ef\u8f6c\u6362\u503a</option>\r\n                        <option value="15" selected="selected">\u96c6\u5408\u7968\u636e</option>\r\n                        <option value="16" selected="selected">\u96c6\u5408\u503a\u5238</option>\r\n                        <option value="17" selected="selected">\u91d1\u878d\u673a\u6784\u878d\u8d44\u5238</option>\r\n                        <option value="18" selected="selected">\u653f\u5e9c\u652f\u6301\u503a\u5238</option>\r\n                        <option value="20" selected="selected">\u8d44\u4ea7\u652f\u6301\u7968\u636e</option>\r\n                        <option value="21" selected="selected">\u4e2d\u5c0f\u4f01\u4e1a\u79c1\u52df\u503a</option>\r\n                        <option value="30" selected="selected">\u8d44\u4ea7\u652f\u6301\u8bc1\u5238</option>\r\n                    </select>\r\n\r\n                    <label for="compStage">\u4ee3\u507f\u671f</label>\r\n                    <select id="compStage" data-dojo-type="bond/bondQuotation/view/_helper/MCheckedMultiSelect">\r\n                        <option value="all" selected="selected">\u5168\u90e8</option>\r\n                        <option value="0" selected="selected">1\u5e74\u4ee5\u5185</option>\r\n                        <option value="1" selected="selected">1-3\u5e74</option>\r\n                        <option value="3" selected="selected">3-5\u5e74</option>\r\n                        <option value="5" selected="selected">5-7\u5e74</option>\r\n                        <option value="7" selected="selected">7-10\u5e74</option>\r\n                        <option value="10" selected="selected">10-15\u5e74</option>\r\n                        <option value="15" selected="selected">15-20\u5e74</option>\r\n                        <option value="20" selected="selected">20-25\u5e74</option>\r\n                        <option value="25" selected="selected">25\u5e74\u4ee5\u4e0a</option>\r\n                    </select>\r\n\r\n                    <div data-dojo-type="dijit.form.Button" data-dojo-attach-point="rateSearchBtn"\r\n                         style="display:none;" data-dojo-props="label:\'\u786e\u5b9a\'"></div>\r\n\r\n                </div>\r\n                <div class="hbox button_style2">\r\n                    <\!--\u66f4\u591a\u7b5b\u9009\u529f\u80fd\u53bb\u9664,\u6b64\u5904\u9690\u85cf--\>\r\n                    <div style="display: none;">\r\n                        <div data-dojo-type="dijit.form.Button" id="rateMoreFilter"\r\n                             data-dojo-props="label:\'\u66f4\u591a\u7b5b\u9009\',dialogId:\'rateMoreFilter\'"></div>\r\n                    </div>\r\n                    <div>\r\n                        <div data-dojo-type="dijit.form.Button" id="rateMoreIndex"\r\n                             data-dojo-props="label:\'\u66f4\u591a\u6307\u6807\',dialogId:\'rateMoreIndex\'"></div>\r\n                    </div>\r\n                    <div>\r\n                        <div data-dojo-type="dijit.form.Button" id="rateMoreFavorite"\r\n                             data-dojo-props="label:\'\u6536\u85cf\',dialogId:\'rateMoreFavorite\'"></div>\r\n                    </div>\r\n                    <div>\r\n                        <div data-dojo-type="dijit.form.Button" id="rateAddCounterparty"\r\n                             data-dojo-props="label:\'\u5bf9\u624b\u65b9\',dialogId:\'rateAddCounterparty\'"></div>\r\n                    </div>\r\n                    <div>\r\n                        <div data-dojo-type="dijit.form.Button" id="rateTopExcelExport" data-dojo-props="label:\'\u5bfc\u51fa\u5230Excel\'"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <\!--end  \u9009\u62e9\u6761\u4ef6\u7b5b\u9009\u6761--\>\r\n\r\n        <\!-- begin  \u52a8\u6001\u8868\u683c\u53ca\u53f3\u90e8\u7684\u7fa4\u90e8\u5206  --\>\r\n        <div class="border_box spacer vbox" style="overflow-x:hidden">\r\n            <div class="spacer" data-dojo-type="dijit/layout/ContentPane">\r\n                <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="quoteTableParent" class="myGrid spacer">\r\n                    <div id="quoteTable" class="spacer"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <\!-- end  \u52a8\u6001\u8868\u683c\u53ca\u53f3\u90e8\u7684\u7fa4\u90e8\u5206  --\>\r\n    </div>\r\n</div>',
"bond/bondQuotation/view/rate/rateCounterparty":function(){define("dijit/Dialog,dojo/on,dojox/slickgrid/slickgrid,dojo/store/Memory,../_helper/util,../_helper/htmlFormatter,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/io-query,dojo/_base/lang,dijit/registry,dojo/_base/array,bond/bondQuotation/view/_helper/imUtil".split(","),function(n,l,j,b,e,f,i,h,r,t,p,k){var f=new f,q=[{id:"counterpartyTraderID",name:"\u5e10\u53f7",field:"counterpartyTraderID",width:60,cssClass:"font-yellow font-center",
headerCssClass:"font-center"},{id:"counterpartyTraderName",name:"\u59d3\u540d",field:"counterpartyTraderName",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyAgencyName",name:"\u516c\u53f8",field:"counterpartyAgencyName",formatter:f.nullToNone,width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyPhone",name:"\u7535\u8bdd",formatter:f.nullToNone,field:"counterpartyPhone",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],
s=[{id:"operate",name:"\u64cd\u4f5c",formatter:function(){return'<a href="#" clickFn="addCounterparty">\u6dfb\u52a0</a>'},field:"operate",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],c=[{id:"operate",name:"\u64cd\u4f5c",formatter:function(){return'<a href="#" clickFn="delCounterparty">\u5220\u9664</a>'},field:"operate",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],d={createRateCounterparty:function(){var a=d,b=dijit.byId("rateCounterpartyDialog");
b||(b=new n({id:"rateCounterpartyDialog",title:"\u6211\u7684\u4ea4\u6613\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/rate/rateCounterpartyDialog.html",onDownloadEnd:function(){l(dijit.byId("rateCounterpartyOk"),"click",function(){dijit.byId("rateCounterpartyDialog").onCancel();a.storeCounterpartyData()});a.createMyCounterpartyTable();a.initialSearch()}}));b.show()},storeCounterpartyData:function(){var a=dijit.byId("rateCounterpartyTable").data,b=[],c=k.getCurrentUserID();
0<a.length&&(p.forEach(a,function(a){b.push({traderID:c,counterpartyTraderID:a.counterpartyTraderID,counterpartyTraderName:a.counterpartyTraderName,counterpartyAgencyName:a.counterpartyAgencyName,counterpartyPhone:a.counterpartyPhone})}),a=e.encodeObjArrayToString(b),a={quotationType:1,myCounterparty:encodeURI(a),t:(new Date).getTime()},(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addMyCounterparty.dzh?"+h.objectToQuery(a))).then(function(){bondForumConfig.rateCounterparty=
b}))},initialSearch:function(){var a=d,b=dijit.byId("rateCounterpartyTabContainer");b.watch("selectedChildWidget",function(){});l(b.tablist,"selectChild",r.hitch(a,"switchTab"));a.createCounterpartyTable1();a.createCounterpartyTable2();a.bindSearchByContition()},bindOperate:function(a){var b=d;a.on("click",function(c,d){var e=c.target.getAttribute("clickFn");e&&r.hitch(b,function(){this[e](c,d,a)})()})},addCounterparty:function(a,b,c){var a=dijit.byId("rateCounterpartyTable"),d=a.data,e=c.data[b.row];
p.some(d,function(a){var b=!1;e.counterpartyTraderID==k.getCurrentUserID()?b=!0:a.counterpartyTraderID===e.counterpartyTraderID&&(b=!0);return b})||(d.push(e),a.refresh(d))},delCounterparty:function(a,b,c){c.data.splice(b.row,1);c.refresh()},createMyCounterpartyTable:function(){var a=d,g=[].concat(q,c),g=new j({store:new b,columns:g,options:{forceFitColumns:!0}},"rateCounterpartyTable");g.startup();a.bindInitCounterparty(g);a.bindOperate(g)},bindInitCounterparty:function(a){(new i).query(e.getSocketParams(bondForumConfig.soUrl+
"bondQuotation/getMyCounterparty.dzh?traderID="+k.getCurrentUserID()+"&quotationType=1&t="+(new Date).getTime())).then(function(b){b&&0<b.length?(p.map(b,function(a){return a.counterpartyTraderID}),a.refresh(b),bondForumConfig.rateCounterparty=b):a.refresh([])})},switchTab:function(a){var b=d;"\u6761\u4ef6\u67e5\u627e"!=a.title&&"\u4eceIM\u8054\u7cfb\u4eba\u6dfb\u52a0"==a.title&&b.selectCounterparty2()},createCounterpartyTable1:function(){var a=d,c=[].concat(q,s),c=new j({store:new b,columns:c,options:{forceFitColumns:!0}},
"rateCounterpartyTable1");c.startup();a.bindOperate(c)},bindSearchByContition:function(){var a=d;l(dijit.byId("rateCounterpartyAddSearch"),"click",function(){var b=dijit.byId("rateCounterpartyAddAccount").get("value"),c=dijit.byId("rateCounterpartyAddName").get("value"),d=dijit.byId("rateCounterpartyAddComp").get("value"),b=JSON.stringify({ID:b,RealName:c,Company:d});(b=k.queryContatInfoByKey(b))&&a.selectCounterparty1(b)})},selectCounterparty1:function(a){var b=dijit.byId("rateCounterpartyTable1"),
a=p.map(a,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),c=k.getCurrentUserID(),a=p.filter(a,function(a){return a.counterpartyTraderID!=c});b.refresh(a)},createCounterpartyTable2:function(){var a=d,c=[].concat(q,s),c=new j({store:new b,columns:c,options:{forceFitColumns:!0}},"rateCounterpartyTable2");c.startup();a.bindOperate(c)},selectCounterparty2:function(){var a=dijit.byId("rateCounterpartyTable2"),
b=k.queryUserGroup(k.getCurrentUserID(),1);if(b){var b=b.GroupInfo["\u6211\u7684\u597d\u53cb"].join(","),b=k.queryContactInfoInGlobal(b),b=p.map(b,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),c=k.getCurrentUserID(),b=p.filter(b,function(a){return a.counterpartyTraderID!=c});a.refresh(b)}else a.refresh([])},saveSelectCounterpartyData:function(a){var b;b=1==a?dijit.byId("rateCounterpartyTable1"):
dijit.byId("rateCounterpartyTable2");var a=b.getSelectedRows(),c=b.data;if(0<a.length){b=dijit.byId("rateCounterpartyTable");var d=b.data,e=[];p.forEach(a,function(a){var b=c[+a];p.some(d,function(a){return a.counterpartyTraderID==b.counterpartyTraderID})||e.push(b)});b.refresh(d.concat(e))}}};return d})},"bond/bondQuotation/view/capital/bottomCapitalBondQuote":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/text!./bottomCapitalBondQuote.html,dojo/text!./bottomCapitalBondQuoteTemplete.html,dojo/query,dojo/dom-class,dojo/on,dojo/_base/array,dojo/json,dojo/dom,dojo/dom-construct,dijit/Dialog,dijit/registry,bond/bondQuotation/view/_helper/htmlFormatter,dojox/slickgrid/slickgrid,dojo/store/Memory,dojo/topic,dojo/dom-geometry,dojo/_base/lang,dojo/_base/event,bond/bondQuotation/view/capital/capitalCommonDialog,bond/bondQuotation/view/_helper/MessageDialog,bond/bondQuotation/view/_helper/util,dojox/store/WebSocket,dojo/io-query,bond/bondQuotation/view/_helper/GridSOSubStore,bond/bondQuotation/view/_helper/imUtil".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s,c,d,a,g,x,y,z,D,B,A,o,m,E,F,C,u){var v=new a;return n("bond.bondQuotation.view.bottomCapitalBondQuote",[l,j,b,e],{templateString:f,startup:function(){this.inherited(arguments);this.bindQuoteStackEvents()},bindQuoteStackEvents:function(){var a=this;dijit.byId("capitalQuoteStackBtns").getChildren().forEach(function(b){var c=b.label;"\u5bfc\u51fa\u5230Excel"!=c&&(a.initialQuote(b,c),b.on("click",function(){h(".button_selected").forEach(function(a){r.remove(a,"button_selected")});
"\u6211\u8981\u62a5\u4ef7"==b.label?(r.add(dijit.byId("capitalNeedBtn").domNode,"button_selected"),h("#capitalNeedQuote").addClass("vbox"),h("#capitalMyReceiveQuote").removeClass("vbox").addClass("none"),h("#capitalMyQuote").removeClass("vbox").addClass("none"),dijit.byId("capitalQuoteExcel").set("style",{visibility:"hidden"}).set("searchKey","needQuote"),a.resize()):"\u6211\u6536\u5230\u7684\u62a5\u4ef7"==b.label?(r.add(dijit.byId("capitalMyReceiveBtn").domNode,"button_selected"),h("#capitalNeedQuote").removeClass("vbox").addClass("none"),
h("#capitalMyReceiveQuote").addClass("vbox"),h("#capitalMyQuote").removeClass("vbox").addClass("none"),dijit.byId("capitalQuoteExcel").set("style",{visibility:"visible "}).set("searchKey","myReceiveQuote"),a.resize()):"\u6211\u7684\u62a5\u4ef7"==b.label&&(r.add(dijit.byId("capitalMyBtn").domNode,"button_selected"),h("#capitalNeedQuote").removeClass("vbox").addClass("none"),h("#capitalMyReceiveQuote").removeClass("vbox").addClass("none"),h("#capitalMyQuote").addClass("vbox"),dijit.byId("capitalQuoteExcel").set("style",
{visibility:"visible "}).set("searchKey","myQuote"),a.resize())}))});t(dijit.byId("capitalQuoteExcel"),"click",function(){a.bindExcelExport()})},initialQuote:function(a,b){"\u6211\u8981\u62a5\u4ef7"==b?(r.add(a.containerNode,"highlighBtn"),dijit.byId("capitalQuoteExcel").set("style",{visibility:"hidden"}).set("searchKey","needQuote"),this.initialNeedQuote()):"\u6211\u6536\u5230\u7684\u62a5\u4ef7"==b?setTimeout(D.hitch(this,"initialReceiveQuote"),100):"\u6211\u7684\u62a5\u4ef7"==b&&setTimeout(D.hitch(this,
"initialMyQuote"),100)},initialNeedQuote:function(){var a=this;q.byId("capitalTableParent").innerHTML=i;t(a.capitalNeedQuoteSubmit,"click",function(){if(m.checkPermission(bondForumConfig.permission))if(q.byId("capitalForm").checkValidity()){var b=1==dijit.byId("bondCapitalNeedQuoteTarget").get("value")?3:1;a.needQuoteSubmitFunc(b)}else(new o).showDialog("\u6570\u636e\u9a8c\u8bc1\u672a\u901a\u8fc7\uff0c\u8bf7\u67e5\u770b\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b\u53ca\u683c\u5f0f!")});a.needQuoteClearFunc();
a.needQuoteAddAndDeleteLineFunc()},needQuoteSubmitFunc:function(a){var b=[];h("#capitalMyTable tr").forEach(function(a){a=p.map(a.children,function(a){if("th"==a.nodeName||"TH"==a.nodeName||a.children&&0==a.children.length)return a.innerText;if(a.children&&0<a.children.length)return a.children[0].value});b.push(a)});b=m.filterNeedQuote(b,3);if(0==b.length)return"error";var c=[];p.forEach(bondForumConfig.capitalCounterparty,function(a){c.push(a.counterpartyTraderID)});c=c.join(",");if(0==c.length||
1==a)c=void 0,a=1;s.place(i,"capitalMyTable","replace");var d=m.getCapitalQuoteLabel(),g=bondForumConfig.userInfo,e=u.getCurrentUserID();g&&(e=g.RealName);d=m.quoteAddConvert(d,b,{traderID:u.getCurrentUserID(),quoteAgency:"dzh",traderName:e,counterpartyTraderID:c||""});a={postTarget:a,quoteInfoAdd:encodeURI(k.stringify(d)),t:(new Date).getTime()};(new E).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addFund.dzh?"+F.objectToQuery(a))).then(function(a){c&&setTimeout(function(){u.sendQuoteInfo(a,
u.getCurrentUserID(),c)},50)})},needQuoteClearFunc:function(){t(this.capitalNeedQuoteClear,"click",function(){s.place(i,"capitalMyTable","replace")})},needQuoteAddAndDeleteLineFunc:function(){t(q.byId("capitalTableParent"),"click",function(a){B.stop(a);var a=a.target,b=a.getAttribute("opFunc");if("addItem"!=b&&"delItem"==b){var b=h(a).closest("tr"),c=h(a).closest("tbody"),a=b[0].children[0].innerText,c=c[0].children.length-2;s.destroy(b[0]);if(a!=c){b=0;for(c-=a;b<c;b++){var d=h("#capitalMyTable tr:nth-child("+
(+a+b+1)+")")[0].children[0];d.innerText=+d.innerText-1}}}});t(q.byId("capitalAddItem"),"click",function(){var a=h("#capitalMyTable tr").length,a=s.toDom("<tr><td>"+(a-1)+'</td><td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td><td><input class="td_input_text" type="text" checkType="validNumber"  /></td><td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td><td><input class="td_input_text" type="text" checkType="validNumber"  /></td><td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td><td><input class="td_input_text" type="text" /></td><td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td></tr>');
s.place(a,"capitalAddItemTr","before")});t(q.byId("capitalTableParent"),"keypress",function(a){m.checkInput(a)})},initialReceiveQuote:function(){var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:60,formatter:v.index,resizable:!1,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:v.timeFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",
field:"quoteAgency",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,formatter:v.tarderFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"amount",name:"\u91d1\u989dW",field:"amount",sortable:!0,width:80,
cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"bondTerm",name:"\u671f\u9650",field:"bondTerm",sortable:!0,formatter:v.capitalBondTermFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"pawn",name:"\u62b5\u62bc\u7269",field:"pawn",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"remark",name:"\u5907\u6ce8",field:"remark",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"}],a=
new g({store:new x,columns:a,options:{forceFitColumns:!0,hideBorder:"body"}},"capitalMyReceiveTable");a.startup();this.bottomReceiveFlg=0;this.bindReceiveInitData(a);this.bindReceiveQuoteHandler(a);m.bindCellClick(a,this);m.openPopupPanel(a)},openImDialog:function(a,b,c){u.openChatWnd(c.data[b.row].traderID)},bindReceiveInitData:function(a){var b=this;(new C).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/fundList.dzh?t="+(new Date).getTime())).then(function(c){if(c)var d=u.getCurrentUserID(),
c=m.filterArrayWithQuote(c,"counterpartyTraderID",d,3);c=m.arrayFilter(c||[],a.pushData||[],"id");c=m.filterPrivateArray(c);b.bottomReceiveFlg+=1;if(0!=c.length)a.store.data=c,a.refresh(c)})},bindReceiveQuoteHandler:function(a){var b=this;b.receiveQuoteHandler=y.subscribe("bondQuote/rateBond",function(c){var d=a.data,g=k.parse(c.data).result;if(g){for(var c=g.head,e=g.datas,g=[],f=0,h=e.length;f<h;f++){for(var i={},j=0,l=c.length;j<l;j++)i[c[j]]=e[f][j];g.push(i)}c=u.getCurrentUserID();c=m.filterArrayWithQuote(g,
"counterpartyTraderID",c,3);0<b.bottomReceiveFlg?(d=m.arrayFilter(d||[],c||[],"id"),a.store.data=d,a.refresh(d),a.pushData=null):a.pushData=a.pushData?[].concat(c,a.pushData):c}})},initialMyQuote:function(){var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:60,formatter:v.index,resizable:!1,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:v.timeFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},
{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",field:"quoteAgency",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"amount",name:"\u91d1\u989dW",field:"amount",
sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"bondTerm",name:"\u671f\u9650",field:"bondTerm",sortable:!0,width:80,formatter:v.capitalBondTermFormat,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"pawn",name:"\u62b5\u62bc\u7269",field:"pawn",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"remark",name:"\u5907\u6ce8",field:"remark",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},
{id:"operate",name:"\u64cd\u4f5c",field:"operate",width:80,cssClass:"font-gray font-center",headerCssClass:"font-center",formatter:function(){return'<input type="image" class="slickgrid_deleteIcon" src="./resources/images/ico-delete.gif" clickFn="myQuoteDelRow">'}}],a=new g({store:new x,columns:a,options:{forceFitColumns:!0,hideBorder:"body"}},"capitalMyQuoteTable");a.startup();this.initMyQuoteData(a);this.bindMyQuoteHandler(a);this.bindMyQuoteRowDelete(a)},initMyQuoteData:function(a){(new C).query(m.getSocketParams(bondForumConfig.soUrl+
"bondQuotation/getMyQuoteInfo.dzh?traderID="+u.getCurrentUserID()+"&type=3&t="+(new Date).getTime())).then(function(b){a.store.data=b;a.refresh(b)})},bindMyQuoteHandler:function(a){this.myQuoteHandler=y.subscribe("bondQuote/rateBond",function(b){var c=a.data,d=k.parse(b.data).result;if(d){for(var b=d.head,g=d.datas,d=[],e=0,f=g.length;e<f;e++){for(var h={},i=0,j=b.length;i<j;i++)h[b[i]]=g[e][i];h.actType&&2!=h.actType&&d.push(h)}b=u.getCurrentUserID();d=m.filterArrayWithQuote(d,"traderID",b,3);c=
d.concat(c);a.store.data=c;a.refresh(c)}})},bindMyQuoteRowDelete:function(a){var b=this;a.on("click",function(c,d){var g=c.target.getAttribute("clickFn");g&&D.hitch(b,function(){this[g](c,d,a)})()})},myQuoteDelRow:function(a,b,c){a=c.data.splice(b.row,1);c.refresh();this.processDelRowToBackend(a,c)},processDelRowToBackend:function(a){if(a&&a[0])a=a[0].id,(new C).query(m.getSocketParams(bondForumConfig.soUrl+"bondQuotation/deleteFund.dzh?id="+a)).then(function(){})},bindExcelExport:function(){var a=
dijit.byId("capitalQuoteExcel"),b;"myReceiveQuote"==a.get("searchKey")?(a=dijit.byId("capitalMyReceiveTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u8d44\u91d1\u6211\u6536\u5230\u7684\u62a5\u4ef7</td></tr>",m.saveAsExcel("\u5927\u667a\u6167_\u8d44\u91d1_\u6211\u6536\u5230\u7684\u62a5\u4ef7_"+m.generateTimeStamp(),b,"\u8d44\u91d1",a,a.getColumns())):"myQuote"==a.get("searchKey")&&
(a=dijit.byId("capitalMyQuoteTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u8d44\u91d1\u6211\u7684\u62a5\u4ef7</td></tr>",m.saveAsExcel("\u5927\u667a\u6167_\u8d44\u91d1_\u6211\u7684\u62a5\u4ef7_"+m.generateTimeStamp(),b,"\u8d44\u91d1",a,a.getColumns()))},resize:function(a){a&&z.setMarginBox(this.domNode,{w:a.w,y:a.y});this.inherited(arguments)}})})},"url:bond/bondQuotation/view/capital/bottomCapitalBondQuote.html":'<div data-dojo-attach-point="containerNode" class="vbox spacer globalHeight">\r\n    <div class="spacer hbox " data-dojo-type="dijit/layout/ContentPane" style="overflow-y: hidden;">\r\n        <div class="spacer vbox " data-dojo-type="dijit/layout/ContentPane" style="overflow-x:auto;">\r\n            <div class="hbox">\r\n                <div class="hbox bottomQuoteBtn bottom_width dijitRegionalPane spacer" data-dojo-type="dijit/layout/ContentPane"\r\n                     id="capitalQuoteStackBtns">\r\n                    <button id="capitalNeedBtn" data-dojo-type="dijit/form/Button" class="button_selected" data-dojo-props="searchKey:\'\'">\u6211\u8981\u62a5\u4ef7</button>\r\n                    <button id="capitalMyReceiveBtn" data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'">\u6211\u6536\u5230\u7684\u62a5\u4ef7</button>\r\n                    <button id="capitalMyBtn"  data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'">\u6211\u7684\u62a5\u4ef7</button>\r\n                    <button data-dojo-type="dijit/form/Button" data-dojo-props="searchKey:\'\'" id="capitalQuoteExcel"\r\n                            class="end_pack_align_box">\u5bfc\u51fa\u5230Excel\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u8981\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="needQuote_height myTable_style"  id="capitalNeedQuote">\r\n                <div style="overflow-y: auto;">\r\n                    <form id="capitalForm">\r\n                        <div id="capitalTableParent">\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class="bottom_width1 border_box hbox" style="padding:0 0 5px 0; -webkit-box-pack: center;">\r\n                        <div class="end_pack_align_box contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u63d0\u4ea4\'"\r\n                                 data-dojo-attach-point="capitalNeedQuoteSubmit"></div>\r\n                        </div>\r\n\r\n                        <div class="sp_add contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u6dfb\u52a0\'"\r\n                                 opfunc="addItem" id="capitalAddItem"></div>\r\n                        </div>\r\n\r\n                        <div class="start_pack_align_box contrl_box">\r\n                            <div data-dojo-type="dijit.form.Button" class="button_style" data-dojo-props="label:\'\u6e05\u7a7a\'"\r\n                                 data-dojo-attach-point="capitalNeedQuoteClear"></div>\r\n                        </div>\r\n                        <div class="contrl_box">\r\n                            <input id="bondCapitalNeedQuoteTarget" type="checkbox"\r\n                                   data-dojo-type="dijit/form/CheckBox" value="1" checked="false"/>\r\n                            <label for="bondCapitalNeedQuoteTarget">\u53d1\u9001\u5230\u4ea4\u6613\u5bf9\u624b</label>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u6536\u5230\u7684\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="spacer  none" id="capitalMyReceiveQuote">\r\n                <div class="vbox spacer " data-dojo-type="dijit/layout/ContentPane">\r\n                    <div id="capitalMyReceiveTableParent" data-dojo-type="dijit/layout/ContentPane"  class="myGrid" >\r\n                        <div id="capitalMyReceiveTable"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <\!--\u6211\u7684\u62a5\u4ef7\u9875\u7b7e--\>\r\n            <div class="spacer  none" id="capitalMyQuote">\r\n                <div class="vbox spacer " data-dojo-type="dijit/layout/ContentPane">\r\n                    <div id="capitalMyQuoteTableParent" data-dojo-type="dijit/layout/ContentPane" class="myGrid">\r\n                        <div id="capitalMyQuoteTable"></div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</div>',
"url:bond/bondQuotation/view/capital/bottomCapitalBondQuoteTemplete.html":'<table border=1 class="table bottom_width1" id="capitalMyTable">\r\n    <tbody>\r\n    <tr>\r\n        <th>\u5e8f\u53f7</th>\r\n        <th>\u65b9\u5411</th>\r\n        <th>\u671f\u9650</th>\r\n        <th>\u671f\u9650\u5355\u4f4d</th>\r\n        <th>\u91d1\u989d(\u4e07)</th>\r\n        <th>\u62b5\u62bc</th>\r\n        <th>\u5907\u6ce8</th>\r\n        <th>\u64cd\u4f5c</th>\r\n    </tr>\r\n\r\n    <tr>\r\n        <td>1</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"  /></td>\r\n        <td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"  /></td>\r\n        <td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td>\r\n        <td><input class="td_input_text" type="text" /></td>\r\n        <td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>\r\n    </tr>\r\n    <tr>\r\n        <td>2</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber" /></td>\r\n        <td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"  /></td>\r\n        <td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td>\r\n        <td><input class="td_input_text" type="text"/></td>\r\n        <td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>\r\n    </tr>\r\n    <\!--<tr>--\>\r\n        <\!--<td>3</td>--\>\r\n        <\!--<td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber" /></td>--\>\r\n        <\!--<td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber" /></td>--\>\r\n        <\!--<td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" /></td>--\>\r\n        <\!--<td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>--\>\r\n    <\!--</tr>--\>\r\n    <\!--<tr>--\>\r\n        <\!--<td>4</td>--\>\r\n        <\!--<td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber"  /></td>--\>\r\n        <\!--<td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" checkType="validNumber"  /></td>--\>\r\n        <\!--<td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td>--\>\r\n        <\!--<td><input class="td_input_text" type="text" /></td>--\>\r\n        <\!--<td><input type="image" src="./resources/images/ico-delete.gif" opFunc="delItem"></td>--\>\r\n    <\!--</tr>--\>\r\n    <tr id="capitalAddItemTr" style="display: none;">\r\n        <td>\u53c2\u7167\u884c</td>\r\n        <td><select><option value="\u6536">\u6536</option><option value="\u51fa">\u51fa</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber" noValidate/></td>\r\n        <td><select><option value="1">\u5929</option><option value="2">\u5468</option><option value="3">\u6708</option></select></td>\r\n        <td><input class="td_input_text" type="text" checkType="validNumber"  noValidate/></td>\r\n        <td><select><option value="\u4e0d\u9650">\u4e0d\u9650</option><option value="\u4ec5\u5229\u7387">\u4ec5\u5229\u7387</option><option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option></select></td>\r\n        <td><input class="td_input_text" type="text" /></td>\r\n        <td><input type="image" src="./resources/images/ico-add.gif" opFunc="addItem"></td>\r\n    </tr>\r\n    </tbody>\r\n</table>',
"bond/bondQuotation/view/capital/capitalCommonDialog":function(){define("dijit/Dialog,dojo/on,dojox/slickgrid/slickgrid,dojo/store/Memory,../_helper/util,../_helper/htmlFormatter,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/io-query,dojo/_base/lang,dijit/registry,dojo/_base/array,bond/bondQuotation/view/_helper/imUtil".split(","),function(n,l,j,b,e,f,i,h,r,t,p,k){var f=new f,q=[{CheckBoxSelectColumn:!0,cssClass:"font-center",toolTip:"\u9009\u4e2d/\u53d6\u6d88\u5168\u9009",width:60,showTitleCheckBox:!0,
headerCssClass:"font-center"},{id:"indexNo",name:"\u5e8f\u53f7",width:60,formatter:f.index,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyTraderID",name:"\u5e10\u53f7",field:"counterpartyTraderID",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyTraderName",name:"\u59d3\u540d",field:"counterpartyTraderName",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyAgencyName",name:"\u516c\u53f8",
field:"counterpartyAgencyName",formatter:f.nullToNone,width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"loginState",name:"\u5728\u7ebf\u72b6\u6001",formatter:f.userStatusFormat,field:"loginState",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyPhone",name:"\u7535\u8bdd",formatter:f.nullToNone,field:"counterpartyPhone",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],s={createCapitalCounterparty:function(){var b=
s,d=dijit.byId("capitalCounterpartyDialog");d||(d=new n({id:"capitalCounterpartyDialog",title:"\u6211\u7684\u4ea4\u6613\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/capital/topCapitalCounterpartyDialog.html",onDownloadEnd:function(){l(dijit.byId("capitalCounterpartyOk"),"click",function(){dijit.byId("capitalCounterpartyDialog").onCancel();b.storeCounterpartyData()});b.createMyCounterpartyTable();l(dijit.byId("capitalCounterpartyAdd"),"click",function(){b.createAddMyCounterpartyDialog()})},
onShow:function(){}}));d.show()},createMyCounterpartyTable:function(){var c=s,d=[].concat(q),d=new j({store:new b,columns:d,options:{forceFitColumns:!0}},"capitalCounterpartyTable");d.startup();c.bindInitCounterparty(d);c.bindClear(d)},bindInitCounterparty:function(b){(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyCounterparty.dzh?traderID="+k.getCurrentUserID()+"&quotationType=3&t="+(new Date).getTime())).then(function(d){if(d&&0<d.length){var a=p.map(d,function(a){return a.counterpartyTraderID}).join(","),
g=k.queryContactInfoInGlobal(a),a=p.map(d,function(a){var b=p.filter(g,function(b){return b.UserName==a.counterpartyTraderID});a.loginState=b?b[0].Status:0;return a});b.refresh(a);bondForumConfig.capitalCounterparty=d}else b.refresh([])})},bindClear:function(b){l(dijit.byId("capitalCounterpartyClear"),"click",function(){b.refresh([])})},storeCounterpartyData:function(){var b=dijit.byId("capitalCounterpartyTable"),d=b.getSelectedRows(),a=[],g=k.getCurrentUserID();if(0<d.length){var f=b.data;p.forEach(d,
function(b){b=f[+b];a.push({traderID:g,counterpartyTraderID:b.counterpartyTraderID,counterpartyTraderName:b.counterpartyTraderName,counterpartyAgencyName:b.counterpartyAgencyName,counterpartyPhone:b.counterpartyPhone})});b=e.encodeObjArrayToString(a);b={quotationType:3,myCounterparty:encodeURI(b),t:(new Date).getTime()};(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addMyCounterparty.dzh?"+h.objectToQuery(b))).then(function(){bondForumConfig.capitalCounterparty=a})}},createAddMyCounterpartyDialog:function(){var b=
s,d=dijit.byId("capitalCounterpartyAddDialog");d||(d=new n({id:"capitalCounterpartyAddDialog",title:"\u6dfb\u52a0\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/capital/topCapitalCounterpartyAddDialog.html",onDownloadEnd:function(){l(dijit.byId("capitalCounterpartyAddOk"),"click",function(){dijit.byId("capitalCounterpartyAddDialog").onCancel();b.saveSelectCounterpartyData(1)});l(dijit.byId("capitalCounterpartyAddOk2"),"click",function(){dijit.byId("capitalCounterpartyAddDialog").onCancel();
b.saveSelectCounterpartyData(2)});var a=dijit.byId("capitalCounterpartyAddNodeContainer");a.watch("selectedChildWidget",function(){});l(a.tablist,"selectChild",r.hitch(b,"switchTab"));b.createCounterpartyTable1();b.createCounterpartyTable2();b.bindSearchByContition()}}));d.show()},switchTab:function(b){var d=s;"\u6761\u4ef6\u67e5\u627e"!=b.title&&"\u4eceIM\u8054\u7cfb\u4eba\u6dfb\u52a0"==b.title&&d.selectCounterparty2()},createCounterpartyTable1:function(){var c=[].concat(q);(new j({store:new b,columns:c,
options:{forceFitColumns:!0}},"capitalCounterpartyTable1")).startup()},bindSearchByContition:function(){var b=s;l(dijit.byId("capitalCounterpartyAddSearch"),"click",function(){var d=dijit.byId("capitalCounterpartyAddAccount").get("value"),a=dijit.byId("capitalCounterpartyAddName").get("value"),g=dijit.byId("capitalCounterpartyAddComp").get("value"),d=JSON.stringify({ID:d,RealName:a,Company:g});(d=k.queryContatInfoByKey(d))&&b.selectCounterparty1(d)})},selectCounterparty1:function(b){var d=dijit.byId("capitalCounterpartyTable1"),
b=p.map(b,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}});d.refresh(b)},createCounterpartyTable2:function(){var c=[].concat(q);(new j({store:new b,columns:c,options:{forceFitColumns:!0}},"capitalCounterpartyTable2")).startup()},selectCounterparty2:function(){var b=dijit.byId("capitalCounterpartyTable2"),d=k.queryUserGroup(k.getCurrentUserID(),1);d?(d=d.GroupInfo["\u6211\u7684\u597d\u53cb"].join(","),
d=k.queryContactInfoInGlobal(d),d=p.map(d,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),b.refresh(d)):b.refresh([])},saveSelectCounterpartyData:function(b){var d;d=1==b?dijit.byId("capitalCounterpartyTable1"):dijit.byId("capitalCounterpartyTable2");var b=d.getSelectedRows(),a=d.data;if(0<b.length){d=dijit.byId("capitalCounterpartyTable");var g=d.data,e=[];p.forEach(b,function(b){var c=
a[+b];p.some(g,function(a){return a.counterpartyTraderID==c.counterpartyTraderID})||e.push(c)});d.refresh(g.concat(e))}}};return s})},"bond/bondQuotation/view/capital/capitalCounterparty":function(){define("dijit/Dialog,dojo/on,dojox/slickgrid/slickgrid,dojo/store/Memory,../_helper/util,../_helper/htmlFormatter,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/io-query,dojo/_base/lang,dijit/registry,dojo/_base/array,bond/bondQuotation/view/_helper/imUtil".split(","),function(n,l,j,b,e,f,i,h,r,t,
p,k){var f=new f,q=[{id:"counterpartyTraderID",name:"\u5e10\u53f7",field:"counterpartyTraderID",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyTraderName",name:"\u59d3\u540d",field:"counterpartyTraderName",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"counterpartyAgencyName",name:"\u516c\u53f8",field:"counterpartyAgencyName",formatter:f.nullToNone,width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"},
{id:"counterpartyPhone",name:"\u7535\u8bdd",formatter:f.nullToNone,field:"counterpartyPhone",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],s=[{id:"operate",name:"\u64cd\u4f5c",formatter:function(){return'<a href="#" clickFn="addCounterparty">\u6dfb\u52a0</a>'},field:"operate",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],c=[{id:"operate",name:"\u64cd\u4f5c",formatter:function(){return'<a href="#" clickFn="delCounterparty">\u5220\u9664</a>'},
field:"operate",width:60,cssClass:"font-yellow font-center",headerCssClass:"font-center"}],d={createCapitalCounterparty:function(){var a=d,b=dijit.byId("capitalCounterpartyDialog");b||(b=new n({id:"capitalCounterpartyDialog",title:"\u6211\u7684\u4ea4\u6613\u5bf9\u624b\u65b9",onHide:function(){this.destroyRecursive()},href:"resources/dialog/capital/capitalCounterpartyDialog.html",onDownloadEnd:function(){l(dijit.byId("capitalCounterpartyOk"),"click",function(){dijit.byId("capitalCounterpartyDialog").onCancel();
a.storeCounterpartyData()});a.createMyCounterpartyTable();a.initialSearch()}}));b.show()},storeCounterpartyData:function(){var a=dijit.byId("capitalCounterpartyTable").data,b=[],c=k.getCurrentUserID();0<a.length&&(p.forEach(a,function(a){b.push({traderID:c,counterpartyTraderID:a.counterpartyTraderID,counterpartyTraderName:a.counterpartyTraderName,counterpartyAgencyName:a.counterpartyAgencyName,counterpartyPhone:a.counterpartyPhone})}),a=e.encodeObjArrayToString(b),a={quotationType:3,myCounterparty:encodeURI(a),
t:(new Date).getTime()},(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/addMyCounterparty.dzh?"+h.objectToQuery(a))).then(function(){bondForumConfig.capitalCounterparty=b}))},initialSearch:function(){var a=d,b=dijit.byId("capitalCounterpartyTabContainer");b.watch("selectedChildWidget",function(){});l(b.tablist,"selectChild",r.hitch(a,"switchTab"));a.createCounterpartyTable1();a.createCounterpartyTable2();a.bindSearchByContition()},bindOperate:function(a){var b=d;a.on("click",
function(c,d){var e=c.target.getAttribute("clickFn");e&&r.hitch(b,function(){this[e](c,d,a)})()})},addCounterparty:function(a,b,c){var a=dijit.byId("capitalCounterpartyTable"),d=a.data,e=c.data[b.row];p.some(d,function(a){var b=!1;e.counterpartyTraderID==k.getCurrentUserID()?b=!0:a.counterpartyTraderID===e.counterpartyTraderID&&(b=!0);return b})||(d.push(e),a.refresh(d))},delCounterparty:function(a,b,c){c.data.splice(b.row,1);c.refresh()},createMyCounterpartyTable:function(){var a=d,e=[].concat(q,
c),e=new j({store:new b,columns:e,options:{forceFitColumns:!0}},"capitalCounterpartyTable");e.startup();a.bindInitCounterparty(e);a.bindOperate(e)},bindInitCounterparty:function(a){(new i).query(e.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyCounterparty.dzh?traderID="+k.getCurrentUserID()+"&quotationType=3&t="+(new Date).getTime())).then(function(b){b&&0<b.length?(p.map(b,function(a){return a.counterpartyTraderID}),a.refresh(b),bondForumConfig.capitalCounterparty=b):a.refresh([])})},
switchTab:function(a){var b=d;"\u6761\u4ef6\u67e5\u627e"!=a.title&&"\u4eceIM\u8054\u7cfb\u4eba\u6dfb\u52a0"==a.title&&b.selectCounterparty2()},createCounterpartyTable1:function(){var a=d,c=[].concat(q,s),c=new j({store:new b,columns:c,options:{forceFitColumns:!0}},"capitalCounterpartyTable1");c.startup();a.bindOperate(c)},bindSearchByContition:function(){var a=d;l(dijit.byId("capitalCounterpartyAddSearch"),"click",function(){var b=dijit.byId("capitalCounterpartyAddAccount").get("value"),c=dijit.byId("capitalCounterpartyAddName").get("value"),
d=dijit.byId("capitalCounterpartyAddComp").get("value"),b=JSON.stringify({ID:b,RealName:c,Company:d});(b=k.queryContatInfoByKey(b))&&a.selectCounterparty1(b)})},selectCounterparty1:function(a){var b=dijit.byId("capitalCounterpartyTable1"),a=p.map(a,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),c=k.getCurrentUserID(),a=p.filter(a,function(a){return a.counterpartyTraderID!=
c});b.refresh(a)},createCounterpartyTable2:function(){var a=d,c=[].concat(q,s),c=new j({store:new b,columns:c,options:{forceFitColumns:!0}},"capitalCounterpartyTable2");c.startup();a.bindOperate(c)},selectCounterparty2:function(){var a=dijit.byId("capitalCounterpartyTable2"),b=k.queryUserGroup(k.getCurrentUserID(),1);if(b){var b=b.GroupInfo["\u6211\u7684\u597d\u53cb"].join(","),b=k.queryContactInfoInGlobal(b),b=p.map(b,function(a){return{counterpartyTraderID:a.Name||a.UserName,counterpartyTraderName:a.RealName,
counterpartyAgencyName:a.Office,loginState:a.Status,counterpartyPhone:a.Phone}}),c=k.getCurrentUserID(),b=p.filter(b,function(a){return a.counterpartyTraderID!=c});a.refresh(b)}else a.refresh([])},saveSelectCounterpartyData:function(a){var b;b=1==a?dijit.byId("capitalCounterpartyTable1"):dijit.byId("capitalCounterpartyTable2");var a=b.getSelectedRows(),c=b.data;if(0<a.length){b=dijit.byId("capitalCounterpartyTable");var d=b.data,e=[];p.forEach(a,function(a){var b=c[+a];p.some(d,function(a){return a.counterpartyTraderID==
b.counterpartyTraderID})||e.push(b)});b.refresh(d.concat(e))}}};return d})},"bond/bondQuotation/view/capital/topCapitalBondQuote":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/layout/_ContentPaneResizeMixin,dojo/text!./topCapitalBondQuote.html,bond/bondQuotation/view/_helper/htmlFormatter,dojox/slickgrid/slickgrid,dojo/store/Memory,dojo/topic,dojo/dom-geometry,dojo/on,dojo/_base/lang,dijit/Dialog,dojo/dom-style,bond/bondQuotation/view/_helper/util,bond/bondQuotation/view/capital/capitalCounterparty,dijit/tree/CheckboxTree,dojo/data/ItemFileWriteStore,dijit/tree/CheckboxForestStoreModel,dojo/_base/array,dojox/store/WebSocket,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/query,dojo/NodeList-data,bond/bondQuotation/view/_helper/imUtil,dojo/dom,dojo/io-query".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s,c,d,a,g,x,y,z,D,B,A,o,m){var E=new i;return n("bond.bondQuotation.view.capital.topCapitalBondQuote",[l,j,b,e],{templateString:f,startup:function(){var b=this;setTimeout(q.hitch(b,"createQuoteTable"),20);b.emitSearch();k(b.capitalSearchBtn,"click",function(){b.dynaSearchTable()});k(dijit.byId("capitalAddCounterparty"),"click",function(){a.createCapitalCounterparty()});k(dijit.byId("capitalTopExcelExport"),"click",function(){b.bindExcelExport()})},dynaSearchTable:function(){this.getSearchCondition();
this.quoteHandler.remove();this.capitalQuoteGrid.destroy();this.capitalQuoteGrid=null;this.capitalQuoteTableParent.set("content",'<div id="capitalQuoteTable"></div>');this.createQuoteTable()},emitSearch:function(){var a=this;dijit.byId("capitalDirection").on("change",function(){a.dynaSearchTable()});dijit.byId("capitalGuaranty").on("change",function(){a.dynaSearchTable()})},getSearchCondition:function(){var a=A("#capitalTable"),b=dijit.byId("capitalDirection").get("value");a.data("capitalDirection",
b);b=dijit.byId("capitalGuaranty").get("value");a.data("capitalGuaranty",b)},createQuoteTable:function(){this.getSearchCondition();A("#capitalTable");var a=[{id:"indexNo",name:"\u5e8f\u53f7",width:60,formatter:E.index,resizable:!1,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteTime",name:"\u62a5\u4ef7\u65f6\u95f4",field:"quoteTime",sortable:!0,formatter:E.timeFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"quoteAgency",name:"\u62a5\u4ef7\u65b9",
field:"quoteAgency",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"traderID",name:"\u4ea4\u6613\u5458",field:"traderID",sortable:!0,formatter:E.tarderFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"tradeDirection",name:"\u4ea4\u6613\u65b9\u5411",field:"tradeDirection",sortable:!0,width:80,cssClass:"font-yellow font-center",headerCssClass:"font-center"},{id:"amount",name:"\u91d1\u989dW",field:"amount",sortable:!0,width:80,
cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"bondTerm",name:"\u671f\u9650",field:"bondTerm",sortable:!0,formatter:E.capitalBondTermFormat,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"pawn",name:"\u62b5\u62bc\u7269",field:"pawn",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"},{id:"remark",name:"\u5907\u6ce8",field:"remark",sortable:!0,width:80,cssClass:"font-gray font-center",headerCssClass:"font-center"}],b=
{forceFitColumns:!0,hideBorder:"body"},c=d.getLeftTableAvailableSize(),c=parseInt(c/80);a.length>c&&(b={forceFitColumns:!1,hideBorder:"body"});a=this.capitalQuoteGrid=new h({store:new r,columns:a,options:b},"capitalQuoteTable");a.startup();this.topCapitalFlg=0;this.bindInitData(a);this.bindTopicHandler(a);d.bindCellClick(a,this);this.resize();d.openPopupPanel(a)},openImDialog:function(a,b,c){m.openChatWnd(c.data[b.row].traderID)},bindInitData:function(a){var b=this;(new B).query(d.getSocketParams(bondForumConfig.soUrl+
"bondQuotation/fundList.dzh?t="+(new Date).getTime())).then(function(c){c=d.arrayFilter(c||[],a.pushData||[],"id");c=d.filterPrivateArray(c);b.topCapitalFlg+=1;if(0!=c.length){var e=A("#capitalTable").data()[0],c=d.filterCapitalArrayWithQueryCondition(c,e,3,[]);a.store.data=c;a.refresh(c)}})},bindTopicHandler:function(a){var b=this;b.quoteHandler=t.subscribe("bondQuote/rateBond",function(c){var e=a.data,f=JSON.parse(c.data).result;if(f){for(var c=f.head,g=f.datas,f=[],h=0,i=g.length;h<i;h++){for(var j=
{},k=0,l=c.length;k<l;k++)j[c[k]]=g[h][k];f.push(j)}c=A("#capitalTable").data()[0];c=d.filterCapitalArrayWithQueryCondition(f,c,3,[]);0<b.topCapitalFlg?(e=d.arrayFilter(e||[],c||[],"id"),e=d.filterPrivateArray(e),a.store.data=e,a.refresh(e),a.pushData=null):a.pushData=a.pushData?[].concat(c,a.pushData):c}})},bindExcelExport:function(){var a=dijit.byId("capitalQuoteTable"),b="<tr><td colspan='"+(+a.getColumns().length-1)+"' style='text-align:center;font-family:'\u5fae\u8f6f\u96c5\u9ed1','\u5b8b\u4f53';font-size:16px;'>\u5927\u667a\u6167\u8d44\u91d1\u52a8\u6001\u62a5\u4ef7</td></tr>";
d.saveAsExcel("\u5927\u667a\u6167_\u8d44\u91d1\u4e0a\u90e8_"+d.generateTimeStamp(),b,"\u8d44\u91d1",a,a.getColumns())},resize:function(a){a&&p.setMarginBox(this.domNode,{w:a.w,y:a.y});this.inherited(arguments)}})})},"url:bond/bondQuotation/view/capital/topCapitalBondQuote.html":'<div data-dojo-attach-point="containerNode" class="border_box spacer hbox">\r\n    <div class="vbox globalWidth globalHeight">\r\n        <\!-- begin  \u9009\u62e9\u6761\u4ef6\u7b5b\u9009\u6761--\>\r\n        <div class="border_box">\r\n            <div class="hbox dijitRegionalPane spacer">\r\n                <div class="spacer hbox">\r\n                    <div style="margin:0 5px;">\r\n                        <label>\u4ea4\u6613\u65b9\u5411</label>\r\n                        <select id="capitalDirection" data-dojo-type="dijit/form/Select" name="capitalDirection"\r\n                                style="width:65px;color:black;">\r\n                            <option value="all" selected="selected">\u5168\u90e8</option>\r\n                            <option value="\u6536" >\u6536</option>\r\n                            <option value="\u51fa">\u51fa</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label>\u62b5\u62bc\u7269</label>\r\n                        <select id="capitalGuaranty" data-dojo-type="dijit/form/Select" name="capitalGuaranty"\r\n                                style="width:75px;color:black;">\r\n                            <option value="\u4e0d\u9650" selected="selected">\u4e0d\u9650</option>\r\n                            <option value="\u4ec5\u5229\u7387" >\u4ec5\u5229\u7387</option>\r\n                            <option value="\u53ef\u4fe1\u7528">\u53ef\u4fe1\u7528</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div data-dojo-type="dijit/form/Button" style="margin-left:5px;display: none;" data-dojo-attach-point="capitalSearchBtn"\r\n                         data-dojo-props="label:\'\u786e\u5b9a\'"></div>\r\n\r\n                </div>\r\n                <div class="hbox">\r\n                    <div>\r\n                        <div data-dojo-type="dijit/form/Button" id="capitalAddCounterparty"\r\n                             data-dojo-props="label:\'\u5bf9\u624b\u65b9\',dialogId:\'capitalAddCounterparty\'"></div>\r\n                    </div>\r\n                    <div style="width:10px;"></div>\r\n                    <div>\r\n                        <div data-dojo-type="dijit/form/Button" id="capitalTopExcelExport" data-dojo-props="label:\'\u5bfc\u51fa\u5230Excel\'"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <\!--end  \u9009\u62e9\u6761\u4ef6\u7b5b\u9009\u6761--\>\r\n\r\n        <\!-- begin  \u52a8\u6001\u8868\u683c\u53ca\u53f3\u90e8\u7684\u7fa4\u90e8\u5206  --\>\r\n        <div class="border_box spacer hbox" style="overflow-x:hidden">\r\n            <div class="spacer" data-dojo-type="dijit/layout/ContentPane">\r\n                <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="capitalQuoteTableParent" class="myGrid spacer">\r\n                    <div id="capitalQuoteTable" class="spacer"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <\!-- end  \u52a8\u6001\u8868\u683c\u53ca\u53f3\u90e8\u7684\u7fa4\u90e8\u5206  --\>\r\n    </div>\r\n</div>'}});
define("bond/bondQuotation/src","dojo/parser,dojo/topic,bond/bondQuotation/view/main,bond/bondQuotation/view/_helper/WebSocketHelper,bond/bondQuotation/view/_helper/GridSOSubStore,dojo/json,dojo/_base/lang,dojo/dom,bond/bondQuotation/view/_helper/util,dojo/_base/array,dojo/dom-construct,bond/bondQuotation/view/_helper/MessageDialog,bond/bondQuotation/view/_helper/imUtil,dojox/store/MultiResultStore,bond/bondQuotation/view/_helper/CustomKeyboardSpirit,bond/bondQuotation/view/_helper/htmlFormatter,bond/bondQuotation/view/_helper/util,bond/bondQuotation/view/_helper/MCheckedMultiSelect,bond/bondQuotation/view/rate/bottomRateBondQuote,bond/bondQuotation/view/rate/topRateBondQuote,bond/bondQuotation/view/rate/rateCounterparty,bond/bondQuotation/view/capital/bottomCapitalBondQuote,bond/bondQuotation/view/capital/capitalCounterparty,bond/bondQuotation/view/capital/topCapitalBondQuote".split(","),
function(n,l,j,b,e,f,i,h,r,t,p,k,q,s){return function(){setTimeout(function(){var b=new s,d=q.getCurrentUserID();b.query({service:"rpc",so:"jso-all-bondpermissions.jar","function":"gw.sh.func.BondPermissionsRequest",paraencode:"base64",parameter:btoa('{"username":"'+d+'","moduleid":"613"}'),response_times:1,cache_timeout:0,response_mode:0,request_timeout:-1}).then(function(a){console.warn("\u83b7\u53d6\u5230\u7684\u7528\u6237\u6743\u9650:"+f.stringify(a));if(a&&(a=a[0].items[0].PEMISSIONS,console.warn(a),
bondForumConfig.permission=a,"NULL"==a))bondForumConfig.jmsPermit="NoAuthority",(new k).showDialog("\u60a8\u6ca1\u6709\u8be5\u529f\u80fd\u6743\u9650\uff0c\u8981\u7533\u8bf7\u5f00\u901a\uff0c\u8bf7\u4e0e\u60a8\u7684\u5ba2\u6237\u7ecf\u7406\u8054\u7cfb\uff01"),setTimeout(function(){dijit.byId("quoteTable")&&dijit.byId("quoteTable").refresh([]);dijit.byId("rateMyReceiveTable")&&dijit.byId("rateMyReceiveTable").refresh([]);dijit.byId("rateMyQuoteTable")&&dijit.byId("rateMyQuoteTable").refresh([]);dijit.byId("capitalQuoteTable")&&
dijit.byId("capitalQuoteTable").refresh([]);dijit.byId("capitalMyReceiveTable")&&dijit.byId("capitalMyReceiveTable").refresh([]);dijit.byId("capitalMyQuoteTable")&&dijit.byId("capitalMyQuoteTable").refresh([])},500)})},0);setTimeout(function(){(new e).query(r.getSocketParams(bondForumConfig.soUrl+"bondQuotation/myFavoriteBond.dzh?traderID="+q.getCurrentUserID()+"&quotationType=1&t="+(new Date).getTime())).then(function(b){if(b&&0<b.length)bondForumConfig.favRateBondCodes=t.map(b,function(b){return b.bondCode})})},
10);(function(){var c=new b.Topic,d=new b.Socket(c,"127.0.0.1","30718");c.subscribe("socketOpen",function(){d.send("/json/subscribe?/bond/mq/quotationForCreditBond?__repeat=-1")});c.subscribe("socketError",function(a){console.error("socketError:\n"+a)});c.subscribe("socketMsg",function(a){var b=f.parse(a.data),c=+b.res_type;0<=c&&b.result&&!bondForumConfig.jmsPermit?l.publish("bondQuote/rateBond",{data:a.data}):0!=c&&(a=b.result.datas[0].join("  "),console.error("jms\u5f02\u5e38\u6d88\u606f:\n"+a))})})();
setTimeout(function(){(new e).query(r.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyCounterparty.dzh?traderID="+q.getCurrentUserID()+"&quotationType=1&t="+(new Date).getTime())).then(function(b){if(b&&0<b.length)bondForumConfig.rateCounterparty=b});(new e).query(r.getSocketParams(bondForumConfig.soUrl+"bondQuotation/getMyCounterparty.dzh?traderID="+q.getCurrentUserID()+"&quotationType=3&t="+(new Date).getTime())).then(function(b){if(b&&0<b.length)bondForumConfig.capitalCounterparty=b})},
20);setTimeout(function(){var b=q.queryContactInfoInGlobal(q.getCurrentUserID());if(b)b=b[0],console.warn(f.stringify(b)),bondForumConfig.userInfo=b},30);n.parse();setTimeout(function(){setInterval(function(){l.publish("bondQuotation/broadCastTopic",{msg:"["+(new Date).toLocaleString()+"]\u5b9a\u65f6\u53d1\u9001\u5237\u65b0\u6570\u636e\u8bf7\u6c42!"})},1E4)},40)}});