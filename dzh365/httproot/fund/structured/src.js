define("models/security",["observable","formatter"],function(t,e){return t.extend(function(t){$.extend(this,t),this.symbol=e.fixSymbol(this.obj)},{obj:"",name:"--",update:function(t){for(var e in t)("new"!==e||0!=t[e])&&(this[e]=isNaN(Number(t[e]))?t[e]:Number(t[e]));this.calculate(),this.emit("updated")},calculate:function(){this.lastTrade=e.fixLastTrade(this),this.change=e.fixChange(this),this.chg=e.fixChg(this)}})}),define("models/structuredFund",["observable"],function(t){return t.extend(function(t){$.extend(this,t),this.update=this.update.bind(this)},{setSecurities:function(t){return this.securities&&this.securities.forEach(function(t){t.off("updated",this.update)},this),this.securities=t,t.forEach(function(t,e){this[["fund","index","classA","classB"][e]]=t.on("updated",this.update)},this),this},update:function(){return this.fund.predictiveNAV=this.B3*(this.B2/100*(1+this.index.chg/100)+this.B18/100),this.fund.premium=((this.B4*this.classA.new+this.B5*this.classB.new)/this.B6-this.fund.predictiveNAV)/this.fund.predictiveNAV,this.classA.premium=(this.classA.lastTrade-this.B14)/this.B14,this.classB.predictiveNAV=(this.B6*this.fund.predictiveNAV-this.B4*this.B14)/this.B5,this.classB.premium=(this.classB.lastTrade-this.classB.predictiveNAV)/this.classB.predictiveNAV,this}})}),define("repositories/fund",["repository_base","formatter","../models/security","../models/structuredFund"],function(t,e,i,n){return new(t.extend({securities:{keys:[]},funds:{},getSecurity:function(t){return t in this.securities||(this.securities[t]=new i({obj:t}),this.securities.keys.push(t)),this.securities[t]},getStructuredFund:function(t){if("string"!=typeof t){var e=new n(t).setSecurities(["FundCode","B9","ACode","BCode"].map(function(t,e){return this.getSecurity(t[e])}.bind(this,t)));return this.funds[t.FundCode]=e,e}return this.funds[t]||{fund:{},classA:{},classB:{}}},getInfo:function(t,e){return 1===arguments.length&&(e=t,t="new,lastclose"),$.send("/objinfo/getinfo",{field:t,where:"obj="+e})},getQuotes:function(t,e,i){switch(arguments.length){case 1:i=t,e="new,lastclose",t=void 0;break;case 2:i=e,e=t,t=void 0}return $.send(t?"/did?did="+t:"/quote/dyna",{field:e,where:"obj="+i,response_mode:0,response_times:-1})},getStructuredFunds:function(){return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundOverviewRequest",paraencode:"base64",parameter:btoa("{}")},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))},after:function(t){return t.map(this.getStructuredFund,this)}.bind(this)})},getClassAFunds:function(){return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundBasicDataRequest",paraencode:"base64",parameter:btoa(JSON.stringify({type:1}))},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))},after:function(t){return t.map(function(t){return $.extend(this.getSecurity(t.C7),t,{structured:this.getStructuredFund(t.B12)})},this)}.bind(this)})},getClassBFunds:function(){return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundBasicDataRequest",paraencode:"base64",parameter:btoa(JSON.stringify({type:2}))},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))},after:function(t){return t.map(function(t){return $.extend(this.getSecurity(t.C9),t,{structured:this.getStructuredFund(t.CO)})},this)}.bind(this)})},getStructuredFundsInfo:function(){var t=$.Deferred();return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundBasicDataRequest",paraencode:"base64",parameter:btoa(JSON.stringify({type:3}))},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))}}).then(function(t,e){this.getInfo("name",e.map(function(t){return[t.CO,t.B2,t.B4].toString()})).then(function(t,e){e.forEach(function(t){"--"!==t.name&&(this[t.obj]=t)},e),this.forEach(function(t){t.CO in this&&(t.B1=this[t.CO].name),t.B2 in this&&(t.B3=this[t.B2].name),t.B4 in this&&(t.B5=this[t.B4].name)},e),t.resolve(this)}.bind(e,t))}.bind(this,t)),t},getPremiumSeries:function(t){return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundZYJVRequest",paraencode:"base64",parameter:btoa(JSON.stringify({co:t,bdate:e.fixDate("-3y"),edate:e.fixDate("1d")}))},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))},after:function(t){for(var e=[],i=[],n=[],r=0,s=t.length;s>r;r++){var a=t[r],o=a.B4.match(/^(\d{4})(\d\d)(\d\d)/);o&&(o=Date.UTC(o[1],o[2]-1,o[3]),Number(a.B1)&&e.push([o,Number(a.B1)]),Number(a.B2)&&i.push([o,Number(a.B2)]),Number(a.B3)&&n.push([o,Number(a.B3)]))}return[e,i,n]}})},getLeverageSeries:function(t){return $.send("/rpc",{so:"jso-html5-structuredfund.jar","function":"gw.sh.func.StructuredfundGGLRequest",paraencode:"base64",parameter:btoa(JSON.stringify({co:t,bdate:e.fixDate("-3y"),edate:e.fixDate("1d")}))},{before:function(t){return JSON.parse(JSON.stringify(t).replace(/\bNULL\b/g,"－"))},after:function(t){for(var e=[],i=[],n=0,r=t.length;r>n;n++){var s=t[n],a=s.B4.match(/^(\d{4})(\d\d)(\d\d)/);a&&(a=Date.UTC(a[1],a[2]-1,a[3]),Number(s.B2)&&e.push([a,Number(s.B2)]),Number(s.B3)&&i.push([a,Number(s.B3)]))}return[e,i]}})}}))}),define("presenters/index",["presenter_base","topic","../repositories/fund"],function(t,e,i){return t.extend(function(){this.view.on("tabActive",this.onTabActive.bind(this))},{onInit:function(){this.items=i.securities,this.funds=[],this.promises=[],this.onTabActive(0)},onTabActive:function(t){this.funds[t]||(this.funds[t]=i[["getStructuredFunds","getClassAFunds","getClassBFunds","getStructuredFundsInfo"][t]]().then(3===t?null:this.subscribe.bind(this),function(t){this.funds[t]=void 0}.bind(this,t))),this.tabIndex=t,this.funds[t].then(function(t,e){this.tabIndex===t&&this.view.renderPane(t,e)}.bind(this,t))},subscribe:function(){this.promises.forEach(function(t){t.cancel()}),this.promises.length=0,this.promises.push(i.getInfo("name,new,lastclose",this.items.keys).then(function(t){this.updateItems(t),this.promises.push(i.getQuotes("new,lastclose,amount",this.items.keys).progress(this.updateItems.bind(this)))}.bind(this)))},updateItems:function(t){t.length&&(t.forEach(function(t){this.items[t.obj].update(t)},this),e.emit("updated"))}})}),define("presenters/analysis",["presenter_base","topic","../repositories/fund","vue"],function(t,e,i,n){return t.extend({init:function(){this.view.renderCharts("",""),this.createViewModel(),this.vm.$on("filtersChange",this.onFiltersChange.bind(this)),this.view.on("tabActive",this.onTabActive.bind(this)),this.view.on("gridItemActive",this.onGridItemActive.bind(this)),e.on("updated",this.view.renderGrid.bind(this.view))},onInit:function(t){this.items=t,this.view.renderFilters(this.vm),this.view.renderGrid(t),this.promises=[],this.onTabActive(0)},onFiltersChange:function(t){var e=[];t.kind&&e.push('item.B12 == "'+t.kind+'"'),t.turnoverA&&e.push('item.classA.amount > "'+1e4*t.turnoverA+'"'),t.turnoverB&&e.push('item.classB.amount > "'+1e4*t.turnoverB+'"'),t.condition&&t.premium&&!isNaN(t.premium)&&e.push("(item.fund.premium * 100).toFixed(2)"+t.condition+Number(t.premium)),e.length?this.view.quotesGrid.setRows(this.items.filter(new Function("item","return "+e.join("&&")))):this.view.quotesGrid.setRows()},onTabActive:function(t){var e=this.view.quotesGrid.selectedItem||this.view.quotesGrid.getItem(0);this.tabIndex=t,e&&this.onGridItemActive(e)},onGridItemActive:function(t){switch(this.promises[this.tabIndex]&&this.promises[this.tabIndex].cancel(),this.tabIndex){case 0:this.view.renderCharts(t.classA.obj,t.classB.obj);break;case 1:this.view.renderPremiumChart([]),this.promises[this.tabIndex]=i.getPremiumSeries(t.fund.obj).then(this.view.renderPremiumChart.bind(this.view));break;case 2:this.view.renderLeverageChart([]),this.promises[this.tabIndex]=i.getLeverageSeries(t.fund.obj).then(this.view.renderLeverageChart.bind(this.view))}},createViewModel:function(){this.vm=new n({data:{kind:"",kinds:[{text:"全部",value:""},"股票型","债券型","QDII"],turnoverA:"",turnoverB:"",condition:"",conditions:[{text:"全部",value:""},">",">=","<","<=",{text:"=",value:"=="}],premium:""},methods:{filtersChange:function(){n.nextTick(function(){this.validated=!0,this.condition||(this.premium=""),["turnoverA","turnoverB","premium"].forEach(function(t){this[t]=this[t].replace(/[^-.0-9]/g,"").replace(/(.)-+/g,"$1").replace(/\.(\d+)?\.*/g,".$1"),isNaN(this[t])&&(this.validated=!1)},this),this.validated&&this.$emit("filtersChange",this.$data)}.bind(this))}}})}})}),define("text!views/analysis.html",[],function(){return'<form class="flex-none" v-on="change: filtersChange, input: filtersChange">\r\n    <div class="form-group pull-right">\r\n        <label>基金类型</label>\r\n        <select v-model="kind" options="kinds"></select>\r\n        <label>A成交额</label>\r\n        <input v-model="turnoverA" type="text">\r\n        <span>万元以上</span>\r\n        <label>B成交额</label>\r\n        <input v-model="turnoverB" type="text">\r\n        <span>万元以上</span>\r\n        <label>合并溢价率</label>\r\n        <select v-model="condition" options="conditions"></select>\r\n        <input v-model="premium" type="text">\r\n    </div>\r\n</form>\r\n<div class="flex-auto grid"></div>\r\n<div class="flex-splitter flex-splitter-bottom"><i></i></div>\r\n<div class="flex-none flex-column">\r\n    <ul class="flex-none nav-tabs tabs-blue-dark">\r\n        <li class="active">分时走势</li>\r\n        <li>折溢价</li>\r\n        <li>杠杆率</li>\r\n    </ul>\r\n    <div class="flex-auto flex-column nav-panes">\r\n        <div class="flex-auto flex-row active">\r\n            <iframe class="flex-1" frameborder="0" allowtransparency="true" src="about:blank"></iframe>\r\n            <iframe class="flex-1" frameborder="0" allowtransparency="true" src="about:blank"></iframe>\r\n        </div>\r\n        <div id="premium" class="flex-auto"></div>\r\n        <div id="leverage" class="flex-auto"></div>\r\n    </div>\r\n</div>'}),define("views/analysis",["view_base","../presenters/analysis","text!views/analysis.html","active_grid","splitter","select","highcharts"],function(t,e,i,n){var r=t.extend(function(){this.splitter.on("move",this.onSplitterMove.bind(this)),this.tabs.on("active",this.onTabActive.bind(this))},{onSplitterMove:function(){this.quotesGrid&&this.quotesGrid.refresh(),this.resizeLineCharts()},onTabActive:function(t,e){this.emit("tabActive",e),e&&this.resizeLineCharts()},onGridItemActive:function(t,e){this.emit("gridItemActive",e)},renderFilters:function(t){t.$mount(this.form[0]),this.form.find("select").widget("select")},renderGrid:function(t){t?this.quotesGrid=new n(this.grid[0],{columns:[{width:"40",name:"序号",css:"white c",value:function(t,e){return e+1}},{width:"75",name:"代码",css:"blue cl",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.fund.obj+'">'+t.fund.symbol+"</a>"+(t.noticeflag_m?'<a class="icon-landmine" title="'+t.noticeflag_m.replace(/^.+?_/,"")+'" href="dzh://navigate?\'root://news/details/notice.html#'+ +t.noticeflag_m.replace(/_.+/,"")+"-7#DZHPOPUP(854,504)#'\"></a>":"")}},{width:"100",name:"简称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.fund.obj+'">'+t.fund.name+"</a>"}},{width:"85",name:"预测净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.fund.predictiveNAV,4)}},{width:"100",name:"合并溢价率",color:function(t){return this.fixColor(100*t.fund.premium)},sort:!0,order:"desc",value:function(t){return this.fixPercent(100*t.fund.premium)}},{width:"75",name:"代码",css:"blue cl",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.classA.obj+'">'+t.classA.symbol+"</a>"+(t.noticeflag_a?'<a class="icon-landmine" title="'+t.noticeflag_a.replace(/^.+?_/,"")+'" href="dzh://navigate?\'root://news/details/notice.html#'+ +t.noticeflag_a.replace(/_.+/,"")+"-7#DZHPOPUP(854,504)#'\"></a>":"")}},{width:"75",name:"简称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.classA.obj+'">'+t.classA.name+"</a>"}},{width:"60",name:"现价",color:function(t){return this.fixColor(t.classA.change,3)},sort:!0,value:function(t){return this.fixFloat(t.classA.lastTrade,3)}},{width:"60",name:"涨幅",color:function(t){return this.fixColor(t.classA.change,3)},sort:!0,value:function(t){return this.fixPercent(t.classA.chg)}},{width:"85",name:"最新净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.B14,4)}},{width:"70",name:"溢价率",color:function(t){return this.fixColor(100*t.classA.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.classA.premium)}},{width:"95",name:"成交额(万)",sort:!0,value:function(t){return this.fixFloat(t.classA.amount/1e4)}},{width:"100",name:"新增(万份)",sort:!0,value:function(t){return this.fixFloat(t.B15)}},{width:"75",name:"代码",css:"blue cl",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.classB.obj+'">'+t.classB.symbol+"</a>"+(t.noticeflag_b?'<a class="icon-landmine" title="'+t.noticeflag_b.replace(/^.+?_/,"")+'" href="dzh://navigate?\'root://news/details/notice.html#'+ +t.noticeflag_b.replace(/_.+/,"")+"-7#DZHPOPUP(854,504)#'\"></a>":"")}},{width:"80",name:"简称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.classB.obj+'">'+t.classB.name+"</a>"}},{width:"60",name:"现价",color:function(t){return this.fixColor(t.classB.change,3)},sort:!0,value:function(t){return this.fixFloat(t.classB.lastTrade,3)}},{width:"60",name:"涨幅",color:function(t){return this.fixColor(t.classB.change,3)},sort:!0,value:function(t){return this.fixPercent(t.classB.chg)}},{width:"85",name:"预测净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.classB.predictiveNAV,4)}},{width:"70",name:"溢价率",color:function(t){return this.fixColor(100*t.classB.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.classB.premium)}},{width:"95",name:"成交额(万)",sort:!0,value:function(t){return this.fixFloat(t.classB.amount/1e4)}},{width:"100",name:"新增(万份)",sort:!0,value:function(t){return this.fixFloat(t.B17)}},{width:"60",name:"A:B",css:"c",sort:!0,value:"B7"},{width:"85",name:"跟踪指数",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.index.obj+'">'+t.index.name.replace("--",t.B8)+"</a>"}},{width:"85",name:"指数涨幅",color:function(t){return this.fixColor(t.index.change)},sort:!0,value:function(t){return this.fixPercent(t.index.chg)}},{width:"70",name:"申购费",sort:!0,value:function(t){return this.fixPercent(t.B10)}},{width:"70",name:"赎回费",sort:!0,value:function(t){return this.fixPercent(t.B11)}},{width:"85",name:"基金类型",sort:!0,value:"B12"},{width:"auto",name:"",value:function(){return""}}],items:t,onSelectItem:this.onGridItemActive.bind(this),onCreate:function(){this.target.css("padding-top",56).find("tr").before(["<tr>","<td></td>",'<td colspan="4">母基金</td>','<td colspan="8">分级A</td>','<td colspan="8">分级B</td>','<td colspan="7"></td>',"</tr>"].join(""))},compare:function(t){return function(t,e){return this(t,e)||t.fund.obj.localeCompare(e.fund.obj)}.bind(this.base(t))}}):this.quotesGrid&&this.quotesGrid.refresh(!0)},renderCharts:function(t,e){"about:blank"===this.charts[1].src?this.charts.eq(0).one("load",function(){this.charts.eq(1).attr("src","/platform/charts/index.html#"+e)}.bind(this)).attr("src","/platform/charts/index.html#"+t):(this.charts.eq(0).attr("src","/platform/charts/index.html#"+t),this.charts.eq(1).attr("src","/platform/charts/index.html#"+e))},renderDefaultCharts:function(){if(this.quotesGrid){var t=this.quotesGrid.getItem(0);t&&this.onGridSelectItem(this.quotesGrid,t)}},renderLineChart:function(t,e,i){this[t]?this[t].series.forEach(function(t,e){t.setData(this[e])},e):this[t]=new Highcharts.Chart($.extend({chart:{renderTo:t,type:"spline",marginTop:35,marginRight:35,backgroundColor:"#000000"},title:{text:"",style:{fontFamily:"simsun",fontSize:"13px",color:"#c0c0c0"},y:15},subtitle:{enabled:!1},exporting:{enabled:!1},legend:{itemStyle:{color:"#c0c0c0"},itemHoverStyle:{color:"#d87000"},itemHiddenStyle:{color:"#606063"}},credits:{enabled:!1},xAxis:{type:"datetime",title:{text:"",style:{color:"#c0c0c0"}},labels:{formatter:function(){return Highcharts.dateFormat("%Y-%m",this.value)},style:{color:"#999999"}},startOnTick:!0,endOnTick:!0,showLastLabel:!0,gridLineColor:"#333333",gridLineWidth:1},yAxis:{title:{text:"",style:{width:"1em",color:"#c0c0c0"},rotation:0,x:-5,y:-48},labels:{formatter:function(){return this.value+"%"},style:{color:"#999999"}},gridLineColor:"#333333"},plotOptions:{spline:{lineWidth:1,marker:{radius:1}}},tooltip:{formatter:function(){return"<b>"+new Date(Number(this.x)).toJSON().substr(0,10)+"</b><br>"+this.series.name+": <b>"+this.y.toFixed(2)+"</b>"+("率"===this.series.name.slice(-1)?"%":"")},backgroundColor:"rgba(0, 0, 0, 0.75)",style:{fontFamily:"simsun",fontSize:"13px",color:"#c0c0c0"}},colors:["#ffffff","#52ff52","#ff5252"]},i)),this[t].setTitle({text:(this.quotesGrid.selectedItem||this.quotesGrid.getItem(0)).fund.name})},renderPremiumChart:function(t){this.renderLineChart("premium",t,{series:[{name:"合并折溢价率",data:t[0]},{name:"A类折溢价率",data:t[1]},{name:"B类折溢价率",data:t[2]}]})},renderLeverageChart:function(t){this.renderLineChart("leverage",t,{series:[{name:"B价格杠杆",data:t[0]},{name:"B净值杠杆",data:t[1]}]})},resizeLineCharts:function(){["premium","leverage"].forEach(function(t,e){this.panes.children().eq(e+1).is(":visible")&&this[t]&&this[t].reflow()},this)}});return r.init=function(t){return new e(new this({root:t.html(i),form:t.find("form"),grid:t.find(".grid"),tabs:t.find(".nav-tabs"),panes:t.find(".nav-panes"),charts:t.find("iframe"),splitter:t.find(".flex-splitter")})).view},r}),define("presenters/a",["presenter_base","topic","vue"],function(t,e,i){return t.extend({init:function(){this.createViewModel(),this.vm.$on("filtersChange",this.onFiltersChange.bind(this)),e.on("updated",this.view.renderGrid.bind(this.view))},onInit:function(t){this.items=t,this.view.renderFilters(this.vm),this.view.renderGrid(t),this.onFiltersChange(this.vm)},onFiltersChange:function(t){var e=[];t.kind&&e.push('item.B19 == "'+t.kind+'"'),t.tradable&&e.push('item.B14 == "'+t.tradable+'"'),e.length?this.view.quotesGrid.setRows(this.items.filter(new Function("item","return "+e.join("&&")))):this.view.quotesGrid.setRows()},createViewModel:function(){this.vm=new i({data:{kind:"",kindOptions:[{text:"全部",value:""},"股票型","债券型","QDII"],tradable:"是",tradableOptions:[{text:"全部",value:""},"是","否"]},methods:{filtersChange:function(){i.nextTick(function(){this.$emit("filtersChange",this.$data)}.bind(this))}}})}})}),define("text!views/a.html",[],function(){return'<form class="flex-none" v-on="change: filtersChange, input: filtersChange">\r\n    <div class="form-group pull-right">\r\n        <label>基金类型</label>\r\n        <select v-model="kind" options="kindOptions"></select>\r\n        <label>A可交易</label>\r\n        <select v-model="tradable" options="tradableOptions"></select>\r\n    </div>\r\n</form>\r\n<div class="flex-auto grid"></div>'}),define("views/a",["view_base","../presenters/a","text!views/a.html","active_grid","select"],function(t,e,i,n){var r=t.extend({renderFilters:function(t){t.$mount(this.form[0]),this.form.find("select").widget("select")},renderGrid:function(t){t?this.quotesGrid=new n(this.grid[0],{columns:[{width:"40",name:"序号",css:"white c",value:function(t,e){return e+1}},{width:"75",name:"代码",css:"blue cl",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.obj+'">'+t.symbol+"</a>"}},{width:"105",name:"简称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.obj+'">'+t.name.replace("--",t.C8)+"</a>"}},{width:"60",name:"现价",color:function(t){return this.fixColor(t.change,3)},sort:!0,value:function(t){return this.fixFloat(t.lastTrade,3)}},{width:"60",name:"涨幅",color:function(t){return this.fixColor(t.change,3)},sort:!0,value:function(t){return this.fixPercent(t.chg)}},{width:"95",name:"成交额(万)",sort:!0,value:function(t){return this.fixFloat(t.amount/1e4)}},{width:"85",name:"最新净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.B1,4)}},{width:"70",name:"溢价率",color:function(t){return this.fixColor(100*t.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.premium)}},{width:"85",name:"隐含收益",sort:!0,value:function(t){return this.fixPercent(t.B16)}},{width:"85",name:"剩余年限",sort:!0,value:function(t){return t.B2}},{width:"85",name:"约定收益",sort:!0,value:function(t){return this.fixPercent(t.B3)}},{width:"130",name:"约定年收益基准",css:"white l",sort:!0,title:!0,value:function(t){return t.B4}},{width:"85",name:"调整频度",css:"l",sort:!0,value:function(t){return t.B5}},{width:"85",name:"生效基准日",css:"white",sort:!0,value:function(t){return this.fixTime(t.B6,"Y-M-d")}},{width:"130",name:"最新定期折算日",css:"white",sort:!0,value:function(t){return this.fixTime(t.B7,"Y-M-d")}},{width:"130",name:"下一定期折算日",css:"white",sort:!0,value:function(t){return this.fixTime(t.B8,"Y-M-d")}},{width:"115",name:"定期折算周期",sort:!0,value:function(t){return t.B9}},{width:"115",name:"定期折算基准",css:"white",sort:!0,value:function(t,e,i){return t.B10?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+t.B10+'"></a>':"－"}},{width:"115",name:"定期折算方式",css:"white",sort:!0,value:function(t,e,i){return t.B11?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B11)+'"></a>':"－"}},{width:"100",name:"B下折距离",color:function(t){return this.fixColor("1"===t.B20?(t.B21-t.structured.classB.predictiveNAV)/t.structured.classB.predictiveNAV*100:(t.B21*t.structured.B14-t.structured.classB.predictiveNAV)/t.structured.classB.predictiveNAV*100)},sort:!0,value:function(t){return this.fixPercent("1"===t.B20?(t.B21-t.structured.classB.predictiveNAV)/t.structured.classB.predictiveNAV*100:(t.B21*t.structured.B14-t.structured.classB.predictiveNAV)/t.structured.classB.predictiveNAV*100)}},{width:"130",name:"母基金上折距离",color:function(t){return this.fixColor((t.B22-t.structured.fund.predictiveNAV)/t.structured.fund.predictiveNAV*100)},sort:!0,value:function(t){return this.fixPercent((t.B22-t.structured.fund.predictiveNAV)/t.structured.fund.predictiveNAV*100)}},{width:"100",name:"合并溢价率",color:function(t){return this.fixColor(100*t.structured.fund.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.structured.fund.premium)}},{width:"145",name:"定期开放申赎周期",sort:!0,value:function(t){return t.B13}},{width:"110",name:"场内份额(万)",sort:!0,value:function(t){return this.fixFloat(t.B17)}},{width:"70",name:"新增",color:function(t){return this.fixColor(t.B18)},sort:!0,value:function(t){return this.fixPercent(t.B18)}},{width:"85",name:"A可交易",sort:!0,value:function(t){return t.B14}},{width:"85",name:"A:B配比",sort:!0,value:function(t){return t.B15}},{width:"85",name:"基金类型",sort:!0,value:function(t){return t.B19}},{width:"auto",name:"",value:function(){return""}}],items:t,compare:function(t){return function(t,e){return this(t,e)||t.obj.localeCompare(e.obj)}.bind(this.base(t))}}):this.quotesGrid&&this.quotesGrid.refresh(!0)}});return r.init=function(t){return new e(new this({root:t.html(i),form:t.find("form"),grid:t.find(".grid")})).view},r}),define("presenters/b",["presenter_base","topic","vue"],function(t,e,i){return t.extend({init:function(){this.createViewModel(),this.vm.$on("filtersChange",this.onFiltersChange.bind(this)),e.on("updated",this.view.renderGrid.bind(this.view))},onInit:function(t){this.items=t,this.view.renderFilters(this.vm),this.view.renderGrid(t),this.onFiltersChange(this.vm)},onFiltersChange:function(t){var e=[];t.kind&&e.push('item.B19 == "'+t.kind+'"'),t.tradable&&e.push('item.B17 == "'+t.tradable+'"'),e.length?this.view.quotesGrid.setRows(this.items.filter(new Function("item","return "+e.join("&&")))):this.view.quotesGrid.setRows()},createViewModel:function(){this.vm=new i({data:{kind:"",kindOptions:[{text:"全部",value:""},"股票型","债券型","QDII"],tradable:"是",tradableOptions:[{text:"全部",value:""},"是","否"]},methods:{filtersChange:function(){i.nextTick(function(){this.$emit("filtersChange",this.$data)}.bind(this))}}})}})}),define("text!views/b.html",[],function(){return'<form class="flex-none" v-on="change: filtersChange, input: filtersChange">\r\n    <div class="form-group pull-right">\r\n        <label>基金类型</label>\r\n        <select v-model="kind" options="kindOptions"></select>\r\n        <label>A可交易</label>\r\n        <select v-model="tradable" options="tradableOptions"></select>\r\n    </div>\r\n</form>\r\n<div class="flex-auto grid"></div>'}),define("views/b",["view_base","../presenters/b","text!views/b.html","active_grid","select"],function(t,e,i,n){var r=t.extend({renderFilters:function(t){t.$mount(this.form[0]),this.form.find("select").widget("select")},renderGrid:function(t){t?this.quotesGrid=new n(this.grid[0],{columns:[{width:"40",name:"序号",css:"white c",value:function(t,e){return e+1}},{width:"75",name:"代码",css:"blue cl",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.obj+'">'+t.symbol+"</a>"}},{width:"105",name:"简称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.obj+'">'+t.name.replace("--",t.C10)+"</a>"}},{width:"60",name:"现价",color:function(t){return this.fixColor(t.change,3)},sort:!0,value:function(t){return this.fixFloat(t.lastTrade,3)}},{width:"60",name:"涨幅",color:function(t){return this.fixColor(t.change,3)},sort:!0,value:function(t){return this.fixPercent(t.chg)}},{width:"95",name:"成交额(万)",sort:!0,value:function(t){return this.fixFloat(t.amount/1e4)}},{width:"85",name:"预测净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.predictiveNAV,4)}},{width:"85",name:"最新净值",css:"white",sort:!0,value:function(t){return this.fixFloat(t.B3,4)}},{width:"70",name:"溢价率",css:"white",color:function(t){return this.fixColor(100*t.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.premium)}},{width:"85",name:"价格杠杆",css:"white",sort:!0,value:function(t){return this.fixFloat(t.B1/t.B4*t.structured.fund.predictiveNAV/t.lastTrade,4)}},{width:"85",name:"净值杠杆",css:"white",sort:!0,value:function(t){return this.fixFloat(t.B1/t.B4*t.structured.fund.predictiveNAV/t.predictiveNAV,4)}},{width:"85",name:"融资成本",sort:!0,value:function(t){return this.fixPercent(t.structured.classA.B16?Number(t.structured.classA.B16)+Number(t.B6)+Number(t.B7):Number(t.B5)+Number(t.B6)+Number(t.B7))}},{width:"130",name:"最新定期折算日",sort:!0,value:function(t){return this.fixTime(t.B8,"Y-M-d")}},{width:"160",name:"下一定期折算日(估)",sort:!0,value:function(t){return this.fixTime(t.B9,"Y-M-d")}},{width:"115",name:"定期折算周期",sort:!0,value:function(t){return t.B10}},{width:"115",name:"定期折算基准",css:"white",sort:!0,value:function(t,e,i){return t.B11?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B11)+'"></a>':"－"}},{width:"115",name:"定期折算方式",css:"white",sort:!0,value:function(t,e,i){return t.B12?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B12)+'"></a>':"－"}},{width:"85",name:"下折距离",sort:!0,value:function(t){return this.fixPercent("1"===t.B23?(t.B24-t.predictiveNAV)/t.predictiveNAV*100:(t.B24*t.structured.classA.B1-t.predictiveNAV)/t.predictiveNAV*100)}},{width:"130",name:"母基金上折距离",sort:!0,value:function(t){return this.fixPercent((t.B25-t.structured.fund.predictiveNAV)/t.structured.fund.predictiveNAV*100)}},{width:"130",name:"母基金预测净值",sort:!0,value:function(t){return this.fixFloat(t.structured.fund.predictiveNAV,4)}},{width:"130",name:"母基金最新净值",sort:!0,value:function(t){return this.fixFloat(t.B14,4)}},{width:"100",name:"合并溢价率",color:function(t){return this.fixColor(100*t.structured.fund.premium)},sort:!0,value:function(t){return this.fixPercent(100*t.structured.fund.premium)}},{width:"110",name:"场内份额(万)",sort:!0,value:function(t){return this.fixFloat(t.B20)}},{width:"70",name:"新增",color:function(t){return this.fixColor(t.B21)},sort:!0,value:function(t){return this.fixPercent(t.B21)}},{width:"115",name:"业绩比较基准",css:"white l",sort:!0,title:!0,value:function(t){return t.B22}},{width:"110",name:"投资类型",css:"l",sort:!0,title:!0,value:function(t){return t.B15}},{width:"85",name:"剩余年限",sort:!0,value:function(t){return t.B16}},{width:"85",name:"A:B配比",sort:!0,value:function(t){return t.B18}},{width:"85",name:"A可交易",sort:!0,value:function(t){return t.B17}},{width:"85",name:"基金类型",sort:!0,value:function(t){return t.B19}},{width:"auto",name:"",value:function(){return""}}],items:t,compare:function(t){return function(t,e){return this(t,e)||t.obj.localeCompare(e.obj)}.bind(this.base(t))}}):this.quotesGrid&&this.quotesGrid.refresh(!0)}});return r.init=function(t){return new e(new this({root:t.html(i),form:t.find("form"),grid:t.find(".grid")})).view},r}),define("presenters/info",["presenter_base","topic","vue"],function(t,e,i){return t.extend({init:function(){this.createViewModel(),this.vm.$on("filtersChange",this.onFiltersChange.bind(this))},onInit:function(t){this.items=t,this.view.renderFilters(this.vm),this.view.renderGrid(this.items,this.vm.groups)},onFiltersChange:function(t){var e=[];t.kind&&e.push('item.B25 == "'+t.kind+'"'),this.view.renderGrid(e.length?this.items.filter(new Function("item","return "+e.join("&&"))):this.items,this.vm.groups)},createViewModel:function(){this.vm=new i({data:{kind:"",kindOptions:[{text:"全部",value:""},"股票型","债券型","QDII"],groups:[!0,!0,!0,!0,!0]},methods:{filtersChange:function(){i.nextTick(function(){this.$emit("filtersChange",this.$data)}.bind(this))}}})}})}),define("text!views/info.html",[],function(){return'<form class="flex-none" v-on="change: filtersChange, input: filtersChange">\r\n    <div class="form-group pull-right">\r\n        <label>基金类型</label>\r\n        <select v-model="kind" options="kindOptions"></select>\r\n        <label><input v-model="groups[0]" type="checkbox"><span>特征信息</span></label>\r\n        <label><input v-model="groups[1]" type="checkbox"><span>A类收益</span></label>\r\n        <label><input v-model="groups[2]" type="checkbox"><span>定期折算</span></label>\r\n        <label><input v-model="groups[3]" type="checkbox"><span>不定期折算</span></label>\r\n        <label><input v-model="groups[4]" type="checkbox"><span>基本资料</span></label>\r\n    </div>\r\n</form>\r\n<div class="flex-auto grid"></div>'}),define("views/info",["view_base","../presenters/info","text!views/info.html","active_grid","select"],function(t,e,i,n){var r=t.extend({renderFilters:function(t){t.$mount(this.form[0]),this.form.find("select").widget("select")},renderGrid:function(t,e){t?(this.fastGrid&&this.fastGrid.destroy(),this.fastGrid=new n(this.grid[0],{columns:this.getColumns(e),items:t,groups:e,scrollTop:this.fastGrid&&this.fastGrid.scrollTop||0,scrollLeft:this.fastGrid&&this.fastGrid.scrollLeft||0,onCreate:function(){this.target.css("padding-top",56).find("tr").before(["<tr>","<td></td>",'<td colspan="2">母基金C</td>','<td colspan="2">分级A</td>','<td colspan="2">分级B</td>','<td colspan="9">特征信息</td>','<td colspan="2">A类收益</td>','<td colspan="5">定期折算</td>','<td colspan="4">不定期折算</td>','<td colspan="8">基本资料</td>',"<td></td>","</tr>"].filter(function(t,e){return 5>e||e>9||this[e-5]}.bind(this.groups)).join(""))},compare:function(t){return function(t,e){return this(t,e)||t.CO.localeCompare(e.CO)}.bind(this.base(t))}})):this.fastGrid&&this.fastGrid.refresh(!0)},getColumns:function(t){return Array.prototype.concat.apply([{width:"40",name:"序号",css:"white c",value:function(t,e){return e+1}},{width:"75",name:"代码",css:"blue c",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.CO+'">'+this.fixSymbol(t.CO)+"</a>"
}},{width:"100",name:"名称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.CO+'">'+t.B1+"</a>"}},{width:"75",name:"代码",css:"blue c",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.B2+'">'+this.fixSymbol(t.B2)+"</a>"}},{width:"110",name:"名称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.B2+'">'+t.B3+"</a>"}},{width:"75",name:"代码",css:"blue c",sort:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.B4+'">'+this.fixSymbol(t.B4)+"</a>"}},{width:"110",name:"名称",css:"l",sort:!0,title:!0,value:function(t){return'<a href="dzh://VIEWSTOCK?DATATYPE=DAY&LAYOUT=Level2默认&PAGE=分时走势&LABEL='+t.B4+'">'+t.B5+"</a>"}}],[[{width:"110",name:"A:B最新配比",css:"white",sort:!0,value:function(t){return t.B6}},{width:"85",name:"初始杠杆",css:"white",sort:!0,value:function(t){return t.B7}},{width:"115",name:"份额配比固定",sort:!0,value:function(t){return t.B8}},{width:"100",name:"可配对转换",sort:!0,value:function(t){return t.B9}},{width:"70",name:"封闭期",sort:!0,value:function(t){return t.B10}},{width:"85",name:"剩余年限",sort:!0,value:function(t){return t.B11}},{width:"115",name:"业绩基准",css:"l",sort:!0,title:!0,value:function(t){return t.B12}},{width:"85",name:"募集方式",css:"l",sort:!0,value:function(t){return t.B13}},{width:"125",name:"存续类型",css:"l",sort:!0,title:!0,value:function(t){return t.B14}}],[{width:"100",name:"约定年收益",css:"white",sort:!0,value:function(t){return this.fixPercent(t.B30)}},{width:"130",name:"约定年收益基准",css:"l",sort:!0,title:!0,value:function(t){return t.B31}}],[{width:"100",name:"最新折算日",css:"white c",sort:!0,value:function(t){return this.fixTime(t.B15,"Y-M-d")}},{width:"100",name:"下一折算日",css:"white c",sort:!0,value:function(t){return this.fixTime(t.B16,"Y-M-d")}},{width:"85",name:"折算周期",sort:!0,value:function(t){return t.B17}},{width:"85",name:"折算基准",css:"l",sort:!0,title:!0,value:function(t){return t.B18}},{width:"85",name:"折算方式",css:"white l",sort:!0,value:function(t,e,i){return t.B19?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B19)+'"></a>':"－"}}],[{width:"85",name:"B阀值",css:"l",sort:!0,title:!0,value:function(t){return t.B32}},{width:"100",name:"母基金阀值",css:"l",sort:!0,value:function(t){return t.B33}},{width:"115",name:"向上折算方式",css:"white l",sort:!0,value:function(t,e,i){return t.B20?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B20)+'"></a>':"－"}},{width:"115",name:"向下折算方式",css:"white l",sort:!0,value:function(t,e,i){return t.B21?'<a class="fa fa-file-text" data-bind="onTextBtnClick" data-title="'+this.columns[i].name+'" data-body="'+encodeHTML(t.B21)+'"></a>':"－"}}],[{width:"145",name:"封闭期后运作方式",css:"l",sort:!0,title:!0,value:function(t){return t.B22}},{width:"100",name:"是否转LOF",css:"l",sort:!0,value:function(t){return t.B23}},{width:"85",name:"投资目标",css:"l",sort:!0,title:!0,value:function(t){return t.B24}},{width:"85",name:"基金类型",css:"l",sort:!0,value:function(t){return t.B25}},{width:"115",name:"基金类型明细",css:"l",sort:!0,value:function(t){return t.B26}},{width:"85",name:"成立时间",css:"white c",sort:!0,value:function(t){return this.fixTime(t.B27,"Y-M-d")}},{width:"100",name:"基金管理人",css:"l",sort:!0,value:function(t){return t.B28}},{width:"100",name:"基金托管人",css:"l",sort:!0,value:function(t){return t.B29}}]].filter(function(t,e){return this[e]}.bind(t)).concat([{width:"auto",name:"",value:function(){return""}}]))}});return r.init=function(t){return new e(new this({root:t.html(i),form:t.find("form"),grid:t.find(".grid")})).view},r}),define("views/index",["view_base","../presenters/index","./analysis","./a","./b","./info","tabs","dialog"],function(t,e,i,n,r,s){var a=t.extend(function(){this.tabs.on("active",this.onTabActive.bind(this))},{views:[],onTabActive:function(t){this.emit("tabActive",t)},onTextBtnClick:function(t){this.dialog.target.find("article").html(["<h1>",t.target.dataset.title,"</h1><section>",t.target.dataset.body,"</section>"].join("")),this.dialog.show()},renderPane:function(t,e){if(this.tabs.selectItem(t),!this.views[t]){var a=[i,n,r,s][t];a&&(this.views[t]=a.init(this.panes.children().eq(t)),this.views[t].emit("init",e))}}});return a.init=function(){new e(new this({root:$("body"),tabs:$(".nav-tabs").widget("tabs"),panes:$(".nav-panes"),dialog:$(".dialog").widget("dialog")}))},a}),require(["views/index"],function(){require(["views/"+(location.pathname.match(/([^\/]+)\.html/)||[,"index"])[1]],function(){arguments[0]&&arguments[0].init&&arguments[0].init()})}),define("src",function(){});