(function(a){a.fn.dialog=function(c){var b=a.extend(true,{winbgcolor:"#333",winbgopcity:"0.5",dialogborder:"solid 1px #666",dialogbdradius:"",oId:"dialog",width:"950",height:"600",titleTxt:"",titleh:"30",titlebg:"",titleon:false,titlecolor:"#fff",titlestatue:"txt",titlehtml:"",bodybg:"",content:"text:",timecircuit:false,time:"3000",drag:false,lock:true,showbg:true,showtitle:true,statue:"",maxmin:true,minWidth:"200",titleImg:{minImg:"最小化",maxImg:"最大化",returnImg:"还原",cloased:"关闭"},resizedialog:false,resizeTop:"50",resizeLeft:"50",loadPower:"off",loadImg:"off",loadStatus:{loadId:"dialogLoad",imgsrc:"image/loading.gif",imgW:"32",imgH:"32",bgcolor:"#fff",opcity:"0.5"},iframeZend:"off",isOut:"off"},c);a.fn.dialog.init(b)};a.extend(a.fn.dialog,{init:function(b){a.fn.dialog.create(b);a.fn.dialog.center(b);a.fn.dialog.closed(b);a.fn.dialog.resizeble(b);a.fn.dialog.loadContent(b);a.fn.dialog.drag(b);a.fn.dialog.resizedialog(b);a.fn.dialog.autoClosed(b);a.fn.dialog.loadStatus(b)},create:function(f){var j=a.fn.dialog.getDialogAllStatues(f).htmlWidth;var h=a.fn.dialog.getDialogAllStatues(f).htmlHeight;var g=a.fn.dialog.getDialogAllStatues(f).scrollWidth;var b=a.fn.dialog.getDialogAllStatues(f).scrollHeight;if(f.resizedialog){f.width=j-f.resizeLeft*2;f.height=h-f.resizeTop*2}else{f.width=f.width;f.height=f.height}var d;if(a("#winbg").length!=0){}else{d='<div id="winbg" style="position:absolute;top:0;left:0;z-index:999;width:'+g+"px;height:"+b+"px;background-color:"+f.winbgcolor+";opacity:"+f.winbgopcity+";filter:alpha(opacity="+f.winbgopcity*100+');"></div>';if(a(f.oId).length!=0){}else{d+='<div id="'+f.oId+'" style="position:fixed;width:'+f.width+"px;height:"+f.height+"px;color:#000;border:"+f.dialogborder+";border-radius:"+f.dialogbdradius+'px;z-index:1000">';if(f.titleon){switch(f.titlestatue){case"txt":if(f.maxmin){d+='<div id="dialog-title" style="background:'+f.titlebg+";height:"+f.titleh+"px;line-height:"+f.titleh+"px;color:"+f.titlecolor+'"><span class="fn-left title-text">'+f.titleTxt+'</span><span class="fn-right dialogBtn" id="closeDialog">'+f.titleImg.cloased+'</span><span class="fn-right dialogBtn" id="maxDialog">'+f.titleImg.maxImg+'</span><span class="fn-right dialogBtn" id="returnDialog">'+f.titleImg.returnImg+'</span><span class="fn-right dialogBtn" id="minDialog">'+f.titleImg.minImg+"</span></div>"}else{d+='<div id="dialog-title" style="background:'+f.titlebg+";height:"+f.titleh+"px;line-height:"+f.titleh+"px;color:"+f.titlecolor+'"><span class="fn-left title-text">'+f.titleTxt+'</span><span class="fn-right close-dialog" id="closeDialog">'+f.titleImg.cloased+"</span></div>"}break;case"html":d+='<div style="background:'+f.titlebg+";height:"+f.titleh+"px;line-height:"+f.titleh+"px;color:"+f.titlecolor+'">'+f.titlehtml+"</div>";break}}d+='<div id="dialog-content"></div>';d+="</div>"}}a.fn.dialog.getDialogAllStatues(f).body.append(d);var k=a.fn.dialog.getDialogAllStatues(f).dialogid;var i=a.fn.dialog.getDialogAllStatues(f).dialogtitle;var c=a.fn.dialog.getDialogAllStatues(f).dialogcontent;var e=k.height()-i.height();c.css("height",e);if(!f.showtitle){i.remove()}if(!f.showbg){a.fn.dialog.getDialogAllStatues(f).winbg.css("opacity","0")}},center:function(d){var e=a.fn.dialog.getDialogAllStatues(d).htmlWidth;var i=a.fn.dialog.getDialogAllStatues(d).htmlHeight;var k=a.fn.dialog.getDialogAllStatues(d).dialogid;var h=a.fn.dialog.getDialogAllStatues(d).dialogtitle;var b=a.fn.dialog.getDialogAllStatues(d).dialogcontent;var f=k.width();var g=k.height();if(f<=e){var l=((e-f)/2);k.css("left",l)}else{k.width(e);k.css("left",0)}if(g<=i){var j=((i-g)/2);k.css("top",j)}else{k.height(i);k.css("top",0);var c=k.height()-h.height();b.css("height",c)}},loadContent:function(g){var e=a.fn.dialog.getDialogAllStatues(g).dialogcontent;var f=a.fn.dialog.getDialogAllStatues(g).htmlWidth;var b=a.fn.dialog.getDialogAllStatues(g).htmlHeight;$contentType=g.content.substring(0,g.content.indexOf(":"));$contentBody=g.content.substring(g.content.indexOf(":")+1,g.content.length);e.empty();switch($contentType){case"text":e.append($contentBody);a.fn.dialog.drag(g);break;case"img":e.append('<img src="'+$contentBody+'" />');a.fn.dialog.drag(g);break;case"html":e.append($contentBody);a.fn.dialog.drag(g);break;case"iframe":var d=a('<iframe style="width:100%;border:0;height:100%;box-shadow:0px 0px 15px 5px #666;" src="/blank_white.html" name="dialogiframe"></iframe>');e.append(d);e.append(c);d.one("load",function(){a(this).attr("src",$contentBody)});a.fn.dialog.getDialogAllStatues(g).body.append("<div unselectable='on' id='"+g.oId+"-iframeDiv' style='cursor:move;-moz-user-select: none;-webkit-user-select: none; -ms-user-select: none;user-select: none;display:none;position:fixed;z-index:1001;width:"+f+"px;height:"+b+"px;top:0px;left:0px;'></div>");a.fn.dialog.drag(g);break;case"jsoniframe":var d=a('<iframe style="width:100%;border:0;height:100%;" src="/blank_white.html" name="dialogiframe"></iframe>');var c=a('<form id="dialogform" name="dialogform" method="post" target="dialogiframe" action="" style="display:none;"><input type="hidden" name="code" value=""/><input type="hidden" name="word" value=""/></form>');e.append(d);e.append(c);d.one("load",function(){if($contentBody){$contentBody=common.getjson($contentBody);a.each($contentBody,function(j,h){c.find("input[name='"+j+"']").val(h)});c.attr("action",$contentBody.url).submit()}});a.fn.dialog.getDialogAllStatues(g).body.append("<div unselectable='on' id='"+g.oId+"-iframeDiv' style='cursor:move;-moz-user-select: none;-webkit-user-select: none; -ms-user-select: none;user-select: none;display:none;position:fixed;z-index:1001;width:"+f+"px;height:"+b+"px;top:0px;left:0px;'></div>");a.fn.dialog.drag(g);break;case"swf":e.append('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+$contentBody+'" /><!--[if !IE]>--><object type="application/x-shockwave-flash" data="'+$contentBody+'" width="100%" height="100%"><!--<![endif]--><p>Alternative content</p><!--[if !IE]>--></object><!--<![endif]--></object>');a.fn.dialog.drag(g);break;case"video":e.append('<video src="'+$contentBody+'" controls="controls">your browser does not support the video tag</video>');a.fn.dialog.drag(g);break}a.fn.dialog.statueIn(g)},closed:function(b){a(top.document).keyup(function(d){var c=d.which;if(c==27){a.fn.dialog.statueOut(b)}});a.fn.dialog.getDialogAllStatues(b).closeDialog.mouseover(function(c){});a.fn.dialog.getDialogAllStatues(b).closeDialog.click(function(){a.fn.dialog.statueOut(b)})},resizeble:function(b){a.fn.dialog.getDialogAllStatues(b).maxDialog.click(function(){a.fn.dialog.maxDialog(b);b.drag=false;a.fn.dialog.drag(b)});a.fn.dialog.getDialogAllStatues(b).minDialog.click(function(){a.fn.dialog.minDialog(b);b.drag=false;a.fn.dialog.drag(b)});a.fn.dialog.getDialogAllStatues(b).returnDialog.click(function(){a.fn.dialog.returnDialog(b);b.drag=true;a.fn.dialog.drag(b)})},statueIn:function(c){var b=a.fn.dialog.getDialogAllStatues(c).dialogid;switch(c.statue){case"fade":b.fadeIn("slow");a.fn.dialog.getDialogAllStatues(c).winbg.fadeIn("slow");break;case"slide":b.css("display","none");b.slideDown("slow");break;default:break}},statueOut:function(e){var d=a.fn.dialog.getDialogAllStatues(e).dialogid;var c=a.fn.dialog.getDialogAllStatues(e).iframeDiv;switch(e.statue){case"fade":d.fadeOut("slow",b);a.fn.dialog.getDialogAllStatues(e).winbg.fadeOut("slow",b);break;case"slide":d.slideUp("slow",b);break;default:b();break}c.remove();function b(){d.remove();a.fn.dialog.getDialogAllStatues(e).winbg.remove()}},drag:function(c){var d=a.fn.dialog.getDialogAllStatues(c).htmlWidth;var n=a.fn.dialog.getDialogAllStatues(c).htmlHeight;var q=a.fn.dialog.getDialogAllStatues(c).dialogid;var k=a.fn.dialog.getDialogAllStatues(c).dialogtitle;var b=a.fn.dialog.getDialogAllStatues(c).dialogcontent;var h=a.fn.dialog.getDialogAllStatues(c).documents;var m=a.fn.dialog.getDialogAllStatues(c).iframeDiv;$contentType=c.content.substring(0,c.content.indexOf(":"));if(document.all){top.window.attachEvent("blur",r)}else{top.document.addEventListener(top.window,"blur",r)}var l,j,f,p;if(c.drag){k.css("cursor","move");k.bind("mousedown",i);function i(o){o.preventDefault();if($contentType=="iframe"){m.css("display","block");m.css("top",b.offset().top);m.css("left",b.offset().left);m.css("width",b.width());m.css("height",b.height())}l=o.clientX-a.fn.dialog.getDialogAllStatues(c).scrollLeft-q.offset().left;j=o.clientY-a.fn.dialog.getDialogAllStatues(c).scrollTop-q.offset().top;h.bind("mousedown",g);h.bind("mousemove",e);h.bind("mouseup",r)}function g(o){o.preventDefault()}function e(t){t.preventDefault();if(c.iframeZend=="on"){top.window.getSelection?top.window.getSelection().removeAllRanges():top.document.selection.empty()}else{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}var o=t.clientX+a.fn.dialog.getDialogAllStatues(c).scrollLeft-l;var s=t.clientY+a.fn.dialog.getDialogAllStatues(c).scrollTop-j;t.clientX=t.clientX;t.clientY=t.clientY;q.css({top:s,left:o});if(c.isOut=="off"){if(o<=1){q.css("left",0)}if(s<=1){q.css("top",0)}if((parseFloat(o)+parseFloat(c.width))>d){q.css("left",d-c.width)}if((parseFloat(s)+parseFloat(q.height()))>n){q.css("top",n-q.height())}}if($contentType=="iframe"){m.css("top",b.offset().top);m.css("left",b.offset().left);m.css("width",b.width());m.css("height",b.height())}}function r(){m.css("display","none");q.css({top:p,left:f});h.unbind("mousemove",e);h.unbind("mouseup",r);h.unbind("mousedown",g)}}else{k.unbind("bind",i)}},maxDialog:function(h){var f=a.fn.dialog.getDialogAllStatues(h).htmlWidth;var b=a.fn.dialog.getDialogAllStatues(h).htmlHeight;var g=a.fn.dialog.getDialogAllStatues(h).dialogid;var d=a.fn.dialog.getDialogAllStatues(h).dialogtitle;var c=a.fn.dialog.getDialogAllStatues(h).dialogcontent;g.height(b-2);g.width(f-2);var e=b-d.height()-2;c.css("height",e);c.css("display","block");g.css("top","0");g.css("left","0")},minDialog:function(g){var f=a.fn.dialog.getDialogAllStatues(g).dialogid;var d=a.fn.dialog.getDialogAllStatues(g).dialogtitle;var b=a.fn.dialog.getDialogAllStatues(g).dialogcontent;var e=d.height();var c=g.minWidth+"px";f.height(e);f.width(c);b.css("display","none");f.css("top",a("html").height()-e-2);f.css("left","0")},returnDialog:function(h){var g=a.fn.dialog.getDialogAllStatues(h).dialogid;var d=a.fn.dialog.getDialogAllStatues(h).dialogtitle;var b=a.fn.dialog.getDialogAllStatues(h).dialogcontent;var f=h.height;var c=h.width;g.height(f);g.width(c);var e=g.height()-d.height();b.css("height",e);b.css("display","block");a.fn.dialog.center(h)},resizedialog:function(c){if(c.iframeZend=="on"){if(document.all){window.attachEvent("onresize",b)}else{window.addEventListener("resize",b,false)}}else{if(document.all){top.window.attachEvent("onresize",b)}else{top.window.addEventListener("resize",b,false)}}function b(){var g=a.fn.dialog.getDialogAllStatues(c).htmlWidth;var l=a.fn.dialog.getDialogAllStatues(c).htmlHeight;var n=a.fn.dialog.getDialogAllStatues(c).dialogid;var k=a.fn.dialog.getDialogAllStatues(c).dialogtitle;var e=a.fn.dialog.getDialogAllStatues(c).dialogcontent;var h=c.width;var i=c.height;if(c.resizedialog){c.width=g-c.resizeLeft*2;c.height=l-c.resizeTop*2;n.width(c.width);n.height(c.height)}else{var o=(g-c.width)/2;var m=(l-c.height)/2;if(o>0){if(n.width()<h){n.width(g)}else{n.width(h)}n.css("left",o)}else{n.css("left",0);n.width(g)}if(m>0){if(n.height()<i){n.height(i)}else{n.height(i)}n.css("top",m)}else{n.css("top",0);n.height(l)}}var f=n.height()-k.height();e.css("height",f);var j=a.fn.dialog.getDialogAllStatues(c).scrollWidth;var d=a.fn.dialog.getDialogAllStatues(c).scrollHeight;a.fn.dialog.getDialogAllStatues(c).winbg.width(j);a.fn.dialog.getDialogAllStatues(c).winbg.height(d)}},autoClosed:function(c){if(c.timecircuit){var b=setTimeout(function(){a.fn.dialog.statueOut(c)},c.time)}},loadStatus:function(f){if(f.loadPower=="on"){var c=a.fn.dialog.getDialogAllStatues(f).dialogcontent;var e=(c.height()-f.loadStatus.imgH-f.titleh)/2;var d=(c.width()-f.loadStatus.imgW)/2;var b="";b="<div id="+f.loadStatus.loadId+" style='background-color:"+f.loadStatus.bgcolor+";opacity:"+f.loadStatus.opcity+";filter:alpha(opacity="+f.loadStatus.opcity*100+");width:"+c.width()+"px;height:"+(c.height())+"px;top:"+f.titleh+"px;position:absolute;' class='loadDialogBox'>";if(f.loadImg=="on"){b+="<div id='dialog-load-img' style='position:absolute;width:"+f.loadStatus.imgW+"px;height:"+f.loadStatus.imgH+"px;top:"+e+"px;left:"+d+"px;'><img src='"+f.loadStatus.imgsrc+"' /></div>"}else{b+='<div class="dialogBar"><i class="sphere"></i></div>'}b+="</div>";c.append(b)}},getDialogAllStatues:function(c){var b={};if(c.iframeZend=="on"){b={documents:document,winbg:a("#winbg"),closeDialog:a("#closeDialog"),maxDialog:a("#maxDialog"),minDialog:a("#minDialog"),returnDialog:a("#returnDialog"),scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft,body:a("body"),scrollWidth:document.body.scrollWidth,scrollHeight:document.body.scrollHeight,htmlHeight:a("html").height(),htmlWidth:a("html").width(),dialogid:a("#"+c.oId),dialogtitle:a("#dialog-title"),dialogcontent:a("#dialog-content"),iframeDiv:a("#"+c.oId+"-iframeDiv")}}else{b={documents:top.$(top.document),winbg:top.$("#winbg"),closeDialog:top.$("#closeDialog"),maxDialog:top.$("#maxDialog"),minDialog:top.$("#minDialog"),returnDialog:top.$("#returnDialog"),scrollTop:top.document.body.scrollTop,scrollLeft:top.document.body.scrollLeft,body:top.$("body"),scrollWidth:top.document.body.scrollWidth,scrollHeight:top.document.body.scrollHeight,htmlHeight:top.$("html").height(),htmlWidth:top.$("html").width(),dialogid:top.$("#"+c.oId),dialogtitle:top.$("#dialog-title"),dialogcontent:top.$("#dialog-content"),iframeDiv:top.$("#"+c.oId+"-iframeDiv")}}return b}})})(jQuery);
