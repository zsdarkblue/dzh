/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"dojox/customfig/actions/ContextMenu":function(){define("dojo/on,dojo/mouse,dojo/keys,dojo/_base/declare,dojox/customfig/actions/CustomfigAction,dojo/_base/lang,dojo/_base/array,dojo/dom,dojo/dom-geometry".split(","),function(u,m,n,c,a,g){return c("dojox.customfig.actions.ContextMenu",a,{constructor:function(a,e){this.plot=a;this.domID=a.domNode;this.plot.canvas.tabIndex=1;(this.menuItems=e.menuItems)&&this.addMenu(this.menuItems)},_addMenu:function(a){var e=this,d=this.domID;require(["dijit/Menu",
"dijit/MenuItem","dijit/MenuSeparator","dijit/PopupMenuItem"],function(f,b,o,p){for(var o=new f({targetNodeIds:[d]}),k=e.plot,l=function(l,d,o,i,a){var c=arguments.callee,h=o.slice(0,1)[0];o===i&&(a=new f({parentMenu:l}));g.isArray(h.label)?c(a,h.labelName,h.label,h.label):a.addChild(new b({label:h.label,onClick:g.hitch(e,h.fn,k)}));1==o.length?l.addChild(new p({label:d,popup:a})):c(l,d,o.slice(1),i,a)},i=0;i<a.length;i++){var c=a[i],t;g.isArray(c.label)?(t=c.labelName,c=c.label,l(o,t,c,c)):o.addChild(new b({label:c.label,
parentMenu:o,onClick:g.hitch(e,c.fn,k)}))}o.startup()})},addMenu:function(a){this._addMenu(a)}})})},"dojox/customfig/actions/CustomfigAction":function(){define(["dojo/on","dojo/_base/declare","dojo/_base/lang"],function(u,m,n){return m("dojox.customfig.actions.CustomfigAction",null,{constructor:function(c){this.plot=c.plot;this._listeners=[]},connect:function(c){for(var a=0;a<this._listeners.length;++a)this._listeners[a].handle=u(c||this.plot.canvas,this._listeners[a].eventName,n.hitch(this,this._listeners[a].methodName))},
disconnect:function(){for(var c=0;c<this._listeners.length;++c)this._listeners[c].handle.remove(),delete this._listeners[c].handle},destroy:function(){this.disconnect()}})})},"dojox/customfig/widget/DIDSharingPlans":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-geometry,dojo/dom-style,dijit/_WidgetBase,dijit/_TemplatedMixin,dojox/customfig/Plot,dojox/customfig/mains/SharingPlans,dojox/store/SharingPlansWSStore,dojox/customfig/datas/SharingPlansData,../utils,dojox/customfig/widget/MinSharingPlans,dojox/customfig/indicators/Indicators".split(","),
function(u,m,n,c,a,g,h,e,d,f,b,o,p){m.getObject("dojox.customfig.indicators");return u("dojox.customfig.widget.DIDSharingPlans",[p],{queryObj:{obj:"obj",time:function(b,f,d,e){return 1*o.str2millisecond(f[d[e]])},price:"newclean",volume:"vol"},reg:function(){var k=this.storeName,l=this.storeTradeTime,d=this.storeDatas,e=this.dataHandleName,a=this.dataHandleTradeTime,c=this.dataHandleDatas,p=this.plot,g=p.main,h=p.indicators,w=this;mainIndicators=p.mainIndicators;queryObj=this.queryObj;indicator2Field=
this.indicator2Field;did=this.did;baseDid=this.baseDid;codes=n.map(this.codes,function(b){return b.name});codeTypes=n.map(this.codes,function(b){return b.type});codeName=n.map(this.codes,function(b){return b.codeName});g.setMainCode(codes);var m={service:"did",did:baseDid,where:"obj="+codes.join(","),response_times:"1"};e&&e.destroy();e=this.dataHandleName=new b(k,{query:m},{name:"name",lastclose:codeTypes[0]});e.setCallback(function(b){var f=[],k=[];codeName&&n.forEach(codeName,function(b){f.push(b)});
g.setMainLabels(f);n.forEach(codes,function(f,l){var d=b.lastclose;"undefined"!=typeof d&&"undefined"!=typeof d[l]?k.push(+d[l]):k.push(0)});g.setBaseValue(k);p.setData(b)});k={service:"objinfo",type:"base",where:"obj="+codes.join(","),field:"open_close_num,open_close_time",response_times:"1",response_mode:0};a&&a.destroy();var a=this.dataHandleTradeTime=new b(l,{query:k},{open_close_num:"open_close_num",open_close_time:"open_close_time"}),x=[];a.setCallback(function(b){if(b.open_close_num)for(var f=
0,k=b.open_close_num.length;f<k;f++)if(x.push(o.organizeXLabels(b.open_close_num[f],b.open_close_time[f])),f)g.setTimeKey(o.checkSameValueInMainarr(x[0],x[f]),f-1);else{g.setXLabels(x[0]);for(var l in h)h[l].setXLabels(x[0]);for(l in mainIndicators)mainIndicators[l].setXLabels(x[0])}p.setData(b)});l=0;for(a=codes.length;l<a;l++){k={service:"did",did:this.did,where:"obj="+codes[l],response_times:-1};d[l]?e=d[l]:(e=new f,d.push(e));k=new b(e,{query:k},queryObj);c.push(k);var z=setTimeout(function(){p.render()},
300);k.setCallback(function(b,f){return function(k){k[b]&&(z&&clearTimeout(z),g.setData(k[b].price,f),0===f&&(w.setData2indicator(h,indicator2Field,k[b],f),w.setData2indicator(mainIndicators,indicator2Field,k[b],f)),p.setData(k[b]),p.render())}}(codes[l],l))}}})})},"dojox/customfig/Plot":function(){define("../main,dojo/_base/declare,dijit/_WidgetBase,dojo/_base/lang,dojo/dom,dojo/dom-geometry,./utils,dojo/cssScale,dojox/customfig/themes/Theme".split(","),function(u,m,n,c,a,g,h,e,d){c.getObject("customfig",
!0,u);return m("dojox.customfig.Plot",[n],{kwArgs:{margins:{l:2,t:2,r:2,b:2},offsets:{l:70,t:10,r:70,b:10},noscale:!0},constructor:function(f){this.kwArgs=c.mixin({},this.kwArgs,f||{});this.mainIndicators={};this.mainIndicatorsNum=0;this.indicators={};this.indicatorsNum=0;this.data={}},postCreate:function(){this.initCanvas(g.getMarginBox(this.domNode));if(!this.theme)this.theme=new d},initCanvas:function(f){var b=this.kwArgs;if(!this.canvas)this.canvas=h.createCanvas(this.domNode),this.ctx=this.canvas.getContext("2d");
this.noscale?(this.canvas.height=e.scaleMul(f.h,"y"),this.canvas.width=e.scaleMul(f.w,"x"),this.canvas.style["-webkit-transform-origin"]="left top",this.canvas.style["-webkit-transform"]="scale("+1/e.getScaleX()+","+1/e.getScaleY()+")"):(this.canvas.height=f.h,this.canvas.width=f.w,this.canvas.style["-webkit-transform-origin"]="",this.canvas.style["-webkit-transform"]="");this.plotHeight=this.canvas.height-b.margins.t-b.margins.b;this.plotWidth=this.canvas.width-b.margins.l-b.margins.r},setTheme:function(f){this.theme=
f},addMain:function(f){this.main&&this.main.destroy();this.main=f;return this},addMainIndicator:function(f){var b=f.type;b in this.mainIndicators&&(this.mainIndicatorsNum-=1,this.mainIndicators[b].destroy());this.mainIndicators[b]=f;this.mainIndicatorsNum+=1;return this},delMainIndicator:function(f){f in this.mainIndicators&&(this.mainIndicatorsNum-=1,this.mainIndicators[f].destroy(),delete this.mainIndicators[f],this.render())},addIndicator:function(f){var b=f.type;b in this.indicators&&(this.indicatorsNum-=
1,this.indicators[b].destroy());this.indicators[b]=f;this.indicatorsNum+=1;return this},setData:function(f){c.mixin(this.data,f)},getData:function(){return this.data},delIndicator:function(f){f in this.indicators&&(this.indicatorsNum-=1,this.indicators[f].destroy(),delete this.indicators[f],this.render())},divideRegion:function(){var f=this.main,b=this.indicators,d=this.mainIndicators,e=this.kwArgs,k=this.mainIndicatorsNum,l=e.margins,e=e.offsets,i,a=this.indicatorsNum;if(f||k){k=(this.plotHeight-
e.t-e.b)/(a+2);i={ctx:this.ctx,offsets:e,height:2*k,width:this.plotWidth-e.l-e.r,yStart:l.t+e.t,xStart:l.l+e.l,theme:this.theme,margins:this.kwArgs.margins};f&&f.setGeometry(i);for(var c in d)d[c].setGeometry(i)}else k=(this.plotHeight-e.t-e.b)/a;var f=0,g;for(g in b)b[g].setGeometry({ctx:this.ctx,offsets:e,height:k,width:this.plotWidth-e.l-e.r,yStart:l.t+e.t+(i?(f+2)*k:f*k),xStart:l.l+e.l,theme:this.theme,margins:this.kwArgs.margins}),f++},render:function(){var f=this.main,b=this.indicators,e=this.mainIndicators;
this.divideRegion();f&&f.render();for(var d in e)e[d].render();for(var k in b)b[k].render()},resize:function(f){f&&(g.setMarginBox(this.domNode,{w:f.w,h:f.h}),this.initCanvas(g.getMarginBox(this.domNode)),this.render())},clear:function(){var f=this.main,b=this.indicators,e=this.mainIndicators;f&&f.clear();for(var d in e)e[d].clear();for(var k in b)b[k].clear()},saveAsExcel:function(){var f=0,b=this.main,e=b.getMainLabels()[0],d=b.getMainCode()[0].split(".")[0],k=this.data,l=[],a=k.time.length;b.baseValue?
l=["time","price","volume"]:(f=b.getStart(),a=b.getEnd(),l="time,open,high,low,close,volume".split(","));b=["<html xmlns:x='urn:schemas-microsoft-com:office:excel'><head><\!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>"];b.push("\u5927\u667a\u6167\u6570\u636e\u5bfc\u51fa");b.push("</x:Name><x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\><meta http-equiv='content-type' content='text/html; charset=gbk'><style>.text { font-family:Arial;font-size:10pt;mso-number-format:'@';}</style></head>");
b.push("<body>");b.push("<table width='100%' border='1' cellpadding='0' bordercolorlight='#999999' bordercolordark='#FFFFFF' cellspacing='0' align='center'>");b.push("");b.push("<tr>");b.push("<th><div>");b.push("\u4ee3\u7801");b.push("</div></th>");b.push("<th><div>");b.push(d);b.push("</div></th>");b.push("<th><div>");b.push("\u540d\u79f0");b.push("</div></th>");b.push("<th><div>");b.push(e);b.push("</div></th>");b.push("</tr>");b.push("<tr>");for(var c in l)b.push("<th><div>"),b.push(l[c]),b.push("</div></th>");
b.push("</tr>");for(c=f;c<a;c++){b.push("<tr>");for(var g in l)b.push("<td>"),b.push(k[l[g]][c]),b.push("</td>");b.push("</tr>")}b.push("</table>");b.push("</body>");window.external.saveas?window.external.saveas(b.join(""),"\u5927\u667a\u6167\u6570\u636e\u5bfc\u51fa","xls"):alert("\u8bf7\u5728\u5927\u667a\u6167\u5ba2\u6237\u7aef\u4f7f\u7528")}})})},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(u){return u.dojox})},"dojox/customfig/utils":function(){define(["..","dojo/_base/lang",
"dojo/dom-construct","../canvasDashedLine"],function(u,m,n,c){function a(e){return g.test(e)?e+0.5:e}var g=/^-?[1-9]\d*$/,h={"%Y-%m-%d %H:%M":function(e){e=new Date(e);return e.getFullYear()+"-"+(100+e.getMonth()+1).toString().substring(1)+"-"+(100+e.getDate()).toString().substring(1)+" "+(100+e.getHours()).toString().substring(1)+":"+(100+e.getMinutes()).toString().substring(1)},"%H:%M":function(e){e=new Date(e);return(100+e.getHours()).toString().substring(1)+":"+(100+e.getMinutes()).toString().substring(1)},
"%m/%d %H:%M":function(e){e=new Date(e);return(100+e.getMonth()+1).toString().substring(1)+"/"+(100+e.getDate()).toString().substring(1)+" "+(100+e.getHours()).toString().substring(1)+":"+(100+e.getMinutes()).toString().substring(1)},"%Y/%m/%d":function(e){e=new Date(e);return e.getFullYear()+"/"+(100+e.getMonth()+1).toString().substring(1)+"/"+(100+e.getDate()).toString().substring(1)}},u=m.getObject("customfig.utils",!0,u);m.mixin(u,{organizeXLabels:function(e,d){for(var f,b,a=[],c=0;c<2*e;c+=2){var k=
[];f=1*d[c];b=1*d[c+1];if(0!==f&&b)for(f=c?f+60:f;f<=b;f+=60)k.push(this.from5StrToHM("%h:%m",f));a.push(k)}return a},checkSameValueInMainarr:function(e,d){2===this.array2ORarray1(e)&&(e=this.array2toarray1(e));2===this.array2ORarray1(d)&&(d=this.array2toarray1(d));var f=[],b={},a,c,k;a=0;for(var l=e.length;a<l;a++)b[e[a]]=a,f.push({mainIndex:a,value:e[a]});for(var l=0,i=d.length;l<i;l++)if(a=b[d[l]],void 0!=a)f[a].overlapsIndex=l,c||(c={mainIndex:a,overlapsIndex:l,value:e[a]}),!k&&a==e.length-1&&
(k={mainIndex:a,overlapsIndex:l,value:e[a]});c&&(f.shift(),f.unshift(c));k&&(f.pop(),f.push(k));return f},array2ORarray1:function(e){return"[object Array]"===Object.prototype.toString.call(e)?"[object Array]"===Object.prototype.toString.call(e[0])?2:1:0},array2toarray1:function(e){for(var d=[],f=0;f<e.length;f++)d=d.concat(e[f]);return d},ygrid:function(e,d,f){2>f&&(f=2);var b=f-1,a=[];0==b&&(b=1);d=(d-e)/b;for(b=0;b<f;b++)a[b]=e+d*b;return a},isEmptyObject:function(e){for(var d in e)return!1;return!0},
createCanvas:function(e){return n.create("canvas",null,e)},clearCanvas:function(e,d,f,b,a,c){d=Math.round(d);f=Math.round(f);e.clearRect(d,f,b,a);e.fillStyle=c;e.fillRect(d,f,b,a)},drawline:function(e,d,f,b,c,g,k){var l=e.lineWidth;e.lineWidth=k||1;e.strokeStyle=g||"#111111";e.beginPath();d=a(d);b=a(b);f=a(f);c=a(c);e.moveTo(d,f);e.lineTo(b,c);e.stroke();e.closePath();e.lineWidth=l},drawText:function(e,d,f,b,a){var c=a.padding||2;e.font=a.font||"10pt Arial bold";e.textAlign=a.align||"start";e.textBaseline=
a.textBaseline||"bottom";e.fillStyle=a.color||"red";e.fillText(d,f+c,b);return e.measureText(d).width},drawDashes:function(e,d,f,b,g,h){d=a(d);b=a(b);f=a(f);g=a(g);c.drawDashedPolyLine(e,[[d,f],[b,g]],{color:h})},drawRect:function(e,d,f,b,c,g){g?(d=a(d),f=a(f),e.strokeRect(d,f,b,c)):e.fillRect(d,f,b,c)},drawArrow:function(e,d,f,b,a,c){e.lineWidth=2;e.fillStyle=+c;e.beginPath();e.moveTo(d+b/2,f);e.lineTo(d+b,f-a/2);e.lineTo(d+3*b/4,f-a/2);e.lineTo(d+3*b/4,f-a);e.lineTo(d+b/4,f-a);e.lineTo(d+b/4,f-
a/2);e.lineTo(d,f-a/2);e.lineTo(d+b/2,f);e.closePath();e.fill();e.save();c.up&&(e.setTransform(1,0,0,1,0,0),e.translate(d+b/2,f-a/2),e.rotate(180*Math.PI/180),e.drawImage(e.canvas,d,f-a,b,a,-b/2,-a/2,b,a),e.restore())},minmax2d:function(a,d,f){var b=-Infinity,c=Infinity,d=d||0,f=f||a[0].length,g;for(g in a){var k=a[g].slice(d,f);for(j in k)+k[j]>=b&&(b=1*k[j]),+k[j]<c&&(c=1*k[j])}return[+c,+b]},minmax1d:function(a){var d=-Infinity,f=Infinity,b;for(b in a)+a[b]>=d&&(d=a[b]),+a[b]<f&&(f=a[b]);return[+f,
+d]},from5StrToHM:function(a,d){var f=Math.floor(d/3600),f=(100+f).toString().substring(1);24<=f&&(f=(100+(f-24)).toString().substring(1));var b=(100+Math.floor(d%3600/60)).toString().substring(1);if("%h:%m"==a)return f+":"+b;if("%h%m"==a)return f+""+b},fromHMTo5Str:function(a){a=a.split(":");if(1<a.length)return 3600*a[0]+60*a[1]},date2Millisecond:function(a){var d;d=(new Date(a)).getTime();if(!isNaN(d))return d;a=a.replace(/-/g," ");d=(new Date(a)).getTime();if(!isNaN(d)||1E5<(d=parseInt(a)))return d},
millisecondChange:function(a,d){var a=a+"",f=(new Date).getTimezoneOffset()/60;d&&(f=0);5==a.length||6==a.length?(a=1E3*a+(new Date).setHours(0,0,0,0),f=0):9<=a.length&&(a*=1E3);return 1*a+36E5*f},millisecond2Date:function(a,d,f,b,c){function g(b,f){if(2==f)return(100+b).toString().substring(1);if(3==f)return(1E3+b).toString().substring(1);b=b.toString().replace(/^([0-9])$/,"0$1");3===f&&(b=b.toString().replace(/^([0-9]{2})$/,"0$1"));return b}d=this.millisecondChange(d,c);if(h[a])return h[a](d);if(!(void 0!==
d&&null!==d)||isNaN(d))return"Invalid date";var a=function(){var b=arguments,f,a,k=b.length;for(f=0;f<k;f++)if(a=b[f],"undefined"!==typeof a&&null!==a)return a}(a,"%Y-%m-%d %H:%M:%S"),c=new Date(d),k,l=c.getHours(),i=c.getDay(),r=c.getDate(),t=c.getMonth(),n=c.getFullYear(),q=f&&f.months?f.months:"\u4e00\u6708,\u4e8c\u6708,\u4e09\u6708,\u56db\u6708,\u4e94\u6708,\u516d\u6708,\u4e03\u6708,\u516b\u6708,\u4e5d\u6708,\u5341\u6708,\u5341\u4e00\u6708,\u5341\u4e8c\u6708".split(","),d={a:(f&&f.weekdays?f.weekdays:
"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(","))[i],d:g(r),e:r,b:q[t].substr(0,3),B:q[t],m:g(t+1),y:n.toString().substr(2,2),Y:n,H:g(l),I:g(l%12||12),l:l%12||12,M:g(c.getMinutes()),P:12>l?"AM":"PM",p:12>l?"am":"pm",S:g(c.getSeconds()),L:g(d%1E3,3)};for(k in d)a=a.replace("%"+k,d[k]);return b?a.substr(0,1).toUpperCase()+a.substr(1):a},str2millisecond:function(a){var d,f,b,c,g;(new Date).getTimezoneOffset();d=a.substr(0,4);f=a.substr(4,2);b=a.substr(6,2);c=a.substr(8,2);g=a.substr(10,
2);a=a.substr(12,2);return(new Date(d+"-"+f+"-"+b+"T"+c+":"+g+":"+a)).getTime()/1E3}});return u})},"dojox/canvasDashedLine":function(){define("dojox/canvasDashedLine",[],function(){var u=function(){};u.prototype={defaultLineStyle:{pattern:"***--***--",color:"#5f5d5b",width:1,scale:8,join:"bevel",cap:"butt"},prepareLineStyle:function(m){if(null==m)return this.defaultLineStyle;if(void 0==m.pattern||null==m.pattern)m.pattern=this.defaultLineStyle.pattern;if(void 0==m.scale||null==m.scale)m.scale=this.defaultLineStyle.scale;
if(void 0==m.color||null==m.color)m.color=this.defaultLineStyle.color;if(void 0==m.width||null==m.width)m.width=this.defaultLineStyle.width;if(void 0==m.cap||null==m.cap)m.cap=this.defaultLineStyle.cap;if(void 0==m.join||null==m.join)m.join=this.defaultLineStyle.join;return m},distance:function(m,n){return Math.sqrt(Math.pow(n[0]-m[0],2)+Math.pow(n[1]-m[1],2))},firstPattern:function(m,n){if(1<=n)return m;for(var c=0,a=[],g=0,h=m.length;g<h;g++)c+m[g].length>n&&(0==a.length?a.push({type:m[g].type,
length:m[g].length-(n-c)}):a.push(m[g])),c+=m[g].length;return a},strToPattern:function(m){for(var m=m.split(""),n=null,c=[],a=0,g=m.length;a<g;a++){var h=m[a];h==n?c[c.length-1].length++:"*"==h?c.push({type:"line",length:1}):c.push({type:"space",length:1});n=m[a]}a=0;for(g=c.length;a<g;a++)c[a].length/=m.length;return c},drawPolyLine:function(m,n,c){m.save();m.strokeStyle=c.color;m.lineWidth=c.width;m.lineCap=c.cap;m.lineJoin=c.join;m.beginPath();m.moveTo(n[0][0],n[0][1]);for(var c=0,a=n.length;c<
a;c++)m.lineTo(n[c][0],n[c][1]);m.stroke();m.restore()},dashedLine:function(m,n,c,a){void 0==a&&(a=0);var g=this.strToPattern(c.pattern),h=this.distance(m,n),e=(n[0]-m[0])/h,h=(n[1]-m[1])/h,d=m[0],m=m[1],f=0,b=null,o=!1,p,k=[];a:for(;;){b=0==f?a:0;0==f?(p=this.firstPattern(g,a),0==p.length&&(p=g)):p=g;for(var l=0,i=p.length;l<i;l++){var r=e*p[l].length*c.scale,t=h*p[l].length*c.scale;if(1E4<f||0<e&&d+r>=n[0]||0==h&&0<e&&d+r>=n[0]||0>e&&d+r<=n[0]||0==h&&0>e&&d+r<=n[0]||0<h&&m+t>=n[1]||0==e&&0<h&&m+
t>=n[1]||0>h&&m+t<=n[1]||0==e&&0>h&&m+t<=n[1])o=!0;o&&(r=n[0]-d,t=n[1]-m,a=b+this.distance([d,m],n)/c.scale);"line"==p[l].type&&k.push([[d,m],[d+r,m+t]]);if(o)break a;d+=r;m+=t;b+=p[l].length;f++}}return{startPosition:a,lines:k}},drawLineFragments:function(m,n,c){for(var a in n)this.drawPolyLine(m,n[a],c)},connectAdjacentLines:function(m,n){var c=m[m.length-1].length;m[m.length-1][c-1][0]==n[0][0][0]&&m[m.length-1][c-1][1]==n[0][0][1]&&(m[m.length-1].push(n[0][1]),n.shift())},dashedPolyLine:function(m,
n){for(var c=0,a=[],g=null,h=0,e=m.length-1;h<e;h++)if(g=this.dashedLine(m[h],m[h+1],n,c),c=g.startPosition,0<g.lines.length){0<a.length&&this.connectAdjacentLines(a,g.lines);for(var d=0,f=g.lines.length;d<f;d++)a.push(g.lines[d])}return a},drawDashedPolyLine:function(m,n,c){c=this.prepareLineStyle(c);n=this.dashedPolyLine(n,c);this.drawLineFragments(m,n,c)}};return new u})},"dojox/customfig/themes/Theme":function(){define(["dojo/_base/declare"],function(u){return u("dojox.customfig.themes.Theme",
null,{com_de_opt:{label:"#5F5E5E",font:"9pt Arial bold",stroke:"#686868",background:"#FFFFFF",backgroundGrid:{type:"dashed",color:"#CFCFCF",height:25,lineHeight:1},xAxisLabel:{color:"#606060",background:"#FFFFFF"},yAxisLabel:{color:"#606060",background:"#FFFFFF"},xLabelsInterval:30,fixedNum:0,prepareDistance:0},sharingPlans:{timetrendFilledColors:["#131313","#0073ff"],timetrendFillAlpha:0.7,timetrend:["#F59F56","red","yellow"],baseValueStyle:{color:"#FF0000",background:"#FFFFFF"},yUpLabel:{color:"#E60000",
background:"#FFFFFF"},yDownLabel:{color:"#1FA42C",background:"#FFFFFF"}},kline:{candleStyle:[{upStyle:{candle:{type:"stroke",color:"#CC4642"}},downStyle:{candle:{type:"fill",color:"#55710B"}}},{upStyle:{candle:{type:"stroke",color:"#5F9EA0"}},downStyle:{candle:{type:"fill",color:"#5F9EA0"}}},{upStyle:{candle:{type:"stroke",color:"#C67413"}},downStyle:{candle:{type:"fill",color:"#C67413"}}},{upStyle:{candle:{type:"stroke",color:"#C67488"}},downStyle:{candle:{type:"fill",color:"#C67488"}}},{upStyle:{candle:{type:"stroke",
color:"#C93413"}},downStyle:{candle:{type:"fill",color:"#C93413"}}}],maximumArrow:{color:"#c8c8c8"},minimumArrow:{color:"#c8c8c8"},yAxisUpLabel:{color:"#CC4642"},yAxisLowLabel:{color:"#55710B"}},ma:{ma:["green","red","blue"]},edx:{edx:{color:"#ff9516",yTxtColor:"#ff9516",txtColor:"#ffffff",txtBgColor:"#ff9516"}},kdj:{kdj:["green","red","blue"]},vol:{volumnStyle:{upColor:"#ff0000",downColor:"#55710B",color:"yellow"}},macd:{macdStyle:{diff:{color:"#9B9B9B"},dea:{color:"#BC6111"},macd:{upcolor:"#ff0000",
downcolor:"#00ff00"}}},crosshair:{tooltip:{content:{background:"#3d70ae",width:"auto",height:"auto",border:"#3C72AE solid 1px","text-shadow":"1px 1px #244f84","text-align":"center",position:"absolute",opacity:0.85,"z-index":2,"line-height":1.6,padding:"4px","border-radius":"9px","font-size":"12px",color:"#FFFFFF"},time:{"font-weight":"normal",color:"#ffc13b"}},vLine:{width:"1px",background:"#3C72AE",position:"absolute","z-index":2},hLine:{height:"1px",background:"#3C72AE",position:"absolute","z-index":2},
vLabel:{border:"1px solid #3C72AE",color:"#3C72AE","text-align":"center","z-index":2,position:"absolute",background:"white"},hLabel:{border:"1px solid #3C72AE",color:"#3C72AE","text-align":"center","z-index":2,position:"absolute",width:"auto",background:"white"}}})})},"dojox/customfig/mains/SharingPlans":function(){define(["dojo/_base/declare","dojo/_base/lang","../Element","../utils"],function(u,m,n,c){return u("dojox.customfig.mains.SharingPlans",[n],{type:"sharingPlans",txt:"\u5206\u65f6\u8d70\u52bf",
defaultOptions:{timetrendType:1,overlapType:0,timetrendFilled:!1,fixedNum:2,rateNum:0.01,rateNumOffset:0.1,newTxt:!1,isDrawHead:!0},constructor:function(a,c){this._options=m.mixin({},this.defaultOptions,c.options);this.mainLabels=c.mainLabels?c.mainLabels:[];this.baseValue=c.baseValue?c.baseValue:[];this.yLabels=c.yLabels?c.yLabels:[];this.xLabels=c.xLabels?c.xLabels:[];this.data=c.data?c.data:[];this.timeKey=c.timeKey?c.timeKey:[];this.drawbase=!1},setGeometry:function(a){this.ctx=a.ctx;this.offsets=
a.offsets;this.height=a.height;this.width=a.width;this.yStart=a.yStart;this.xStart=a.xStart;this.margins=a.margins;this.options=m.mixin({},a.theme.com_de_opt,a.theme[this.type],this._options)},coreRange:function(){var a=0,g,h,e,d=this.data,f=this.options;this.baseValue&&this.baseValue.length?e=this.baseValue:e=this.baseValue[0]=this.yStart+this.height/2;this.xLabels&&this.xLabels.length?g=this._getLabelsLength():g=this.width;this.cwidth=(this.width-f.prepareDistance)/(g-1);this.csize=0;if(d&&e)for(var b=
0,o=d.length;b<o;b++)d[b]&&e[b]&&(h=c.minmax1d(d[b]),g=Math.abs(h[1]-e[b])/e[b],h=Math.abs(h[0]-e[b])/e[b],a=Math.max(a,g*(1+f.rateNumOffset),h*(1+f.rateNumOffset)));if(0===a)a=f.rateNum;else if(a<f.rateNum)a=f.rateNum;this.ymin=1-a;this.ymax=1+a;this.yAxisRange=this.ymax-this.ymin;this.yAxisScale=this.height/this.yAxisRange},drawMain:function(){this.options.timetrendFilled?this.fillPlot():this.strokePlot()},fillPlot:function(){var a=this.ctx,g=this.options,h=this.baseValue,e=this.data,d=this.xStart,
f=this.yStart,b=f+this.height/2,o=f+this.height,p=this.yAxisScale,k=this.cwidth,l=this.timeKey,i,r,t,n,q;if(e&&h)for(var s=0,v=e.length;s<v;s++)if(e[s]&&h[s])if(t=[],0===s){a.save();a.beginPath();a.globalAlpha=g.timetrendFillAlpha;a.strokeStyle=g.timetrend[s];a.lineWidth=1;for(var w=0,m=e[s].length;w<m;w++){var x=w*k+d;i=Math.round((e[s][w]-h[s])/h[s]*p);w?a.lineTo(g.prepareDistance+x,b-i):a.moveTo(g.prepareDistance+x,b-i)}a.stroke();if(1==g.timetrendFilledColors.length)a.fillStyle=g.timetrendFilledColors[0];
else if(2==g.timetrendFilledColors.length)w=a.createLinearGradient(g.prepareDistance,f,g.prepareDistance,o),w.addColorStop(0,g.timetrendFilledColors[0]),w.addColorStop(1,g.timetrendFilledColors[1]),a.fillStyle=w;a.lineTo(g.prepareDistance+x,o);a.lineTo(d+g.prepareDistance,o);a.lineTo(g.prepareDistance+d,o);a.closePath();a.fill();a.restore()}else{n=l[s-1];q=e[s][0];for(w=0;w<m;w++)n&&n[w].overlapsIndex?(i=w*k+d,q=n[w].overlapsIndex,r=Math.round((e[s][q]-h[s])/h[s]*p),c.drawline(a,g.prepareDistance+
t[0],t[1],g.prepareDistance+i,b-r,g.timetrend[s],g.backgroundGrid.lineHeight),t=[i,b-r],q=e[s][q]):(i=w*k+d,r=Math.round((q-h[s])/h[s]*p),c.drawline(a,g.prepareDistance+t[0],t[1],g.prepareDistance+i,b-r,g.timetrend[s],g.backgroundGrid.lineHeight),t=[i,b-r])}},strokePlot:function(){var a=this.ctx,g=this.options,h=this.baseValue,e=this.data,d=this.xStart,f=this.yStart+this.height/2,b=this.yAxisScale,o=this.cwidth,p=this.csize,k=this.timeKey,l,i,r,t,n;if(e&&h)for(var q=0,s=e.length;q<s;q++)if(e[q]&&
h[q])if(r=[],0===q)for(var v=0,w=e[q].length;v<w;v++)l=v*o+d+p/2,i=Math.round((e[q][v]-h[q])/h[q]*b),c.drawline(a,g.prepareDistance+r[0],r[1],g.prepareDistance+l,f-i,g.timetrend[q],g.backgroundGrid.lineHeight),r=[l,f-i];else if(k[q-1]){t=k[q-1];n=e[q][0];for(v=0;v<w;v++)t&&void 0!=t[v].overlapsIndex?(l=v*o+d+p/2,n=t[v].overlapsIndex,i=Math.round((e[q][n]-h[q])/h[q]*b),c.drawline(a,g.prepareDistance+r[0],r[1],g.prepareDistance+l,f-i,g.timetrend[q],g.backgroundGrid.lineHeight),r=[l,f-i],n=e[q][n]):
(l=v*o+d+p/2,i=Math.round((n-h[q])/h[q]*b),c.drawline(a,g.prepareDistance+r[0],r[1],g.prepareDistance+l,f-i,g.timetrend[q],g.backgroundGrid.lineHeight),r=[l,f-i])}},yAxis:function(){var a=this.ctx,g=this.xStart,h=g+this.width,e=this.height,d=this.yStart+e/2,f=this.yAxisScale,b,o=this.ymin,p=this.ymax,k=this.options;b=this.yLabels;var l=[],i=[],r=k.fixedNum;if((!b||!b.length)&&this.baseValue&&this.baseValue.length){b=this.baseValue[0];l=c.ygrid(b,b*p,Math.floor(e/2/k.backgroundGrid.height));i=c.ygrid(o*
b,b,Math.floor(e/2/k.backgroundGrid.height));c.drawline(a,g,d,h,d,k.baseValueStyle.color,k.backgroundGrid.lineHeight);c.drawText(a,(0).toFixed(r)+"%",h,d,{align:"left",textBaseline:"middle",padding:5,color:k.label,background:k.background,font:k.font});this.drawbase&&c.drawText(a,b.toFixed(r),g,d,{align:"right",padding:-5,textBaseline:"middle",color:k.label,background:k.background,font:k.font});for(var t=1,n=l.length;t<n;t++)e=l[t],o=(100*((e-b)/b)).toFixed(r)+"%",p=d-(l[t]-b)/b*f,c.drawText(a,o,h,
p,{align:"left",textBaseline:"middle",padding:5,color:k.yUpLabel.color,background:k.yUpLabel.background,font:k.font}),this.drawbase&&c.drawText(a,e.toFixed(r),g,p,{align:"right",padding:-5,textBaseline:"middle",color:k.yUpLabel.color,background:k.yUpLabel.background,font:k.font}),t!=n-1&&("dashed"==k.backgroundGrid.type?c.drawDashes(a,g,p,h,p,k.backgroundGrid.color,k.backgroundGrid.lineHeight):c.drawline(a,g,p,h,p,k.backgroundGrid.color,k.backgroundGrid.lineHeight));t=0;for(n=i.length;t<n-1;t++)e=
i[t],o=(100*((b-e)/b)).toFixed(r)+"%",p=d+(b-i[t])/b*f,0==t?(c.drawText(a,o,h,p,{align:"left",textBaseline:"bottom",padding:5,color:k.yDownLabel.color,background:k.yDownLabel.background,font:k.font}),this.drawbase&&c.drawText(a,e.toFixed(r),g,p,{align:"right",padding:-5,textBaseline:"bottom",color:k.yDownLabel.color,background:k.yDownLabel.background,font:k.font})):(c.drawText(a,o,h,p,{align:"left",textBaseline:"middle",padding:5,color:k.yDownLabel.color,background:k.yDownLabel.background,font:k.font}),
this.drawbase&&c.drawText(a,e.toFixed(r),g,p,{align:"right",padding:-5,textBaseline:"middle",color:k.yDownLabel.color,background:k.yDownLabel.background,font:k.font}),"dashed"==k.backgroundGrid.type?c.drawDashes(a,g,p,h,p,k.backgroundGrid.color,k.backgroundGrid.lineHeight):c.drawline(a,g,p,h,p,k.backgroundGrid.color,k.backgroundGrid.lineHeight))}},xAxis:function(){var a=this.ctx,g=this.xStart,h=g+this.width,e=this.yStart,d=e+this.height,f=this.xLabels,b=this.options,o=b.prepareDistance,p=this.cwidth,
k=this.csize,l,i=0,r=0;if(f&&f.length)for(var t=0,n=f.length;t<n;t++){for(var q=f[t].length,s=t?b.xLabelsInterval-1:0;s<q;s+=b.xLabelsInterval)0==s&&0==t?l=g+o+s*p+k/2:l=i+b.xLabelsInterval*p,l-r>a.measureText(f[t][s]).width&&(c.drawText(a,f[t][s],l,d,{align:"center",textBaseline:"top",color:b.xAxisLabel.color,background:b.xAxisLabel.background,font:b.font}),r=l),i=l,l<=g||l>=h||("dashed"==b.backgroundGrid.type?c.drawDashes(a,l,d,l,e,b.backgroundGrid.color,b.backgroundGrid.lineHeight):"solid"==b.backgroundGrid.type&&
c.drawline(a,l,d,l,e,b.backgroundGrid.color,b.backgroundGrid.lineHeight));s-b.xLabelsInterval!=q-1&&(l=i+Math.round(Math.abs(q-1-(s-b.xLabelsInterval))*p),l-r>a.measureText(f[t][q-1]).width&&(c.drawText(a,f[t][q-1],l,d,{align:"center",textBaseline:"top",color:b.xAxisLabel.color,background:b.xAxisLabel.background,font:b.font}),r=l),i=l,l<=g||l>=h||("dashed"==b.backgroundGrid.type?c.drawDashes(a,l,d,l,e,b.backgroundGrid.color,b.backgroundGrid.lineHeight):"solid"==b.backgroundGrid.type&&c.drawline(a,
l,d,l,e,b.backgroundGrid.color,b.backgroundGrid.lineHeight)))}},render:function(){var a=this.options,g=this.offsets,h=this.xStart,e=this.yStart,d=this.ctx,f=this.plot,b=this.margins,o="";c.clearCanvas(d,h-g.l-this.margins.l,e-g.t-b.t+1,this.width+g.l+g.r+b.l+b.r+1,this.height+g.t+g.b+b.t+b.b-1,a.background);d.strokeStyle=a.stroke;c.drawRect(d,h,e,this.width,this.height,!0);if(a.isDrawHead)if(a.newTxt)this.renderTxt();else{if(this.mainLabels){g=0;for(b=this.mainLabels.length;g<b;g++)c.drawText(d,this.mainLabels[g],
h+d.measureText(o).width,e-1,{align:"start",textBaseline:"bottom",color:a.timetrend[g],background:a.background,font:a.font}),o+=this.mainLabels[g]+" "}c.drawText(d,this.txt,h+d.measureText(o).width,e-1,{align:"start",textBaseline:"bottom",color:a.label,background:a.background,font:a.font});o+=this.txt+" ";f.mainLabels=o}this.coreRange();this.xAxis();this.yAxis();this.drawMain()},drawArrow:function(a,c,h,e,d,f,b){a.lineWidth=2;a.fillStyle=+f;a.beginPath();a.moveTo(c+e/2,h);a.lineTo(c+e,h-d/2);a.lineTo(c+
3*e/4,h-d/2);a.lineTo(c+3*e/4,h-d);a.lineTo(c+e/4,h-d);a.lineTo(c+e/4,h-d/2);a.lineTo(c,h-d/2);a.lineTo(c+e/2,h);a.closePath();a.fill();a.save();f.up&&(a.setTransform(1,0,0,1,0,0),a.translate(c+e/2,h-d/2),a.rotate(180*Math.PI/180),a.drawImage(b,c,h-d,e,d,-e/2,-d/2,e,d),a.restore())},renderTxt:function(){var a=this.options,g=this.ctx,h=this.xStart,e=this.yStart,d=this.offsets,f=this.plot,b=f.canvas,o=this.data[0],p=a.fixedNum,k=this.baseValue,l,i=0,r=this.drawArrow,o=o&&Number(o.slice(-1)).toFixed(p);
if("undefined"!=typeof o){l=(o-k).toFixed(p);k=(100*l/k).toFixed(p)+"%";p=(f.data.amount.slice(-1)/Math.pow(10,8)).toFixed(p)+"\u4ebf";f=0<=l?{value:"#E60000",up:!0}:{value:"#1FA42C",up:!1};f.toString=function(){return this.value};c.clearCanvas(g,h+1,e-d.t+1,this.width-2,d.t-2,a.background);txts=[{value:o,style:{color:""+f,font:"20px Arial bold"}},{value:l,style:{color:""+f}},{value:k,style:{color:""+f}},{value:p,style:{color:"#8f2211"}}];for(var t in txts)d=txts[t],o=d.style.font||"10px Arial bold",
c.drawText(g,d.value,h+i,e-1,{align:"start",textBaseline:"bottom",color:d.style.color,font:o,background:a.background,font:a.font}),i=g.measureText(d.value).width+i+15,0==Number(t)&&(r(g,h+i-7.5,e-4,20,20,f,b),i+=20)}},destroy:function(){},setMainLabels:function(a){this.mainLabels=a},getMainLabels:function(){return this.mainLabels},setMainCode:function(a){this.mainCode=a},getMainCode:function(){return this.mainCode},setTimeKey:function(a,c){this.getTimeKey()[c]=a},getTimeKey:function(){return this.timeKey},
setData:function(a,c){this.getData()[c]=a},getData:function(){return this.data},setBaseValue:function(a){this.baseValue=a;this.drawbase=!0},getBaseValue:function(){return this.baseValue},setXLabels:function(a){this.xLabels=a},getXLabels:function(){return this.xLabels},setYLabels:function(a){this.yLabels=a},getYLabels:function(){return this.yLabels},setOptions:function(a){this.options=m.mixin(this.options,a)},getOptions:function(){return this.options},_getLabelsLength:function(){for(var a=0,c=0;c<
this.xLabels.length;c++)a+=this.xLabels[c].length;return a},clear:function(){this.data=[];this.timeKey=[]}})})},"dojox/customfig/Element":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(u){return u("dojox.customfig.Element",null,{constructor:function(m){this.plot=m;this.options={}}})})},"dojox/store/SharingPlansWSStore":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/json,dojo/Deferred,dojo/store/util/QueryResults,dojo/store/Observable,dojo/_base/array,dojo/io-query,dojo/topic,dojox/store/WebSocket".split(","),
function(u,m,n,c,a,g,h,e,d,f){return u("dojox.store.SharingPlansWSStore",f,{convert:function(b){var f=b.result,a,k,c={},d;if(0!=b.length){if(b.req_seq)d=b.req_seq;if(f&&2==f.head.length&&"obj"==f.head[0]&&"data"==f.head[1])b=f.datas,b instanceof Array&&(h.forEach(b,function(b){a=b[0];k=b[1];c[a]=k}),c[this.idProperty]=d);else if(f&&f.head&&f.datas)return f[this.idProperty]=d,f;return c}}})})},"dojox/customfig/datas/SharingPlansData":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred",
"dojo/aspect","dojo/_base/lang"],function(u,m,n,c,a){function g(a,c){var d=a.time,f;if(d&&c.time)for(var b=0,g=c.time.length;b<g;b++)if(f=d[d.length-1],f===c.time[b])for(var p in a)f=a[p],c[p]&&(f[f.length-1]=c[p][b]);else if(f<c.time[b])for(p in a)f=a[p],c[p]&&f.push(c[p][b]);return a}return m("dojox.customfig.datas.SharingPlansData",null,{constructor:function(a,c,d){this.store=a;this.kwArgs=c;this.value=d?"function"==typeof d?d:"object"==typeof d?function(f,b){for(var a={},c,k,l={},i=0,e=f.length;i<
e;i++)a[f[i]]=i;i=0;for(e=b.length;i<e;i++){k=b[i];for(var g in d)c=d[g],l[g]||(l[g]=[]),"function"==typeof c?l[g].push(c(l,k,a,g,this.data)):"string"==typeof c&&(void 0!==a[c]?l[g].push(k[a[c]]):delete l[g])}return l}:function(f){return f[d]}:function(f){return f.value};this.data={};this._initialRendering=!1;this.fetch()},destroy:function(){this.observeHandle&&this.observeHandle.remove();this.data={}},setCallback:function(a){this.callback=a},fetch:function(){var h=this;if(this.observeHandle)this.observeHandle.remove(),
this.data={};this.store.query(this.kwArgs.query,this.kwArgs);this.observeHandle=c.after(this.store,"put",a.hitch(this,function(a,c){var f=c[0],b,o;if(f.head&&f.datas)o=h.value(f.head,f.datas),(b=o.obj)?b instanceof String?h.data[b]?(b=h.data[b],g(b,o)):h.data[b]=o:h.data[b[0]]?(b=h.data[b[0]],g(b,o)):h.data[b[0]]=o:h.data=o;else for(var p in f)b=f[p],b.head&&b.datas&&(o=h.value(b.head,b.datas),h.data[p]?(b=h.data[p],g(b,o)):h.data[p]=o);h._pushDataChanges()}))},_pushDataChanges:function(){this.callback&&
this.callback(this.data)}})})},"dojox/customfig/widget/MinSharingPlans":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-geometry,dojo/dom-style,dijit/_WidgetBase,dijit/_TemplatedMixin,dojox/customfig/Plot,dojox/customfig/mains/SharingPlans,dojox/store/SharingPlansWSStore,dojox/customfig/datas/SharingPlansData,../utils,dojox/customfig/indicators/Indicators".split(","),function(u,m,n,c,a,g,h,e,d,f,b,o){var p=m.getObject("dojox.customfig.indicators");return u("dojox.customfig.widget.MinSharingPlans",
[g,h],{templateString:'<div><div data-dojo-attach-point="containerNode" style="width:100%; height:100%;position:relative"></div></div>',codes:[],did:null,baseDid:null,plot:null,storeName:null,storeTradeTime:null,dataHandleName:null,dataHandleTradeTime:null,queryObj:{time:"time",price:"price",volume:"volume",amount:"amount",tickcount:"tickcount",buyprice:"buyprice",buyvolume:"buyvolume",sellprice:"sellprice",sellvolume:"sellvolume"},indicator2Field:{ma:"price",vol:"volume",macd:"price",edx:"edx"},
constructor:function(b){this.kwArgs=b||{};this.storeDatas=[];this.dataHandleDatas=[]},startup:function(){this.inherited(arguments);if(0==parseFloat(a.get(this.domNode,"height"))&&this.domNode.parentNode){var b=c.getMarginBox(this.domNode.parentNode);delete b.t;delete b.l;c.setMarginBox(this.domNode,b)}var b=this.kwArgs,l=b.indicators||[],i=b.mainIndicators||[],g=this.plot=new e(b.plot,this.containerNode),h=new d(this.plot,b.sharingPlans||{});b.theme&&g.setTheme(b.theme);g.addMain(h);n.forEach(l,function(b){g.addIndicator(new p[b.type](g,
b.params))});n.forEach(i,function(b){g.addMainIndicator(new p[b.type](g,b.params))});this.codes=b.codes;this.storeName=new f;this.storeTradeTime=new f;this.render()},getData:function(){this.unReg();this.reg()},reg:function(){var a=this.storeName,c=this.storeTradeTime,d=this.storeDatas,e=this.dataHandleName,g=this.dataHandleTradeTime,h=this.dataHandleDatas,q=this.plot,s=q.main,p=q.indicators,w=this;mainIndicators=q.mainIndicators;queryObj=this.queryObj;indicator2Field=this.indicator2Field;codes=n.map(this.codes,
function(b){return b.name});codeTypes=n.map(this.codes,function(b){return b.type});s.setMainCode(codes);var m={service:"objinfo",type:"getinfo",where:"obj="+codes.join(","),field:"name,lastclose,lastexecprice",response_times:"1",response_mode:0};e&&e.destroy();e=this.dataHandleName=new b(a,{query:m},{name:"name",lastclose:"lastclose",lastexecprice:"lastexecprice"});e.setCallback(function(b){var f=[],a=[];b.name&&n.forEach(b.name,function(b){f.push(b)});s.setMainLabels(f);n.forEach(codes,function(f,
c){var d=b[codeTypes[c]];"undefined"!=typeof d&&"undefined"!=typeof d[c]?a.push(+d[c]):a.push(0)});s.setBaseValue(a);q.setData(b)});a={service:"objinfo",type:"base",where:"obj="+codes.join(","),field:"open_close_num,open_close_time",response_times:"1",response_mode:0};g&&g.destroy();var g=this.dataHandleTradeTime=new b(c,{query:a},{open_close_num:"open_close_num",open_close_time:"open_close_time"}),x=[];g.setCallback(function(b){if(b.open_close_num)for(var f=0,a=b.open_close_num.length;f<a;f++)if(x.push(o.organizeXLabels(b.open_close_num[f],
b.open_close_time[f])),f)s.setTimeKey(o.checkSameValueInMainarr(x[0],x[f]),f-1);else{s.setXLabels(x[0]);for(var c in p)p[c].setXLabels(x[0]);for(c in mainIndicators)mainIndicators[c].setXLabels(x[0])}q.setData(b)});c=0;for(g=codes.length;c<g;c++){a={service:"quote",type:"min",where:"obj="+codes[c],count:0,response_times:"-1",response_mode:0};d[c]?e=d[c]:(e=new f,d.push(e));a=new b(e,{query:a},queryObj);h.push(a);var z=setTimeout(function(){q.render()},1E3);a.setCallback(function(b,f){return function(a){a[b]&&
(z&&clearTimeout(z),s.setData(a[b].price,f),0===f&&(w.setData2indicator(p,indicator2Field,a[b],f),w.setData2indicator(mainIndicators,indicator2Field,a[b],f)),q.setData(a[b]),q.render())}}(codes[c],c))}},unReg:function(){var b=this.dataHandleDatas||[];n.forEach(this.storeDatas,function(b){b.cancel(b.req_seq)});n.forEach(b,function(b){b.destroy()});b=this.dataHandleDatas=[];this.plot.clear()},render:function(){var b=this.plot;this.getData();b.render()},resize:function(b){b&&(c.setMarginBox(this.domNode,
{w:b.w,h:b.h}),c.setMarginBox(this.containerNode,{w:b.w,h:b.h}),b=c.getMarginBox(this.containerNode),delete b.l,delete b.t,this.plot.resize(b))},changeDid:function(b){this.did=b},changeBaseDid:function(b){this.baseDid=b},changeQueryObj:function(b){this.queryObj=b},changeCodes:function(b){if("[object Array]"===Object.prototype.toString.call(b))this.codes=b},addCode:function(b){var f=this.getCodes();-1==f.join(",").indexOf(b.name)&&1<=f.length&&f.push(b)},delCode:function(){var b=this.getCodes();if(2<=
b.length)this.codes=b.slice(0,b.length-1)},delAllCode:function(){var b=this.getCodes();if(1<=b.length)this.codes=b.slice(0,1)},addIndicator:function(b){var f=b.type,a=this.plot;!a.indicators[f.toLowerCase()]&&p[f]&&a.addIndicator(new p[f](a,b.params))},delIndicator:function(b){var f=this.plot,a=f.indicators,b=b.toLowerCase();a[b]&&f.delIndicator(b)},addMainIndicator:function(b){var f=b.type,a=this.plot;!a.mainIndicators[f.toLowerCase()]&&p[f]&&a.addMainIndicator(new p[f](a,b.params))},delMainIndicator:function(b){var f=
this.plot,a=f.mainIndicators,b=b.toLowerCase();a[b]&&f.delMainIndicator(b)},setTheme:function(b){this.plot.setTheme(b)},getCodes:function(){return this.codes},setData2indicator:function(b,f,a,c){var d,e,g,h;for(h in b)if(g=b[h],d=f[g.type])"[object String]"===Object.prototype.toString.call(d)&&a[d]?g.setData(a[d],c):"object Array"===Object.prototype.toString.call(d)&&(e=[],n.forEach(d,function(b){a[b]&&e.push(a[b])}),g.setData(e,c))}})})},"dojox/customfig/indicators/Indicators":function(){define(["./Vol",
"./Macd","./Ma","./Kdj","./Edx"],function(){})},"dojox/customfig/indicators/Vol":function(){define(["dojo/_base/declare","./Default","../utils","dojo/_base/lang"],function(u,m,n){return u("dojox.customfig.indicators.Vol",m,{type:"vol",txt:"\u6210\u4ea4\u91cf",fn:function(c){var a=[],g,h=!0;3==c.length&&(h=!1);h?g=c:g=c[0];for(var e=0,d=g.length;e<d;e++)0===e?a.push(1*g[e]):h?a.push(1*g[e]-1*g[e-1]):a.push(1*g[e]);if(!h)a.open=c[1],a.close=c[2];return a},defaultOptions:{precision:{num:2,txt:"x100"}},
constructor:function(){},coreRange:function(){var c,a=this.options,g=a.topSpacing;this.xLabels&&this.xLabels.length?c=this.getLabelsLength():c=this.width;this.plot.csizeRate?(this.cwidth=(this.width-a.prepareDistance)/c,this.csize=Math.round(this.cwidth/this.plot.csizeRate)):(this.cwidth=(this.width-a.prepareDistance)/(c-1),this.csize=0);this.data&&this.data.length?(/kline/.test(this.plot.main.type)?(this.start=this.start?this.start:0,this.end=this.end?this.end:this.data.length):(this.start=0,this.end=
this.data.length),c=n.minmax1d(this.data.slice(this.start,this.end))[1]):c=this.height-g;this.ymin=0;this.ymax=0==c?this.height-g:1*c;this.yAxisRange=this.ymax-this.ymin;this.yAxisScale=(this.height-g)/this.yAxisRange},drawMain:function(){this.linePlot()},linePlot:function(){var c=this.ctx,a=this.plot,g=this.options,h=this.ymin,e=this.data,d=this.yStart+this.height,f=g.prepareDistance,b=this.yAxisScale,o=this.cwidth,p=this.csize,k,l,i,r,t;if(e)for(var m=0,q=this.end;m+this.start<q;m++)l=Math.round((e[m+
this.start]-h)*b),e.open&&e.close&&/kline/.test(a.main.type)?(e.open[m+this.start]<e.close[m+this.start]?(i=g.volumnStyle.upColor,t=!0,c.strokeStyle=i):(i=g.volumnStyle.downColor,t=!1,c.fillStyle=i),r=l,1<this.csize?(k=f+m*o+this.xStart,n.drawRect(c,k,d-l,p,r,t)):(k=f+m*o+this.xStart+this.csize/2,n.drawline(c,k,d,k,d-l,i,1))):(k=f+m*o+this.xStart+this.csize/2,i=g.volumnStyle.color,n.drawline(c,k,d,k,d-l,i,1))},yAxis:function(){var c=this.ctx,a=this.options,g=this.xStart,h=g+this.width,e=this.yStart,
d=this.height,f=e+d,b=this.yAxisScale,o=this.ymin,p=this.yLabels,k,l=a.fixedNum;if(!p||!p.length)for(var d=n.ygrid(o,this.ymax,Math.floor((d-a.topSpacing)/a.backgroundGrid.height)),i=0,r=d.length;i<r;i++)p=d[i]/Math.pow(10,a.precision.num),k=f-(d[i]-o)*b,i?n.drawText(c,p.toFixed(l),g,k,{align:"right",textBaseline:"middle",padding:-5,color:a.yAxisLabel.color,background:a.yAxisLabel.background,font:a.font}):n.drawText(c,a.precision.txt,g,k,{align:"right",textBaseline:"bottom",padding:-5,color:a.yAxisLabel.color,
background:a.yAxisLabel.background,font:a.font}),k===e||k===f||("dashed"==a.backgroundGrid.type?n.drawDashes(c,g,k,h,k,a.backgroundGrid.color,1):n.drawline(c,g,k,h,k,a.backgroundGrid.color))},xAxis:function(){var c=this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=h+this.height,d=this.options,f=d.prepareDistance,b=!0,o=this.plot,p=this.xLabels,k=this.cwidth,l=d.topSpacing,i,r=0,t=0;/kline/.test(o.main.type)&&(b=!1);o.main&&(d.xLabelsInterval=o.main.options.xLabelsInterval);if(p&&p.length)for(var o=
0,m=p.length;o<m;o++){for(var q=p[o].length,s=o?d.xLabelsInterval-1:0;s<q;s+=d.xLabelsInterval)0==s&&0==o?i=a+f+s*k+this.csize/2:i=r+d.xLabelsInterval*k,i-t>c.measureText(p[o][s]).width&&(n.drawText(c,p[o][s],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!b||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color));
s-d.xLabelsInterval!=q-1&&(i=r+Math.round(Math.abs(q-1-(s-d.xLabelsInterval))*k),i-t>c.measureText(p[o][q-1]).width&&(n.drawText(c,p[o][q-1],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!b||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color)))}},render:function(){var c=this.options,a=this.ctx,g=this.xStart,
h=this.yStart;this.inherited(arguments);n.drawText(a,this.mainLabels+" "+this.txt,g,h+c.topSpacing-1,{align:"start",textBaseline:"bottom",color:c.label,background:c.background,font:c.font})}})})},"dojox/customfig/indicators/Default":function(){define(["dojo/_base/declare","../utils","../Element","dojo/_base/lang","dojo/_base/connect"],function(u,m,n,c,a){return u("dojox.customfig.indicators.Default",[n],{type:"default",txt:"",fn:function(a){return a},com_def_Opt:{topSpacing:0,mainIndicatorType:0,
closed:!1,closedStyle:{w:7,h:7,color:"red"}},constructor:function(g,h){this._options=c.mixin({},this.defaultOptions,this.com_def_Opt,h.options);this.args=h.args?h.args:this.args||[];this.mainLabels=h.mainLabels?h.mainLabels:"";this.xLabels=h.xLabels?h.xLabels:[];this.yLabels=h.yLabels?h.yLabels:[];this.fn=h.fn?h.fn:this.fn;h.data?this.setData(h.data):this.data=[];h.txt&&(this.txt=h.txt);this.invokeHandles=[];this.invokeHandles.push(a.connect(g.canvas,"click",this,this._onClick))},setGeometry:function(a){this.ctx=
a.ctx;this.offsets=a.offsets;this.height=a.height;this.width=a.width;this.yStart=a.yStart;this.xStart=a.xStart;this.margins=a.margins;this.options=c.mixin({},a.theme.com_de_opt,a.theme[this.type],this._options)},coreRange:function(){},drawMain:function(){},yAxis:function(){},xAxis:function(){},render:function(){var a=this.options,c=this.ctx,e=this.xStart,d=this.yStart,f=this.offsets,b=this.plot,o=this.margins,p=a.mainIndicatorType,k;if(!b.main||!p){p=e-f.l-o.l;k=this.width+f.l+f.r+o.l+o.r;b.main||
!m.isEmptyObject(b.mainIndicators)?(b=d,o=this.height+f.b):(b=d-f.t-o.t,o=this.height+f.t+o.t+f.b);m.clearCanvas(c,p,b,k,o,a.background);this.ctx.fillStyle=a.background;this.ctx.strokeStyle=a.stroke;m.drawRect(c,e,d,this.width,this.height,!0);if(a.closed)a.closeXPos={x1:e+this.width+f.r-a.closedStyle.w,y1:d+1,x2:e+this.width+f.r-1,y2:d+a.closedStyle.h},m.drawline(c,a.closeXPos.x1,a.closeXPos.y1,a.closeXPos.x2,a.closeXPos.y2,a.closedStyle.color),m.drawline(c,a.closeXPos.x1,a.closeXPos.y2,a.closeXPos.x2,
a.closeXPos.y1,a.closedStyle.color);this.coreRange();this.xAxis();this.yAxis();this.drawMain()}},_onClick:function(a){var c,e,d,f,b,o;o=this.options.closeXPos;var p=this.plot;c=a.offsetX;e=a.offsetY;if(o)d=o.x1,f=o.x2,b=o.y1,o=o.y2,c>=d&&c<=f&&e>=b&&e<=o&&(p.delIndicator(this.type),a.stopPropagation())},destroy:function(){for(var c=0,h=this.invokeHandles.length;c<h;c++)a.disconnect(this.invokeHandles[c]);this.invokeHandles=[]},setMainLabels:function(a){this.mainLabels=a},getMainLabels:function(){return this.mainLabels},
setData:function(a){this.data=this.fn(a)},getData:function(){return this.data},setXLabels:function(a){this.xLabels=a},getXLabels:function(){return this.xLabels},setYLabels:function(a){this.yLabels=a},getYLabels:function(){return this.yLabels},setStart:function(a){this.start=a},getStart:function(){return this.start},setEnd:function(a){this.end=a},getEnd:function(){return this.end},setOptions:function(a){this.options=c.mixin(this.options,a)},getOptions:function(){return this.options},getLabelsLength:function(){for(var a=
0,c=0;c<this.xLabels.length;c++)a+=this.xLabels[c].length;return a},clear:function(){this.data=[];this.olddatalength=this.end=this.start=null}})})},"dojox/customfig/indicators/Macd":function(){define(["dojo/_base/declare","./Default","../utils","dojo/_base/lang"],function(u,m,n){return u("dojox.customfig.indicators.Macd",[m],{type:"macd",txt:"MACD",fn:function(c,a){var g=a[1],h=a[2],e=[];if(c&&c.length){for(var d=function(b,a){var f=[],c=2/(a+1);f[0]=b[0];for(var d=1;d<b.length;d++)f[d]=void 0===
b[d]||null===b[d]?f[d-1]:f[d-1]?c*b[d]+(a-1)/(a+1)*f[d-1]:b[d];return f},f=d(c,a[0]),g=d(c,g),b=0;b<f.length;b++)f[b]=g[b]-f[b];g=d(f,h);for(b=0;b<f.length;b++)e[b]=[f[b],g[b],2*(f[b]-g[b])];return e}},ymin:0,ymax:0,yAxisRange:0,yAxisScale:0,args:[12,26,9],defaultOptions:{fixedNum:2,precision:{num:2,txt:"x100"}},constructor:function(){},coreRange:function(){var c,a;c=this.options;var g=c.topSpacing,h=this.plot;this.xLabels&&this.xLabels.length?a=this.getLabelsLength():a=this.width;h.csizeRate?(this.cwidth=
(this.width-c.prepareDistance)/a,this.csize=Math.round(this.cwidth/h.csizeRate)):(this.cwidth=(this.width-c.prepareDistance)/(a-1),this.csize=0);this.data&&this.data.length?(this.plot.main&&/kline/.test(this.plot.main.type)?(this.start=this.start?this.start:0,this.end=this.end?this.end:this.data.length):(this.start=0,this.end=this.data.length),c=n.minmax2d(this.data.slice(this.start,this.end)),a=c[0],c=c[1]):(c=1,a=0);this.ymax=Math.max(Math.abs(a),Math.abs(c));this.ymin=-1*this.ymax;this.yAxisScale=
(this.yAxisRange=this.ymax-this.ymin)?(this.height-g)/this.yAxisRange:(this.height-g)/2},drawMain:function(){this.linePlot()},linePlot:function(){var c=this.ctx,a=this.options,g=this.data,h=this.xStart,e=a.topSpacing,d=a.prepareDistance,f=this.yAxisScale,e=this.yStart+e+(this.height-e)/2,b=this.cwidth,o=this.csize,a=a.macdStyle,p={diff:0,dea:1,macd:2},k,l,i,r,t;if(g&&g.length)for(var m in p)if(k=p[m],2==k)for(var q=0,s=this.end;q+this.start<s;q++)i=d+q*b+h+o/2,r=e-g[q+this.start][k]*f,l=0<g[q+this.start][k]?
a[m].upcolor:a[m].downcolor,n.drawline(c,i,e,i,r,l,1);else{t=[];q=0;for(s=this.end;q+this.start<s;q++)i=Math.round(d+q*b+h+o/2),r=e-g[q+this.start][k]*f,l=a[m].color,n.drawline(c,t[0],t[1],i,r,l,1),t=[i,r]}},yAxis:function(){var c=this.ctx,a=this.options,g=this.xStart,h=g+this.width,e=this.yStart,d=this.height,f=a.topSpacing,b=this.yAxisScale,o=e+f+(d-f)/2,p=this.ymin?this.ymin:-1,k=this.yLabels,l=a.fixedNum,i=[],r=[];if(!k||!k.length){i=n.ygrid(0,this.ymax?this.ymax:1,Math.floor((d-f)/2/a.backgroundGrid.height));
r=n.ygrid(p,0,Math.floor((d-f)/2/a.backgroundGrid.height));"dashed"==a.backgroundGrid.type?n.drawDashes(c,g,o,h,o,a.backgroundGrid.color,1):n.drawline(c,g,o,h,o,a.backgroundGrid.color);n.drawText(c,(0).toFixed(l),g,o,{align:"right",padding:-5,textBaseline:"middle",color:a.yAxisLabel.color,background:a.yAxisLabel.background,font:a.font});p=0;for(k=i.length;p<k;p++)d=i[p],f=o-i[p]*b,n.drawText(c,d.toFixed(l),g,f,{align:"right",padding:-5,textBaseline:"middle",color:a.yAxisLabel.color,background:a.yAxisLabel.background,
font:a.font}),f!=e&&("dashed"==a.backgroundGrid.type?n.drawDashes(c,g,f,h,f,a.backgroundGrid.color,1):n.drawline(c,g,f,h,f,a.backgroundGrid.color));p=0;for(k=r.length-1;p<k;p++)d=r[p],f=o-r[p]*b,0==p?n.drawText(c,d.toFixed(l),g,f,{align:"right",padding:-5,textBaseline:"bottom",color:a.yAxisLabel.color,background:a.yAxisLabel.background,font:a.font}):("dashed"==a.backgroundGrid.type?n.drawDashes(c,g,f,h,f,a.backgroundGrid.color,1):n.drawline(c,g,f,h,f,a.backgroundGrid.color),n.drawText(c,d.toFixed(l),
g,f,{align:"right",padding:-5,textBaseline:"middle",color:a.yAxisLabel.color,background:a.yAxisLabel.background,font:a.font}))}},xAxis:function(){var c=this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=h+this.height,d=this.options,f=d.prepareDistance,b=this.xLabels,o=this.plot,p=this.cwidth,k=this.csize,l=d.topSpacing,i,r=0,t=0,m=!0;o.main&&/kline/.test(o.main.type)&&(m=!1);o.main&&(d.xLabelsInterval=o.main.options.xLabelsInterval);if(b&&b.length)for(var o=0,q=b.length;o<q;o++){for(var s=b[o].length,
v=o?d.xLabelsInterval-1:0;v<s;v+=d.xLabelsInterval)0==v&&0==o?i=a+f+v*p+k/2:i=r+d.xLabelsInterval*p,i-t>c.measureText(b[o][v]).width&&(n.drawText(c,b[o][v],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!m||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color));v-d.xLabelsInterval!=s-1&&(i=r+Math.round(Math.abs(s-
1-(v-d.xLabelsInterval))*p),i-t>c.measureText(b[o][s-1]).width&&(n.drawText(c,b[o][s-1],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!m||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color)))}},setData:function(c){this.data=this.fn(c,this.args)},render:function(){this.inherited(arguments);this.renderTxt(this.end-
1)},renderTxt:function(c){var a=this.options,g=this.ctx,h=this.xStart,e=this.yStart,d=this.txt,f=this.args,b=this.data,o=a.fixedNum,p=a.macdStyle,k={diff:0,dea:1},l;if(b&&b.length>c&&0<=c){n.clearCanvas(g,h+1,e+1,this.width-2,a.topSpacing-2,a.background);d=this.mainLabels+" "+d+"("+f[0]+","+f[1]+","+f[2]+")";n.drawText(g,d,h,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:a.label,background:a.background,font:a.font});for(var i in k)l=k[i],f=g.measureText(d).width,l=" "+i+":"+b[c][l].toFixed(o),
l=l.toUpperCase(),d+=l,n.drawText(g,l,h+f,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:p[i].color,background:a.background,font:a.font})}}})})},"dojox/customfig/indicators/Ma":function(){define(["dojo/_base/declare","./Default","../utils","dojo/_base/lang"],function(u,m,n){return u("dojox.customfig.indicators.Ma",[m],{type:"ma",txt:"\u5747\u7ebf",args:[5],fn:function(c,a,g,h){var e=[],d=0,f=0,b=[],o=[];if(h&&h.length)for(f=0;f<h.length;f++){o=[];period=parseInt(h[f]);for(var p=a+1<period?
0:a-period+1,k=c.slice(p,g),l=0;l<k.length;l++)if(l<period-1)0===p&&(o[l]=void 0);else{var b=k.slice(l+1-period,l+1),d=0,i;for(i in b)d+=1*b[i];o[0===p?l-a:l+1-period]=d/period}e.push(o)}else{k=c.slice(a,g);l=0;for(c=k.length;l<c;l++)d+=1*k[l],f++,o.push(d/f);e=[o]}return e},defaultOptions:{fixedNum:2},constructor:function(){},coreRange:function(){var c=this.plot.main,a=this.options,g=a.mainIndicatorType;if(c&&g)this.cwidth=c.cwidth,this.csize=c.csize,this.begin=c.begin,this.candles=c.candles,this.ymin=
c.ymin,this.ymax=c.ymax,this.yAxisRange=c.yAxisRange,this.yAxisScale=c.yAxisScale,this.baseValue=c.baseValue?c.baseValue:[];else{var h,e,d;this.baseValue=[];this.xLabels&&this.xLabels.length?d=this.getLabelsLength():d=this.width;this.plot.csizeRate?(this.cwidth=(this.width-a.prepareDistance)/d,this.csize=Math.round(this.cwidth/this.plot.csizeRate)):(this.cwidth=(this.width-a.prepareDistance)/(d-1),this.csize=0);this.data&&(e=this.d_[0],h=this.d_[1]);this.ymin=e;this.ymax=h;this.yAxisRange=this.ymax-
this.ymin;this.yAxisScale=this.height/this.yAxisRange}},drawMain:function(){var c=this.ctx,a=this.plot,g=this.options,h=this.ymin,e=this.data,d=this.xStart,f=this.yStart+this.height/2,b=this.yStart+this.height,o=this.yAxisScale,p=this.baseValue[0],k=this.cwidth,l=this.csize,i,r=[];a.main&&(b-=a.main.options.bottomSpacing);if(e)for(var t=0,m=e.length;t<m;t++)for(var r=[],q=0,s=e[t].length;q<s;q++)a=d+Math.round(g.prepareDistance+q*k+l/2),p?(i=Math.round((e[t][q]-p)/p*o),n.drawline(c,r[0],r[1],a,f-
i,g.ma[t],1),r=[a,f-i]):(i=Math.round((e[t][q]-h)*o),n.drawline(c,r[0],r[1],a,b-i,g.ma[t],1),r=[a,b-i])},yAxis:function(){var c=this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=this.height,d=h+e,f=this.options,b=this.yAxisScale,o=this.ymin,p=this.yLabels,k,l=f.fixedNum;if(!p||!p.length)for(var e=n.ygrid(o,this.ymax,Math.floor(e/f.backgroundGrid.height)),i=0,r=e.length;i<r;i++)p=e[i],k=d-(e[i]-o)*b,n.drawText(c,p.toFixed(l),a,k,{align:"right",textBaseline:"middle",padding:-5,color:f.yAxisLabel.color,
background:f.yAxisLabel.background,font:f.font}),k===h||k===d||("dashed"==f.backgroundGrid.type?n.drawDashes(c,a,k,g,k,f.backgroundGrid.color,1):n.drawline(c,a,k,g,k,f.backgroundGrid.color))},xAxis:function(){var c=this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=h+this.height,d=this.options,f=d.prepareDistance,b=this.xLabels,o=this.cwidth,p=this.csize,k,l=0,i=0;if(b&&b.length)for(var r=0,t=b.length;r<t;r++){for(var m=b[r].length,q=r?d.xLabelsInterval-1:0;q<m;q+=d.xLabelsInterval)0==q&&0==r?
k=a+f+q*o+p/2:k=l+d.xLabelsInterval*o,k-i>c.measureText(b[r][q]).width&&(n.drawText(c,b[r][q],k,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),i=k),l=k,k<=a||k>=g||("dashed"==d.backgroundGrid.type?n.drawDashes(c,k,e,k,h,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,k,e,k,h,d.backgroundGrid.color));q-d.xLabelsInterval!=m-1&&(k=l+Math.round(Math.abs(m-1-(q-d.xLabelsInterval))*o),k-i>c.measureText(b[r][m-1]).width&&
(n.drawText(c,b[r][m-1],k,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),i=k),l=k,k<=a||k>=g||("dashed"==d.backgroundGrid.type?n.drawDashes(c,k,e,k,h,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,k,e,k,h,d.backgroundGrid.color)))}},render:function(){var c=this.options.mainIndicatorType;this.plot.main&&c?(this.coreRange(),this.drawMain()):this.inherited(arguments);this.renderTxt()},setData:function(c){var a=this.fn,
g=this.args,h=this.start?this.start:0,e=this.end?this.end:c.length;if((this.allDataItem=c)&&c.length)this.data=a(c,h,e,g);this.begin=0;this.candles=this.data.length;this.d_=n.minmax2d(this.data.slice(this.begin,this.candles));this.options.mainIndicatorType&&(this.plot.main.maMaxAndMin=this.d_)},renderTxt:function(c){var a=this.options,g=this.ctx,h=this.xStart,e=this.yStart,d=this.plot,f=d.main,b=this.txt,o=this.args,p=this.data,k=a.fixedNum;c||(c=0);c&&(c-=this.start);if(p&&p.length){0==c&&(c=p[0].length-
1);d=g.measureText(d.mainLabels).width;n.clearCanvas(g,h+d,e-f.offsets.t+1,this.width-d-2,f.offsets.t-2,a.background);b=b+"MA("+o.join(",")+")";n.drawText(g,b,h+d,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:a.label,background:a.background,font:a.font});for(var l in o)offsetMLabel=d+g.measureText(b).width,f=" MA"+l+":"+(p[l][c]?p[l][c].toFixed(k):" "),b+=f,n.drawText(g,f,h+offsetMLabel,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:a.ma[l],background:a.background,font:a.font})}}})})},
"dojox/customfig/indicators/Kdj":function(){define(["dojo/_base/declare","./Default","../utils","dojo/_base/lang"],function(u,m,n){return u("dojox.customfig.indicators.Kdj",[m],{type:"kdj",txt:"KDJ",args:[9,3,3],fn:function(c,a){var g=[];if(c&&c.length){for(var g=a[0],h,e,d,f=[],b=[],o=[],p=c[0],k=c[1],l=c[2],i=0;i<p.length;i++)e=i-g+1,0>e&&(e=0),h=Math.min.apply(null,p.slice(e,i+1)),e=Math.max.apply(null,k.slice(e,i+1)),d=l[i],d=100*((d-h)/(e-h)),e="undefined"==typeof f[i-1]?50:f[i-1],h="undefined"==
typeof b[i-1]?50:b[i-1],e=2/3*e+1/3*d,h=2/3*h+1/3*e,d=3*e-2*h,f[i]=e,b[i]=h,o[i]=[e,h,d];return o}},defaultOptions:{fixedNum:2},constructor:function(){},coreRange:function(){var c=this.options,a=c.topSpacing,g;this.baseValue=[];this.xLabels&&this.xLabels.length?g=this.getLabelsLength():g=this.width;this.plot.csizeRate?(this.cwidth=(this.width-c.prepareDistance)/g,this.csize=Math.round(this.cwidth/this.plot.csizeRate)):(this.cwidth=(this.width-c.prepareDistance)/(g-1),this.csize=0);this.data&&this.data.length?
(this.plot.main&&/kline/.test(this.plot.main.type)?(this.start=this.start?this.start:0,this.end=this.end?this.end:this.data.length):(this.start=0,this.end=this.data.length),g=n.minmax2d(this.data.slice(this.start,this.end)),c=g[0],g=g[1]):(g=1,c=0);this.ymax=g;this.ymin=c;this.yAxisRange=this.ymax-this.ymin;this.yAxisScale=(this.height-a)/this.yAxisRange},drawMain:function(){var c=this.ctx,a=this.options,g=this.ymin,h=this.data,e=this.xStart,d=this.yStart+this.height/2,f=this.yStart+this.height,b=
this.yAxisScale,o=this.baseValue[0],p=this.cwidth,k=this.csize,l={k:0,d:1,j:2},i=this.start,r=this.end,t,m,q,s;if(h)for(var v in l){q=l[v];s=[];for(var w=0;w+i<r;w++)t=e+Math.round(a.prepareDistance+w*p+k/2),m=w+i,o?(m=Math.round((h[m][q]-o)/o*b),n.drawline(c,s[0],s[1],t,d-m,a.kdj[q],1),s=[t,d-m]):(m=Math.round((h[m][q]-g)*b),n.drawline(c,s[0],s[1],t,f-m,a.kdj[q],1),s=[t,f-m])}},yAxis:function(){var c=this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=this.height,d=h+e,f=this.options,b=this.yAxisScale,
o=this.ymin,p=this.yLabels,k,l=f.fixedNum;if(!p||!p.length)for(var e=n.ygrid(o,this.ymax,Math.floor(e/f.backgroundGrid.height)),i=0,r=e.length;i<r;i++)p=e[i],k=d-(e[i]-o)*b,n.drawText(c,p.toFixed(l),a,k,{align:"right",textBaseline:"middle",padding:-5,color:f.yAxisLabel.color,background:f.yAxisLabel.background,font:f.font}),k===h||k===d||("dashed"==f.backgroundGrid.type?n.drawDashes(c,a,k,g,k,f.backgroundGrid.color,1):n.drawline(c,a,k,g,k,f.backgroundGrid.color))},xAxis:function(){var c=this.ctx,a=
this.xStart,g=a+this.width,h=this.yStart,e=h+this.height,d=this.options,f=d.prepareDistance,b=this.xLabels,o=this.plot,p=this.cwidth,k=this.csize,l=d.topSpacing,i,r=0,t=0,m=!0;o.main&&/kline/.test(o.main.type)&&(m=!1);o.main&&(d.xLabelsInterval=o.main.options.xLabelsInterval);if(b&&b.length)for(var o=0,q=b.length;o<q;o++){for(var s=b[o].length,v=o?d.xLabelsInterval-1:0;v<s;v+=d.xLabelsInterval)0==v&&0==o?i=a+f+v*p+k/2:i=r+d.xLabelsInterval*p,i-t>c.measureText(b[o][v]).width&&(n.drawText(c,b[o][v],
i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!m||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color));v-d.xLabelsInterval!=s-1&&(i=r+Math.round(Math.abs(s-1-(v-d.xLabelsInterval))*p),i-t>c.measureText(b[o][s-1]).width&&(n.drawText(c,b[o][s-1],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,
background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!m||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color)))}},render:function(){this.inherited(arguments);this.renderTxt(this.end-1)},setData:function(c){var a=this.fn,g=this.args;if(c&&c.length)this.data=a(c,g)},renderTxt:function(c){var a=this.options,g=this.ctx,h=this.xStart,e=this.yStart,d=this.txt,f=this.args,b=this.data,
o=a.fixedNum,p={K:0,D:1,J:2},k,l;if(b&&b.length>c&&0<=c){n.clearCanvas(g,h+1,e+1,this.width-2,a.topSpacing-2,a.background);d=this.mainLabels+" "+d+"("+f[0]+","+f[1]+","+f[2]+")";n.drawText(g,d,h,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:a.label,background:a.background,font:a.font});for(var i in p)l=p[i],f=g.measureText(d).width,k=" "+i+":"+b[c][l].toFixed(o),d+=k,n.drawText(g,k,h+f,e+a.topSpacing-1,{align:"start",textBaseline:"bottom",color:a.kdj[l],background:a.background,font:a.font})}}})})},
"dojox/customfig/indicators/Edx":function(){define(["dojo/_base/declare","./Default","../utils","dojo/_base/lang"],function(u,m,n){return u("dojox.customfig.indicators.Edx",m,{type:"edx",txt:"edx",fn:function(c){return c},defaultOptions:{precision:{num:2,txt:"x100"},isDrawHeadText:!1},constructor:function(){},coreRange:function(){var c,a,g=this.options,h=g.topSpacing;this.xLabels&&this.xLabels.length?c=this.getLabelsLength():c=this.width;this.plot.csizeRate?(this.cwidth=(this.width-g.prepareDistance)/
c,this.csize=Math.round(this.cwidth/this.plot.csizeRate)):(this.cwidth=(this.width-g.prepareDistance)/(c-1),this.csize=0);this.data&&this.data.length?(/kline/.test(this.plot.main.type)?(this.start=this.start?this.start:0,this.end=this.end?this.end:this.data.length):(this.start=0,this.end=this.data.length),c=n.minmax1d(this.data.slice(this.start,this.end)),a=c[0],c=c[1]):c=this.height-h;this.ymin=a;this.ymax=0==c?this.height-h:1*c;this.yAxisRange=this.ymax-this.ymin;this.yAxisScale=(this.height-h)/
this.yAxisRange},drawMain:function(){this.linePlot()},linePlot:function(){var c=this.ctx,a=this.options,g=this.ymin,h=this.data,e=this.xStart,d=this.yStart+this.height,f=this.yAxisScale,b=this.cwidth,o=this.csize,p,k,l=[];if(h)for(var i=0,r=h.length;i<r;i++)p=e+Math.round(a.prepareDistance+i*b+o/2),k=Math.round((h[i]-g)*f),n.drawline(c,l[0],l[1],p,d-k,a.edx.color,1),l=[p,d-k]},yAxis:function(){var c=this.ctx,a=this.options,g=this.xStart,h=g+this.width,e=this.yStart,d=this.height,f=e+d,b=this.yAxisScale,
o=this.ymin,p=this.yLabels,k,l=a.fixedNum;if(!p||!p.length)for(var d=n.ygrid(o,this.ymax,Math.floor((d-a.topSpacing)/a.backgroundGrid.height)),i=0,r=d.length;i<r;i++)p=d[i],k=f-(d[i]-o)*b,n.drawText(c,p.toFixed(l),g,k,{align:"right",textBaseline:"middle",padding:-5,color:a.edx.yTxtColor,background:a.yAxisLabel.background,font:a.font}),k===e||k===f||("dashed"==a.backgroundGrid.type?n.drawDashes(c,g,k,h,k,a.backgroundGrid.color,1):n.drawline(c,g,k,h,k,a.backgroundGrid.color))},xAxis:function(){var c=
this.ctx,a=this.xStart,g=a+this.width,h=this.yStart,e=h+this.height,d=this.options,f=d.prepareDistance,b=!0,o=this.plot,p=this.xLabels,k=this.cwidth,l=d.topSpacing,i,r=0,t=0;/kline/.test(o.main.type)&&(b=!1);o.main&&(d.xLabelsInterval=o.main.options.xLabelsInterval);if(p&&p.length)for(var o=0,m=p.length;o<m;o++){for(var q=p[o].length,s=o?d.xLabelsInterval-1:0;s<q;s+=d.xLabelsInterval)0==s&&0==o?i=a+f+s*k+this.csize/2:i=r+d.xLabelsInterval*k,i-t>c.measureText(p[o][s]).width&&(n.drawText(c,p[o][s],
i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!b||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color));s-d.xLabelsInterval!=q-1&&(i=r+Math.round(Math.abs(q-1-(s-d.xLabelsInterval))*k),i-t>c.measureText(p[o][q-1]).width&&(n.drawText(c,p[o][q-1],i,e,{align:"center",textBaseline:"top",color:d.xAxisLabel.color,
background:d.xAxisLabel.background,font:d.font}),t=i),r=i,i<=a||i>=g||!b||("dashed"==d.backgroundGrid.type?n.drawDashes(c,i,e,i,h+l,d.backgroundGrid.color,1):"solid"==d.backgroundGrid.type&&n.drawline(c,i,e,i,h+l,d.backgroundGrid.color)))}},render:function(){var c=this.options,a=this.ctx,g=this.xStart,h=this.yStart,e=this.plot.main,d={align:"center",textBaseline:"middle",color:c.edx.txtColor,background:c.edx.txtBgColor,font:c.font},f=d.padding||2,b=a.measureText(this.mainLabels+" "+this.txt).width+
2*f,o=1.4*a.measureText("A").width+2*f;this.inherited(arguments);a.fillStyle=c.edx.txtBgColor;n.drawRect(a,g+f,h+f,b,o,!1);n.drawText(a,this.mainLabels+" "+this.txt,g-f+b/2,h+f+o/2,d);c.isDrawHeadText&&this.rendTxt(e.xStart,e.yStart,e.width,e.offsets,e.options)},rendTxt:function(c,a,g,h,e){var d=this.options,f=this.ctx,b=this.plot.data,o=n.drawArrow,p,k,l,i,r,t,m=0;if("undefined"!=typeof b.price){p=+b.price.slice(-1);k=+b.volume.slice(-1);l=+b.edx.slice(-1);i=+b.etfBuyAmount.slice(-1);r=+b.etfSellAmount.slice(-1);
t=p>+b.price.slice(-2,-1)?{value:"red",up:!0}:{value:"blue",up:!1};b=l>+b.edx.slice(-2,-1)?{value:"red",up:!0}:{value:"blue",up:!1};t.toString=b.toString=function(){return this.value};n.clearCanvas(f,c+1,a-h.t+1,g-2,h.t,e.background);txts=[{value:"\u6700\u65b0\u4ef7: "+p,style:{color:t,textColor:"#14CEF4",font:"20px Arial bold"},isDraw:!0},{value:"\u6210\u4ea4\u91cf: "+k+"\u624b",style:{textColor:"yellow"}},{value:"EDX: "+l,style:{color:b,textColor:"ff9516"},isDraw:!0},{value:"\u7d2f\u8ba1\u7533\u8d4e\u51c0\u91cf/\u989d: "+
i+"\u624b/"+r+"\u4e07\u5143",style:{color:"#8f2211",textColor:"#e45f64"}}];for(var q in txts)if(g=txts[q],h=g.style.font||"10px Arial bold",n.drawText(f,g.value,c+m,a-1,{align:"start",textBaseline:"bottom",color:g.style.textColor,font:h,background:d.background,font:d.font}),m=f.measureText(g.value).width+m+15,h=2*f.measureText("A").width,g.isDraw)f.fillStyle=""+g.style.color,o(f,c+m-7.5,a-4,0.4*h,1*h,g.style.color),m+=20}}})})},"dojox/customfig/widget/DIDKline":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-geometry,dojo/dom-style,dijit/_WidgetBase,dijit/_TemplatedMixin,dojox/customfig/Plot,dojox/customfig/mains/Kline,dojox/store/SharingPlansWSStore,dojox/customfig/datas/KlineData,../utils,dojox/customfig/widget/KlineKline,dojox/store/LocalStorage,dojox/customfig/indicators/Indicators".split(","),
function(u,m,n,c,a,g,h,e,d,f,b,o,p){m.getObject("dojox.customfig.indicators");return u("dojox.customfig.widget.DIDKline",[p],{queryObj:{obj:"obj",time:function(b,a,f,c,d){return o.millisecond2Date(arguments.callee.that.timeStyle,1*o.str2millisecond(a[f[c]]))},timeStamp:function(b,a,f){return o.str2millisecond(a[f.time])},open:"open",high:"high",low:"low",close:"close",volume:"vol"},getData:function(){this.unReg();this.reg()},reg:function(){var a=this.codes,c=this.storeName,d=this.storeDatas,e=this.plot,
g=e.main,h=e.indicators,o=this.dataHandleName,p=this.dataHandleDatas,v=e.mainIndicators,m=this.queryObj,y=this.indicator2Field;this.getTimeScale();var x=this.setData2indicator,z=this.did;m.time.that=this;g.setMainCode(a);var u={service:"objinfo",type:"getinfo",where:"obj="+a.join(","),field:"name",response_times:"1",response_mode:0};o&&o.destroy();o=new b(c,{query:u},{name:"name"});o.setCallback(function(b){var a=[];b.name&&n.forEach(b.name,function(b){a.push(b)});g.setMainLabels(a)});c=0;for(o=a.length;c<
o;c++){u={service:"did",did:z,where:"obj="+a[c],response_times:-1};if(d[c])var B=d[c];else B=new f,d.push(B);u=new b(B,{query:u},m);p.push(u);var A=[],C=setTimeout(function(){e.render()},100);u.setCallback(function(b,a){return function(f){if(f[b]){C&&clearTimeout(C);if(a)g.setData([f[b].open,f[b].high,f[b].low,f[b].close],a),A[a]=f[b].time,g.setTimeKey(A[a],a-1);else{var c=f[b];e.setData(c);g.setTimeStamp(c.timeStamp);g.setXLabels([c.time]);g.setData([c.open,c.high,c.low,c.close],a);A[a]=c.time;x(g,
h,y,f[b],a);x(g,v,y,f[b],a)}e.render()}}}(a[c],c))}}})})},"dojox/customfig/mains/Kline":function(){define("dojo/_base/declare,dojo/_base/lang,../Element,../utils,dojo/_base/array,dojo/dom-style,dojo/dom-construct,dojo/dom-geometry,dojo/cssScale".split(","),function(u,m,n,c,a,g,h,e,d){return u("dojox.customfig.mains.Kline",[n],{type:"kline",txt:"\u5206\u949f\u7ebf",startTime:null,endTime:null,count:0,allKey:[],isPercentLabelShow:!0,percentLabelDom:null,csizeRate:1.6,defaultOptions:{overlapType:0,klineType:1,
fixedNum:2,xLabelsInterval:5,showCounts:10,topSpacing:10,bottomSpacing:10,isHighLowShowed:!0,isDrawName:!0},constructor:function(a,b){this._options=m.mixin({},this.defaultOptions,b.options);this.mainLabels=b.mainLabels?b.mainLabels:[];b.txt&&(this.txt=b.txt);b.startTime&&(this.startTime=b.startTime);b.endTime&&(this.endTime=b.endTime);b.count&&(this.count=b.count);this.yLabels=b.yLabels?b.yLabels:[];this.xLabels=b.xLabels?b.xLabels:[];this.data=b.data?b.data:[];this.timeKey=b.timeKey?b.timeKey:[];
this.plot.csizeRate=this.csizeRate},setGeometry:function(a){this.ctx=a.ctx;this.offsets=a.offsets;this.height=a.height;this.width=a.width;this.yStart=a.yStart;this.xStart=a.xStart;this.margins=a.margins;this.options=m.mixin({},a.theme.com_de_opt,a.theme[this.type],this._options)},coreRange:function(){var f=this.options,b=this.xLabels,d=this.data,e=this.timeKey,k=this,l=-Infinity,i=Infinity,g,h=[],n,q;b&&b.length?g=this._getLabelsLength():g=this.width;this.cwidth=(this.width-f.prepareDistance)/g;this.csize=
this.cwidth/this.plot.csizeRate;d&&d.length?a.forEach(d,function(b,a){if(e&&e[a-1]&&b[3]){if(q=e[a-1],h=c.minmax2d(b,q[0].overlapsIndex,q[q.length-1].overlapsIndex),q[0]&&void 0!=q[0].overlapsIndex)n=b[3][q[0].overlapsIndex]/d[0][3][k.start+q[0].mainIndex],q[0].percent=n,i=Math.min(i,h[0]/n),l=Math.max(l,h[1]/n)}else h=c.minmax2d(b,k.start,k.end),i=Math.min(i,h[0]),l=Math.max(l,h[1]),k.mainMax=+l,k.mainMin=+i}):(l=this.height,i=0);this.maMaxAndMin&&(i=Math.min(i,this.maMaxAndMin[0]),l=Math.max(l,
this.maMaxAndMin[1]));this.ymin=+i;this.ymax=+l;this.yAxisRange=this.ymax-this.ymin;if(0==this.yAxisRange)this.yAxisRange=2*this.ymax;this.yAxisScale=(this.height-f.topSpacing-f.bottomSpacing)/this.yAxisRange},drawMain:function(){this.drawPlot()},drawCandle:function(a,b,d,e,k,l){var i=this.ctx,g=this.options,h=this.ymin,n=this.yStart+this.height-g.bottomSpacing,q=g.prepareDistance,s=this.yAxisScale,v=this.cwidth,m=this.csize,y=this.xStart,x=g.candleStyle,g=n-(a-h)*s,b=n-(b-h)*s,d=n-(d-h)*s,h=n-(e-
h)*s;e>a?(a=g-h,h===g&&(a=1),k=x[k].upStyle.candle.color,i.strokeStyle=k,1<m?(l=q+l*v+y,c.drawRect(i,l,h,m,a,!0),c.drawline(i,l+m/2,b,l+m/2,h,k,1),c.drawline(i,l+m/2,g,l+m/2,d,k,1)):(l=q+l*v+y+m/2,c.drawline(i,l,b,l,d,k,1))):(a=h-g,h===g&&(a=1),k=x[k].downStyle.candle.color,i.fillStyle=k,1<m?(l=q+l*v+y,c.drawRect(i,l,g,m,a,!1),c.drawline(i,l+m/2,b,l+m/2,h,k,1),c.drawline(i,l+m/2,g,l+m/2,d,k,1)):(l=q+l*v+y+m/2,c.drawline(i,l,b,l,d,k,1)))},drawBamboo:function(a,b,d,e,k,l){var i=this.ctx,g=this.options,
h=this.ymin,n=this.yStart+this.height-g.bottomSpacing,q=g.prepareDistance,s=this.yAxisScale,m=this.cwidth,w=this.csize,y=this.xStart,x=g.candleStyle,g=n-(a-h)*s,b=n-(b-h)*s,d=n-(d-h)*s,h=n-(e-h)*s,l=q+l*m+y;e>a?(a=x[k].upStyle.candle.color,c.drawline(i,l+w/2,b,l+w/2,d,a,1),c.drawline(i,l+w/2,h,l+w,h,a,1),c.drawline(i,l,g,l+w/2,g,a,1)):(a=x[k].downStyle.candle.color,c.drawline(i,l+w/2,b,l+w/2,d,a,1),c.drawline(i,l,g,l+w/2,g,a,1),c.drawline(i,l+w/2,h,l+w,h,a,1))},drawLine:function(a,b,d,e,k,l){var g=
this.ctx,h=this.options,n=h.prepareDistance,m=this.cwidth,q=this.csize,s=this.xStart,v=h.candleStyle,h=this.yStart+this.height-h.bottomSpacing-(e-this.ymin)*this.yAxisScale;0!=l&&(n=n+l*m+s,c.drawline(g,n+q/2-m,arguments.callee.lastclose,n+q/2,h,e>a?v[k].upStyle.candle.color:v[k].downStyle.candle.color,1));arguments.callee.lastclose=h},drawHighLow:function(a,b,d){var e=this.ctx,k=this.options,l=this.ymin,g=this.yStart+this.height-k.bottomSpacing,h=k.prepareDistance,n=this.yAxisScale,m=this.cwidth,
q=this.csize,s=this.xStart,v=a.toFixed(k.fixedNum),a=g-(a-l)*n,b=h+b*m+s+q/2,d=d?k.maximumArrow.color:k.minimumArrow.color;b-s>24+e.measureText(v).width?(c.drawline(e,b,a,b-24,a,d,1),c.drawline(e,b-4,a+4,b,a,d,1),c.drawline(e,b-4,a-4,b,a,d,1),c.drawText(e,v,b-24,a,{align:"right",textBaseline:"middle",padding:-5,color:d,background:k.yAxisLabel.background,font:k.font})):(c.drawline(e,b,a,b+24,a,d,1),c.drawline(e,b+4,a+4,b,a,d,1),c.drawline(e,b+4,a-4,b,a,d,1),c.drawText(e,v,b+24+e.measureText(v).width,
a,{align:"right",textBaseline:"middle",padding:-5,color:d,background:k.yAxisLabel.background,font:k.font}))},drawPlot:function(){var a=this.options,b=a.klineType,c=this.data,d=this.timeKey,e=!1,l,g,h,n,m,q,s;if(c)for(var v=0,w=c.length;v<w;v++)if(0===v){l=c[v];for(var y=0,x=this.end;y+this.start<x;y++)g=+l[0][y+this.start],h=+l[1][y+this.start],n=+l[2][y+this.start],m=+l[3][y+this.start],q=function(){if(a.isHighLowShowed){if(h==this.mainMax&&!this.drawHighLow.maxExecuted)this.drawHighLow(h,y,!0),
this.drawHighLow.maxExecuted=!0;if(n==this.mainMin&&!this.drawHighLow.minExecuted)this.drawHighLow(n,y),this.drawHighLow.minExecuted=!0}},e=function(){var b=!1;if(1E3<this.end-this.start){var a=((this.end-this.start)/1E3).toPrecision(1),f=/^-?\d+$/;y&&!f.test(y/a)&&(b=!0)}return b},s=function(){1===b?this.drawCandle(g,h,n,m,v,y):2===b?this.drawBamboo(g,h,n,m,v,y):3===b&&this.drawLine(g,h,n,m,v,y)},(e=e.call(this))||s.call(this),q.call(this);this.drawHighLow.maxExecuted=!1;this.drawHighLow.minExecuted=
!1}else if(d[v-1]){q=d[v-1];x=[];s=q[0].percent;l=c[v];for(y=0;y<q.length;y++)if(q&&void 0!=q[y].overlapsIndex){if(!(0==y&&0!=q[y].mainIndex))x=q[y].overlapsIndex,g=l[0][x]/s,h=l[1][x]/s,n=l[2][x]/s,m=l[3][x]/s,1===b?this.drawCandle(g,h,n,m,v,y):2===b?this.drawBamboo(g,h,n,m,v,y):3===b&&this.drawLine(g,h,n,m,v,y),x=[g,h,n,m]}else x&&(g=x[3],h=x[3],n=x[3],m=x[3],1===b?this.drawCandle(g,h,n,m,v,y):2===b?this.drawBamboo(g,h,n,m,v,y):3===b&&this.drawLine(g,h,n,m,v,y),x=[g,h,n,m])}},yAxis:function(){var a=
this.ctx,b=this.xStart,d=b+this.width,e=this.yStart+this.height,g=this.options,l=this.yAxisScale,h=this.ymin,n=this.ymax,m=this.yLabels,u,q,s=g.fixedNum;if(!m||!m.length)for(var m=c.ygrid(h,n,Math.ceil((this.height-g.topSpacing-g.bottomSpacing)/g.backgroundGrid.height)),v=0,w=m.length;v<w;v++)u=m[v],q=e-(m[v]-h)*l-g.bottomSpacing,h==n&&(q=e-n*l-g.bottomSpacing),c.drawText(a,u.toFixed(s),b,q,{align:"right",textBaseline:"middle",padding:-5,color:g.yAxisLabel.color,background:g.yAxisLabel.background,
font:g.font}),this.addPercent(u,q),"dashed"==g.backgroundGrid.type?c.drawDashes(a,b,q,d,q,g.backgroundGrid.color,1):c.drawline(a,b,q,d,q,g.backgroundGrid.color)},addPercent:function(a,b){var o=this.ctx,p=this.yStart,k=this.xStart+this.width,l=this.options,i=this.yAxisScale,n=this.ymax,m=l.fixedNum,u=this.data,q,s;1<u.length&&this.isPercentLabelShow?(q=u[0],u=+q[3][this.start],s=+q[3][this.end-1],u=(a-u)/u,q=0<u?l.yAxisUpLabel.color:l.yAxisLowLabel.color,u=Math.abs(u),this.percentLabelDom=this.percentLabelDom||
h.create("div",{innerHTML:"<strong></strong><div style ='width: 5px; height: 5px; border-top: #587eb5 2px solid; border-left: #587eb5 2px solid; position: absolute; background: #fff; top: 5px; left:-4px; -webkit-transform: rotate(-45deg) skew(2deg, 0deg);border-radius: 2px;'></div>"}),!this.percentLabelDom.isplaced&&h.place(this.percentLabelDom,this.plot.domNode,"first"),this.percentLabelDom.isplaced=!0,this.percentLabelDom.children[0].innerHTML=s.toFixed(m),g.set(this.percentLabelDom,this.plot.theme.crosshair.vLabel),
e.position(this.percentLabelDom),g.set(this.percentLabelDom,{"-webkit-transform-origin":"left top","-webkit-transform":"scale("+1/d.getScaleX()+","+1/d.getScaleY()+")"}),p+=(n-s)*i,g.set(this.percentLabelDom,{position:"absolute",display:"",left:d.scale(k+5,"x")+"px",top:d.scale(p,"y")+"px",border:"1px solid rgb(60, 114, 174)","z-index":100,width:"72px",opacity:1,background:"#fff"}),c.drawText(o,u.toFixed(m)+"%",k,b,{align:"left",textBaseline:"middle",padding:5,color:q,background:l.yAxisLabel.background,
font:l.font})):this.percentLabelDom&&g.set(this.percentLabelDom,{display:"none"})},xAxis:function(){var a=this.ctx,b=this.xStart,d=this.yStart+this.height,e=this.xLabels,g=this.options,l=g.prepareDistance,h=g.showCounts,n=this.cwidth,m=this.csize,u,q,s=q=0,v,w,y,x;if(Array.isArray(e))for(var z=0,E=e.length;z<E;z++){v=e[z].length;x=Math.ceil(v/h);g.xLabelsInterval=x;for(w=z?x-1:0;w<v;w+=x)0==w&&0==z?u=b+l+w*n+m/2:u=q+x*n,q=u-s,y=a.measureText(e[z][w]).width,q>y&&(c.drawText(a,e[z][w],u,d,{align:"center",
textBaseline:"top",color:g.xAxisLabel.color,background:g.xAxisLabel.background,font:g.font}),s=u),q=u}},render:function(){var a=this.options,b=this.offsets,d=this.xStart,e=this.yStart,g=this.ctx,l=this.plot,h=this.margins,n="",m=a.candleStyle;c.clearCanvas(g,d-b.l-this.margins.l,e-b.t+1,this.width+b.l+b.r+h.l+h.r+1,this.height+b.t+b.b-1,a.background);g.strokeStyle=a.stroke;c.drawRect(g,d,e,this.width,this.height,!0);if(this.mainLabels&&a.isDrawName)for(var h=0,u=this.mainLabels.length;h<u;h++)b=m[h].downStyle.candle.color,
c.drawText(g,this.mainLabels[h],d+g.measureText(n).width,e-1,{align:"start",textBaseline:"bottom",color:b,background:a.background,font:a.font}),n+=this.mainLabels[h]+" ";c.drawText(g,this.txt,d+g.measureText(n).width,e-1,{align:"start",textBaseline:"bottom",color:a.label,background:a.background,font:a.font});n+=this.txt+" ";l.mainLabels=n;this.coreRange();this.xAxis();this.yAxis();this.drawMain()},destroy:function(){},setMainLabels:function(a){this.mainLabels=a},getMainLabels:function(){return this.mainLabels},
setMainCode:function(a){this.mainCode=a},getMainCode:function(){return this.mainCode},setTimeKey:function(a,b){this.allKey[b]=a;this.getTimeKey()[b]=c.checkSameValueInMainarr(this.getXLabels()[0],a)},getTimeKey:function(){return this.timeKey},setTimeStamp:function(a){this.timeStamp=a},getTimeStamp:function(){return this.timeStamp},setData:function(a,b){this.getData()[b]=a},getData:function(){return this.data},setXLabels:function(a){this.allXLabels=a;this.xLabels=[this._getDrawLabels(a[0])]},getXLabels:function(){return this.xLabels},
setYLabels:function(a){this.yLabels=a},getYLabels:function(){return this.yLabels},setOptions:function(a){this.options=m.mixin(this.options,a)},getOptions:function(){return this.options},setTxt:function(a){this.txt=a},clear:function(){this.data=[];this.timeKey=[];this.olddatalength=this.end=this.start=null;this.allKey=[]},setStart:function(a){this.start=a},getStart:function(){return this.start},setEnd:function(a){this.end=a},getEnd:function(){return this.end},setCount:function(a){this.count=a},getCount:function(){return this.count},
setTimeStyle:function(a){this.timeStyle=a},_getLabelsLength:function(){for(var a=0,b=0;b<this.xLabels.length;b++)a+=this.xLabels[b].length;return a},setStartTime:function(a){this.startTime=a},setEndTime:function(a){this.endTime=a},_getDrawLabels:function(a){var b=a.length,d=this.getTimeStamp();if(this.startTime&&!this.start)for(var e=c.str2millisecond(this.startTime),g=0;g<b;g++)if(Number(d[g])>=Number(e)){this.start=g;break}if(this.endTime&&!this.end){e=c.str2millisecond(this.endTime);for(g=b-1;0<=
g;g--)if(d[g]<=e){this.end=g+1;break}}if(this.olddatalength&&(this.end==this.olddatalength||this.end>this.olddatalength)||null==this.end)this.end=b;d=0<this.end-this.count?this.end-this.count:0;this.start=this.start&&!this.count?this.start:this.count?d:0;0>this.start&&(this.start=0);this.olddatalength=b;return a.slice(this.start,this.end)}})})},"dojox/customfig/datas/KlineData":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/aspect","dojo/_base/lang"],function(u,
m,n,c,a){function g(a,c){var d=a.time,f;if(d&&c.time)for(var b=0,g=c.time.length;b<g;b++)if(f=d[d.length-1],f===c.time[b])for(var p in a)f=a[p],c[p]&&(f[f.length-1]=c[p][b]);else if(f<c.time[b])for(p in a)f=a[p],c[p]&&f.push(c[p][b]);return a}return m("dojox.customfig.datas.KlineData",null,{constructor:function(a,c,d){this.store=a;this.kwArgs=c;this.value=d?"function"==typeof d?d:"object"==typeof d?function(a,b){for(var c={},e,g,l={},h=0,n=a.length;h<n;h++)c[a[h]]=h;h=0;for(n=b.length;h<n;h++){g=
b[h];for(var m in d)e=d[m],l[m]||(l[m]=[]),"function"==typeof e?l[m].push(e(l,g,c,m,this.data)):"string"==typeof e&&(void 0!==c[e]?l[m].push(g[c[e]]):delete l[m])}return l}:function(a){return a[d]}:function(a){return a.value};this.data={};this._initialRendering=!1;this.fetch()},destroy:function(){this.observeHandle&&this.observeHandle.remove();this.data={}},setCallback:function(a){this.callback=a},fetch:function(){var h=this;if(this.observeHandle)this.observeHandle.remove(),this.data={};this.store.query(this.kwArgs.query,
this.kwArgs);this.observeHandle=c.after(this.store,"put",a.hitch(this,function(a,c){var f=c[0],b,o;if(f.head&&f.datas)"message"==f.head[0]?(f.datas[0]=JSON.parse(f.datas[0],!0),o=h.value(f.datas[0].data.head,f.datas[0].data.datas),h.data[f.datas[0].obj]?(b=h.data[f.datas[0].obj],g(b,o)):h.data[f.datas[0].obj]=o):(o=h.value(f.head,f.datas),(b=o.obj)?b instanceof String?h.data[b]?(b=h.data[b],g(b,o)):h.data[b]=o:h.data[b[0]]?(b=h.data[b[0]],g(b,o)):h.data[b[0]]=o:h.data=o);else for(var n in f)b=f[n],
b.head&&b.datas&&(o=h.value(b.head,b.datas),h.data[n]?(b=h.data[n],g(b,o)):h.data[n]=o);h._pushDataChanges()}))},_pushDataChanges:function(){this.callback&&this.callback(this.data)}})})},"dojox/customfig/widget/KlineKline":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-construct,dojo/dom-geometry,dojo/dom-style,dijit/_WidgetBase,dijit/_TemplatedMixin,dojox/customfig/Plot,dojox/customfig/mains/Kline,dojox/store/SharingPlansWSStore,dojox/customfig/datas/KlineData,../utils,dojox/customfig/actions/Crosshair,dojox/customfig/actions/MouseAndKey,dojox/customfig/indicators/Indicators".split(","),
function(u,m,n,c,a,g,h,e,d,f,b,o,p){var k=m.getObject("dojox.customfig.indicators");return u("dojox.customfig.widget.KlineKline",[h,e],{templateString:'<div><div data-dojo-attach-point="containerNode" style="width:100%; height:100%;position:relative"></div></div>',codes:[],did:null,plot:null,theme:null,storeName:null,dataHandleName:null,timeScale:{value:"1m",txt:"\u4e00\u5206\u949f"},timeStyle:"%m/%d %H:%M",queryObj:{obj:"obj",time:function(a,b,c,d,f){return p.millisecond2Date(arguments.callee.that.timeStyle,
1*b[c[d]])},timeStamp:function(a,b,c){return 1*b[c.time]},open:"open",high:"high",low:"low",close:"close",volume:"volume",amount:"amount",tickcount:"tickcount"},indicator2Field:{ma:"close",vol:["volume","open","close"],macd:"close",kdj:["low","high","close"]},dateFormat:{m:"%m/%d %H:%M",d:"%Y/%m/%d",w:"%Y/%m/%d",M:"%Y/%m",q:"%Y/%m",y:"%Y"},constructor:function(a){this.kwArgs=a||{};this.timeScale=a.timeScale||this.timeScale;this.storeDatas=[];this.dataHandleDatas=[]},startup:function(){this.inherited(arguments);
if(0==parseFloat(g.get(this.domNode,"height"))&&this.domNode.parentNode){var c=a.getMarginBox(this.domNode.parentNode);delete c.t;delete c.l;a.setMarginBox(this.domNode,c)}var c=this.kwArgs,e=c.indicators||[],h=c.mainIndicators||[],o=this.plot=new d(c.plot,this.containerNode),m=new f(this.plot,c.Kline||{});m.setTxt(this.timeScale.txt);c.theme&&o.setTheme(c.theme);o.addMain(m);n.forEach(e,function(a){o.addIndicator(new k[a.type](o,a.params))});n.forEach(h,function(a){o.addMainIndicator(new k[a.type](o,
a.params))});this.codes=c.codes;this.storeName=new b;this.setTimeScale(this.timeScale);m.setTimeStyle(this.getTimeStyle());this.render()},getData:function(){this.unReg();this.reg()},reg:function(){var a=this.codes,c=this.storeName,d=this.storeDatas,f=this.plot,e=f.main,g=f.indicators,h=this.dataHandleName,k=this.dataHandleDatas,m=f.mainIndicators,p=this.queryObj,x=this.indicator2Field,z=this.getTimeScale(),u=this.setData2indicator;p.time.that=this;e.setMainCode(a);var B={service:"objinfo",type:"getinfo",
where:"obj="+a.join(","),field:"name",response_times:"1",response_mode:0};h&&h.destroy();h=new o(c,{query:B},{name:"name"});h.setCallback(function(a){var b=[];a.name&&n.forEach(a.name,function(a){b.push(a)});e.setMainLabels(b)});c={service:"quote",type:"klineex",where:"obj="+a.join(","),k_period:z.value,response_times:"-1",response_mode:0};d[0]?h=d[0]:(h=new b,d.push(h));d=new o(h,{query:c},p);k.push(d);var A=[];d.setCallback(function(a){return function(b){for(var c=0,d=a.length;c<d;c++){var h=a[c];
if(b[h])if(c)e.setData([b[h].open,b[h].high,b[h].low,b[h].close],c),A[c]=b[h].time,e.setTimeKey(A[c],c-1);else{var l=b[h];f.setData(l);e.setTimeStamp(l.timeStamp);e.setXLabels([l.time]);e.setData([l.open,l.high,l.low,l.close],c);A[c]=l.time;u(e,g,x,b[h],c);u(e,m,x,b[h],c)}}f.render()}}(a))},unReg:function(){var a=this.dataHandleDatas||[];n.forEach(a,function(a){a.destroy()});a=this.dataHandleDatas=[];this.plot.clear()},render:function(){this.getData()},resize:function(b){b&&(a.setMarginBox(this.domNode,
{w:b.w,h:b.h}),a.setMarginBox(this.containerNode,{w:b.w,h:b.h}),b=a.getMarginBox(this.containerNode),delete b.l,delete b.t,this.plot.resize(b))},changeCodes:function(a){if("[object String]"===Object.prototype.toString.call(a))this.codes=[a];else if("[object Array]"===Object.prototype.toString.call(a))this.codes=a},changeDid:function(a){this.did=a},changeQueryObj:function(a){this.queryObj=a},addCode:function(a){var b=this.getCodes();-1==b.join(",").indexOf(a)&&1<=b.length&&b.push(a)},delCode:function(){var a=
this.getCodes();if(2<=a.length)this.codes=a.slice(0,a.length-1)},delAllCode:function(){var a=this.getCodes();if(1<=a.length)this.codes=a.slice(0,1)},addIndicator:function(a){var b=a.type,c=this.plot;!c.indicators[b.toLowerCase()]&&k[b]&&c.addIndicator(new k[b](c,a.params))},delIndicator:function(a){var b=this.plot,c=b.indicators,a=a.toLowerCase();c[a]&&b.delIndicator(a)},addMainIndicator:function(a){var b=a.type,c=this.plot;!c.mainIndicators[b.toLowerCase()]&&k[b]&&c.addMainIndicator(new k[b](c,a.params))},
delMainIndicator:function(a){var b=this.plot,c=b.mainIndicators,a=a.toLowerCase();c[a]&&b.delMainIndicator(a)},setTheme:function(a){this.plot.setTheme(a)},getCodes:function(){return this.codes},setTimeScale:function(a){var b=this.dateFormat;this.timeScale=a;this.plot.main.setTxt(a.txt);this.setTimeStyle(b[a.value.slice(-1)])},getTimeScale:function(){return this.timeScale},setTimeStyle:function(a){this.timeStyle=a},getTimeStyle:function(){return this.timeStyle},setStart:function(a){this.plot.main.setStart(a)},
setEnd:function(a){this.plot.main.setEnd(a)},setStartTime:function(a){this.plot.main.setStartTime(a)},setEndTime:function(a){this.plot.main.setEndTime(a)},setCount:function(a){this.plot.main.setCount(a)},setData2indicator:function(a,b,c,d,f){var e,g,h,k;for(k in b)if(h=b[k],e=c[h.type])h.setXLabels(a.getXLabels()),h.setStart(a.getStart()),h.setEnd(a.getEnd()),"[object String]"===Object.prototype.toString.call(e)&&d[e]?h.setData(d[e],f):"[object Array]"===Object.prototype.toString.call(e)&&(g=[],n.forEach(e,
function(a){d[a]&&g.push(d[a])}),h.setData(g,f))}})})},"dojox/customfig/actions/Crosshair":function(){define("dojo/_base/declare,dijit/_WidgetBase,dijit/_TemplatedMixin,dojo/_base/lang,dojo/_base/connect,dojox/customfig/utils,dojo/dom-style,dojo/dom-construct,dojo/dom-geometry,dojo/dom,dojo/cssScale".split(","),function(u,m,n,c,a,g,h,e,d,f,b){var o=function(a,b,c,d){var f;if(a[c])return(f=a[c][b])?f=d?a[c][b-1]?a[c][b-1]:0:f:(b=d?a[c].length-2:a[c].length-1,f=a[c][b]),f},p=function(a){for(var b=0,
c=0,d=a.length;c<d;c++)b+=+a[c];return b},k=function(a,b,c,d){var f=0,d=d||0;b++;a[c]&&(f=b>a[c].length?p(a[c].slice(d))/a[c].slice(d).length:p(a[c].slice(d,b))/(b-d));return f},l=function(a){return{"\u65f6\u95f4":{field:"time",fn:function(a,b,c){return(a=o(a,b,c))?g.millisecond2Date("%Y-%m-%d %H:%M %a",a):"--"}},"\u4ef7\u683c":{field:"price",fn:function(b,c,d){return(b=o(b,c,d))?(+b).toFixed(a):"--"}},"\u5747\u4ef7":{field:"price",fn:function(b,c,d,f){return k(b,c,d,f).toFixed(a)}},"\u6da8\u8dcc":{field:"price",
fn:function(b,c,d){c=o(b,c,d);b=o(b,0,"lastclose");return c&&b?(c-b).toFixed(a):0}},"\u6210\u4ea4\u91cf":{field:"volume",fn:function(a,b,c){var d=o(a,b,c),a=o(a,b,c,!0);return d&&a?d-a:0}}}},i=function(a){return{"\u65f6\u95f4":{field:"time",fn:function(a,b,c){return(a=o(a,b,c))?a:"--"}},"\u5f00\u76d8\u4ef7":{field:"open",fn:function(b,c,d){return(b=o(b,c,d))?(+b).toFixed(a):"--"}},"\u6700\u9ad8\u4ef7":{field:"high",fn:function(b,c,d){return(b=o(b,c,d))?(+b).toFixed(a):"--"}},"\u6700\u4f4e\u4ef7":{field:"low",
fn:function(b,c,d){return(b=o(b,c,d))?(+b).toFixed(a):"--"}},"\u6536\u76d8\u4ef7":{field:"close",fn:function(b,c,d){return(b=o(b,c,d))?(+b).toFixed(a):"--"}},"\u5747\u4ef7":{field:"close",fn:function(b,c,d,f){return k(b,c,d,f).toFixed(a)}},"\u6da8\u8dcc":{field:"close",fn:function(b,c,d){var f=o(b,c,d),b=0>c-1?o(b,c,"open"):o(b,c,d,!0);return Number(f)&&b?(f-b).toFixed(a):0}},"\u6210\u4ea4\u91cf":{field:"volume",fn:function(a,b,c){return(a=o(a,b,c))?(+a).toFixed(0):"--"}},"\u6210\u4ea4\u989d":{field:"amount",
fn:function(b,c,d){var b=o(b,c,d),f;f=parseInt(b);b=""+f;1E4<(1E8>f)&&(b=(f/1E4).toFixed(a)+"\u4e07");1E8<f&&(b=(f/1E8).toFixed(a)+"\u4ebf");return b}}}},r={time:"\u65f6\u95f4",open:"\u5f00\u76d8\u4ef7",high:"\u6700\u9ad8\u4ef7",low:"\u6700\u4f4e\u4ef7",close:"\u6536\u76d8\u4ef7",average:"\u5747\u4ef7",updown:"\u6da8\u8dcc",volume:"\u6210\u4ea4\u91cf",amount:"\u6210\u4ea4\u989d",price:"\u4ef7\u683c"},t=u(null,{tipKeyValue:null,tooltipTemplateString:"<span>{1}</span>:<span>{2}</span><br>",defaultOptions:{fixNum:3},
constructor:function(a,b,d){this.mLabel=a;this.plot=b;a=c.mixin(this.defaultOptions,d?d.options:{});this.tipKeyValue=this.plot.csizeRate?i(a.fixNum):l(a.fixNum);if(d.keys){for(var a=this.tipKeyValue,d=d.keys,f=0,e=d.length,g={};f<e;f++)b=d[f],(b=r[b])&&(g[b]=a[b]);this.tipKeyValue=g}},isShow:!1,behave:function(a){var c=this.plot,e=c.kwArgs.margins,g=c.offsets,k=e.t+g.t,e=e.l+g.l,l=c.plotHeight-g.t-g.b,g=c.plotWidth-g.l-g.r,i=c.main,o=c.mainIndicators,n=c.indicators,m,p,r,t;m=d.position(f.byId(c.domNode),
!1);c=Math.round(a.pageX-m.x);a=Math.round(a.pageY-m.y);if(a>=k&&a<=k+l&&c>=e&&c<=e+g){if(this.toggle()){h.set(this.mLabel,{top:b.scale(k,"y")+"px"});if(i&&(k=i.yStart,l=k+i.height,a>=k&&a<=l&&(this.setToolTip(i,c),k=d.getMarginBox(this.mLabel,!1),this.setTooltipPos(c,e,g,k.w),o)))for(var u in o)if(m=o[u],k=m.yStart,xStart=m.xStart,l=k+m.height,r=m.options.prepareDistance,p=m.csize,t=m.cwidth,p=Math.ceil((c-xStart-r-p)/t),a>=k&&a<=l){this.setToolTip(m,c);k=d.getMarginBox(this.mLabel,!1);this.setTooltipPos(c,
e,g,k.w);p=m.getStart()?m.getStart()+p:p;m.renderTxt&&m.renderTxt(p);return}if(!i&&o)for(u in o)if(i=o[u],k=i.yStart,l=k+i.height,a>=k&&a<=l){this.setToolTip(i,c);k=d.getMarginBox(this.mLabel,!1);this.setTooltipPos(c,e,g,k.w);return}if(n)for(u in n)if(i=n[u],k=i.yStart,xStart=i.xStart,l=k+i.height,r=i.options.prepareDistance,p=i.csize,t=i.cwidth,p=Math.ceil((c-xStart-r-p)/t),a>=k&&a<=l){this.setToolTip(i,c);k=d.getMarginBox(this.mLabel,!1);this.setTooltipPos(c,e,g,k.w);p=i.getStart()?i.getStart()+
p:p;i.renderTxt&&i.renderTxt(p);break}}}else h.set(this.mLabel,{display:"none"})},setToolTip:function(a,b){var c=a.xStart,d=a.cwidth,f=a.csize;g.array2toarray1(a.xLabels);var e=this.plot,h=e.getData(),k=a.options.prepareDistance,l=this.tooltipTemplateString,c=e.main.csizeRate?Math.ceil((b-c-k-f)/d)+e.main.getStart():Math.ceil((b-c-k-f)/d),d=[],k=this.plot.theme.crosshair.tooltip,i;for(i in this.tipKeyValue){a=this.tipKeyValue[i];f=l.replace(/\{1\}/g,i);if(/\u5747\u4ef7/g.test(i))var o=e.main.getStart?
e.main.getStart():0,f=f.replace(/\{2\}/g,a.fn(h,c,a.field,o));else f=f.replace(/\{2\}/g,a.fn(h,c,a.field)),/\u65f6\u95f4/g.test(i)&&(f='<span style="color:'+k.time.color+";font-weight:"+k.time["font-weight"]+'">'+f+"</span>");d.push(f)}this.mLabel.innerHTML=d.join("")},setTooltipPos:function(a,c,d,f){a<=c+d/2?h.set(this.mLabel,{left:b.scale(c+d-f,"x")+"px"}):h.set(this.mLabel,{left:b.scale(c,"x")+"px"});h.set(this.mLabel,{right:"auto"})},toggle:function(){h.set(this.mLabel,{"-webkit-transform-origin":"left top",
"-webkit-transform":"scale("+1/b.getScaleX()+","+1/b.getScaleY()+")"});if(this.isShow)return h.set(this.mLabel,{display:""}),!0;h.set(this.mLabel,{display:"none"});return!1}}),D=u(null,{constructor:function(a,b,c,d,f){this.vLine=a;this.hLine=b;this.vLabel=c;this.hLabel=d;this.plot=f},isShow:!1,toggle:function(){h.set(this.hLabel,{display:""});h.set(this.vLabel,{display:""});h.set(this.hLabel,{"-webkit-transform-origin":"left top","-webkit-transform":"scale("+1/b.getScaleX()+","+1/b.getScaleY()+")"});
h.set(this.vLabel,{"-webkit-transform-origin":"left top","-webkit-transform":"scale("+1/b.getScaleX()+","+1/b.getScaleY()+")"});h.set(this.hLine,{"-webkit-transform-origin":"left top","-webkit-transform":"scale("+1/b.getScaleX()+","+1/b.getScaleY()+")"});h.set(this.vLine,{"-webkit-transform-origin":"left top","-webkit-transform":"scale("+1/b.getScaleX()+","+1/b.getScaleY()+")"});if(this.isShow)return h.set(this.hLine,{display:""}),h.set(this.vLine,{display:""}),!0;h.set(this.hLine,{display:"none"});
h.set(this.vLine,{display:"none"});return!1},behave:function(a){var c=this.plot,e=c.kwArgs.margins,g=c.offsets,k=e.t+g.t,e=e.l+g.l,l=c.plotHeight-g.t-g.b,g=c.plotWidth-g.l-g.r,i=c.main,o=c.mainIndicators,n=c.indicators,m,p,r;r=d.position(f.byId(c.domNode),!0);c=Math.round(a.pageX-r.x);a=Math.round(a.pageY-r.y);if(a>=k&&a<=k+l&&c>=e&&c<=e+g){this.toggle()&&(h.set(this.hLine,{width:g+"px",left:b.scale(e,"x")+"px",top:b.scale(a,"y")+"px"}),h.set(this.vLine,{height:l+"px",top:b.scale(k,"y")+"px",left:b.scale(c,
"x")+"px"}));if(i&&(m=i.yStart,r=m+i.height,p=i.yAxisScale,a>=m&&a<=r))i.baseValue?(p=i.baseValue[0],m=p*i.ymin,p*=i.ymax,p=i.height/(p-m)):m=i.ymin,this.setXLabel(i,c),this.setYLabel(m,r,p,a,i.options.bottomSpacing||0,i.options.fixedNum);if(!i&&o)for(var t in o)i=o[t],m=i.yStart,r=m+i.height,a>=m&&a<=r&&(this.setXLabel(i,c),this.setYLabel(i.ymin,r,i.yAxisScale,a,i.options.bottomSpacing||0,i.options.fixedNum));if(n)for(t in n)i=n[t],m=i.yStart,r=m+i.height,a>=m&&a<=r&&(this.setXLabel(i,c),this.setYLabel(i.ymin,
r,i.yAxisScale,a,i.options.bottomSpacing||0,i.options.fixedNum));o=d.position(this.hLabel);t=d.position(this.vLabel);g=c-e<o.w/2?e:g-(c-e)<o.w/2?e+g-o:c-o.w/2;h.set(this.hLabel,{top:b.scale(k+l+2,"y")+"px",left:b.scale(g,"x")+"px"});h.set(this.vLabel,{left:"-3px",top:b.scale(a-t.h/2,"y")+"px",width:e+"px"})}else h.set(this.hLine,{display:"none"}),h.set(this.vLine,{display:"none"}),h.set(this.hLabel,{display:"none"}),h.set(this.vLabel,{display:"none"})},setXLabel:function(a,b){var c=a.xStart,d=a.cwidth,
f=a.csize,e=g.array2toarray1(a.xLabels);prepareDistance=a.options.prepareDistance;xline=Math.ceil((b-c-prepareDistance-f)/d);c=e[xline]||e[xline-1];"undefined"==typeof c&&(c="--/--");this.hLabel.children[0].innerHTML=c},setYLabel:function(a,b,c,d,f,e){this.vLabel.children[0].innerHTML=((b-d-f)/c+a).toFixed(e)}});return u("dojox.customfig.actions.Crosshair",[m,n],{templateString:"<div><div data-dojo-attach-point='mLabel' style='display:none;'></div><div data-dojo-attach-point='vLabel' style='display:none;'><strong data-dojo-attach-point='vLabelVal'></strong><div style ='width: 5px; height: 5px; border-top: #587eb5 2px solid; border-left: #587eb5 2px solid; position: absolute;  top: 5px; right: -4px; -webkit-transform: rotate(145deg) skew(1deg, 1deg);border-radius: 2px;'></div></div><div data-dojo-attach-point='hLabel' style='display:none;'><strong data-dojo-attach-point='hLabelVal'></strong><div style ='width: 5px; height: 5px; border-top: #587eb5 2px solid; border-left: #587eb5 2px solid; position: absolute; top: -5px; left: 45%; -webkit-transform: rotate(45deg) skew(0deg, 0deg);border-radius: 2px;'></div></div><div data-dojo-attach-point='vLine' style='display:none;'></div><div data-dojo-attach-point='hLine' style='display:none;'></div>",
plot:null,lineLabel:null,toolTip:null,constructor:function(a){this.kwArgs=a;this.plot=a.plot;this.tipKey=a.tipKey||{}},postCreate:function(){var b=this.kwArgs,d=this.plot.theme,b=this.style={tooltip:b.style?c.mixin({},d.crosshair.tooltip,b.style.tooltip):d.crosshair.tooltip,hLine:b.style?c.mixin({},d.crosshair.hLine,b.style.hLine):d.crosshair.hLine,vLine:b.style?c.mixin({},d.crosshair.vLine,b.style.vLine):d.crosshair.vLine,hLabel:b.style?c.mixin({},d.crosshair.hLabel,b.style.hLabel):d.crosshair.hLabel,
vLabel:b.style?c.mixin({},d.crosshair.vLabel,b.style.vLabel):d.crosshair.vLabel};h.set(this.mLabel,b.tooltip.content);h.set(this.hLabel,b.hLabel);h.set(this.vLabel,b.vLabel);h.set(this.hLine,b.hLine);h.set(this.vLine,b.vLine);this.lineLabel=new D(this.vLine,this.hLine,this.vLabel,this.hLabel,this.plot);this.toolTip=new t(this.mLabel,this.plot,this.tipKey);e.place(this.domNode,this.plot.domNode,"first");a.connect(this.plot.domNode,"click",this,this.click);a.connect(this.plot.domNode,"mousemove",this,
this.mouseMove)},click:function(a){var b=this.plot,c=b.kwArgs.margins,e=b.offsets,g=c.t+e.t,c=c.l+e.l,h=b.plotHeight-e.t-e.b,e=b.plotWidth-e.l-e.r,k;k=d.position(f.byId(b.domNode),!1);b=Math.round(a.pageX-k.x);a=Math.round(a.pageY-k.y);if(a>=g&&a<=g+h&&b>=c&&b<=c+e)this.toolTip.isShow=!this.toolTip.isShow,this.lineLabel.isShow=!this.lineLabel.isShow},mouseMove:function(a){this.toolTip.behave(a);this.lineLabel.behave(a)}})})},"dojox/customfig/actions/MouseAndKey":function(){define("dojo/on,dojo/mouse,dojo/keys,dojo/_base/declare,dojox/customfig/actions/CustomfigAction,dojo/_base/lang,dojo/_base/array,dojo/dom,dojo/dom-geometry".split(","),
function(u,m,n,c,a,g,h,e,d){return c("dojox.customfig.actions.MouseAndKey",a,{oldPageX:0,constructor:function(a){this.plot=a;this._listeners.push({eventName:"mousedown",methodName:"onMouseDown"});this._listeners.push({eventName:"keydown",methodName:"onKeyDown"});this._listeners.push({eventName:"mousemove",methodName:"onMouseMove"});this._handles=[];this.connect();this.plot.canvas.tabIndex=1},_disconnectHandles:function(){h.forEach(this._handles,function(a){a.remove()});this._handles=[]},onMouseDown:function(a){if(m.isLeft(a))this.oldPageX=
a.pageX,this.start=this.plot.main.getStart(),this.end=this.plot.main.getEnd(),this._handles.push(u(this.plot.canvas,"mousemove",g.hitch(this,"_onMouseMove"))),this._handles.push(u(this.plot.canvas,"mouseup",g.hitch(this,"_onMouseUp")))},onMouseMove:function(a){var b=this.plot,c=b.kwArgs.margins,g=b.offsets,h=c.t+g.t,c=c.l+g.l,l=b.plotHeight-g.t-g.b,g=b.plotWidth-g.l-g.r,i=b.canvas,m,n;n=d.position(e.byId(b.canvas),!1);m=Math.round(a.pageX-n.x);a=Math.round(a.pageY-n.y);if(a>=h&&a<=h+l&&m>=c&&m<=c+
g)i.focus(),b.canvas.style.cursor="default";if(a>=h+l&&m>=c&&m<=c+g)i.focus(),b.canvas.style.cursor="e-resize"},onKeyDown:function(a){var b=this.plot,c=b.mainIndicators,d=b.indicators,c=b.mainIndicators,e=b.main,g=e.width,h=e.options.prepareDistance,m=0.5,t=e.allKey,u=e.allXLabels?e.allXLabels[0].length:0;e.getEnd();var q=e.getStart(),s=arguments.callee;switch(a.charCode||a.keyCode){case n.UP_ARROW:m=1+m;break;case n.DOWN_ARROW:m=1-m;break;default:return}count=Math.floor((g-h)/(e.cwidth*m));count>
u&&(count=u);0==q&&1>m?(e.setEnd(count),e.setCount(0)):e.setCount(count);e.setXLabels(e.allXLabels?e.allXLabels:[]);if(!(1>count||count==u&&s.count==u)){s.count=count;for(var v in t)e.setTimeKey(t[v],v);for(var w in d)g=d[w],g.setXLabels(e.getXLabels()),g.setStart(e.getStart()),g.setEnd(e.getEnd());for(w in c)d=c[w],d.setXLabels(e.getXLabels()),d.setStart(e.getStart()),d.setEnd(e.getEnd()),d.setData(d.allDataItem);b.render()}},_onMouseMove:function(a){var b=this.plot,c=b.kwArgs.margins,g=b.offsets,
h=c.t+g.t,l=c.l+g.l,i=b.plotHeight-g.t-g.b,m=b.plotWidth-g.l-g.r,g=b.main,c=b.mainIndicators,n=b.indicators,c=b.mainIndicators,u,q,s;s=d.position(e.byId(b.canvas),!1);u=Math.round(a.pageX-s.x);if(Math.round(a.pageY-s.y)>=h+i&&u>=l&&u<=l+m&&(b.canvas.style.cursor="e-resize",a=a.pageX-this.oldPageX,h=Math.round(Math.abs(a)/g.cwidth),l=g.allXLabels?g.allXLabels[0].length:0,i=g.allKey,!(1>h||0>a&&g.end==l||0<a&&0==g.start))){0<a||(h=-h);g.setStart(this.start-h);g.setEnd(this.end-h);g.setCount(0);g.setXLabels(g.allXLabels?
g.allXLabels:[]);for(q in i)g.setTimeKey(i[q],q);for(var v in n)q=n[v],q.setXLabels(g.getXLabels()),q.setStart(g.getStart()),q.setEnd(g.getEnd());for(v in c)q=c[v],q.setXLabels(g.getXLabels()),q.setStart(g.getStart()),q.setEnd(g.getEnd()),q.setData(q.allDataItem);b.render()}},_onMouseUp:function(){this._disconnectHandles()}})})},"dojox/customfig/widget/EDXSharingPlans":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-geometry,dojo/dom-style,dijit/_WidgetBase,dijit/_TemplatedMixin,dojox/customfig/Plot,dojox/customfig/mains/SharingPlans,dojox/store/SharingPlansWSStore,dojox/customfig/datas/SharingPlansData,../utils,dojox/customfig/widget/MinSharingPlans,dojox/customfig/indicators/Indicators".split(","),
function(u,m,n,c,a,g,h,e,d,f,b,o,p){m.getObject("dojox.customfig.indicators");return u("dojox.customfig.widget.EDXSharingPlans",[p],{queryObj:{obj:"obj",time:function(a,b,c){return 1*o.str2millisecond(b[c.updateTime])},price:"Price",volume:"Vol",edx:"EDX",etfBuyAmount:"EtfBuyAmount",etfSellAmount:"EtfSellAmount"},reg:function(){var a=this.storeName,c=this.storeTradeTime,d=this.storeDatas,e=this.dataHandleName,g=this.dataHandleTradeTime,h=this.dataHandleDatas,m=this.plot,p=m.main,u=m.indicators,w=
this;mainIndicators=m.mainIndicators;queryObj=this.queryObj;indicator2Field=this.indicator2Field;did=this.did;baseDid=this.baseDid;codes=n.map(this.codes,function(a){return a.name});codeTypes=n.map(this.codes,function(a){return a.type});p.setMainCode(codes);var y={service:"objinfo",type:"getinfo",where:"obj="+codes.join(","),field:"name,lastclose,lastexecprice",response_times:"1",response_mode:0};e&&e.destroy();e=this.dataHandleName=new b(a,{query:y},{name:"name",lastclose:"lastclose",lastexecprice:"lastexecprice"});
e.setCallback(function(a){var b=[],c=[];a.name&&n.forEach(a.name,function(a){b.push(a)});p.setMainLabels(b);n.forEach(codes,function(b,d){var e=a[codeTypes[d]];"undefined"!=typeof e&&"undefined"!=typeof e[d]?c.push(+e[d]):c.push(0)});p.setBaseValue(c);m.setData(a)});a={service:"objinfo",type:"base",where:"obj="+codes.join(","),field:"open_close_num,open_close_time",response_times:"1",response_mode:0};g&&g.destroy();var g=this.dataHandleTradeTime=new b(c,{query:a},{open_close_num:"open_close_num",
open_close_time:"open_close_time"}),x=[];g.setCallback(function(a){if(a.open_close_num)for(var b=0,c=a.open_close_num.length;b<c;b++)if(x.push(o.organizeXLabels(a.open_close_num[b],a.open_close_time[b])),b)p.setTimeKey(o.checkSameValueInMainarr(x[0],x[b]),b-1);else{p.setXLabels(x[0]);for(var d in u)u[d].setXLabels(x[0]);for(d in mainIndicators)mainIndicators[d].setXLabels(x[0])}m.setData(a)});c=0;for(g=codes.length;c<g;c++)a={service:"script",script:"EDX('"+codes[c]+"','1d','20120903000000000000','20130807000000000000');",
curdir:"120\\",timer:1E3,response_times:-1},d[c]?e=d[c]:(e=new f,d.push(e)),a=new b(e,{query:a},queryObj),h.push(a),a.setCallback(function(a,b){return function(c){c[a]&&(p.setData(c[a].price,b),0===b&&(w.setData2indicator(u,indicator2Field,c[a],b),w.setData2indicator(mainIndicators,indicator2Field,c[a],b)),m.setData(c[a]),m.render())}}(codes[c],c))}})})}}});
